var kw=Object.defineProperty;var Tw=(Oi,Pi,Mi)=>Pi in Oi?kw(Oi,Pi,{enumerable:!0,configurable:!0,writable:!0,value:Mi}):Oi[Pi]=Mi;var ti=(Oi,Pi,Mi)=>(Tw(Oi,typeof Pi!="symbol"?Pi+"":Pi,Mi),Mi),du=(Oi,Pi,Mi)=>{if(!Pi.has(Oi))throw TypeError("Cannot "+Mi)};var l=(Oi,Pi,Mi)=>(du(Oi,Pi,"read from private field"),Mi?Mi.call(Oi):Pi.get(Oi)),N=(Oi,Pi,Mi)=>{if(Pi.has(Oi))throw TypeError("Cannot add the same private member more than once");Pi instanceof WeakSet?Pi.add(Oi):Pi.set(Oi,Mi)},J=(Oi,Pi,Mi,Be)=>(du(Oi,Pi,"write to private field"),Be?Be.call(Oi,Mi):Pi.set(Oi,Mi),Mi),ws=(Oi,Pi,Mi,Be)=>({set _(pc){J(Oi,Pi,pc,Mi)},get _(){return l(Oi,Pi,Be)}}),Y=(Oi,Pi,Mi)=>(du(Oi,Pi,"access private method"),Mi);import{b2 as $s,R as se,a8 as Pw,b3 as a0,b4 as o0,r as Ni,b5 as Wh,j as Mw,a as wn,__tla as Rw}from"./index-0d2e1b37.js";let l0,Fw=Promise.all([(()=>{try{return Rw}catch{}})()]).then(async()=>{var Oi={976:(r,t,s)=>{var Gt,lt,Ft,uu,ie,xa,_e,h0,T,c0,D,H,L,V,j,G,W,U,O,z,et,nt,gt,yt,Nt,Ht,Pt,Bt,d0,at,$h,vt,fu,bt,pu,ot,ft,Et,Kt,te,me,Pe,gu,je,hi,ze,vi,u0,er,mu;s.d(t,{AnnotationLayer:()=>Ve,FreeTextAnnotationElement:()=>st,InkAnnotationElement:()=>Dt,StampAnnotationElement:()=>ge});var n=s(292),a=s(419),o=s(792);function c(Me){return Math.floor(Math.max(0,Math.min(1,Me))*255).toString(16).padStart(2,"0")}function u(Me){return Math.max(0,Math.min(255,255*Me))}class d{static CMYK_G([Q,K,ht,xt]){return["G",1-Math.min(1,.3*Q+.59*ht+.11*K+xt)]}static G_CMYK([Q]){return["CMYK",0,0,0,1-Q]}static G_RGB([Q]){return["RGB",Q,Q,Q]}static G_rgb([Q]){return Q=u(Q),[Q,Q,Q]}static G_HTML([Q]){const K=c(Q);return`#${K}${K}${K}`}static RGB_G([Q,K,ht]){return["G",.3*Q+.59*K+.11*ht]}static RGB_rgb(Q){return Q.map(u)}static RGB_HTML(Q){return`#${Q.map(c).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([Q,K,ht,xt]){return["RGB",1-Math.min(1,Q+xt),1-Math.min(1,ht+xt),1-Math.min(1,K+xt)]}static CMYK_rgb([Q,K,ht,xt]){return[u(1-Math.min(1,Q+xt)),u(1-Math.min(1,ht+xt)),u(1-Math.min(1,K+xt))]}static CMYK_HTML(Q){const K=this.CMYK_RGB(Q).slice(1);return this.RGB_HTML(K)}static RGB_CMYK([Q,K,ht]){const xt=1-Q,St=1-K,It=1-ht,Ot=Math.min(xt,St,It);return["CMYK",xt,St,It,Ot]}}var f=s(284);const m=1e3,S=9,_=new WeakSet;function v(Me){return{width:Me[2]-Me[0],height:Me[3]-Me[1]}}class b{static create(Q){switch(Q.data.annotationType){case n.AnnotationType.LINK:return new A(Q);case n.AnnotationType.TEXT:return new F(Q);case n.AnnotationType.WIDGET:switch(Q.data.fieldType){case"Tx":return new g(Q);case"Btn":return Q.data.radioButton?new C(Q):Q.data.checkBox?new E(Q):new B(Q);case"Ch":return new I(Q);case"Sig":return new w(Q)}return new M(Q);case n.AnnotationType.POPUP:return new rt(Q);case n.AnnotationType.FREETEXT:return new st(Q);case n.AnnotationType.LINE:return new wt(Q);case n.AnnotationType.SQUARE:return new dt(Q);case n.AnnotationType.CIRCLE:return new Tt(Q);case n.AnnotationType.POLYLINE:return new Lt(Q);case n.AnnotationType.CARET:return new ct(Q);case n.AnnotationType.INK:return new Dt(Q);case n.AnnotationType.POLYGON:return new Qt(Q);case n.AnnotationType.HIGHLIGHT:return new ee(Q);case n.AnnotationType.UNDERLINE:return new zt(Q);case n.AnnotationType.SQUIGGLY:return new Jt(Q);case n.AnnotationType.STRIKEOUT:return new oe(Q);case n.AnnotationType.STAMP:return new ge(Q);case n.AnnotationType.FILEATTACHMENT:return new Ae(Q);default:return new x(Q)}}}const ve=class{constructor(Q,{isRenderable:K=!1,ignoreBorder:ht=!1,createQuadrilaterals:xt=!1}={}){N(this,Ft);N(this,Gt,null);N(this,lt,!1);this.isRenderable=K,this.data=Q.data,this.layer=Q.layer,this.linkService=Q.linkService,this.downloadManager=Q.downloadManager,this.imageResourcesPath=Q.imageResourcesPath,this.renderForms=Q.renderForms,this.svgFactory=Q.svgFactory,this.annotationStorage=Q.annotationStorage,this.enableScripting=Q.enableScripting,this.hasJSActions=Q.hasJSActions,this._fieldObjects=Q.fieldObjects,this.parent=Q.parent,K&&(this.container=this._createContainer(ht)),xt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Q,contentsObj:K,richText:ht}){return!!(Q!=null&&Q.str||K!=null&&K.str||ht!=null&&ht.str)}get hasPopupData(){return ve._hasPopupData(this.data)}updateEdited(Q){if(!this.container)return;l(this,Gt)||J(this,Gt,{rect:this.data.rect.slice(0)});const{rect:K}=Q;K&&Y(this,Ft,uu).call(this,K)}resetEdited(){!l(this,Gt)||(Y(this,Ft,uu).call(this,l(this,Gt).rect),J(this,Gt,null))}_createContainer(Q){const{data:K,parent:{page:ht,viewport:xt}}=this,St=document.createElement("section");St.setAttribute("data-annotation-id",K.id),this instanceof M||(St.tabIndex=m);const{style:It}=St;if(It.zIndex=this.parent.zIndex++,K.popupRef&&St.setAttribute("aria-haspopup","dialog"),K.alternativeText&&(St.title=K.alternativeText),K.noRotate&&St.classList.add("norotate"),!K.rect||this instanceof rt){const{rotation:we}=K;return!K.hasOwnCanvas&&we!==0&&this.setRotation(we,St),St}const{width:Ot,height:ye}=v(K.rect);if(!Q&&K.borderStyle.width>0){It.borderWidth=`${K.borderStyle.width}px`;const we=K.borderStyle.horizontalCornerRadius,He=K.borderStyle.verticalCornerRadius;if(we>0||He>0){const zi=`calc(${we}px * var(--scale-factor)) / calc(${He}px * var(--scale-factor))`;It.borderRadius=zi}else if(this instanceof C){const zi=`calc(${Ot}px * var(--scale-factor)) / calc(${ye}px * var(--scale-factor))`;It.borderRadius=zi}switch(K.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:It.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:It.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:It.borderBottomStyle="solid";break}const Ue=K.borderColor||null;Ue?(J(this,lt,!0),It.borderColor=n.Util.makeHexColor(Ue[0]|0,Ue[1]|0,Ue[2]|0)):It.borderWidth=0}const le=n.Util.normalizeRect([K.rect[0],ht.view[3]-K.rect[1]+ht.view[1],K.rect[2],ht.view[3]-K.rect[3]+ht.view[1]]),{pageWidth:$t,pageHeight:ne,pageX:ue,pageY:he}=xt.rawDims;It.left=`${100*(le[0]-ue)/$t}%`,It.top=`${100*(le[1]-he)/ne}%`;const{rotation:Le}=K;return K.hasOwnCanvas||Le===0?(It.width=`${100*Ot/$t}%`,It.height=`${100*ye/ne}%`):this.setRotation(Le,St),St}setRotation(Q,K=this.container){if(!this.data.rect)return;const{pageWidth:ht,pageHeight:xt}=this.parent.viewport.rawDims,{width:St,height:It}=v(this.data.rect);let Ot,ye;Q%180===0?(Ot=100*St/ht,ye=100*It/xt):(Ot=100*It/ht,ye=100*St/xt),K.style.width=`${Ot}%`,K.style.height=`${ye}%`,K.setAttribute("data-main-rotation",(360-Q)%360)}get _commonActions(){const Q=(K,ht,xt)=>{const St=xt.detail[K],It=St[0],Ot=St.slice(1);xt.target.style[ht]=d[`${It}_HTML`](Ot),this.annotationStorage.setValue(this.data.id,{[ht]:d[`${It}_rgb`](Ot)})};return(0,n.shadow)(this,"_commonActions",{display:K=>{const{display:ht}=K.detail,xt=ht%2===1;this.container.style.visibility=xt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:xt,noPrint:ht===1||ht===2})},print:K=>{this.annotationStorage.setValue(this.data.id,{noPrint:!K.detail.print})},hidden:K=>{const{hidden:ht}=K.detail;this.container.style.visibility=ht?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:ht,noView:ht})},focus:K=>{setTimeout(()=>K.target.focus({preventScroll:!1}),0)},userName:K=>{K.target.title=K.detail.userName},readonly:K=>{K.target.disabled=K.detail.readonly},required:K=>{this._setRequired(K.target,K.detail.required)},bgColor:K=>{Q("bgColor","backgroundColor",K)},fillColor:K=>{Q("fillColor","backgroundColor",K)},fgColor:K=>{Q("fgColor","color",K)},textColor:K=>{Q("textColor","color",K)},borderColor:K=>{Q("borderColor","borderColor",K)},strokeColor:K=>{Q("strokeColor","borderColor",K)},rotation:K=>{const ht=K.detail.rotation;this.setRotation(ht),this.annotationStorage.setValue(this.data.id,{rotation:ht})}})}_dispatchEventFromSandbox(Q,K){var xt;const ht=this._commonActions;for(const St of Object.keys(K.detail))(xt=Q[St]||ht[St])==null||xt(K)}_setDefaultPropertiesFromJS(Q){if(!this.enableScripting)return;const K=this.annotationStorage.getRawValue(this.data.id);if(!K)return;const ht=this._commonActions;for(const[xt,St]of Object.entries(K)){const It=ht[xt];if(It){const Ot={detail:{[xt]:St},target:Q};It(Ot),delete K[xt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Q}=this.data;if(!Q)return;const[K,ht,xt,St]=this.data.rect;if(Q.length===1){const[,{x:we,y:He},{x:Ue,y:zi}]=Q[0];if(xt===we&&St===He&&K===Ue&&ht===zi)return}const{style:It}=this.container;let Ot;if(l(this,lt)){const{borderColor:we,borderWidth:He}=It;It.borderWidth=0,Ot=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${we}" stroke-width="${He}">`],this.container.classList.add("hasBorder")}const ye=xt-K,le=St-ht,{svgFactory:$t}=this,ne=$t.createElement("svg");ne.classList.add("quadrilateralsContainer"),ne.setAttribute("width",0),ne.setAttribute("height",0);const ue=$t.createElement("defs");ne.append(ue);const he=$t.createElement("clipPath"),Le=`clippath_${this.data.id}`;he.setAttribute("id",Le),he.setAttribute("clipPathUnits","objectBoundingBox"),ue.append(he);for(const[,{x:we,y:He},{x:Ue,y:zi}]of Q){const ei=$t.createElement("rect"),lr=(Ue-K)/ye,Hi=(St-He)/le,qe=(we-Ue)/ye,$=(He-zi)/le;ei.setAttribute("x",lr),ei.setAttribute("y",Hi),ei.setAttribute("width",qe),ei.setAttribute("height",$),he.append(ei),Ot==null||Ot.push(`<rect vector-effect="non-scaling-stroke" x="${lr}" y="${Hi}" width="${qe}" height="${$}"/>`)}l(this,lt)&&(Ot.push("</g></svg>')"),It.backgroundImage=Ot.join("")),this.container.append(ne),this.container.style.clipPath=`url(#${Le})`}_createPopup(){const{container:Q,data:K}=this;Q.setAttribute("aria-haspopup","dialog");const ht=new rt({data:{color:K.color,titleObj:K.titleObj,modificationDate:K.modificationDate,contentsObj:K.contentsObj,richText:K.richText,parentRect:K.rect,borderStyle:0,id:`popup_${K.id}`,rotation:K.rotation},parent:this.parent,elements:[this]});this.parent.div.append(ht.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Q,K=null){const ht=[];if(this._fieldObjects){const xt=this._fieldObjects[Q];if(xt)for(const{page:St,id:It,exportValues:Ot}of xt){if(St===-1||It===K)continue;const ye=typeof Ot=="string"?Ot:null,le=document.querySelector(`[data-element-id="${It}"]`);if(le&&!_.has(le)){(0,n.warn)(`_getElementsByName - element not allowed: ${It}`);continue}ht.push({id:It,exportValue:ye,domElement:le})}return ht}for(const xt of document.getElementsByName(Q)){const{exportValue:St}=xt,It=xt.getAttribute("data-element-id");It!==K&&(!_.has(xt)||ht.push({id:It,exportValue:St,domElement:xt}))}return ht}show(){var Q;this.container&&(this.container.hidden=!1),(Q=this.popup)==null||Q.maybeShow()}hide(){var Q;this.container&&(this.container.hidden=!0),(Q=this.popup)==null||Q.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Q=this.getElementsToTriggerPopup();if(Array.isArray(Q))for(const K of Q)K.classList.add("highlightArea");else Q.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:Q,data:{id:K}}=this;this.container.addEventListener("dblclick",()=>{var ht;(ht=this.linkService.eventBus)==null||ht.dispatch("switchannotationeditormode",{source:this,mode:Q,editId:K})})}};let x=ve;Gt=new WeakMap,lt=new WeakMap,Ft=new WeakSet,uu=function(Q){const{container:{style:K},data:{rect:ht,rotation:xt},parent:{viewport:{rawDims:{pageWidth:St,pageHeight:It,pageX:Ot,pageY:ye}}}}=this;ht==null||ht.splice(0,4,...Q);const{width:le,height:$t}=v(Q);K.left=`${100*(Q[0]-Ot)/St}%`,K.top=`${100*(It-Q[3]+ye)/It}%`,xt===0?(K.width=`${100*le/St}%`,K.height=`${100*$t/It}%`):this.setRotation(xt)};class A extends x{constructor(K,ht=null){super(K,{isRenderable:!0,ignoreBorder:!!(ht!=null&&ht.ignoreBorder),createQuadrilaterals:!0});N(this,ie);N(this,_e);N(this,T);this.isTooltipOnly=K.data.isTooltipOnly}render(){const{data:K,linkService:ht}=this,xt=document.createElement("a");xt.setAttribute("data-element-id",K.id);let St=!1;return K.url?(ht.addLinkAttributes(xt,K.url,K.newWindow),St=!0):K.action?(this._bindNamedAction(xt,K.action),St=!0):K.attachment?(Y(this,_e,h0).call(this,xt,K.attachment,K.attachmentDest),St=!0):K.setOCGState?(Y(this,T,c0).call(this,xt,K.setOCGState),St=!0):K.dest?(this._bindLink(xt,K.dest),St=!0):(K.actions&&(K.actions.Action||K.actions["Mouse Up"]||K.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(xt,K),St=!0),K.resetForm?(this._bindResetFormAction(xt,K.resetForm),St=!0):this.isTooltipOnly&&!St&&(this._bindLink(xt,""),St=!0)),this.container.classList.add("linkAnnotation"),St&&this.container.append(xt),this.container}_bindLink(K,ht){K.href=this.linkService.getDestinationHash(ht),K.onclick=()=>(ht&&this.linkService.goToDestination(ht),!1),(ht||ht==="")&&Y(this,ie,xa).call(this)}_bindNamedAction(K,ht){K.href=this.linkService.getAnchorUrl(""),K.onclick=()=>(this.linkService.executeNamedAction(ht),!1),Y(this,ie,xa).call(this)}_bindJSAction(K,ht){K.href=this.linkService.getAnchorUrl("");const xt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const St of Object.keys(ht.actions)){const It=xt.get(St);!It||(K[It]=()=>{var Ot;return(Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ht.id,name:St}}),!1})}K.onclick||(K.onclick=()=>!1),Y(this,ie,xa).call(this)}_bindResetFormAction(K,ht){const xt=K.onclick;if(xt||(K.href=this.linkService.getAnchorUrl("")),Y(this,ie,xa).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),xt||(K.onclick=()=>!1);return}K.onclick=()=>{var ne;xt==null||xt();const{fields:St,refs:It,include:Ot}=ht,ye=[];if(St.length!==0||It.length!==0){const ue=new Set(It);for(const he of St){const Le=this._fieldObjects[he]||[];for(const{id:we}of Le)ue.add(we)}for(const he of Object.values(this._fieldObjects))for(const Le of he)ue.has(Le.id)===Ot&&ye.push(Le)}else for(const ue of Object.values(this._fieldObjects))ye.push(...ue);const le=this.annotationStorage,$t=[];for(const ue of ye){const{id:he}=ue;switch($t.push(he),ue.type){case"text":{const we=ue.defaultValue||"";le.setValue(he,{value:we});break}case"checkbox":case"radiobutton":{const we=ue.defaultValue===ue.exportValues;le.setValue(he,{value:we});break}case"combobox":case"listbox":{const we=ue.defaultValue||"";le.setValue(he,{value:we});break}default:continue}const Le=document.querySelector(`[data-element-id="${he}"]`);if(Le){if(!_.has(Le)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${he}`);continue}}else continue;Le.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:$t,name:"ResetForm"}})),!1}}}ie=new WeakSet,xa=function(){this.container.setAttribute("data-internal-link","")},_e=new WeakSet,h0=function(K,ht,xt=null){K.href=this.linkService.getAnchorUrl(""),K.onclick=()=>{var St;return(St=this.downloadManager)==null||St.openOrDownloadData(ht.content,ht.filename,xt),!1},Y(this,ie,xa).call(this)},T=new WeakSet,c0=function(K,ht){K.href=this.linkService.getAnchorUrl(""),K.onclick=()=>(this.linkService.executeSetOCGState(ht),!1),Y(this,ie,xa).call(this)};class F extends x{constructor(Q){super(Q,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Q=document.createElement("img");return Q.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Q.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),Q.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Q),this.container}}class M extends x{render(){return this.container}showElementAndHideCanvas(Q){var K;this.data.hasOwnCanvas&&(((K=Q.previousSibling)==null?void 0:K.nodeName)==="CANVAS"&&(Q.previousSibling.hidden=!0),Q.hidden=!1)}_getKeyModifier(Q){return n.FeatureTest.platform.isMac?Q.metaKey:Q.ctrlKey}_setEventListener(Q,K,ht,xt,St){ht.includes("mouse")?Q.addEventListener(ht,It=>{var Ot;(Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:xt,value:St(It),shift:It.shiftKey,modifier:this._getKeyModifier(It)}})}):Q.addEventListener(ht,It=>{var Ot;if(ht==="blur"){if(!K.focused||!It.relatedTarget)return;K.focused=!1}else if(ht==="focus"){if(K.focused)return;K.focused=!0}!St||((Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:xt,value:St(It)}}))})}_setEventListeners(Q,K,ht,xt){var St,It,Ot;for(const[ye,le]of ht)(le==="Action"||(St=this.data.actions)!=null&&St[le])&&((le==="Focus"||le==="Blur")&&(K||(K={focused:!1})),this._setEventListener(Q,K,ye,le,xt),le==="Focus"&&!((It=this.data.actions)!=null&&It.Blur)?this._setEventListener(Q,K,"blur","Blur",null):le==="Blur"&&!((Ot=this.data.actions)!=null&&Ot.Focus)&&this._setEventListener(Q,K,"focus","Focus",null))}_setBackgroundColor(Q){const K=this.data.backgroundColor||null;Q.style.backgroundColor=K===null?"transparent":n.Util.makeHexColor(K[0],K[1],K[2])}_setTextStyle(Q){const K=["left","center","right"],{fontColor:ht}=this.data.defaultAppearanceData,xt=this.data.defaultAppearanceData.fontSize||S,St=Q.style;let It;const Ot=2,ye=le=>Math.round(10*le)/10;if(this.data.multiLine){const le=Math.abs(this.data.rect[3]-this.data.rect[1]-Ot),$t=Math.round(le/(n.LINE_FACTOR*xt))||1,ne=le/$t;It=Math.min(xt,ye(ne/n.LINE_FACTOR))}else{const le=Math.abs(this.data.rect[3]-this.data.rect[1]-Ot);It=Math.min(xt,ye(le/n.LINE_FACTOR))}St.fontSize=`calc(${It}px * var(--scale-factor))`,St.color=n.Util.makeHexColor(ht[0],ht[1],ht[2]),this.data.textAlignment!==null&&(St.textAlign=K[this.data.textAlignment])}_setRequired(Q,K){K?Q.setAttribute("required",!0):Q.removeAttribute("required"),Q.setAttribute("aria-required",K)}}class g extends M{constructor(Q){const K=Q.renderForms||Q.data.hasOwnCanvas||!Q.data.hasAppearance&&!!Q.data.fieldValue;super(Q,{isRenderable:K})}setPropertyOnSiblings(Q,K,ht,xt){const St=this.annotationStorage;for(const It of this._getElementsByName(Q.name,Q.id))It.domElement&&(It.domElement[K]=ht),St.setValue(It.id,{[xt]:ht})}render(){var xt,St;const Q=this.annotationStorage,K=this.data.id;this.container.classList.add("textWidgetAnnotation");let ht=null;if(this.renderForms){const It=Q.getValue(K,{value:this.data.fieldValue});let Ot=It.value||"";const ye=Q.getValue(K,{charLimit:this.data.maxLen}).charLimit;ye&&Ot.length>ye&&(Ot=Ot.slice(0,ye));let le=It.formattedValue||((xt=this.data.textContent)==null?void 0:xt.join(`
`))||null;le&&this.data.comb&&(le=le.replaceAll(/\s+/g,""));const $t={userValue:Ot,formattedValue:le,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(ht=document.createElement("textarea"),ht.textContent=le??Ot,this.data.doNotScroll&&(ht.style.overflowY="hidden")):(ht=document.createElement("input"),ht.type="text",ht.setAttribute("value",le??Ot),this.data.doNotScroll&&(ht.style.overflowX="hidden")),this.data.hasOwnCanvas&&(ht.hidden=!0),_.add(ht),ht.setAttribute("data-element-id",K),ht.disabled=this.data.readOnly,ht.name=this.data.fieldName,ht.tabIndex=m,this._setRequired(ht,this.data.required),ye&&(ht.maxLength=ye),ht.addEventListener("input",ue=>{Q.setValue(K,{value:ue.target.value}),this.setPropertyOnSiblings(ht,"value",ue.target.value,"value"),$t.formattedValue=null}),ht.addEventListener("resetform",ue=>{const he=this.data.defaultFieldValue??"";ht.value=$t.userValue=he,$t.formattedValue=null});let ne=ue=>{const{formattedValue:he}=$t;he!=null&&(ue.target.value=he),ue.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){ht.addEventListener("focus",he=>{var we;if($t.focused)return;const{target:Le}=he;$t.userValue&&(Le.value=$t.userValue),$t.lastCommittedValue=Le.value,$t.commitKey=1,(we=this.data.actions)!=null&&we.Focus||($t.focused=!0)}),ht.addEventListener("updatefromsandbox",he=>{this.showElementAndHideCanvas(he.target);const Le={value(we){$t.userValue=we.detail.value??"",Q.setValue(K,{value:$t.userValue.toString()}),we.target.value=$t.userValue},formattedValue(we){const{formattedValue:He}=we.detail;$t.formattedValue=He,He!=null&&we.target!==document.activeElement&&(we.target.value=He),Q.setValue(K,{formattedValue:He})},selRange(we){we.target.setSelectionRange(...we.detail.selRange)},charLimit:we=>{var ei;const{charLimit:He}=we.detail,{target:Ue}=we;if(He===0){Ue.removeAttribute("maxLength");return}Ue.setAttribute("maxLength",He);let zi=$t.userValue;!zi||zi.length<=He||(zi=zi.slice(0,He),Ue.value=$t.userValue=zi,Q.setValue(K,{value:zi}),(ei=this.linkService.eventBus)==null||ei.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:zi,willCommit:!0,commitKey:1,selStart:Ue.selectionStart,selEnd:Ue.selectionEnd}}))}};this._dispatchEventFromSandbox(Le,he)}),ht.addEventListener("keydown",he=>{var He;$t.commitKey=1;let Le=-1;if(he.key==="Escape"?Le=0:he.key==="Enter"&&!this.data.multiLine?Le=2:he.key==="Tab"&&($t.commitKey=3),Le===-1)return;const{value:we}=he.target;$t.lastCommittedValue!==we&&($t.lastCommittedValue=we,$t.userValue=we,(He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:we,willCommit:!0,commitKey:Le,selStart:he.target.selectionStart,selEnd:he.target.selectionEnd}}))});const ue=ne;ne=null,ht.addEventListener("blur",he=>{var we,He;if(!$t.focused||!he.relatedTarget)return;(we=this.data.actions)!=null&&we.Blur||($t.focused=!1);const{value:Le}=he.target;$t.userValue=Le,$t.lastCommittedValue!==Le&&((He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:Le,willCommit:!0,commitKey:$t.commitKey,selStart:he.target.selectionStart,selEnd:he.target.selectionEnd}})),ue(he)}),(St=this.data.actions)!=null&&St.Keystroke&&ht.addEventListener("beforeinput",he=>{var Hi;$t.lastCommittedValue=null;const{data:Le,target:we}=he,{value:He,selectionStart:Ue,selectionEnd:zi}=we;let ei=Ue,lr=zi;switch(he.inputType){case"deleteWordBackward":{const qe=He.substring(0,Ue).match(/\w*[^\w]*$/);qe&&(ei-=qe[0].length);break}case"deleteWordForward":{const qe=He.substring(Ue).match(/^[^\w]*\w*/);qe&&(lr+=qe[0].length);break}case"deleteContentBackward":Ue===zi&&(ei-=1);break;case"deleteContentForward":Ue===zi&&(lr+=1);break}he.preventDefault(),(Hi=this.linkService.eventBus)==null||Hi.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:He,change:Le||"",willCommit:!1,selStart:ei,selEnd:lr}})}),this._setEventListeners(ht,$t,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],he=>he.target.value)}if(ne&&ht.addEventListener("blur",ne),this.data.comb){const ue=(this.data.rect[2]-this.data.rect[0])/ye;ht.classList.add("comb"),ht.style.letterSpacing=`calc(${ue}px * var(--scale-factor) - 1ch)`}}else ht=document.createElement("div"),ht.textContent=this.data.fieldValue,ht.style.verticalAlign="middle",ht.style.display="table-cell",this.data.hasOwnCanvas&&(ht.hidden=!0);return this._setTextStyle(ht),this._setBackgroundColor(ht),this._setDefaultPropertiesFromJS(ht),this.container.append(ht),this.container}}class w extends M{constructor(Q){super(Q,{isRenderable:!!Q.data.hasOwnCanvas})}}class E extends M{constructor(Q){super(Q,{isRenderable:Q.renderForms})}render(){const Q=this.annotationStorage,K=this.data,ht=K.id;let xt=Q.getValue(ht,{value:K.exportValue===K.fieldValue}).value;typeof xt=="string"&&(xt=xt!=="Off",Q.setValue(ht,{value:xt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const St=document.createElement("input");return _.add(St),St.setAttribute("data-element-id",ht),St.disabled=K.readOnly,this._setRequired(St,this.data.required),St.type="checkbox",St.name=K.fieldName,xt&&St.setAttribute("checked",!0),St.setAttribute("exportValue",K.exportValue),St.tabIndex=m,St.addEventListener("change",It=>{const{name:Ot,checked:ye}=It.target;for(const le of this._getElementsByName(Ot,ht)){const $t=ye&&le.exportValue===K.exportValue;le.domElement&&(le.domElement.checked=$t),Q.setValue(le.id,{value:$t})}Q.setValue(ht,{value:ye})}),St.addEventListener("resetform",It=>{const Ot=K.defaultFieldValue||"Off";It.target.checked=Ot===K.exportValue}),this.enableScripting&&this.hasJSActions&&(St.addEventListener("updatefromsandbox",It=>{const Ot={value(ye){ye.target.checked=ye.detail.value!=="Off",Q.setValue(ht,{value:ye.target.checked})}};this._dispatchEventFromSandbox(Ot,It)}),this._setEventListeners(St,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],It=>It.target.checked)),this._setBackgroundColor(St),this._setDefaultPropertiesFromJS(St),this.container.append(St),this.container}}class C extends M{constructor(Q){super(Q,{isRenderable:Q.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Q=this.annotationStorage,K=this.data,ht=K.id;let xt=Q.getValue(ht,{value:K.fieldValue===K.buttonValue}).value;if(typeof xt=="string"&&(xt=xt!==K.buttonValue,Q.setValue(ht,{value:xt})),xt)for(const It of this._getElementsByName(K.fieldName,ht))Q.setValue(It.id,{value:!1});const St=document.createElement("input");if(_.add(St),St.setAttribute("data-element-id",ht),St.disabled=K.readOnly,this._setRequired(St,this.data.required),St.type="radio",St.name=K.fieldName,xt&&St.setAttribute("checked",!0),St.tabIndex=m,St.addEventListener("change",It=>{const{name:Ot,checked:ye}=It.target;for(const le of this._getElementsByName(Ot,ht))Q.setValue(le.id,{value:!1});Q.setValue(ht,{value:ye})}),St.addEventListener("resetform",It=>{const Ot=K.defaultFieldValue;It.target.checked=Ot!=null&&Ot===K.buttonValue}),this.enableScripting&&this.hasJSActions){const It=K.buttonValue;St.addEventListener("updatefromsandbox",Ot=>{const ye={value:le=>{const $t=It===le.detail.value;for(const ne of this._getElementsByName(le.target.name)){const ue=$t&&ne.id===ht;ne.domElement&&(ne.domElement.checked=ue),Q.setValue(ne.id,{value:ue})}}};this._dispatchEventFromSandbox(ye,Ot)}),this._setEventListeners(St,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ot=>Ot.target.checked)}return this._setBackgroundColor(St),this._setDefaultPropertiesFromJS(St),this.container.append(St),this.container}}class B extends A{constructor(Q){super(Q,{ignoreBorder:Q.data.hasAppearance})}render(){const Q=super.render();Q.classList.add("buttonWidgetAnnotation","pushButton");const K=Q.lastChild;return this.enableScripting&&this.hasJSActions&&K&&(this._setDefaultPropertiesFromJS(K),K.addEventListener("updatefromsandbox",ht=>{this._dispatchEventFromSandbox({},ht)})),Q}}class I extends M{constructor(Q){super(Q,{isRenderable:Q.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Q=this.annotationStorage,K=this.data.id,ht=Q.getValue(K,{value:this.data.fieldValue}),xt=document.createElement("select");_.add(xt),xt.setAttribute("data-element-id",K),xt.disabled=this.data.readOnly,this._setRequired(xt,this.data.required),xt.name=this.data.fieldName,xt.tabIndex=m;let St=this.data.combo&&this.data.options.length>0;this.data.combo||(xt.size=this.data.options.length,this.data.multiSelect&&(xt.multiple=!0)),xt.addEventListener("resetform",$t=>{const ne=this.data.defaultFieldValue;for(const ue of xt.options)ue.selected=ue.value===ne});for(const $t of this.data.options){const ne=document.createElement("option");ne.textContent=$t.displayValue,ne.value=$t.exportValue,ht.value.includes($t.exportValue)&&(ne.setAttribute("selected",!0),St=!1),xt.append(ne)}let It=null;if(St){const $t=document.createElement("option");$t.value=" ",$t.setAttribute("hidden",!0),$t.setAttribute("selected",!0),xt.prepend($t),It=()=>{$t.remove(),xt.removeEventListener("input",It),It=null},xt.addEventListener("input",It)}const Ot=$t=>{const ne=$t?"value":"textContent",{options:ue,multiple:he}=xt;return he?Array.prototype.filter.call(ue,Le=>Le.selected).map(Le=>Le[ne]):ue.selectedIndex===-1?null:ue[ue.selectedIndex][ne]};let ye=Ot(!1);const le=$t=>{const ne=$t.target.options;return Array.prototype.map.call(ne,ue=>({displayValue:ue.textContent,exportValue:ue.value}))};return this.enableScripting&&this.hasJSActions?(xt.addEventListener("updatefromsandbox",$t=>{const ne={value(ue){It==null||It();const he=ue.detail.value,Le=new Set(Array.isArray(he)?he:[he]);for(const we of xt.options)we.selected=Le.has(we.value);Q.setValue(K,{value:Ot(!0)}),ye=Ot(!1)},multipleSelection(ue){xt.multiple=!0},remove(ue){const he=xt.options,Le=ue.detail.remove;he[Le].selected=!1,xt.remove(Le),he.length>0&&Array.prototype.findIndex.call(he,we=>we.selected)===-1&&(he[0].selected=!0),Q.setValue(K,{value:Ot(!0),items:le(ue)}),ye=Ot(!1)},clear(ue){for(;xt.length!==0;)xt.remove(0);Q.setValue(K,{value:null,items:[]}),ye=Ot(!1)},insert(ue){const{index:he,displayValue:Le,exportValue:we}=ue.detail.insert,He=xt.children[he],Ue=document.createElement("option");Ue.textContent=Le,Ue.value=we,He?He.before(Ue):xt.append(Ue),Q.setValue(K,{value:Ot(!0),items:le(ue)}),ye=Ot(!1)},items(ue){const{items:he}=ue.detail;for(;xt.length!==0;)xt.remove(0);for(const Le of he){const{displayValue:we,exportValue:He}=Le,Ue=document.createElement("option");Ue.textContent=we,Ue.value=He,xt.append(Ue)}xt.options.length>0&&(xt.options[0].selected=!0),Q.setValue(K,{value:Ot(!0),items:le(ue)}),ye=Ot(!1)},indices(ue){const he=new Set(ue.detail.indices);for(const Le of ue.target.options)Le.selected=he.has(Le.index);Q.setValue(K,{value:Ot(!0)}),ye=Ot(!1)},editable(ue){ue.target.disabled=!ue.detail.editable}};this._dispatchEventFromSandbox(ne,$t)}),xt.addEventListener("input",$t=>{var he;const ne=Ot(!0),ue=Ot(!1);Q.setValue(K,{value:ne}),$t.preventDefault(),(he=this.linkService.eventBus)==null||he.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:ye,change:ue,changeEx:ne,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(xt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],$t=>$t.target.value)):xt.addEventListener("input",function($t){Q.setValue(K,{value:Ot(!0)})}),this.data.combo&&this._setTextStyle(xt),this._setBackgroundColor(xt),this._setDefaultPropertiesFromJS(xt),this.container.append(xt),this.container}}class rt extends x{constructor(Q){const{data:K,elements:ht}=Q;super(Q,{isRenderable:x._hasPopupData(K)}),this.elements=ht}render(){this.container.classList.add("popupAnnotation");const Q=new tt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),K=[];for(const ht of this.elements)ht.popup=Q,K.push(ht.data.id),ht.addHighlightArea();return this.container.setAttribute("aria-controls",K.map(ht=>`${n.AnnotationPrefix}${ht}`).join(",")),this.container}}class tt{constructor({container:Q,color:K,elements:ht,titleObj:xt,modificationDate:St,contentsObj:It,richText:Ot,parent:ye,rect:le,parentRect:$t,open:ne}){N(this,Bt);N(this,at);N(this,vt);N(this,bt);N(this,D,Y(this,Bt,d0).bind(this));N(this,H,Y(this,bt,pu).bind(this));N(this,L,Y(this,vt,fu).bind(this));N(this,V,Y(this,at,$h).bind(this));N(this,j,null);N(this,G,null);N(this,W,null);N(this,U,null);N(this,O,null);N(this,z,null);N(this,et,null);N(this,nt,!1);N(this,gt,null);N(this,yt,null);N(this,Nt,null);N(this,Ht,null);N(this,Pt,!1);var ue;J(this,G,Q),J(this,Ht,xt),J(this,W,It),J(this,Nt,Ot),J(this,z,ye),J(this,j,K),J(this,yt,le),J(this,et,$t),J(this,O,ht),J(this,U,a.PDFDateString.toDateObject(St)),this.trigger=ht.flatMap(he=>he.getElementsToTriggerPopup());for(const he of this.trigger)he.addEventListener("click",l(this,V)),he.addEventListener("mouseenter",l(this,L)),he.addEventListener("mouseleave",l(this,H)),he.classList.add("popupTriggerArea");for(const he of ht)(ue=he.container)==null||ue.addEventListener("keydown",l(this,D));l(this,G).hidden=!0,ne&&Y(this,at,$h).call(this)}render(){if(l(this,gt))return;const{page:{view:Q},viewport:{rawDims:{pageWidth:K,pageHeight:ht,pageX:xt,pageY:St}}}=l(this,z),It=J(this,gt,document.createElement("div"));if(It.className="popup",l(this,j)){const ei=It.style.outlineColor=n.Util.makeHexColor(...l(this,j));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?It.style.backgroundColor=`color-mix(in srgb, ${ei} 30%, white)`:It.style.backgroundColor=n.Util.makeHexColor(...l(this,j).map(lr=>Math.floor(.7*(255-lr)+lr)))}const Ot=document.createElement("span");Ot.className="header";const ye=document.createElement("h1");if(Ot.append(ye),{dir:ye.dir,str:ye.textContent}=l(this,Ht),It.append(Ot),l(this,U)){const ei=document.createElement("span");ei.classList.add("popupDate"),ei.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),ei.setAttribute("data-l10n-args",JSON.stringify({date:l(this,U).toLocaleDateString(),time:l(this,U).toLocaleTimeString()})),Ot.append(ei)}const le=l(this,W),$t=l(this,Nt);if($t!=null&&$t.str&&(!(le!=null&&le.str)||le.str===$t.str))f.XfaLayer.render({xfaHtml:$t.html,intent:"richText",div:It}),It.lastChild.classList.add("richText","popupContent");else{const ei=this._formatContents(le);It.append(ei)}let ne=!!l(this,et),ue=ne?l(this,et):l(this,yt);for(const ei of l(this,O))if(!ue||n.Util.intersect(ei.data.rect,ue)!==null){ue=ei.data.rect,ne=!0;break}const he=n.Util.normalizeRect([ue[0],Q[3]-ue[1]+Q[1],ue[2],Q[3]-ue[3]+Q[1]]),Le=5,we=ne?ue[2]-ue[0]+Le:0,He=he[0]+we,Ue=he[1],{style:zi}=l(this,G);zi.left=`${100*(He-xt)/K}%`,zi.top=`${100*(Ue-St)/ht}%`,l(this,G).append(It)}_formatContents({str:Q,dir:K}){const ht=document.createElement("p");ht.classList.add("popupContent"),ht.dir=K;const xt=Q.split(/(?:\r\n?|\n)/);for(let St=0,It=xt.length;St<It;++St){const Ot=xt[St];ht.append(document.createTextNode(Ot)),St<It-1&&ht.append(document.createElement("br"))}return ht}forceHide(){J(this,Pt,this.isVisible),l(this,Pt)&&(l(this,G).hidden=!0)}maybeShow(){!l(this,Pt)||(J(this,Pt,!1),l(this,G).hidden=!1)}get isVisible(){return l(this,G).hidden===!1}}D=new WeakMap,H=new WeakMap,L=new WeakMap,V=new WeakMap,j=new WeakMap,G=new WeakMap,W=new WeakMap,U=new WeakMap,O=new WeakMap,z=new WeakMap,et=new WeakMap,nt=new WeakMap,gt=new WeakMap,yt=new WeakMap,Nt=new WeakMap,Ht=new WeakMap,Pt=new WeakMap,Bt=new WeakSet,d0=function(Q){Q.altKey||Q.shiftKey||Q.ctrlKey||Q.metaKey||(Q.key==="Enter"||Q.key==="Escape"&&l(this,nt))&&Y(this,at,$h).call(this)},at=new WeakSet,$h=function(){J(this,nt,!l(this,nt)),l(this,nt)?(Y(this,vt,fu).call(this),l(this,G).addEventListener("click",l(this,V)),l(this,G).addEventListener("keydown",l(this,D))):(Y(this,bt,pu).call(this),l(this,G).removeEventListener("click",l(this,V)),l(this,G).removeEventListener("keydown",l(this,D)))},vt=new WeakSet,fu=function(){l(this,gt)||this.render(),this.isVisible?l(this,nt)&&l(this,G).classList.add("focused"):(l(this,G).hidden=!1,l(this,G).style.zIndex=parseInt(l(this,G).style.zIndex)+1e3)},bt=new WeakSet,pu=function(){l(this,G).classList.remove("focused"),!(l(this,nt)||!this.isVisible)&&(l(this,G).hidden=!0,l(this,G).style.zIndex=parseInt(l(this,G).style.zIndex)-1e3)};class st extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Q.data.textContent,this.textPosition=Q.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Q=document.createElement("div");Q.classList.add("annotationTextContent"),Q.setAttribute("role","comment");for(const K of this.textContent){const ht=document.createElement("span");ht.textContent=K,Q.append(ht)}this.container.append(Q)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class wt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,ot,null)}render(){this.container.classList.add("lineAnnotation");const K=this.data,{width:ht,height:xt}=v(K.rect),St=this.svgFactory.create(ht,xt,!0),It=J(this,ot,this.svgFactory.createElement("svg:line"));return It.setAttribute("x1",K.rect[2]-K.lineCoordinates[0]),It.setAttribute("y1",K.rect[3]-K.lineCoordinates[1]),It.setAttribute("x2",K.rect[2]-K.lineCoordinates[2]),It.setAttribute("y2",K.rect[3]-K.lineCoordinates[3]),It.setAttribute("stroke-width",K.borderStyle.width||1),It.setAttribute("stroke","transparent"),It.setAttribute("fill","transparent"),St.append(It),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap;class dt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,ft,null)}render(){this.container.classList.add("squareAnnotation");const K=this.data,{width:ht,height:xt}=v(K.rect),St=this.svgFactory.create(ht,xt,!0),It=K.borderStyle.width,Ot=J(this,ft,this.svgFactory.createElement("svg:rect"));return Ot.setAttribute("x",It/2),Ot.setAttribute("y",It/2),Ot.setAttribute("width",ht-It),Ot.setAttribute("height",xt-It),Ot.setAttribute("stroke-width",It||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),St.append(Ot),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,ft)}addHighlightArea(){this.container.classList.add("highlightArea")}}ft=new WeakMap;class Tt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,Et,null)}render(){this.container.classList.add("circleAnnotation");const K=this.data,{width:ht,height:xt}=v(K.rect),St=this.svgFactory.create(ht,xt,!0),It=K.borderStyle.width,Ot=J(this,Et,this.svgFactory.createElement("svg:ellipse"));return Ot.setAttribute("cx",ht/2),Ot.setAttribute("cy",xt/2),Ot.setAttribute("rx",ht/2-It/2),Ot.setAttribute("ry",xt/2-It/2),Ot.setAttribute("stroke-width",It||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),St.append(Ot),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Et)}addHighlightArea(){this.container.classList.add("highlightArea")}}Et=new WeakMap;class Lt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,Kt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const K=this.data,{width:ht,height:xt}=v(K.rect),St=this.svgFactory.create(ht,xt,!0);let It=[];for(const ye of K.vertices){const le=ye.x-K.rect[0],$t=K.rect[3]-ye.y;It.push(le+","+$t)}It=It.join(" ");const Ot=J(this,Kt,this.svgFactory.createElement(this.svgElementName));return Ot.setAttribute("points",It),Ot.setAttribute("stroke-width",K.borderStyle.width||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),St.append(Ot),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Kt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kt=new WeakMap;class Qt extends Lt{constructor(Q){super(Q),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ct extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Dt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,te,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const K=this.data,{width:ht,height:xt}=v(K.rect),St=this.svgFactory.create(ht,xt,!0);for(const It of K.inkLists){let Ot=[];for(const le of It){const $t=le.x-K.rect[0],ne=K.rect[3]-le.y;Ot.push(`${$t},${ne}`)}Ot=Ot.join(" ");const ye=this.svgFactory.createElement(this.svgElementName);l(this,te).push(ye),ye.setAttribute("points",Ot),ye.setAttribute("stroke-width",K.borderStyle.width||1),ye.setAttribute("stroke","transparent"),ye.setAttribute("fill","transparent"),!K.popupRef&&this.hasPopupData&&this._createPopup(),St.append(ye)}return this.container.append(St),this.container}getElementsToTriggerPopup(){return l(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap;class ee extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class zt extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Jt extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class oe extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ge extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ae extends x{constructor(K){var St;super(K,{isRenderable:!0});N(this,Pe);N(this,me,null);const{filename:ht,content:xt}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(ht,!0),this.content=xt,(St=this.linkService.eventBus)==null||St.dispatch("fileattachmentannotation",{source:this,filename:ht,content:xt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:K,data:ht}=this;let xt;ht.hasAppearance||ht.fillAlpha===0?xt=document.createElement("div"):(xt=document.createElement("img"),xt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(ht.name)?"paperclip":"pushpin"}.svg`,ht.fillAlpha&&ht.fillAlpha<1&&(xt.style=`filter: opacity(${Math.round(ht.fillAlpha*100)}%);`)),xt.addEventListener("dblclick",Y(this,Pe,gu).bind(this)),J(this,me,xt);const{isMac:St}=n.FeatureTest.platform;return K.addEventListener("keydown",It=>{It.key==="Enter"&&(St?It.metaKey:It.ctrlKey)&&Y(this,Pe,gu).call(this)}),!ht.popupRef&&this.hasPopupData?this._createPopup():xt.classList.add("popupTriggerArea"),K.append(xt),K}getElementsToTriggerPopup(){return l(this,me)}addHighlightArea(){this.container.classList.add("highlightArea")}}me=new WeakMap,Pe=new WeakSet,gu=function(){var K;(K=this.downloadManager)==null||K.openOrDownloadData(this.content,this.filename)};class Ve{constructor({div:Q,accessibilityManager:K,annotationCanvasMap:ht,annotationEditorUIManager:xt,page:St,viewport:It}){N(this,vi);N(this,er);N(this,je,null);N(this,hi,null);N(this,ze,new Map);this.div=Q,J(this,je,K),J(this,hi,ht),this.page=St,this.viewport=It,this.zIndex=0,this._annotationEditorUIManager=xt}async render(Q){var It;const{annotations:K}=Q,ht=this.div;(0,a.setLayerDimensions)(ht,this.viewport);const xt=new Map,St={data:null,layer:ht,linkService:Q.linkService,downloadManager:Q.downloadManager,imageResourcesPath:Q.imageResourcesPath||"",renderForms:Q.renderForms!==!1,svgFactory:new a.DOMSVGFactory,annotationStorage:Q.annotationStorage||new o.AnnotationStorage,enableScripting:Q.enableScripting===!0,hasJSActions:Q.hasJSActions,fieldObjects:Q.fieldObjects,parent:this,elements:null};for(const Ot of K){if(Ot.noHTML)continue;const ye=Ot.annotationType===n.AnnotationType.POPUP;if(ye){const ne=xt.get(Ot.id);if(!ne)continue;St.elements=ne}else{const{width:ne,height:ue}=v(Ot.rect);if(ne<=0||ue<=0)continue}St.data=Ot;const le=b.create(St);if(!le.isRenderable)continue;if(!ye&&Ot.popupRef){const ne=xt.get(Ot.popupRef);ne?ne.push(le):xt.set(Ot.popupRef,[le])}const $t=le.render();Ot.hidden&&($t.style.visibility="hidden"),Y(this,vi,u0).call(this,$t,Ot.id),le.annotationEditorType>0&&(l(this,ze).set(le.data.id,le),(It=this._annotationEditorUIManager)==null||It.renderAnnotationElement(le))}Y(this,er,mu).call(this)}update({viewport:Q}){const K=this.div;this.viewport=Q,(0,a.setLayerDimensions)(K,{rotation:Q.rotation}),Y(this,er,mu).call(this),K.hidden=!1}getEditableAnnotations(){return Array.from(l(this,ze).values())}getEditableAnnotation(Q){return l(this,ze).get(Q)}}je=new WeakMap,hi=new WeakMap,ze=new WeakMap,vi=new WeakSet,u0=function(Q,K){var xt;const ht=Q.firstChild||Q;ht.id=`${n.AnnotationPrefix}${K}`,this.div.append(Q),(xt=l(this,je))==null||xt.moveElementInDOM(this.div,Q,ht,!1)},er=new WeakSet,mu=function(){if(!l(this,hi))return;const Q=this.div;for(const[K,ht]of l(this,hi)){const xt=Q.querySelector(`[data-annotation-id="${K}"]`);if(!xt)continue;ht.className="annotationContent";const{firstChild:St}=xt;St?St.nodeName==="CANVAS"?St.replaceWith(ht):St.classList.contains("annotationContent")?St.after(ht):St.before(ht):xt.append(ht)}l(this,hi).clear()}},792:(r,t,s)=>{var f,m,S,f0,v;s.d(t,{AnnotationStorage:()=>u,PrintAnnotationStorage:()=>d,SerializableEmpty:()=>c});var n=s(292),a=s(310),o=s(651);const c=Object.freeze({map:null,hash:"",transfer:void 0});class u{constructor(){N(this,S);N(this,f,!1);N(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(x,A){const F=l(this,m).get(x);return F===void 0?A:Object.assign(A,F)}getRawValue(x){return l(this,m).get(x)}remove(x){if(l(this,m).delete(x),l(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const A of l(this,m).values())if(A instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(x,A){const F=l(this,m).get(x);let M=!1;if(F!==void 0)for(const[g,w]of Object.entries(A))F[g]!==w&&(M=!0,F[g]=w);else M=!0,l(this,m).set(x,A);M&&Y(this,S,f0).call(this),A instanceof a.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(A.constructor._type)}has(x){return l(this,m).has(x)}getAll(){return l(this,m).size>0?(0,n.objectFromMap)(l(this,m)):null}setAll(x){for(const[A,F]of Object.entries(x))this.setValue(A,F)}get size(){return l(this,m).size}resetModified(){l(this,f)&&(J(this,f,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new d(this)}get serializable(){if(l(this,m).size===0)return c;const x=new Map,A=new o.MurmurHash3_64,F=[],M=Object.create(null);let g=!1;for(const[w,E]of l(this,m)){const C=E instanceof a.AnnotationEditor?E.serialize(!1,M):E;C&&(x.set(w,C),A.update(`${w}:${JSON.stringify(C)}`),g||(g=!!C.bitmap))}if(g)for(const w of x.values())w.bitmap&&F.push(w.bitmap);return x.size>0?{map:x,hash:A.hexdigest(),transfer:F}:c}get editorStats(){let x=null;const A=new Map;for(const F of l(this,m).values()){if(!(F instanceof a.AnnotationEditor))continue;const M=F.telemetryFinalData;if(!M)continue;const{type:g}=M;A.has(g)||A.set(g,Object.getPrototypeOf(F).constructor),x||(x=Object.create(null));const w=x[g]||(x[g]=new Map);for(const[E,C]of Object.entries(M)){if(E==="type")continue;let B=w.get(E);B||(B=new Map,w.set(E,B));const I=B.get(C)??0;B.set(C,I+1)}}for(const[F,M]of A)x[F]=M.computeTelemetryFinalData(x[F]);return x}}f=new WeakMap,m=new WeakMap,S=new WeakSet,f0=function(){l(this,f)||(J(this,f,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class d extends u{constructor(A){super();N(this,v,void 0);const{map:F,hash:M,transfer:g}=A.serializable,w=structuredClone(F,g?{transfer:g}:null);J(this,v,{map:w,hash:M,transfer:g})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,v)}}v=new WeakMap},831:(r,t,s)=>{s.a(r,async(n,a)=>{var C,B,I,rt,Qa,st,Kh,dt,Tt,Lt,Qt,ct,Xh,ee,zt,Jt,oe,ge,Ae,zo,Gt,lt,vu,Wt,ve;try{let ie=function(bt){if(typeof bt=="string"||bt instanceof URL?bt={url:bt}:(bt instanceof ArrayBuffer||ArrayBuffer.isView(bt))&&(bt={data:bt}),typeof bt!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!bt.url&&!bt.data&&!bt.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const q=new W,{docId:ot}=q,ft=bt.url?xe(bt.url):null,Et=bt.data?_e(bt.data):null,Kt=bt.httpHeaders||null,te=bt.withCredentials===!0,me=bt.password??null,Pe=bt.range instanceof U?bt.range:null,Ti=Number.isInteger(bt.rangeChunkSize)&&bt.rangeChunkSize>0?bt.rangeChunkSize:T;let je=bt.worker instanceof gt?bt.worker:null;const hi=bt.verbosity,ze=typeof bt.docBaseUrl=="string"&&!(0,u.isDataScheme)(bt.docBaseUrl)?bt.docBaseUrl:null,vi=typeof bt.cMapUrl=="string"?bt.cMapUrl:null,oi=bt.cMapPacked!==!1,er=bt.CMapReaderFactory||L,bi=typeof bt.standardFontDataUrl=="string"?bt.standardFontDataUrl:null,Me=bt.StandardFontDataFactory||j,Q=bt.stopAtErrors!==!0,K=Number.isInteger(bt.maxImageSize)&&bt.maxImageSize>-1?bt.maxImageSize:-1,ht=bt.isEvalSupported!==!1,xt=typeof bt.isOffscreenCanvasSupported=="boolean"?bt.isOffscreenCanvasSupported:!o.isNodeJS,St=Number.isInteger(bt.canvasMaxAreaInBytes)?bt.canvasMaxAreaInBytes:-1,It=typeof bt.disableFontFace=="boolean"?bt.disableFontFace:o.isNodeJS,Ot=bt.fontExtraProperties===!0,ye=bt.enableXfa===!0,le=bt.ownerDocument||globalThis.document,$t=bt.disableRange===!0,ne=bt.disableStream===!0,ue=bt.disableAutoFetch===!0,he=bt.pdfBug===!0,Le=Pe?Pe.length:bt.length??NaN,we=typeof bt.useSystemFonts=="boolean"?bt.useSystemFonts:!o.isNodeJS&&!It,He=typeof bt.useWorkerFetch=="boolean"?bt.useWorkerFetch:er===u.DOMCMapReaderFactory&&Me===u.DOMStandardFontDataFactory&&vi&&bi&&(0,u.isValidFetchUrl)(vi,document.baseURI)&&(0,u.isValidFetchUrl)(bi,document.baseURI),Ue=bt.canvasFactory||new H({ownerDocument:le}),zi=bt.filterFactory||new V({docId:ot,ownerDocument:le}),ei=null;(0,o.setVerbosityLevel)(hi);const lr={canvasFactory:Ue,filterFactory:zi};if(He||(lr.cMapReaderFactory=new er({baseUrl:vi,isCompressed:oi}),lr.standardFontDataFactory=new Me({baseUrl:bi})),!je){const $={verbosity:hi,port:_.GlobalWorkerOptions.workerPort};je=$.port?gt.fromPort($):new gt($),q._worker=je}const Hi={docId:ot,apiVersion:"4.2.67",data:Et,password:me,disableAutoFetch:ue,rangeChunkSize:Ti,length:Le,docBaseUrl:ze,enableXfa:ye,evaluatorOptions:{maxImageSize:K,disableFontFace:It,ignoreErrors:Q,isEvalSupported:ht,isOffscreenCanvasSupported:xt,canvasMaxAreaInBytes:St,fontExtraProperties:Ot,useSystemFonts:we,cMapUrl:He?vi:null,standardFontDataUrl:He?bi:null}},qe={ignoreErrors:Q,disableFontFace:It,fontExtraProperties:Ot,enableXfa:ye,ownerDocument:le,disableAutoFetch:ue,pdfBug:he,styleElement:ei};return je.promise.then(function(){if(q.destroyed)throw new Error("Loading aborted");const $=G(je,Hi),At=new Promise(function(Zt){let ae;Pe?ae=new A.PDFDataTransportStream(Pe,{disableRange:$t,disableStream:ne}):Et||(ae=(de=>o.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,u.isValidFetchUrl)(de.url)?new F.PDFFetchStream(de):new g.PDFNodeStream(de):(0,u.isValidFetchUrl)(de.url)?new F.PDFFetchStream(de):new M.PDFNetworkStream(de))({url:ft,length:Le,httpHeaders:Kt,withCredentials:te,rangeChunkSize:Ti,disableRange:$t,disableStream:ne})),Zt(ae)});return Promise.all([$,At]).then(function([Zt,ae]){if(q.destroyed)throw new Error("Loading aborted");const de=new v.MessageHandler(ot,Zt,je.port),Ce=new yt(de,q,ae,qe,lr);q._transport=Ce,de.send("Ready",null)})}).catch(q._capability.reject),q},xe=function(bt){if(bt instanceof URL)return bt.href;try{return new URL(bt,window.location).href}catch{if(o.isNodeJS&&typeof bt=="string")return bt}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},_e=function(bt){if(o.isNodeJS&&typeof Buffer<"u"&&bt instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(bt instanceof Uint8Array&&bt.byteLength===bt.buffer.byteLength)return bt;if(typeof bt=="string")return(0,o.stringToBytes)(bt);if(bt instanceof ArrayBuffer||ArrayBuffer.isView(bt)||typeof bt=="object"&&!isNaN(bt==null?void 0:bt.length))return new Uint8Array(bt);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")},ut=function(bt){return typeof bt=="object"&&Number.isInteger(bt==null?void 0:bt.num)&&bt.num>=0&&Number.isInteger(bt==null?void 0:bt.gen)&&bt.gen>=0};s.d(t,{PDFDataRangeTransport:()=>U,PDFWorker:()=>gt,build:()=>at,getDocument:()=>ie,version:()=>Z});var o=s(292),c=s(792),u=s(419),d=s(10),f=s(573),m=s(923),S=s(814),_=s(164),v=s(178),b=s(62),x=s(626),A=s(585),F=s(94),M=s(457),g=s(786),w=s(50),E=n([f,g]);[f,g]=E.then?(await E)():E;const T=65536,R=100,D=5e3,H=o.isNodeJS?f.NodeCanvasFactory:u.DOMCanvasFactory,L=o.isNodeJS?f.NodeCMapReaderFactory:u.DOMCMapReaderFactory,V=o.isNodeJS?f.NodeFilterFactory:u.DOMFilterFactory,j=o.isNodeJS?f.NodeStandardFontDataFactory:u.DOMStandardFontDataFactory;async function G(bt,q){if(bt.destroyed)throw new Error("Worker was destroyed");const ot=await bt.messageHandler.sendWithPromise("GetDocRequest",q,q.data?[q.data.buffer]:null);if(bt.destroyed)throw new Error("Worker was destroyed");return ot}const _t=class{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${ws(_t,C)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var q,ot,ft;this.destroyed=!0;try{(q=this._worker)!=null&&q.port&&(this._worker._pendingDestroy=!0),await((ot=this._transport)==null?void 0:ot.destroy())}catch(Et){throw(ft=this._worker)!=null&&ft.port&&delete this._worker._pendingDestroy,Et}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let W=_t;C=new WeakMap,N(W,C,0);class U{constructor(q,ot,ft=!1,Et=null){this.length=q,this.initialData=ot,this.progressiveDone=ft,this.contentDispositionFilename=Et,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(q){this._rangeListeners.push(q)}addProgressListener(q){this._progressListeners.push(q)}addProgressiveReadListener(q){this._progressiveReadListeners.push(q)}addProgressiveDoneListener(q){this._progressiveDoneListeners.push(q)}onDataRange(q,ot){for(const ft of this._rangeListeners)ft(q,ot)}onDataProgress(q,ot){this._readyCapability.promise.then(()=>{for(const ft of this._progressListeners)ft(q,ot)})}onDataProgressiveRead(q){this._readyCapability.promise.then(()=>{for(const ot of this._progressiveReadListeners)ot(q)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const q of this._progressiveDoneListeners)q()})}transportReady(){this._readyCapability.resolve()}requestDataRange(q,ot){(0,o.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class O{constructor(q,ot){this._pdfInfo=q,this._transport=ot}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,o.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(q){return this._transport.getPage(q)}getPageIndex(q){return this._transport.getPageIndex(q)}getDestinations(){return this._transport.getDestinations()}getDestination(q){return this._transport.getDestination(q)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:q="display"}={}){const{renderingIntent:ot}=this._transport.getRenderingIntent(q);return this._transport.getOptionalContentConfig(ot)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(q=!1){return this._transport.startCleanup(q||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(q){return this._transport.cachedPageNumber(q)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class z{constructor(q,ot,ft,Et=!1){N(this,rt);N(this,st);N(this,B,null);N(this,I,!1);this._pageIndex=q,this._pageInfo=ot,this._transport=ft,this._stats=Et?new u.StatTimer:null,this._pdfBug=Et,this.commonObjs=ft.commonObjs,this.objs=new Ht,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:q,rotation:ot=this.rotate,offsetX:ft=0,offsetY:Et=0,dontFlip:Kt=!1}={}){return new u.PageViewport({viewBox:this.view,scale:q,rotation:ot,offsetX:ft,offsetY:Et,dontFlip:Kt})}getAnnotations({intent:q="display"}={}){const{renderingIntent:ot}=this._transport.getRenderingIntent(q);return this._transport.getAnnotations(this._pageIndex,ot)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,o.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var q;return((q=this._transport._htmlForXfa)==null?void 0:q.children[this._pageIndex])||null}render({canvasContext:q,viewport:ot,intent:ft="display",annotationMode:Et=o.AnnotationMode.ENABLE,transform:Kt=null,background:te=null,optionalContentConfigPromise:me=null,annotationCanvasMap:Pe=null,pageColors:Ti=null,printAnnotationStorage:je=null}){var K,ht;(K=this._stats)==null||K.time("Overall");const hi=this._transport.getRenderingIntent(ft,Et,je),{renderingIntent:ze,cacheKey:vi}=hi;J(this,I,!1),Y(this,st,Kh).call(this),me||(me=this._transport.getOptionalContentConfig(ze));let oi=this._intentStates.get(vi);oi||(oi=Object.create(null),this._intentStates.set(vi,oi)),oi.streamReaderCancelTimeout&&(clearTimeout(oi.streamReaderCancelTimeout),oi.streamReaderCancelTimeout=null);const er=!!(ze&o.RenderingIntentFlag.PRINT);oi.displayReadyCapability||(oi.displayReadyCapability=Promise.withResolvers(),oi.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ht=this._stats)==null||ht.time("Page Request"),this._pumpOperatorList(hi));const bi=xt=>{var St,It;oi.renderTasks.delete(Me),(this._maybeCleanupAfterRender||er)&&J(this,I,!0),Y(this,rt,Qa).call(this,!er),xt?(Me.capability.reject(xt),this._abortOperatorList({intentState:oi,reason:xt instanceof Error?xt:new Error(xt)})):Me.capability.resolve(),(St=this._stats)==null||St.timeEnd("Rendering"),(It=this._stats)==null||It.timeEnd("Overall")},Me=new Bt({callback:bi,params:{canvasContext:q,viewport:ot,transform:Kt,background:te},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Pe,operatorList:oi.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!er,pdfBug:this._pdfBug,pageColors:Ti});(oi.renderTasks||(oi.renderTasks=new Set)).add(Me);const Q=Me.task;return Promise.all([oi.displayReadyCapability.promise,me]).then(([xt,St])=>{var It;if(this.destroyed){bi();return}if((It=this._stats)==null||It.time("Rendering"),!(St.renderingIntent&ze))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");Me.initializeGraphics({transparency:xt,optionalContentConfig:St}),Me.operatorListChanged()}).catch(bi),Q}getOperatorList({intent:q="display",annotationMode:ot=o.AnnotationMode.ENABLE,printAnnotationStorage:ft=null}={}){var Pe;function Et(){te.operatorList.lastChunk&&(te.opListReadCapability.resolve(te.operatorList),te.renderTasks.delete(me))}const Kt=this._transport.getRenderingIntent(q,ot,ft,!0);let te=this._intentStates.get(Kt.cacheKey);te||(te=Object.create(null),this._intentStates.set(Kt.cacheKey,te));let me;return te.opListReadCapability||(me=Object.create(null),me.operatorListChanged=Et,te.opListReadCapability=Promise.withResolvers(),(te.renderTasks||(te.renderTasks=new Set)).add(me),te.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Pe=this._stats)==null||Pe.time("Page Request"),this._pumpOperatorList(Kt)),te.opListReadCapability.promise}streamTextContent({includeMarkedContent:q=!1,disableNormalization:ot=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:q===!0,disableNormalization:ot===!0},{highWaterMark:100,size(ft){return ft.items.length}})}getTextContent(q={}){if(this._transport._htmlForXfa)return this.getXfa().then(ft=>w.XfaText.textContent(ft));const ot=this.streamTextContent(q);return new Promise(function(ft,Et){function Kt(){te.read().then(function({value:Pe,done:Ti}){if(Ti){ft(me);return}Object.assign(me.styles,Pe.styles),me.items.push(...Pe.items),Kt()},Et)}const te=ot.getReader(),me={items:[],styles:Object.create(null)};Kt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const q=[];for(const ot of this._intentStates.values())if(this._abortOperatorList({intentState:ot,reason:new Error("Page was destroyed."),force:!0}),!ot.opListReadCapability)for(const ft of ot.renderTasks)q.push(ft.completed),ft.cancel();return this.objs.clear(),J(this,I,!1),Y(this,st,Kh).call(this),Promise.all(q)}cleanup(q=!1){J(this,I,!0);const ot=Y(this,rt,Qa).call(this,!1);return q&&ot&&this._stats&&(this._stats=new u.StatTimer),ot}_startRenderPage(q,ot){var Et,Kt;const ft=this._intentStates.get(ot);!ft||((Et=this._stats)==null||Et.timeEnd("Page Request"),(Kt=ft.displayReadyCapability)==null||Kt.resolve(q))}_renderPageChunk(q,ot){for(let ft=0,Et=q.length;ft<Et;ft++)ot.operatorList.fnArray.push(q.fnArray[ft]),ot.operatorList.argsArray.push(q.argsArray[ft]);ot.operatorList.lastChunk=q.lastChunk,ot.operatorList.separateAnnots=q.separateAnnots;for(const ft of ot.renderTasks)ft.operatorListChanged();q.lastChunk&&Y(this,rt,Qa).call(this,!0)}_pumpOperatorList({renderingIntent:q,cacheKey:ot,annotationStorageSerializable:ft}){const{map:Et,transfer:Kt}=ft,te=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:q,cacheKey:ot,annotationStorage:Et},Kt).getReader(),me=this._intentStates.get(ot);me.streamReader=te;const Pe=()=>{te.read().then(({value:Ti,done:je})=>{if(je){me.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Ti,me),Pe())},Ti=>{if(me.streamReader=null,!this._transport.destroyed){if(me.operatorList){me.operatorList.lastChunk=!0;for(const je of me.renderTasks)je.operatorListChanged();Y(this,rt,Qa).call(this,!0)}if(me.displayReadyCapability)me.displayReadyCapability.reject(Ti);else if(me.opListReadCapability)me.opListReadCapability.reject(Ti);else throw Ti}})};Pe()}_abortOperatorList({intentState:q,reason:ot,force:ft=!1}){if(q.streamReader){if(q.streamReaderCancelTimeout&&(clearTimeout(q.streamReaderCancelTimeout),q.streamReaderCancelTimeout=null),!ft){if(q.renderTasks.size>0)return;if(ot instanceof u.RenderingCancelledException){let Et=R;ot.extraDelay>0&&ot.extraDelay<1e3&&(Et+=ot.extraDelay),q.streamReaderCancelTimeout=setTimeout(()=>{q.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:q,reason:ot,force:!0})},Et);return}}if(q.streamReader.cancel(new o.AbortException(ot.message)).catch(()=>{}),q.streamReader=null,!this._transport.destroyed){for(const[Et,Kt]of this._intentStates)if(Kt===q){this._intentStates.delete(Et);break}this.cleanup()}}}get stats(){return this._stats}}B=new WeakMap,I=new WeakMap,rt=new WeakSet,Qa=function(q=!1){if(Y(this,st,Kh).call(this),!l(this,I)||this.destroyed)return!1;if(q)return J(this,B,setTimeout(()=>{J(this,B,null),Y(this,rt,Qa).call(this,!1)},D)),!1;for(const{renderTasks:ot,operatorList:ft}of this._intentStates.values())if(ot.size>0||!ft.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),J(this,I,!1),!0},st=new WeakSet,Kh=function(){l(this,B)&&(clearTimeout(l(this,B)),J(this,B,null))};class et{constructor(){N(this,dt,new Set);N(this,Tt,Promise.resolve())}postMessage(q,ot){const ft={data:structuredClone(q,ot?{transfer:ot}:null)};l(this,Tt).then(()=>{for(const Et of l(this,dt))Et.call(this,ft)})}addEventListener(q,ot){l(this,dt).add(ot)}removeEventListener(q,ot){l(this,dt).delete(ot)}terminate(){l(this,dt).clear()}}dt=new WeakMap,Tt=new WeakMap;const nt={isWorkerDisabled:!1,fakeWorkerId:0};o.isNodeJS&&(nt.isWorkerDisabled=!0,(Lt=_.GlobalWorkerOptions).workerSrc||(Lt.workerSrc="./pdf.worker.mjs")),nt.isSameOrigin=function(bt,q){let ot;try{if(ot=new URL(bt),!ot.origin||ot.origin==="null")return!1}catch{return!1}const ft=new URL(q,ot);return ot.origin===ft.origin},nt.createCDNWrapper=function(bt){const q=`await import("${bt}");`;return URL.createObjectURL(new Blob([q],{type:"text/javascript"}))};const vt=class{constructor({name:q=null,port:ot=null,verbosity:ft=(0,o.getVerbosityLevel)()}={}){var Et;if(this.name=q,this.destroyed=!1,this.verbosity=ft,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,ot){if((Et=l(vt,Qt))!=null&&Et.has(ot))throw new Error("Cannot use more than one PDFWorker per port.");(l(vt,Qt)||J(vt,Qt,new WeakMap)).set(ot,this),this._initializeFromPort(ot);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(q){this._port=q,this._messageHandler=new v.MessageHandler("main","worker",q),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!nt.isWorkerDisabled&&!l(vt,ct,Xh)){let{workerSrc:q}=vt;try{nt.isSameOrigin(window.location.href,q)||(q=nt.createCDNWrapper(new URL(q,window.location).href));const ot=new Worker(q,{type:"module"}),ft=new v.MessageHandler("main","worker",ot),Et=()=>{ot.removeEventListener("error",Kt),ft.destroy(),ot.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Kt=()=>{this._webWorker||Et()};ot.addEventListener("error",Kt),ft.on("test",me=>{if(ot.removeEventListener("error",Kt),this.destroyed){Et();return}me?(this._messageHandler=ft,this._port=ot,this._webWorker=ot,this._readyCapability.resolve(),ft.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),ft.destroy(),ot.terminate())}),ft.on("ready",me=>{if(ot.removeEventListener("error",Kt),this.destroyed){Et();return}try{te()}catch{this._setupFakeWorker()}});const te=()=>{const me=new Uint8Array;ft.send("test",me,[me.buffer])};te();return}catch{(0,o.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){nt.isWorkerDisabled||((0,o.warn)("Setting up fake worker."),nt.isWorkerDisabled=!0),vt._setupFakeWorkerGlobal.then(q=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const ot=new et;this._port=ot;const ft=`fake${nt.fakeWorkerId++}`,Et=new v.MessageHandler(ft+"_worker",ft,ot);q.setup(Et,ot);const Kt=new v.MessageHandler(ft,ft+"_worker",ot);this._messageHandler=Kt,this._readyCapability.resolve(),Kt.send("configure",{verbosity:this.verbosity})}).catch(q=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${q.message}".`))})}destroy(){var q;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(q=l(vt,Qt))==null||q.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(q){var ft;if(!(q!=null&&q.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const ot=(ft=l(this,Qt))==null?void 0:ft.get(q.port);if(ot){if(ot._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return ot}return new vt(q)}static get workerSrc(){if(_.GlobalWorkerOptions.workerSrc)return _.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const q=async()=>l(this,ct,Xh)?l(this,ct,Xh):(await $s(()=>import(this.workerSrc).then(async ot=>(await ot.__tla,ot)),[])).WorkerMessageHandler;return(0,o.shadow)(this,"_setupFakeWorkerGlobal",q())}};let gt=vt;Qt=new WeakMap,ct=new WeakSet,Xh=function(){var q;try{return((q=globalThis.pdfjsWorker)==null?void 0:q.WorkerMessageHandler)||null}catch{return null}},N(gt,ct),N(gt,Qt,void 0);class yt{constructor(q,ot,ft,Et,Kt){N(this,Ae);N(this,ee,new Map);N(this,zt,new Map);N(this,Jt,new Map);N(this,oe,new Map);N(this,ge,null);this.messageHandler=q,this.loadingTask=ot,this.commonObjs=new Ht,this.fontLoader=new d.FontLoader({ownerDocument:Et.ownerDocument,styleElement:Et.styleElement}),this._params=Et,this.canvasFactory=Kt.canvasFactory,this.filterFactory=Kt.filterFactory,this.cMapReaderFactory=Kt.cMapReaderFactory,this.standardFontDataFactory=Kt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=ft,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,o.shadow)(this,"annotationStorage",new c.AnnotationStorage)}getRenderingIntent(q,ot=o.AnnotationMode.ENABLE,ft=null,Et=!1){let Kt=o.RenderingIntentFlag.DISPLAY,te=c.SerializableEmpty;switch(q){case"any":Kt=o.RenderingIntentFlag.ANY;break;case"display":break;case"print":Kt=o.RenderingIntentFlag.PRINT;break;default:(0,o.warn)(`getRenderingIntent - invalid intent: ${q}`)}switch(ot){case o.AnnotationMode.DISABLE:Kt+=o.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case o.AnnotationMode.ENABLE:break;case o.AnnotationMode.ENABLE_FORMS:Kt+=o.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case o.AnnotationMode.ENABLE_STORAGE:Kt+=o.RenderingIntentFlag.ANNOTATIONS_STORAGE,te=(Kt&o.RenderingIntentFlag.PRINT&&ft instanceof c.PrintAnnotationStorage?ft:this.annotationStorage).serializable;break;default:(0,o.warn)(`getRenderingIntent - invalid annotationMode: ${ot}`)}return Et&&(Kt+=o.RenderingIntentFlag.OPLIST),{renderingIntent:Kt,cacheKey:`${Kt}_${te.hash}`,annotationStorageSerializable:te}}destroy(){var ft;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(ft=l(this,ge))==null||ft.reject(new Error("Worker was destroyed during onPassword callback"));const q=[];for(const Et of l(this,zt).values())q.push(Et._destroy());l(this,zt).clear(),l(this,Jt).clear(),l(this,oe).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const ot=this.messageHandler.sendWithPromise("Terminate",null);return q.push(ot),Promise.all(q).then(()=>{var Et;this.commonObjs.clear(),this.fontLoader.clear(),l(this,ee).clear(),this.filterFactory.destroy(),(0,S.cleanupTextLayer)(),(Et=this._networkStream)==null||Et.cancelAllRequests(new o.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:q,loadingTask:ot}=this;q.on("GetReader",(ft,Et)=>{(0,o.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Kt=>{this._lastProgress={loaded:Kt.loaded,total:Kt.total}},Et.onPull=()=>{this._fullReader.read().then(function({value:Kt,done:te}){if(te){Et.close();return}(0,o.assert)(Kt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Et.enqueue(new Uint8Array(Kt),1,[Kt])}).catch(Kt=>{Et.error(Kt)})},Et.onCancel=Kt=>{this._fullReader.cancel(Kt),Et.ready.catch(te=>{if(!this.destroyed)throw te})}}),q.on("ReaderHeadersReady",ft=>{const Et=Promise.withResolvers(),Kt=this._fullReader;return Kt.headersReady.then(()=>{var te;(!Kt.isStreamingSupported||!Kt.isRangeSupported)&&(this._lastProgress&&((te=ot.onProgress)==null||te.call(ot,this._lastProgress)),Kt.onProgress=me=>{var Pe;(Pe=ot.onProgress)==null||Pe.call(ot,{loaded:me.loaded,total:me.total})}),Et.resolve({isStreamingSupported:Kt.isStreamingSupported,isRangeSupported:Kt.isRangeSupported,contentLength:Kt.contentLength})},Et.reject),Et.promise}),q.on("GetRangeReader",(ft,Et)=>{(0,o.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Kt=this._networkStream.getRangeReader(ft.begin,ft.end);if(!Kt){Et.close();return}Et.onPull=()=>{Kt.read().then(function({value:te,done:me}){if(me){Et.close();return}(0,o.assert)(te instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Et.enqueue(new Uint8Array(te),1,[te])}).catch(te=>{Et.error(te)})},Et.onCancel=te=>{Kt.cancel(te),Et.ready.catch(me=>{if(!this.destroyed)throw me})}}),q.on("GetDoc",({pdfInfo:ft})=>{this._numPages=ft.numPages,this._htmlForXfa=ft.htmlForXfa,delete ft.htmlForXfa,ot._capability.resolve(new O(ft,this))}),q.on("DocException",function(ft){let Et;switch(ft.name){case"PasswordException":Et=new o.PasswordException(ft.message,ft.code);break;case"InvalidPDFException":Et=new o.InvalidPDFException(ft.message);break;case"MissingPDFException":Et=new o.MissingPDFException(ft.message);break;case"UnexpectedResponseException":Et=new o.UnexpectedResponseException(ft.message,ft.status);break;case"UnknownErrorException":Et=new o.UnknownErrorException(ft.message,ft.details);break;default:(0,o.unreachable)("DocException - expected a valid Error.")}ot._capability.reject(Et)}),q.on("PasswordRequest",ft=>{if(J(this,ge,Promise.withResolvers()),ot.onPassword){const Et=Kt=>{Kt instanceof Error?l(this,ge).reject(Kt):l(this,ge).resolve({password:Kt})};try{ot.onPassword(Et,ft.code)}catch(Kt){l(this,ge).reject(Kt)}}else l(this,ge).reject(new o.PasswordException(ft.message,ft.code));return l(this,ge).promise}),q.on("DataLoaded",ft=>{var Et;(Et=ot.onProgress)==null||Et.call(ot,{loaded:ft.length,total:ft.length}),this.downloadInfoCapability.resolve(ft)}),q.on("StartRenderPage",ft=>{this.destroyed||l(this,zt).get(ft.pageIndex)._startRenderPage(ft.transparency,ft.cacheKey)}),q.on("commonobj",([ft,Et,Kt])=>{var te;if(this.destroyed||this.commonObjs.has(ft))return null;switch(Et){case"Font":const me=this._params;if("error"in Kt){const hi=Kt.error;(0,o.warn)(`Error during font loading: ${hi}`),this.commonObjs.resolve(ft,hi);break}const Pe=me.pdfBug&&((te=globalThis.FontInspector)!=null&&te.enabled)?(hi,ze)=>globalThis.FontInspector.fontAdded(hi,ze):null,Ti=new d.FontFaceObject(Kt,{disableFontFace:me.disableFontFace,ignoreErrors:me.ignoreErrors,inspectFont:Pe});this.fontLoader.bind(Ti).catch(()=>q.sendWithPromise("FontFallback",{id:ft})).finally(()=>{!me.fontExtraProperties&&Ti.data&&(Ti.data=null),this.commonObjs.resolve(ft,Ti)});break;case"CopyLocalImage":const{imageRef:je}=Kt;(0,o.assert)(je,"The imageRef must be defined.");for(const hi of l(this,zt).values())for(const[,ze]of hi.objs)if(ze.ref===je)return ze.dataLen?(this.commonObjs.resolve(ft,structuredClone(ze)),ze.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(ft,Kt);break;default:throw new Error(`Got unknown common object type ${Et}`)}return null}),q.on("obj",([ft,Et,Kt,te])=>{var Pe;if(this.destroyed)return;const me=l(this,zt).get(Et);if(!me.objs.has(ft)){if(me._intentStates.size===0){(Pe=te==null?void 0:te.bitmap)==null||Pe.close();return}switch(Kt){case"Image":me.objs.resolve(ft,te),(te==null?void 0:te.dataLen)>o.MAX_IMAGE_SIZE_TO_CACHE&&(me._maybeCleanupAfterRender=!0);break;case"Pattern":me.objs.resolve(ft,te);break;default:throw new Error(`Got unknown object type ${Kt}`)}}}),q.on("DocProgress",ft=>{var Et;this.destroyed||((Et=ot.onProgress)==null||Et.call(ot,{loaded:ft.loaded,total:ft.total}))}),q.on("FetchBuiltInCMap",ft=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(ft):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),q.on("FetchStandardFontData",ft=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(ft):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var ft;this.annotationStorage.size<=0&&(0,o.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:q,transfer:ot}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:q,filename:((ft=this._fullReader)==null?void 0:ft.filename)??null},ot).finally(()=>{this.annotationStorage.resetModified()})}getPage(q){if(!Number.isInteger(q)||q<=0||q>this._numPages)return Promise.reject(new Error("Invalid page request."));const ot=q-1,ft=l(this,Jt).get(ot);if(ft)return ft;const Et=this.messageHandler.sendWithPromise("GetPage",{pageIndex:ot}).then(Kt=>{if(this.destroyed)throw new Error("Transport destroyed");Kt.refStr&&l(this,oe).set(Kt.refStr,q);const te=new z(ot,Kt,this,this._params.pdfBug);return l(this,zt).set(ot,te),te});return l(this,Jt).set(ot,Et),Et}getPageIndex(q){return ut(q)?this.messageHandler.sendWithPromise("GetPageIndex",{num:q.num,gen:q.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(q,ot){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:q,intent:ot})}getFieldObjects(){return Y(this,Ae,zo).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,Ae,zo).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(q){return typeof q!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:q})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,Ae,zo).call(this,"GetDocJSActions")}getPageJSActions(q){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:q})}getStructTree(q){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:q})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(q){return Y(this,Ae,zo).call(this,"GetOptionalContentConfig").then(ot=>new x.OptionalContentConfig(ot,q))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const q="GetMetadata",ot=l(this,ee).get(q);if(ot)return ot;const ft=this.messageHandler.sendWithPromise(q,null).then(Et=>{var Kt,te;return{info:Et[0],metadata:Et[1]?new b.Metadata(Et[1]):null,contentDispositionFilename:((Kt=this._fullReader)==null?void 0:Kt.filename)??null,contentLength:((te=this._fullReader)==null?void 0:te.contentLength)??null}});return l(this,ee).set(q,ft),ft}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(q=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const ot of l(this,zt).values())if(!ot.cleanup())throw new Error(`startCleanup: Page ${ot.pageNumber} is currently rendering.`);this.commonObjs.clear(),q||this.fontLoader.clear(),l(this,ee).clear(),this.filterFactory.destroy(!0),(0,S.cleanupTextLayer)()}}cachedPageNumber(q){if(!ut(q))return null;const ot=q.gen===0?`${q.num}R`:`${q.num}R${q.gen}`;return l(this,oe).get(ot)??null}get loadingParams(){const{disableAutoFetch:q,enableXfa:ot}=this._params;return(0,o.shadow)(this,"loadingParams",{disableAutoFetch:q,enableXfa:ot})}}ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,ge=new WeakMap,Ae=new WeakSet,zo=function(q,ot=null){const ft=l(this,ee).get(q);if(ft)return ft;const Et=this.messageHandler.sendWithPromise(q,ot);return l(this,ee).set(q,Et),Et};const Nt=Symbol("INITIAL_DATA");class Ht{constructor(){N(this,lt);N(this,Gt,Object.create(null))}get(q,ot=null){if(ot){const Et=Y(this,lt,vu).call(this,q);return Et.promise.then(()=>ot(Et.data)),null}const ft=l(this,Gt)[q];if(!ft||ft.data===Nt)throw new Error(`Requesting object that isn't resolved yet ${q}.`);return ft.data}has(q){const ot=l(this,Gt)[q];return!!ot&&ot.data!==Nt}resolve(q,ot=null){const ft=Y(this,lt,vu).call(this,q);ft.data=ot,ft.resolve()}clear(){var q;for(const ot in l(this,Gt)){const{data:ft}=l(this,Gt)[ot];(q=ft==null?void 0:ft.bitmap)==null||q.close()}J(this,Gt,Object.create(null))}*[Symbol.iterator](){for(const q in l(this,Gt)){const{data:ot}=l(this,Gt)[q];ot!==Nt&&(yield[q,ot])}}}Gt=new WeakMap,lt=new WeakSet,vu=function(q){var ot;return(ot=l(this,Gt))[q]||(ot[q]={...Promise.withResolvers(),data:Nt})};class Pt{constructor(q){N(this,Wt,null);J(this,Wt,q),this.onContinue=null}get promise(){return l(this,Wt).capability.promise}cancel(q=0){l(this,Wt).cancel(null,q)}get separateAnnots(){const{separateAnnots:q}=l(this,Wt).operatorList;if(!q)return!1;const{annotationCanvasMap:ot}=l(this,Wt);return q.form||q.canvas&&(ot==null?void 0:ot.size)>0}}Wt=new WeakMap;const jt=class{constructor({callback:q,params:ot,objs:ft,commonObjs:Et,annotationCanvasMap:Kt,operatorList:te,pageIndex:me,canvasFactory:Pe,filterFactory:Ti,useRequestAnimationFrame:je=!1,pdfBug:hi=!1,pageColors:ze=null}){this.callback=q,this.params=ot,this.objs=ft,this.commonObjs=Et,this.annotationCanvasMap=Kt,this.operatorListIdx=null,this.operatorList=te,this._pageIndex=me,this.canvasFactory=Pe,this.filterFactory=Ti,this._pdfBug=hi,this.pageColors=ze,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=je===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Pt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=ot.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:q=!1,optionalContentConfig:ot}){var me,Pe;if(this.cancelled)return;if(this._canvas){if(l(jt,ve).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(jt,ve).add(this._canvas)}this._pdfBug&&((me=globalThis.StepperManager)!=null&&me.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:ft,viewport:Et,transform:Kt,background:te}=this.params;this.gfx=new m.CanvasGraphics(ft,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:ot},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Kt,viewport:Et,transparency:q,background:te}),this.operatorListIdx=0,this.graphicsReady=!0,(Pe=this.graphicsReadyCallback)==null||Pe.call(this)}cancel(q=null,ot=0){var ft;this.running=!1,this.cancelled=!0,(ft=this.gfx)==null||ft.endDrawing(),l(jt,ve).delete(this._canvas),this.callback(q||new u.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,ot))}operatorListChanged(){var q;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(q=this.stepper)==null||q.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(jt,ve).delete(this._canvas),this.callback())))}};let Bt=jt;ve=new WeakMap,N(Bt,ve,new WeakSet);const Z="4.2.67",at="49b388101";a()}catch(ie){a(ie)}})},583:(r,t,s)=>{s.d(t,{BaseCMapReaderFactory:()=>c,BaseCanvasFactory:()=>o,BaseFilterFactory:()=>a,BaseSVGFactory:()=>d,BaseStandardFontDataFactory:()=>u});var n=s(292);class a{constructor(){this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,S){return"none"}addHighlightHCMFilter(m,S,_,v,b){return"none"}destroy(m=!1){}}class o{constructor(){this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,S){if(m<=0||S<=0)throw new Error("Invalid canvas size");const _=this._createCanvas(m,S);return{canvas:_,context:_.getContext("2d")}}reset(m,S,_){if(!m.canvas)throw new Error("Canvas is not specified");if(S<=0||_<=0)throw new Error("Invalid canvas size");m.canvas.width=S,m.canvas.height=_}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,S){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}class c{constructor({baseUrl:m=null,isCompressed:S=!0}){this.constructor===c&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=S}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const S=this.baseUrl+m+(this.isCompressed?".bcmap":""),_=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(S,_).catch(v=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${S}`)})}_fetchData(m,S){(0,n.unreachable)("Abstract method `_fetchData` called.")}}class u{constructor({baseUrl:m=null}){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const S=`${this.baseUrl}${m}`;return this._fetchData(S).catch(_=>{throw new Error(`Unable to load font data at: ${S}`)})}_fetchData(m){(0,n.unreachable)("Abstract method `_fetchData` called.")}}class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,S,_=!1){if(m<=0||S<=0)throw new Error("Invalid SVG dimensions");const v=this._createSVG("svg:svg");return v.setAttribute("version","1.1"),_||(v.setAttribute("width",`${m}px`),v.setAttribute("height",`${S}px`)),v.setAttribute("preserveAspectRatio","none"),v.setAttribute("viewBox",`0 0 ${m} ${S}`),v}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,n.unreachable)("Abstract method `_createSVG` called.")}}},923:(r,t,s)=>{var Wt,yu,ie,bu;s.d(t,{CanvasGraphics:()=>lt});var n=s(292),a=s(419);const o={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function c(ut,T){if(!T)return;const R=T[2]-T[0],D=T[3]-T[1],H=new Path2D;H.rect(T[0],T[1],R,D),ut.clip(H)}class u{constructor(){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class d extends u{constructor(T){super(),this._type=T[1],this._bbox=T[2],this._colorStops=T[3],this._p0=T[4],this._p1=T[5],this._r0=T[6],this._r1=T[7],this.matrix=null}_createGradient(T){let R;this._type==="axial"?R=T.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(R=T.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const D of this._colorStops)R.addColorStop(D[0],D[1]);return R}getPattern(T,R,D,H){let L;if(H===o.STROKE||H===o.FILL){const V=R.current.getClippedPathBoundingBox(H,(0,a.getCurrentTransform)(T))||[0,0,0,0],j=Math.ceil(V[2]-V[0])||1,G=Math.ceil(V[3]-V[1])||1,W=R.cachedCanvases.getCanvas("pattern",j,G,!0),U=W.context;U.clearRect(0,0,U.canvas.width,U.canvas.height),U.beginPath(),U.rect(0,0,U.canvas.width,U.canvas.height),U.translate(-V[0],-V[1]),D=n.Util.transform(D,[1,0,0,1,V[0],V[1]]),U.transform(...R.baseTransform),this.matrix&&U.transform(...this.matrix),c(U,this._bbox),U.fillStyle=this._createGradient(U),U.fill(),L=T.createPattern(W.canvas,"no-repeat");const O=new DOMMatrix(D);L.setTransform(O)}else c(T,this._bbox),L=this._createGradient(T);return L}}function f(ut,T,R,D,H,L,V,j){const G=T.coords,W=T.colors,U=ut.data,O=ut.width*4;let z;G[R+1]>G[D+1]&&(z=R,R=D,D=z,z=L,L=V,V=z),G[D+1]>G[H+1]&&(z=D,D=H,H=z,z=V,V=j,j=z),G[R+1]>G[D+1]&&(z=R,R=D,D=z,z=L,L=V,V=z);const et=(G[R]+T.offsetX)*T.scaleX,nt=(G[R+1]+T.offsetY)*T.scaleY,gt=(G[D]+T.offsetX)*T.scaleX,yt=(G[D+1]+T.offsetY)*T.scaleY,Nt=(G[H]+T.offsetX)*T.scaleX,Ht=(G[H+1]+T.offsetY)*T.scaleY;if(nt>=Ht)return;const Pt=W[L],Bt=W[L+1],Z=W[L+2],at=W[V],_t=W[V+1],vt=W[V+2],jt=W[j],bt=W[j+1],q=W[j+2],ot=Math.round(nt),ft=Math.round(Ht);let Et,Kt,te,me,Pe,Ti,je,hi;for(let ze=ot;ze<=ft;ze++){if(ze<yt){const Me=ze<nt?0:(nt-ze)/(nt-yt);Et=et-(et-gt)*Me,Kt=Pt-(Pt-at)*Me,te=Bt-(Bt-_t)*Me,me=Z-(Z-vt)*Me}else{let Me;ze>Ht?Me=1:yt===Ht?Me=0:Me=(yt-ze)/(yt-Ht),Et=gt-(gt-Nt)*Me,Kt=at-(at-jt)*Me,te=_t-(_t-bt)*Me,me=vt-(vt-q)*Me}let vi;ze<nt?vi=0:ze>Ht?vi=1:vi=(nt-ze)/(nt-Ht),Pe=et-(et-Nt)*vi,Ti=Pt-(Pt-jt)*vi,je=Bt-(Bt-bt)*vi,hi=Z-(Z-q)*vi;const oi=Math.round(Math.min(Et,Pe)),er=Math.round(Math.max(Et,Pe));let bi=O*ze+oi*4;for(let Me=oi;Me<=er;Me++)vi=(Et-Me)/(Et-Pe),vi<0?vi=0:vi>1&&(vi=1),U[bi++]=Kt-(Kt-Ti)*vi|0,U[bi++]=te-(te-je)*vi|0,U[bi++]=me-(me-hi)*vi|0,U[bi++]=255}}function m(ut,T,R){const D=T.coords,H=T.colors;let L,V;switch(T.type){case"lattice":const j=T.verticesPerRow,G=Math.floor(D.length/j)-1,W=j-1;for(L=0;L<G;L++){let U=L*j;for(let O=0;O<W;O++,U++)f(ut,R,D[U],D[U+1],D[U+j],H[U],H[U+1],H[U+j]),f(ut,R,D[U+j+1],D[U+1],D[U+j],H[U+j+1],H[U+1],H[U+j])}break;case"triangles":for(L=0,V=D.length;L<V;L+=3)f(ut,R,D[L],D[L+1],D[L+2],H[L],H[L+1],H[L+2]);break;default:throw new Error("illegal figure")}}class S extends u{constructor(T){super(),this._coords=T[2],this._colors=T[3],this._figures=T[4],this._bounds=T[5],this._bbox=T[7],this._background=T[8],this.matrix=null}_createMeshCanvas(T,R,D){const H=Math.floor(this._bounds[0]),L=Math.floor(this._bounds[1]),V=Math.ceil(this._bounds[2])-H,j=Math.ceil(this._bounds[3])-L,G=Math.min(Math.ceil(Math.abs(V*T[0]*1.1)),3e3),W=Math.min(Math.ceil(Math.abs(j*T[1]*1.1)),3e3),U=V/G,O=j/W,z={coords:this._coords,colors:this._colors,offsetX:-H,offsetY:-L,scaleX:1/U,scaleY:1/O},et=G+2*2,nt=W+2*2,gt=D.getCanvas("mesh",et,nt,!1),yt=gt.context,Nt=yt.createImageData(G,W);if(R){const Ht=Nt.data;for(let Pt=0,Bt=Ht.length;Pt<Bt;Pt+=4)Ht[Pt]=R[0],Ht[Pt+1]=R[1],Ht[Pt+2]=R[2],Ht[Pt+3]=255}for(const Ht of this._figures)m(Nt,Ht,z);return yt.putImageData(Nt,2,2),{canvas:gt.canvas,offsetX:H-2*U,offsetY:L-2*O,scaleX:U,scaleY:O}}getPattern(T,R,D,H){c(T,this._bbox);let L;if(H===o.SHADING)L=n.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(T));else if(L=n.Util.singularValueDecompose2dScale(R.baseTransform),this.matrix){const j=n.Util.singularValueDecompose2dScale(this.matrix);L=[L[0]*j[0],L[1]*j[1]]}const V=this._createMeshCanvas(L,H===o.SHADING?null:this._background,R.cachedCanvases);return H!==o.SHADING&&(T.setTransform(...R.baseTransform),this.matrix&&T.transform(...this.matrix)),T.translate(V.offsetX,V.offsetY),T.scale(V.scaleX,V.scaleY),T.createPattern(V.canvas,"no-repeat")}}class _ extends u{getPattern(){return"hotpink"}}function v(ut){switch(ut[0]){case"RadialAxial":return new d(ut);case"Mesh":return new S(ut);case"Dummy":return new _}throw new Error(`Unknown IR type: ${ut[0]}`)}const b={COLORED:1,UNCOLORED:2},Ft=class{constructor(T,R,D,H,L){this.operatorList=T[2],this.matrix=T[3]||[1,0,0,1,0,0],this.bbox=T[4],this.xstep=T[5],this.ystep=T[6],this.paintType=T[7],this.tilingType=T[8],this.color=R,this.ctx=D,this.canvasGraphicsFactory=H,this.baseTransform=L}createPatternCanvas(T){const R=this.operatorList,D=this.bbox,H=this.xstep,L=this.ystep,V=this.paintType,j=this.tilingType,G=this.color,W=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+j);const U=D[0],O=D[1],z=D[2],et=D[3],nt=n.Util.singularValueDecompose2dScale(this.matrix),gt=n.Util.singularValueDecompose2dScale(this.baseTransform),yt=[nt[0]*gt[0],nt[1]*gt[1]],Nt=this.getSizeAndScale(H,this.ctx.canvas.width,yt[0]),Ht=this.getSizeAndScale(L,this.ctx.canvas.height,yt[1]),Pt=T.cachedCanvases.getCanvas("pattern",Nt.size,Ht.size,!0),Bt=Pt.context,Z=W.createCanvasGraphics(Bt);Z.groupLevel=T.groupLevel,this.setFillAndStrokeStyleToContext(Z,V,G);let at=U,_t=O,vt=z,jt=et;return U<0&&(at=0,vt+=Math.abs(U)),O<0&&(_t=0,jt+=Math.abs(O)),Bt.translate(-(Nt.scale*at),-(Ht.scale*_t)),Z.transform(Nt.scale,0,0,Ht.scale,0,0),Bt.save(),this.clipBbox(Z,at,_t,vt,jt),Z.baseTransform=(0,a.getCurrentTransform)(Z.ctx),Z.executeOperatorList(R),Z.endDrawing(),{canvas:Pt.canvas,scaleX:Nt.scale,scaleY:Ht.scale,offsetX:at,offsetY:_t}}getSizeAndScale(T,R,D){T=Math.abs(T);const H=Math.max(Ft.MAX_PATTERN_SIZE,R);let L=Math.ceil(T*D);return L>=H?L=H:D=L/T,{scale:D,size:L}}clipBbox(T,R,D,H,L){const V=H-R,j=L-D;T.ctx.rect(R,D,V,j),T.current.updateRectMinMax((0,a.getCurrentTransform)(T.ctx),[R,D,H,L]),T.clip(),T.endPath()}setFillAndStrokeStyleToContext(T,R,D){const H=T.ctx,L=T.current;switch(R){case b.COLORED:const V=this.ctx;H.fillStyle=V.fillStyle,H.strokeStyle=V.strokeStyle,L.fillColor=V.fillStyle,L.strokeColor=V.strokeStyle;break;case b.UNCOLORED:const j=n.Util.makeHexColor(D[0],D[1],D[2]);H.fillStyle=j,H.strokeStyle=j,L.fillColor=j,L.strokeColor=j;break;default:throw new n.FormatError(`Unsupported paint type: ${R}`)}}getPattern(T,R,D,H){let L=D;H!==o.SHADING&&(L=n.Util.transform(L,R.baseTransform),this.matrix&&(L=n.Util.transform(L,this.matrix)));const V=this.createPatternCanvas(R);let j=new DOMMatrix(L);j=j.translate(V.offsetX,V.offsetY),j=j.scale(1/V.scaleX,1/V.scaleY);const G=T.createPattern(V.canvas,"repeat");return G.setTransform(j),G}};let x=Ft;ti(x,"MAX_PATTERN_SIZE",3e3);function A({src:ut,srcPos:T=0,dest:R,width:D,height:H,nonBlackColor:L=4294967295,inverseDecode:V=!1}){const j=n.FeatureTest.isLittleEndian?4278190080:255,[G,W]=V?[L,j]:[j,L],U=D>>3,O=D&7,z=ut.length;R=new Uint32Array(R.buffer);let et=0;for(let nt=0;nt<H;nt++){for(const yt=T+U;T<yt;T++){const Nt=T<z?ut[T]:255;R[et++]=Nt&128?W:G,R[et++]=Nt&64?W:G,R[et++]=Nt&32?W:G,R[et++]=Nt&16?W:G,R[et++]=Nt&8?W:G,R[et++]=Nt&4?W:G,R[et++]=Nt&2?W:G,R[et++]=Nt&1?W:G}if(O===0)continue;const gt=T<z?ut[T++]:255;for(let yt=0;yt<O;yt++)R[et++]=gt&1<<7-yt?W:G}return{srcPos:T,destPos:et}}const F=16,M=100,g=4096,w=15,E=10,C=1e3,B=16;function I(ut,T){if(ut._removeMirroring)throw new Error("Context is already forwarding operations.");ut.__originalSave=ut.save,ut.__originalRestore=ut.restore,ut.__originalRotate=ut.rotate,ut.__originalScale=ut.scale,ut.__originalTranslate=ut.translate,ut.__originalTransform=ut.transform,ut.__originalSetTransform=ut.setTransform,ut.__originalResetTransform=ut.resetTransform,ut.__originalClip=ut.clip,ut.__originalMoveTo=ut.moveTo,ut.__originalLineTo=ut.lineTo,ut.__originalBezierCurveTo=ut.bezierCurveTo,ut.__originalRect=ut.rect,ut.__originalClosePath=ut.closePath,ut.__originalBeginPath=ut.beginPath,ut._removeMirroring=()=>{ut.save=ut.__originalSave,ut.restore=ut.__originalRestore,ut.rotate=ut.__originalRotate,ut.scale=ut.__originalScale,ut.translate=ut.__originalTranslate,ut.transform=ut.__originalTransform,ut.setTransform=ut.__originalSetTransform,ut.resetTransform=ut.__originalResetTransform,ut.clip=ut.__originalClip,ut.moveTo=ut.__originalMoveTo,ut.lineTo=ut.__originalLineTo,ut.bezierCurveTo=ut.__originalBezierCurveTo,ut.rect=ut.__originalRect,ut.closePath=ut.__originalClosePath,ut.beginPath=ut.__originalBeginPath,delete ut._removeMirroring},ut.save=function(){T.save(),this.__originalSave()},ut.restore=function(){T.restore(),this.__originalRestore()},ut.translate=function(R,D){T.translate(R,D),this.__originalTranslate(R,D)},ut.scale=function(R,D){T.scale(R,D),this.__originalScale(R,D)},ut.transform=function(R,D,H,L,V,j){T.transform(R,D,H,L,V,j),this.__originalTransform(R,D,H,L,V,j)},ut.setTransform=function(R,D,H,L,V,j){T.setTransform(R,D,H,L,V,j),this.__originalSetTransform(R,D,H,L,V,j)},ut.resetTransform=function(){T.resetTransform(),this.__originalResetTransform()},ut.rotate=function(R){T.rotate(R),this.__originalRotate(R)},ut.clip=function(R){T.clip(R),this.__originalClip(R)},ut.moveTo=function(R,D){T.moveTo(R,D),this.__originalMoveTo(R,D)},ut.lineTo=function(R,D){T.lineTo(R,D),this.__originalLineTo(R,D)},ut.bezierCurveTo=function(R,D,H,L,V,j){T.bezierCurveTo(R,D,H,L,V,j),this.__originalBezierCurveTo(R,D,H,L,V,j)},ut.rect=function(R,D,H,L){T.rect(R,D,H,L),this.__originalRect(R,D,H,L)},ut.closePath=function(){T.closePath(),this.__originalClosePath()},ut.beginPath=function(){T.beginPath(),this.__originalBeginPath()}}class rt{constructor(T){this.canvasFactory=T,this.cache=Object.create(null)}getCanvas(T,R,D){let H;return this.cache[T]!==void 0?(H=this.cache[T],this.canvasFactory.reset(H,R,D)):(H=this.canvasFactory.create(R,D),this.cache[T]=H),H}delete(T){delete this.cache[T]}clear(){for(const T in this.cache){const R=this.cache[T];this.canvasFactory.destroy(R),delete this.cache[T]}}}function tt(ut,T,R,D,H,L,V,j,G,W){const[U,O,z,et,nt,gt]=(0,a.getCurrentTransform)(ut);if(O===0&&z===0){const Ht=V*U+nt,Pt=Math.round(Ht),Bt=j*et+gt,Z=Math.round(Bt),at=(V+G)*U+nt,_t=Math.abs(Math.round(at)-Pt)||1,vt=(j+W)*et+gt,jt=Math.abs(Math.round(vt)-Z)||1;return ut.setTransform(Math.sign(U),0,0,Math.sign(et),Pt,Z),ut.drawImage(T,R,D,H,L,0,0,_t,jt),ut.setTransform(U,O,z,et,nt,gt),[_t,jt]}if(U===0&&et===0){const Ht=j*z+nt,Pt=Math.round(Ht),Bt=V*O+gt,Z=Math.round(Bt),at=(j+W)*z+nt,_t=Math.abs(Math.round(at)-Pt)||1,vt=(V+G)*O+gt,jt=Math.abs(Math.round(vt)-Z)||1;return ut.setTransform(0,Math.sign(O),Math.sign(z),0,Pt,Z),ut.drawImage(T,R,D,H,L,0,0,jt,_t),ut.setTransform(U,O,z,et,nt,gt),[jt,_t]}ut.drawImage(T,R,D,H,L,V,j,G,W);const yt=Math.hypot(U,O),Nt=Math.hypot(z,et);return[yt*G,Nt*W]}function st(ut){const{width:T,height:R}=ut;if(T>C||R>C)return null;const D=1e3,H=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),L=T+1;let V=new Uint8Array(L*(R+1)),j,G,W;const U=T+7&-8;let O=new Uint8Array(U*R),z=0;for(const yt of ut.data){let Nt=128;for(;Nt>0;)O[z++]=yt&Nt?0:255,Nt>>=1}let et=0;for(z=0,O[z]!==0&&(V[0]=1,++et),G=1;G<T;G++)O[z]!==O[z+1]&&(V[G]=O[z]?2:1,++et),z++;for(O[z]!==0&&(V[G]=2,++et),j=1;j<R;j++){z=j*U,W=j*L,O[z-U]!==O[z]&&(V[W]=O[z]?1:8,++et);let yt=(O[z]?4:0)+(O[z-U]?8:0);for(G=1;G<T;G++)yt=(yt>>2)+(O[z+1]?4:0)+(O[z-U+1]?8:0),H[yt]&&(V[W+G]=H[yt],++et),z++;if(O[z-U]!==O[z]&&(V[W+G]=O[z]?2:4,++et),et>D)return null}for(z=U*(R-1),W=j*L,O[z]!==0&&(V[W]=8,++et),G=1;G<T;G++)O[z]!==O[z+1]&&(V[W+G]=O[z]?4:8,++et),z++;if(O[z]!==0&&(V[W+G]=4,++et),et>D)return null;const nt=new Int32Array([0,L,-1,0,-L,0,0,0,1]),gt=new Path2D;for(j=0;et&&j<=R;j++){let yt=j*L;const Nt=yt+T;for(;yt<Nt&&!V[yt];)yt++;if(yt===Nt)continue;gt.moveTo(yt%L,j);const Ht=yt;let Pt=V[yt];do{const Bt=nt[Pt];do yt+=Bt;while(!V[yt]);const Z=V[yt];Z!==5&&Z!==10?(Pt=Z,V[yt]=0):(Pt=Z&51*Pt>>4,V[yt]&=Pt>>2|Pt<<2),gt.lineTo(yt%L,yt/L|0),V[yt]||--et}while(Ht!==yt);--j}return O=null,V=null,function(yt){yt.save(),yt.scale(1/T,-1/R),yt.translate(0,-R),yt.fill(gt),yt.beginPath(),yt.restore()}}class wt{constructor(T,R){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,T,R])}clone(){const T=Object.create(this);return T.clipBox=this.clipBox.slice(),T}setCurrentPoint(T,R){this.x=T,this.y=R}updatePathMinMax(T,R,D){[R,D]=n.Util.applyTransform([R,D],T),this.minX=Math.min(this.minX,R),this.minY=Math.min(this.minY,D),this.maxX=Math.max(this.maxX,R),this.maxY=Math.max(this.maxY,D)}updateRectMinMax(T,R){const D=n.Util.applyTransform(R,T),H=n.Util.applyTransform(R.slice(2),T),L=n.Util.applyTransform([R[0],R[3]],T),V=n.Util.applyTransform([R[2],R[1]],T);this.minX=Math.min(this.minX,D[0],H[0],L[0],V[0]),this.minY=Math.min(this.minY,D[1],H[1],L[1],V[1]),this.maxX=Math.max(this.maxX,D[0],H[0],L[0],V[0]),this.maxY=Math.max(this.maxY,D[1],H[1],L[1],V[1])}updateScalingPathMinMax(T,R){n.Util.scaleMinMax(T,R),this.minX=Math.min(this.minX,R[0]),this.minY=Math.min(this.minY,R[1]),this.maxX=Math.max(this.maxX,R[2]),this.maxY=Math.max(this.maxY,R[3])}updateCurvePathMinMax(T,R,D,H,L,V,j,G,W,U){const O=n.Util.bezierBoundingBox(R,D,H,L,V,j,G,W,U);U||this.updateRectMinMax(T,O)}getPathBoundingBox(T=o.FILL,R=null){const D=[this.minX,this.minY,this.maxX,this.maxY];if(T===o.STROKE){R||(0,n.unreachable)("Stroke bounding box must include transform.");const H=n.Util.singularValueDecompose2dScale(R),L=H[0]*this.lineWidth/2,V=H[1]*this.lineWidth/2;D[0]-=L,D[1]-=V,D[2]+=L,D[3]+=V}return D}updateClipFromPath(){const T=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(T||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(T){this.clipBox=T,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(T=o.FILL,R=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(T,R))}}function dt(ut,T){if(typeof ImageData<"u"&&T instanceof ImageData){ut.putImageData(T,0,0);return}const R=T.height,D=T.width,H=R%B,L=(R-H)/B,V=H===0?L:L+1,j=ut.createImageData(D,B);let G=0,W;const U=T.data,O=j.data;let z,et,nt,gt;if(T.kind===n.ImageKind.GRAYSCALE_1BPP){const yt=U.byteLength,Nt=new Uint32Array(O.buffer,0,O.byteLength>>2),Ht=Nt.length,Pt=D+7>>3,Bt=4294967295,Z=n.FeatureTest.isLittleEndian?4278190080:255;for(z=0;z<V;z++){for(nt=z<L?B:H,W=0,et=0;et<nt;et++){const at=yt-G;let _t=0;const vt=at>Pt?D:at*8-7,jt=vt&-8;let bt=0,q=0;for(;_t<jt;_t+=8)q=U[G++],Nt[W++]=q&128?Bt:Z,Nt[W++]=q&64?Bt:Z,Nt[W++]=q&32?Bt:Z,Nt[W++]=q&16?Bt:Z,Nt[W++]=q&8?Bt:Z,Nt[W++]=q&4?Bt:Z,Nt[W++]=q&2?Bt:Z,Nt[W++]=q&1?Bt:Z;for(;_t<vt;_t++)bt===0&&(q=U[G++],bt=128),Nt[W++]=q&bt?Bt:Z,bt>>=1}for(;W<Ht;)Nt[W++]=0;ut.putImageData(j,0,z*B)}}else if(T.kind===n.ImageKind.RGBA_32BPP){for(et=0,gt=D*B*4,z=0;z<L;z++)O.set(U.subarray(G,G+gt)),G+=gt,ut.putImageData(j,0,et),et+=B;z<V&&(gt=D*H*4,O.set(U.subarray(G,G+gt)),ut.putImageData(j,0,et))}else if(T.kind===n.ImageKind.RGB_24BPP)for(nt=B,gt=D*nt,z=0;z<V;z++){for(z>=L&&(nt=H,gt=D*nt),W=0,et=gt;et--;)O[W++]=U[G++],O[W++]=U[G++],O[W++]=U[G++],O[W++]=255;ut.putImageData(j,0,z*B)}else throw new Error(`bad image kind: ${T.kind}`)}function Tt(ut,T){if(T.bitmap){ut.drawImage(T.bitmap,0,0);return}const R=T.height,D=T.width,H=R%B,L=(R-H)/B,V=H===0?L:L+1,j=ut.createImageData(D,B);let G=0;const W=T.data,U=j.data;for(let O=0;O<V;O++){const z=O<L?B:H;({srcPos:G}=A({src:W,srcPos:G,dest:U,width:D,height:z,nonBlackColor:0})),ut.putImageData(j,0,O*B)}}function Lt(ut,T){const R=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const D of R)ut[D]!==void 0&&(T[D]=ut[D]);ut.setLineDash!==void 0&&(T.setLineDash(ut.getLineDash()),T.lineDashOffset=ut.lineDashOffset)}function Qt(ut){if(ut.strokeStyle=ut.fillStyle="#000000",ut.fillRule="nonzero",ut.globalAlpha=1,ut.lineWidth=1,ut.lineCap="butt",ut.lineJoin="miter",ut.miterLimit=10,ut.globalCompositeOperation="source-over",ut.font="10px sans-serif",ut.setLineDash!==void 0&&(ut.setLineDash([]),ut.lineDashOffset=0),!n.isNodeJS){const{filter:T}=ut;T!=="none"&&T!==""&&(ut.filter="none")}}function ct(ut,T,R,D){const H=ut.length;for(let L=3;L<H;L+=4){const V=ut[L];if(V===0)ut[L-3]=T,ut[L-2]=R,ut[L-1]=D;else if(V<255){const j=255-V;ut[L-3]=ut[L-3]*V+T*j>>8,ut[L-2]=ut[L-2]*V+R*j>>8,ut[L-1]=ut[L-1]*V+D*j>>8}}}function Dt(ut,T,R){const D=ut.length,H=1/255;for(let L=3;L<D;L+=4){const V=R?R[ut[L]]:ut[L];T[L]=T[L]*V*H|0}}function ee(ut,T,R){const D=ut.length;for(let H=3;H<D;H+=4){const L=ut[H-3]*77+ut[H-2]*152+ut[H-1]*28;T[H]=R?T[H]*R[L>>8]>>8:T[H]*L>>16}}function zt(ut,T,R,D,H,L,V,j,G,W,U){const O=!!L,z=O?L[0]:0,et=O?L[1]:0,nt=O?L[2]:0,gt=H==="Luminosity"?ee:Dt,yt=Math.min(D,Math.ceil(1048576/R));for(let Nt=0;Nt<D;Nt+=yt){const Ht=Math.min(yt,D-Nt),Pt=ut.getImageData(j-W,Nt+(G-U),R,Ht),Bt=T.getImageData(j,Nt+G,R,Ht);O&&ct(Pt.data,z,et,nt),gt(Pt.data,Bt.data,V),T.putImageData(Bt,j,Nt+G)}}function Jt(ut,T,R,D){const H=D[0],L=D[1],V=D[2]-H,j=D[3]-L;V===0||j===0||(zt(T.context,R,V,j,T.subtype,T.backdrop,T.transferMap,H,L,T.offsetX,T.offsetY),ut.save(),ut.globalAlpha=1,ut.globalCompositeOperation="source-over",ut.setTransform(1,0,0,1,0,0),ut.drawImage(R.canvas,0,0),ut.restore())}function oe(ut,T){if(T)return!0;const R=n.Util.singularValueDecompose2dScale(ut);R[0]=Math.fround(R[0]),R[1]=Math.fround(R[1]);const D=Math.fround((globalThis.devicePixelRatio||1)*a.PixelsPerInch.PDF_TO_CSS_UNITS);return R[0]<=D&&R[1]<=D}const ge=["butt","round","square"],Ae=["miter","round","bevel"],Ve={},Gt={},_e=class{constructor(T,R,D,H,L,{optionalContentConfig:V,markedContentStack:j=null},G,W){N(this,Wt);N(this,ie);this.ctx=T,this.current=new wt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=R,this.objs=D,this.canvasFactory=H,this.filterFactory=L,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=j||[],this.optionalContentConfig=V,this.cachedCanvases=new rt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=G,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=W,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(T,R=null){return typeof T=="string"?T.startsWith("g_")?this.commonObjs.get(T):this.objs.get(T):R}beginDrawing({transform:T,viewport:R,transparency:D=!1,background:H=null}){const L=this.ctx.canvas.width,V=this.ctx.canvas.height,j=this.ctx.fillStyle;if(this.ctx.fillStyle=H||"#ffffff",this.ctx.fillRect(0,0,L,V),this.ctx.fillStyle=j,D){const G=this.cachedCanvases.getCanvas("transparent",L,V);this.compositeCtx=this.ctx,this.transparentCanvas=G.canvas,this.ctx=G.context,this.ctx.save(),this.ctx.transform(...(0,a.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Qt(this.ctx),T&&(this.ctx.transform(...T),this.outputScaleX=T[0],this.outputScaleY=T[0]),this.ctx.transform(...R.transform),this.viewportScale=R.scale,this.baseTransform=(0,a.getCurrentTransform)(this.ctx)}executeOperatorList(T,R,D,H){const L=T.argsArray,V=T.fnArray;let j=R||0;const G=L.length;if(G===j)return j;const W=G-j>E&&typeof D=="function",U=W?Date.now()+w:0;let O=0;const z=this.commonObjs,et=this.objs;let nt;for(;;){if(H!==void 0&&j===H.nextBreakPoint)return H.breakIt(j,D),j;if(nt=V[j],nt!==n.OPS.dependency)this[nt].apply(this,L[j]);else for(const gt of L[j]){const yt=gt.startsWith("g_")?z:et;if(!yt.has(gt))return yt.get(gt,D),j}if(j++,j===G)return j;if(W&&++O>E){if(Date.now()>U)return D(),j;O=0}}}endDrawing(){Y(this,Wt,yu).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const T of this._cachedBitmapsMap.values()){for(const R of T.values())typeof HTMLCanvasElement<"u"&&R instanceof HTMLCanvasElement&&(R.width=R.height=0);T.clear()}this._cachedBitmapsMap.clear(),Y(this,ie,bu).call(this)}_scaleImage(T,R){const D=T.width,H=T.height;let L=Math.max(Math.hypot(R[0],R[1]),1),V=Math.max(Math.hypot(R[2],R[3]),1),j=D,G=H,W="prescale1",U,O;for(;L>2&&j>1||V>2&&G>1;){let z=j,et=G;L>2&&j>1&&(z=j>=16384?Math.floor(j/2)-1||1:Math.ceil(j/2),L/=j/z),V>2&&G>1&&(et=G>=16384?Math.floor(G/2)-1||1:Math.ceil(G)/2,V/=G/et),U=this.cachedCanvases.getCanvas(W,z,et),O=U.context,O.clearRect(0,0,z,et),O.drawImage(T,0,0,j,G,0,0,z,et),T=U.canvas,j=z,G=et,W=W==="prescale1"?"prescale2":"prescale1"}return{img:T,paintWidth:j,paintHeight:G}}_createMaskCanvas(T){const R=this.ctx,{width:D,height:H}=T,L=this.current.fillColor,V=this.current.patternFill,j=(0,a.getCurrentTransform)(R);let G,W,U,O;if((T.bitmap||T.data)&&T.count>1){const vt=T.bitmap||T.data.buffer;W=JSON.stringify(V?j:[j.slice(0,4),L]),G=this._cachedBitmapsMap.get(vt),G||(G=new Map,this._cachedBitmapsMap.set(vt,G));const jt=G.get(W);if(jt&&!V){const bt=Math.round(Math.min(j[0],j[2])+j[4]),q=Math.round(Math.min(j[1],j[3])+j[5]);return{canvas:jt,offsetX:bt,offsetY:q}}U=jt}U||(O=this.cachedCanvases.getCanvas("maskCanvas",D,H),Tt(O.context,T));let z=n.Util.transform(j,[1/D,0,0,-1/H,0,0]);z=n.Util.transform(z,[1,0,0,1,0,-H]);const[et,nt,gt,yt]=n.Util.getAxialAlignedBoundingBox([0,0,D,H],z),Nt=Math.round(gt-et)||1,Ht=Math.round(yt-nt)||1,Pt=this.cachedCanvases.getCanvas("fillCanvas",Nt,Ht),Bt=Pt.context,Z=et,at=nt;Bt.translate(-Z,-at),Bt.transform(...z),U||(U=this._scaleImage(O.canvas,(0,a.getCurrentTransformInverse)(Bt)),U=U.img,G&&V&&G.set(W,U)),Bt.imageSmoothingEnabled=oe((0,a.getCurrentTransform)(Bt),T.interpolate),tt(Bt,U,0,0,U.width,U.height,0,0,D,H),Bt.globalCompositeOperation="source-in";const _t=n.Util.transform((0,a.getCurrentTransformInverse)(Bt),[1,0,0,1,-Z,-at]);return Bt.fillStyle=V?L.getPattern(R,this,_t,o.FILL):L,Bt.fillRect(0,0,D,H),G&&!V&&(this.cachedCanvases.delete("fillCanvas"),G.set(W,Pt.canvas)),{canvas:Pt.canvas,offsetX:Math.round(Z),offsetY:Math.round(at)}}setLineWidth(T){T!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=T,this.ctx.lineWidth=T}setLineCap(T){this.ctx.lineCap=ge[T]}setLineJoin(T){this.ctx.lineJoin=Ae[T]}setMiterLimit(T){this.ctx.miterLimit=T}setDash(T,R){const D=this.ctx;D.setLineDash!==void 0&&(D.setLineDash(T),D.lineDashOffset=R)}setRenderingIntent(T){}setFlatness(T){}setGState(T){for(const[R,D]of T)switch(R){case"LW":this.setLineWidth(D);break;case"LC":this.setLineCap(D);break;case"LJ":this.setLineJoin(D);break;case"ML":this.setMiterLimit(D);break;case"D":this.setDash(D[0],D[1]);break;case"RI":this.setRenderingIntent(D);break;case"FL":this.setFlatness(D);break;case"Font":this.setFont(D[0],D[1]);break;case"CA":this.current.strokeAlpha=D;break;case"ca":this.current.fillAlpha=D,this.ctx.globalAlpha=D;break;case"BM":this.ctx.globalCompositeOperation=D;break;case"SMask":this.current.activeSMask=D?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(D);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const T=this.inSMaskMode;this.current.activeSMask&&!T?this.beginSMaskMode():!this.current.activeSMask&&T&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const T=this.ctx.canvas.width,R=this.ctx.canvas.height,D="smaskGroupAt"+this.groupLevel,H=this.cachedCanvases.getCanvas(D,T,R);this.suspendedCtx=this.ctx,this.ctx=H.context;const L=this.ctx;L.setTransform(...(0,a.getCurrentTransform)(this.suspendedCtx)),Lt(this.suspendedCtx,L),I(L,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Lt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(T){if(!this.current.activeSMask)return;T?(T[0]=Math.floor(T[0]),T[1]=Math.floor(T[1]),T[2]=Math.ceil(T[2]),T[3]=Math.ceil(T[3])):T=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const R=this.current.activeSMask,D=this.suspendedCtx;Jt(D,R,this.ctx,T),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Lt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const T=this.current;this.stateStack.push(T),this.current=T.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Lt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(T,R,D,H,L,V){this.ctx.transform(T,R,D,H,L,V),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(T,R,D){const H=this.ctx,L=this.current;let V=L.x,j=L.y,G,W;const U=(0,a.getCurrentTransform)(H),O=U[0]===0&&U[3]===0||U[1]===0&&U[2]===0,z=O?D.slice(0):null;for(let et=0,nt=0,gt=T.length;et<gt;et++)switch(T[et]|0){case n.OPS.rectangle:V=R[nt++],j=R[nt++];const yt=R[nt++],Nt=R[nt++],Ht=V+yt,Pt=j+Nt;H.moveTo(V,j),yt===0||Nt===0?H.lineTo(Ht,Pt):(H.lineTo(Ht,j),H.lineTo(Ht,Pt),H.lineTo(V,Pt)),O||L.updateRectMinMax(U,[V,j,Ht,Pt]),H.closePath();break;case n.OPS.moveTo:V=R[nt++],j=R[nt++],H.moveTo(V,j),O||L.updatePathMinMax(U,V,j);break;case n.OPS.lineTo:V=R[nt++],j=R[nt++],H.lineTo(V,j),O||L.updatePathMinMax(U,V,j);break;case n.OPS.curveTo:G=V,W=j,V=R[nt+4],j=R[nt+5],H.bezierCurveTo(R[nt],R[nt+1],R[nt+2],R[nt+3],V,j),L.updateCurvePathMinMax(U,G,W,R[nt],R[nt+1],R[nt+2],R[nt+3],V,j,z),nt+=6;break;case n.OPS.curveTo2:G=V,W=j,H.bezierCurveTo(V,j,R[nt],R[nt+1],R[nt+2],R[nt+3]),L.updateCurvePathMinMax(U,G,W,V,j,R[nt],R[nt+1],R[nt+2],R[nt+3],z),V=R[nt+2],j=R[nt+3],nt+=4;break;case n.OPS.curveTo3:G=V,W=j,V=R[nt+2],j=R[nt+3],H.bezierCurveTo(R[nt],R[nt+1],V,j,V,j),L.updateCurvePathMinMax(U,G,W,R[nt],R[nt+1],V,j,V,j,z),nt+=4;break;case n.OPS.closePath:H.closePath();break}O&&L.updateScalingPathMinMax(U,z),L.setCurrentPoint(V,j)}closePath(){this.ctx.closePath()}stroke(T=!0){const R=this.ctx,D=this.current.strokeColor;R.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof D=="object"&&(D!=null&&D.getPattern)?(R.save(),R.strokeStyle=D.getPattern(R,this,(0,a.getCurrentTransformInverse)(R),o.STROKE),this.rescaleAndStroke(!1),R.restore()):this.rescaleAndStroke(!0)),T&&this.consumePath(this.current.getClippedPathBoundingBox()),R.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(T=!0){const R=this.ctx,D=this.current.fillColor,H=this.current.patternFill;let L=!1;H&&(R.save(),R.fillStyle=D.getPattern(R,this,(0,a.getCurrentTransformInverse)(R),o.FILL),L=!0);const V=this.current.getClippedPathBoundingBox();this.contentVisible&&V!==null&&(this.pendingEOFill?(R.fill("evenodd"),this.pendingEOFill=!1):R.fill()),L&&R.restore(),T&&this.consumePath(V)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Ve}eoClip(){this.pendingClip=Gt}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const T=this.pendingTextPaths,R=this.ctx;if(T===void 0){R.beginPath();return}R.save(),R.beginPath();for(const D of T)R.setTransform(...D.transform),R.translate(D.x,D.y),D.addToPath(R,D.fontSize);R.restore(),R.clip(),R.beginPath(),delete this.pendingTextPaths}setCharSpacing(T){this.current.charSpacing=T}setWordSpacing(T){this.current.wordSpacing=T}setHScale(T){this.current.textHScale=T/100}setLeading(T){this.current.leading=-T}setFont(T,R){var U;const D=this.commonObjs.get(T),H=this.current;if(!D)throw new Error(`Can't find font for ${T}`);if(H.fontMatrix=D.fontMatrix||n.FONT_IDENTITY_MATRIX,(H.fontMatrix[0]===0||H.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+T),R<0?(R=-R,H.fontDirection=-1):H.fontDirection=1,this.current.font=D,this.current.fontSize=R,D.isType3Font)return;const L=D.loadedName||"sans-serif",V=((U=D.systemFontInfo)==null?void 0:U.css)||`"${L}", ${D.fallbackName}`;let j="normal";D.black?j="900":D.bold&&(j="bold");const G=D.italic?"italic":"normal";let W=R;R<F?W=F:R>M&&(W=M),this.current.fontSizeScale=R/W,this.ctx.font=`${G} ${j} ${W}px ${V}`}setTextRenderingMode(T){this.current.textRenderingMode=T}setTextRise(T){this.current.textRise=T}moveText(T,R){this.current.x=this.current.lineX+=T,this.current.y=this.current.lineY+=R}setLeadingMoveText(T,R){this.setLeading(-R),this.moveText(T,R)}setTextMatrix(T,R,D,H,L,V){this.current.textMatrix=[T,R,D,H,L,V],this.current.textMatrixScale=Math.hypot(T,R),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(T,R,D,H){const L=this.ctx,V=this.current,j=V.font,G=V.textRenderingMode,W=V.fontSize/V.fontSizeScale,U=G&n.TextRenderingMode.FILL_STROKE_MASK,O=!!(G&n.TextRenderingMode.ADD_TO_PATH_FLAG),z=V.patternFill&&!j.missingFile;let et;(j.disableFontFace||O||z)&&(et=j.getPathGenerator(this.commonObjs,T)),j.disableFontFace||z?(L.save(),L.translate(R,D),L.beginPath(),et(L,W),H&&L.setTransform(...H),(U===n.TextRenderingMode.FILL||U===n.TextRenderingMode.FILL_STROKE)&&L.fill(),(U===n.TextRenderingMode.STROKE||U===n.TextRenderingMode.FILL_STROKE)&&L.stroke(),L.restore()):((U===n.TextRenderingMode.FILL||U===n.TextRenderingMode.FILL_STROKE)&&L.fillText(T,R,D),(U===n.TextRenderingMode.STROKE||U===n.TextRenderingMode.FILL_STROKE)&&L.strokeText(T,R,D)),O&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,a.getCurrentTransform)(L),x:R,y:D,fontSize:W,addToPath:et})}get isFontSubpixelAAEnabled(){const{context:T}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);T.scale(1.5,1),T.fillText("I",0,10);const R=T.getImageData(0,0,10,10).data;let D=!1;for(let H=3;H<R.length;H+=4)if(R[H]>0&&R[H]<255){D=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",D)}showText(T){const R=this.current,D=R.font;if(D.isType3Font)return this.showType3Text(T);const H=R.fontSize;if(H===0)return;const L=this.ctx,V=R.fontSizeScale,j=R.charSpacing,G=R.wordSpacing,W=R.fontDirection,U=R.textHScale*W,O=T.length,z=D.vertical,et=z?1:-1,nt=D.defaultVMetrics,gt=H*R.fontMatrix[0],yt=R.textRenderingMode===n.TextRenderingMode.FILL&&!D.disableFontFace&&!R.patternFill;L.save(),L.transform(...R.textMatrix),L.translate(R.x,R.y+R.textRise),W>0?L.scale(U,-1):L.scale(U,1);let Nt;if(R.patternFill){L.save();const at=R.fillColor.getPattern(L,this,(0,a.getCurrentTransformInverse)(L),o.FILL);Nt=(0,a.getCurrentTransform)(L),L.restore(),L.fillStyle=at}let Ht=R.lineWidth;const Pt=R.textMatrixScale;if(Pt===0||Ht===0){const at=R.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(at===n.TextRenderingMode.STROKE||at===n.TextRenderingMode.FILL_STROKE)&&(Ht=this.getSinglePixelWidth())}else Ht/=Pt;if(V!==1&&(L.scale(V,V),Ht/=V),L.lineWidth=Ht,D.isInvalidPDFjsFont){const at=[];let _t=0;for(const vt of T)at.push(vt.unicode),_t+=vt.width;L.fillText(at.join(""),0,0),R.x+=_t*gt*U,L.restore(),this.compose();return}let Bt=0,Z;for(Z=0;Z<O;++Z){const at=T[Z];if(typeof at=="number"){Bt+=et*at*H/1e3;continue}let _t=!1;const vt=(at.isSpace?G:0)+j,jt=at.fontChar,bt=at.accent;let q,ot,ft=at.width;if(z){const Kt=at.vmetric||nt,te=-(at.vmetric?Kt[1]:ft*.5)*gt,me=Kt[2]*gt;ft=Kt?-Kt[0]:ft,q=te/V,ot=(Bt+me)/V}else q=Bt/V,ot=0;if(D.remeasure&&ft>0){const Kt=L.measureText(jt).width*1e3/H*V;if(ft<Kt&&this.isFontSubpixelAAEnabled){const te=ft/Kt;_t=!0,L.save(),L.scale(te,1),q/=te}else ft!==Kt&&(q+=(ft-Kt)/2e3*H/V)}if(this.contentVisible&&(at.isInFont||D.missingFile)){if(yt&&!bt)L.fillText(jt,q,ot);else if(this.paintChar(jt,q,ot,Nt),bt){const Kt=q+H*bt.offset.x/V,te=ot-H*bt.offset.y/V;this.paintChar(bt.fontChar,Kt,te,Nt)}}const Et=z?ft*gt-vt*W:ft*gt+vt*W;Bt+=Et,_t&&L.restore()}z?R.y-=Bt:R.x+=Bt*U,L.restore(),this.compose()}showType3Text(T){const R=this.ctx,D=this.current,H=D.font,L=D.fontSize,V=D.fontDirection,j=H.vertical?1:-1,G=D.charSpacing,W=D.wordSpacing,U=D.textHScale*V,O=D.fontMatrix||n.FONT_IDENTITY_MATRIX,z=T.length,et=D.textRenderingMode===n.TextRenderingMode.INVISIBLE;let nt,gt,yt,Nt;if(!(et||L===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,R.save(),R.transform(...D.textMatrix),R.translate(D.x,D.y),R.scale(U,V),nt=0;nt<z;++nt){if(gt=T[nt],typeof gt=="number"){Nt=j*gt*L/1e3,this.ctx.translate(Nt,0),D.x+=Nt*U;continue}const Ht=(gt.isSpace?W:0)+G,Pt=H.charProcOperatorList[gt.operatorListId];if(!Pt){(0,n.warn)(`Type3 character "${gt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=gt,this.save(),R.scale(L,L),R.transform(...O),this.executeOperatorList(Pt),this.restore()),yt=n.Util.applyTransform([gt.width,0],O)[0]*L+Ht,R.translate(yt,0),D.x+=yt*U}R.restore(),this.processingType3=null}}setCharWidth(T,R){}setCharWidthAndBounds(T,R,D,H,L,V){this.ctx.rect(D,H,L-D,V-H),this.ctx.clip(),this.endPath()}getColorN_Pattern(T){let R;if(T[0]==="TilingPattern"){const D=T[1],H=this.baseTransform||(0,a.getCurrentTransform)(this.ctx),L={createCanvasGraphics:V=>new _e(V,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};R=new x(T,D,this.ctx,L,H)}else R=this._getPattern(T[1],T[2]);return R}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(T,R,D){const H=n.Util.makeHexColor(T,R,D);this.ctx.strokeStyle=H,this.current.strokeColor=H}setFillRGBColor(T,R,D){const H=n.Util.makeHexColor(T,R,D);this.ctx.fillStyle=H,this.current.fillColor=H,this.current.patternFill=!1}_getPattern(T,R=null){let D;return this.cachedPatterns.has(T)?D=this.cachedPatterns.get(T):(D=v(this.getObject(T)),this.cachedPatterns.set(T,D)),R&&(D.matrix=R),D}shadingFill(T){if(!this.contentVisible)return;const R=this.ctx;this.save();const D=this._getPattern(T);R.fillStyle=D.getPattern(R,this,(0,a.getCurrentTransformInverse)(R),o.SHADING);const H=(0,a.getCurrentTransformInverse)(R);if(H){const{width:L,height:V}=R.canvas,[j,G,W,U]=n.Util.getAxialAlignedBoundingBox([0,0,L,V],H);this.ctx.fillRect(j,G,W-j,U-G)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(T,R){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(T)&&T.length===6&&this.transform(...T),this.baseTransform=(0,a.getCurrentTransform)(this.ctx),R)){const D=R[2]-R[0],H=R[3]-R[1];this.ctx.rect(R[0],R[1],D,H),this.current.updateRectMinMax((0,a.getCurrentTransform)(this.ctx),R),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(T){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const R=this.ctx;T.isolated||(0,n.info)("TODO: Support non-isolated groups."),T.knockout&&(0,n.warn)("Knockout groups not supported.");const D=(0,a.getCurrentTransform)(R);if(T.matrix&&R.transform(...T.matrix),!T.bbox)throw new Error("Bounding box is required.");let H=n.Util.getAxialAlignedBoundingBox(T.bbox,(0,a.getCurrentTransform)(R));const L=[0,0,R.canvas.width,R.canvas.height];H=n.Util.intersect(H,L)||[0,0,0,0];const V=Math.floor(H[0]),j=Math.floor(H[1]);let G=Math.max(Math.ceil(H[2])-V,1),W=Math.max(Math.ceil(H[3])-j,1),U=1,O=1;G>g&&(U=G/g,G=g),W>g&&(O=W/g,W=g),this.current.startNewPathAndClipBox([0,0,G,W]);let z="groupAt"+this.groupLevel;T.smask&&(z+="_smask_"+this.smaskCounter++%2);const et=this.cachedCanvases.getCanvas(z,G,W),nt=et.context;nt.scale(1/U,1/O),nt.translate(-V,-j),nt.transform(...D),T.smask?this.smaskStack.push({canvas:et.canvas,context:nt,offsetX:V,offsetY:j,scaleX:U,scaleY:O,subtype:T.smask.subtype,backdrop:T.smask.backdrop,transferMap:T.smask.transferMap||null,startTransformInverse:null}):(R.setTransform(1,0,0,1,0,0),R.translate(V,j),R.scale(U,O),R.save()),Lt(R,nt),this.ctx=nt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(R),this.groupLevel++}endGroup(T){if(!this.contentVisible)return;this.groupLevel--;const R=this.ctx,D=this.groupStack.pop();if(this.ctx=D,this.ctx.imageSmoothingEnabled=!1,T.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const H=(0,a.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...H);const L=n.Util.getAxialAlignedBoundingBox([0,0,R.canvas.width,R.canvas.height],H);this.ctx.drawImage(R.canvas,0,0),this.ctx.restore(),this.compose(L)}}beginAnnotation(T,R,D,H,L){if(Y(this,Wt,yu).call(this),Qt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(R)&&R.length===4){const V=R[2]-R[0],j=R[3]-R[1];if(L&&this.annotationCanvasMap){D=D.slice(),D[4]-=R[0],D[5]-=R[1],R=R.slice(),R[0]=R[1]=0,R[2]=V,R[3]=j;const[G,W]=n.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(this.ctx)),{viewportScale:U}=this,O=Math.ceil(V*this.outputScaleX*U),z=Math.ceil(j*this.outputScaleY*U);this.annotationCanvas=this.canvasFactory.create(O,z);const{canvas:et,context:nt}=this.annotationCanvas;this.annotationCanvasMap.set(T,et),this.annotationCanvas.savedCtx=this.ctx,this.ctx=nt,this.ctx.save(),this.ctx.setTransform(G,0,0,-W,0,j*W),Qt(this.ctx)}else Qt(this.ctx),this.ctx.rect(R[0],R[1],V,j),this.ctx.clip(),this.endPath()}this.current=new wt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...D),this.transform(...H)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,ie,bu).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(T){if(!this.contentVisible)return;const R=T.count;T=this.getObject(T.data,T),T.count=R;const D=this.ctx,H=this.processingType3;if(H&&(H.compiled===void 0&&(H.compiled=st(T)),H.compiled)){H.compiled(D);return}const L=this._createMaskCanvas(T),V=L.canvas;D.save(),D.setTransform(1,0,0,1,0,0),D.drawImage(V,L.offsetX,L.offsetY),D.restore(),this.compose()}paintImageMaskXObjectRepeat(T,R,D=0,H=0,L,V){if(!this.contentVisible)return;T=this.getObject(T.data,T);const j=this.ctx;j.save();const G=(0,a.getCurrentTransform)(j);j.transform(R,D,H,L,0,0);const W=this._createMaskCanvas(T);j.setTransform(1,0,0,1,W.offsetX-G[4],W.offsetY-G[5]);for(let U=0,O=V.length;U<O;U+=2){const z=n.Util.transform(G,[R,D,H,L,V[U],V[U+1]]),[et,nt]=n.Util.applyTransform([0,0],z);j.drawImage(W.canvas,et,nt)}j.restore(),this.compose()}paintImageMaskXObjectGroup(T){if(!this.contentVisible)return;const R=this.ctx,D=this.current.fillColor,H=this.current.patternFill;for(const L of T){const{data:V,width:j,height:G,transform:W}=L,U=this.cachedCanvases.getCanvas("maskCanvas",j,G),O=U.context;O.save();const z=this.getObject(V,L);Tt(O,z),O.globalCompositeOperation="source-in",O.fillStyle=H?D.getPattern(O,this,(0,a.getCurrentTransformInverse)(R),o.FILL):D,O.fillRect(0,0,j,G),O.restore(),R.save(),R.transform(...W),R.scale(1,-1),tt(R,U.canvas,0,0,j,G,0,-1,1,1),R.restore()}this.compose()}paintImageXObject(T){if(!this.contentVisible)return;const R=this.getObject(T);if(!R){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(R)}paintImageXObjectRepeat(T,R,D,H){if(!this.contentVisible)return;const L=this.getObject(T);if(!L){(0,n.warn)("Dependent image isn't ready yet");return}const V=L.width,j=L.height,G=[];for(let W=0,U=H.length;W<U;W+=2)G.push({transform:[R,0,0,D,H[W],H[W+1]],x:0,y:0,w:V,h:j});this.paintInlineImageXObjectGroup(L,G)}applyTransferMapsToCanvas(T){return this.current.transferMaps!=="none"&&(T.filter=this.current.transferMaps,T.drawImage(T.canvas,0,0),T.filter="none"),T.canvas}applyTransferMapsToBitmap(T){if(this.current.transferMaps==="none")return T.bitmap;const{bitmap:R,width:D,height:H}=T,L=this.cachedCanvases.getCanvas("inlineImage",D,H),V=L.context;return V.filter=this.current.transferMaps,V.drawImage(R,0,0),V.filter="none",L.canvas}paintInlineImageXObject(T){if(!this.contentVisible)return;const R=T.width,D=T.height,H=this.ctx;if(this.save(),!n.isNodeJS){const{filter:j}=H;j!=="none"&&j!==""&&(H.filter="none")}H.scale(1/R,-1/D);let L;if(T.bitmap)L=this.applyTransferMapsToBitmap(T);else if(typeof HTMLElement=="function"&&T instanceof HTMLElement||!T.data)L=T;else{const j=this.cachedCanvases.getCanvas("inlineImage",R,D).context;dt(j,T),L=this.applyTransferMapsToCanvas(j)}const V=this._scaleImage(L,(0,a.getCurrentTransformInverse)(H));H.imageSmoothingEnabled=oe((0,a.getCurrentTransform)(H),T.interpolate),tt(H,V.img,0,0,V.paintWidth,V.paintHeight,0,-D,R,D),this.compose(),this.restore()}paintInlineImageXObjectGroup(T,R){if(!this.contentVisible)return;const D=this.ctx;let H;if(T.bitmap)H=T.bitmap;else{const L=T.width,V=T.height,j=this.cachedCanvases.getCanvas("inlineImage",L,V).context;dt(j,T),H=this.applyTransferMapsToCanvas(j)}for(const L of R)D.save(),D.transform(...L.transform),D.scale(1,-1),tt(D,H,L.x,L.y,L.w,L.h,0,-1,1,1),D.restore();this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(T){}markPointProps(T,R){}beginMarkedContent(T){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(T,R){T==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(R)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(T){const R=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(T);const D=this.ctx;this.pendingClip&&(R||(this.pendingClip===Gt?D.clip("evenodd"):D.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),D.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const T=(0,a.getCurrentTransform)(this.ctx);if(T[1]===0&&T[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(T[0]),Math.abs(T[3]));else{const R=Math.abs(T[0]*T[3]-T[2]*T[1]),D=Math.hypot(T[0],T[2]),H=Math.hypot(T[1],T[3]);this._cachedGetSinglePixelWidth=Math.max(D,H)/R}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:T}=this.current,{a:R,b:D,c:H,d:L}=this.ctx.getTransform();let V,j;if(D===0&&H===0){const G=Math.abs(R),W=Math.abs(L);if(G===W)if(T===0)V=j=1/G;else{const U=G*T;V=j=U<1?1/U:1}else if(T===0)V=1/G,j=1/W;else{const U=G*T,O=W*T;V=U<1?1/U:1,j=O<1?1/O:1}}else{const G=Math.abs(R*L-D*H),W=Math.hypot(R,D),U=Math.hypot(H,L);if(T===0)V=U/G,j=W/G;else{const O=T*G;V=U>O?U/O:1,j=W>O?W/O:1}}this._cachedScaleForStroking[0]=V,this._cachedScaleForStroking[1]=j}return this._cachedScaleForStroking}rescaleAndStroke(T){const{ctx:R}=this,{lineWidth:D}=this.current,[H,L]=this.getScaleForStroking();if(R.lineWidth=D||1,H===1&&L===1){R.stroke();return}const V=R.getLineDash();if(T&&R.save(),R.scale(H,L),V.length>0){const j=Math.max(H,L);R.setLineDash(V.map(G=>G/j)),R.lineDashOffset/=j}R.stroke(),T&&R.restore()}isContentVisible(){for(let T=this.markedContentStack.length-1;T>=0;T--)if(!this.markedContentStack[T].visible)return!1;return!0}};let lt=_e;Wt=new WeakSet,yu=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ie=new WeakSet,bu=function(){if(this.pageColors){const T=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(T!=="none"){const R=this.ctx.filter;this.ctx.filter=T,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=R}}};for(const ut in n.OPS)lt.prototype[ut]!==void 0&&(lt.prototype[n.OPS[ut]]=lt.prototype[ut])},419:(r,t,s)=>{var Lt,Qt,ct,Dt,ee,zt,Jt,Za,ge,Ja,Ve,to,lt,_u,Wt,Yh,ie,qh,_e,Ho,T,Bo;s.d(t,{DOMCMapReaderFactory:()=>m,DOMCanvasFactory:()=>d,DOMFilterFactory:()=>u,DOMSVGFactory:()=>_,DOMStandardFontDataFactory:()=>S,PDFDateString:()=>B,PageViewport:()=>v,PixelsPerInch:()=>c,RenderingCancelledException:()=>b,StatTimer:()=>g,fetchData:()=>f,getColorValues:()=>tt,getCurrentTransform:()=>st,getCurrentTransformInverse:()=>wt,getFilenameFromUrl:()=>F,getPdfFilenameFromUrl:()=>M,getRGB:()=>rt,getXfaPageViewport:()=>I,isDataScheme:()=>x,isPdfFile:()=>A,isValidFetchUrl:()=>w,noContextMenu:()=>E,setLayerDimensions:()=>dt});var n=s(583),a=s(292);const o="http://www.w3.org/2000/svg",Tt=class{};let c=Tt;ti(c,"CSS",96),ti(c,"PDF",72),ti(c,"PDF_TO_CSS_UNITS",Tt.CSS/Tt.PDF);class u extends n.BaseFilterFactory{constructor({docId:L,ownerDocument:V=globalThis.document}={}){super();N(this,Jt);N(this,ge);N(this,Ve);N(this,lt);N(this,Wt);N(this,ie);N(this,_e);N(this,T);N(this,Lt,void 0);N(this,Qt,void 0);N(this,ct,void 0);N(this,Dt,void 0);N(this,ee,void 0);N(this,zt,0);J(this,ct,L),J(this,Dt,V)}addFilter(L){if(!L)return"none";let V=l(this,Jt,Za).get(L);if(V)return V;let j,G,W,U;if(L.length===1){const nt=L[0],gt=new Array(256);for(let yt=0;yt<256;yt++)gt[yt]=nt[yt]/255;U=j=G=W=gt.join(",")}else{const[nt,gt,yt]=L,Nt=new Array(256),Ht=new Array(256),Pt=new Array(256);for(let Bt=0;Bt<256;Bt++)Nt[Bt]=nt[Bt]/255,Ht[Bt]=gt[Bt]/255,Pt[Bt]=yt[Bt]/255;j=Nt.join(","),G=Ht.join(","),W=Pt.join(","),U=`${j}${G}${W}`}if(V=l(this,Jt,Za).get(U),V)return l(this,Jt,Za).set(L,V),V;const O=`g_${l(this,ct)}_transfer_map_${ws(this,zt)._++}`,z=`url(#${O})`;l(this,Jt,Za).set(L,z),l(this,Jt,Za).set(U,z);const et=Y(this,Wt,Yh).call(this,O);return Y(this,_e,Ho).call(this,j,G,W,et),z}addHCMFilter(L,V){var Nt;const j=`${L}-${V}`,G="base";let W=l(this,ge,Ja).get(G);if((W==null?void 0:W.key)===j||(W?((Nt=W.filter)==null||Nt.remove(),W.key=j,W.url="none",W.filter=null):(W={key:j,url:"none",filter:null},l(this,ge,Ja).set(G,W)),!L||!V))return W.url;const U=Y(this,T,Bo).call(this,L);L=a.Util.makeHexColor(...U);const O=Y(this,T,Bo).call(this,V);if(V=a.Util.makeHexColor(...O),l(this,Ve,to).style.color="",L==="#000000"&&V==="#ffffff"||L===V)return W.url;const z=new Array(256);for(let Ht=0;Ht<=255;Ht++){const Pt=Ht/255;z[Ht]=Pt<=.03928?Pt/12.92:((Pt+.055)/1.055)**2.4}const et=z.join(","),nt=`g_${l(this,ct)}_hcm_filter`,gt=W.filter=Y(this,Wt,Yh).call(this,nt);Y(this,_e,Ho).call(this,et,et,et,gt),Y(this,lt,_u).call(this,gt);const yt=(Ht,Pt)=>{const Bt=U[Ht]/255,Z=O[Ht]/255,at=new Array(Pt+1);for(let _t=0;_t<=Pt;_t++)at[_t]=Bt+_t/Pt*(Z-Bt);return at.join(",")};return Y(this,_e,Ho).call(this,yt(0,5),yt(1,5),yt(2,5),gt),W.url=`url(#${nt})`,W.url}addHighlightHCMFilter(L,V,j,G,W){var Z;const U=`${V}-${j}-${G}-${W}`;let O=l(this,ge,Ja).get(L);if((O==null?void 0:O.key)===U||(O?((Z=O.filter)==null||Z.remove(),O.key=U,O.url="none",O.filter=null):(O={key:U,url:"none",filter:null},l(this,ge,Ja).set(L,O)),!V||!j))return O.url;const[z,et]=[V,j].map(Y(this,T,Bo).bind(this));let nt=Math.round(.2126*z[0]+.7152*z[1]+.0722*z[2]),gt=Math.round(.2126*et[0]+.7152*et[1]+.0722*et[2]),[yt,Nt]=[G,W].map(Y(this,T,Bo).bind(this));gt<nt&&([nt,gt,yt,Nt]=[gt,nt,Nt,yt]),l(this,Ve,to).style.color="";const Ht=(at,_t,vt)=>{const jt=new Array(256),bt=(gt-nt)/vt,q=at/255,ot=(_t-at)/(255*vt);let ft=0;for(let Et=0;Et<=vt;Et++){const Kt=Math.round(nt+Et*bt),te=q+Et*ot;for(let me=ft;me<=Kt;me++)jt[me]=te;ft=Kt+1}for(let Et=ft;Et<256;Et++)jt[Et]=jt[ft-1];return jt.join(",")},Pt=`g_${l(this,ct)}_hcm_${L}_filter`,Bt=O.filter=Y(this,Wt,Yh).call(this,Pt);return Y(this,lt,_u).call(this,Bt),Y(this,_e,Ho).call(this,Ht(yt[0],Nt[0],5),Ht(yt[1],Nt[1],5),Ht(yt[2],Nt[2],5),Bt),O.url=`url(#${Pt})`,O.url}destroy(L=!1){L&&l(this,ge,Ja).size!==0||(l(this,Qt)&&(l(this,Qt).parentNode.parentNode.remove(),J(this,Qt,null)),l(this,Lt)&&(l(this,Lt).clear(),J(this,Lt,null)),J(this,zt,0))}}Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakSet,Za=function(){return l(this,Lt)||J(this,Lt,new Map)},ge=new WeakSet,Ja=function(){return l(this,ee)||J(this,ee,new Map)},Ve=new WeakSet,to=function(){if(!l(this,Qt)){const L=l(this,Dt).createElement("div"),{style:V}=L;V.visibility="hidden",V.contain="strict",V.width=V.height=0,V.position="absolute",V.top=V.left=0,V.zIndex=-1;const j=l(this,Dt).createElementNS(o,"svg");j.setAttribute("width",0),j.setAttribute("height",0),J(this,Qt,l(this,Dt).createElementNS(o,"defs")),L.append(j),j.append(l(this,Qt)),l(this,Dt).body.append(L)}return l(this,Qt)},lt=new WeakSet,_u=function(L){const V=l(this,Dt).createElementNS(o,"feColorMatrix");V.setAttribute("type","matrix"),V.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),L.append(V)},Wt=new WeakSet,Yh=function(L){const V=l(this,Dt).createElementNS(o,"filter");return V.setAttribute("color-interpolation-filters","sRGB"),V.setAttribute("id",L),l(this,Ve,to).append(V),V},ie=new WeakSet,qh=function(L,V,j){const G=l(this,Dt).createElementNS(o,V);G.setAttribute("type","discrete"),G.setAttribute("tableValues",j),L.append(G)},_e=new WeakSet,Ho=function(L,V,j,G){const W=l(this,Dt).createElementNS(o,"feComponentTransfer");G.append(W),Y(this,ie,qh).call(this,W,"feFuncR",L),Y(this,ie,qh).call(this,W,"feFuncG",V),Y(this,ie,qh).call(this,W,"feFuncB",j)},T=new WeakSet,Bo=function(L){return l(this,Ve,to).style.color=L,rt(getComputedStyle(l(this,Ve,to)).getPropertyValue("color"))};class d extends n.BaseCanvasFactory{constructor({ownerDocument:H=globalThis.document}={}){super(),this._document=H}_createCanvas(H,L){const V=this._document.createElement("canvas");return V.width=H,V.height=L,V}}async function f(D,H="text"){if(w(D,document.baseURI)){const L=await fetch(D);if(!L.ok)throw new Error(L.statusText);switch(H){case"arraybuffer":return L.arrayBuffer();case"blob":return L.blob();case"json":return L.json()}return L.text()}return new Promise((L,V)=>{const j=new XMLHttpRequest;j.open("GET",D,!0),j.responseType=H,j.onreadystatechange=()=>{if(j.readyState===XMLHttpRequest.DONE){if(j.status===200||j.status===0){switch(H){case"arraybuffer":case"blob":case"json":L(j.response);return}L(j.responseText);return}V(new Error(j.statusText))}},j.send(null)})}class m extends n.BaseCMapReaderFactory{_fetchData(H,L){return f(H,this.isCompressed?"arraybuffer":"text").then(V=>({cMapData:V instanceof ArrayBuffer?new Uint8Array(V):(0,a.stringToBytes)(V),compressionType:L}))}}class S extends n.BaseStandardFontDataFactory{_fetchData(H){return f(H,"arraybuffer").then(L=>new Uint8Array(L))}}class _ extends n.BaseSVGFactory{_createSVG(H){return document.createElementNS(o,H)}}class v{constructor({viewBox:H,scale:L,rotation:V,offsetX:j=0,offsetY:G=0,dontFlip:W=!1}){this.viewBox=H,this.scale=L,this.rotation=V,this.offsetX=j,this.offsetY=G;const U=(H[2]+H[0])/2,O=(H[3]+H[1])/2;let z,et,nt,gt;switch(V%=360,V<0&&(V+=360),V){case 180:z=-1,et=0,nt=0,gt=1;break;case 90:z=0,et=1,nt=1,gt=0;break;case 270:z=0,et=-1,nt=-1,gt=0;break;case 0:z=1,et=0,nt=0,gt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}W&&(nt=-nt,gt=-gt);let yt,Nt,Ht,Pt;z===0?(yt=Math.abs(O-H[1])*L+j,Nt=Math.abs(U-H[0])*L+G,Ht=(H[3]-H[1])*L,Pt=(H[2]-H[0])*L):(yt=Math.abs(U-H[0])*L+j,Nt=Math.abs(O-H[1])*L+G,Ht=(H[2]-H[0])*L,Pt=(H[3]-H[1])*L),this.transform=[z*L,et*L,nt*L,gt*L,yt-z*L*U-nt*L*O,Nt-et*L*U-gt*L*O],this.width=Ht,this.height=Pt}get rawDims(){const{viewBox:H}=this;return(0,a.shadow)(this,"rawDims",{pageWidth:H[2]-H[0],pageHeight:H[3]-H[1],pageX:H[0],pageY:H[1]})}clone({scale:H=this.scale,rotation:L=this.rotation,offsetX:V=this.offsetX,offsetY:j=this.offsetY,dontFlip:G=!1}={}){return new v({viewBox:this.viewBox.slice(),scale:H,rotation:L,offsetX:V,offsetY:j,dontFlip:G})}convertToViewportPoint(H,L){return a.Util.applyTransform([H,L],this.transform)}convertToViewportRectangle(H){const L=a.Util.applyTransform([H[0],H[1]],this.transform),V=a.Util.applyTransform([H[2],H[3]],this.transform);return[L[0],L[1],V[0],V[1]]}convertToPdfPoint(H,L){return a.Util.applyInverseTransform([H,L],this.transform)}}class b extends a.BaseException{constructor(H,L=0){super(H,"RenderingCancelledException"),this.extraDelay=L}}function x(D){const H=D.length;let L=0;for(;L<H&&D[L].trim()==="";)L++;return D.substring(L,L+5).toLowerCase()==="data:"}function A(D){return typeof D=="string"&&/\.pdf$/i.test(D)}function F(D,H=!1){return H||([D]=D.split(/[#?]/,1)),D.substring(D.lastIndexOf("/")+1)}function M(D,H="document.pdf"){if(typeof D!="string")return H;if(x(D))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),H;const L=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,V=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,j=L.exec(D);let G=V.exec(j[1])||V.exec(j[2])||V.exec(j[3]);if(G&&(G=G[0],G.includes("%")))try{G=V.exec(decodeURIComponent(G))[0]}catch{}return G||H}class g{constructor(){ti(this,"started",Object.create(null));ti(this,"times",[])}time(H){H in this.started&&(0,a.warn)(`Timer is already running for ${H}`),this.started[H]=Date.now()}timeEnd(H){H in this.started||(0,a.warn)(`Timer has not been started for ${H}`),this.times.push({name:H,start:this.started[H],end:Date.now()}),delete this.started[H]}toString(){const H=[];let L=0;for(const{name:V}of this.times)L=Math.max(V.length,L);for(const{name:V,start:j,end:G}of this.times)H.push(`${V.padEnd(L)} ${G-j}ms
`);return H.join("")}}function w(D,H){try{const{protocol:L}=H?new URL(D,H):new URL(D);return L==="http:"||L==="https:"}catch{return!1}}function E(D){D.preventDefault()}let C;class B{static toDateObject(H){if(!H||typeof H!="string")return null;C||(C=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const L=C.exec(H);if(!L)return null;const V=parseInt(L[1],10);let j=parseInt(L[2],10);j=j>=1&&j<=12?j-1:0;let G=parseInt(L[3],10);G=G>=1&&G<=31?G:1;let W=parseInt(L[4],10);W=W>=0&&W<=23?W:0;let U=parseInt(L[5],10);U=U>=0&&U<=59?U:0;let O=parseInt(L[6],10);O=O>=0&&O<=59?O:0;const z=L[7]||"Z";let et=parseInt(L[8],10);et=et>=0&&et<=23?et:0;let nt=parseInt(L[9],10)||0;return nt=nt>=0&&nt<=59?nt:0,z==="-"?(W+=et,U+=nt):z==="+"&&(W-=et,U-=nt),new Date(Date.UTC(V,j,G,W,U,O))}}function I(D,{scale:H=1,rotation:L=0}){const{width:V,height:j}=D.attributes.style,G=[0,0,parseInt(V),parseInt(j)];return new v({viewBox:G,scale:H,rotation:L})}function rt(D){if(D.startsWith("#")){const H=parseInt(D.slice(1),16);return[(H&16711680)>>16,(H&65280)>>8,H&255]}return D.startsWith("rgb(")?D.slice(4,-1).split(",").map(H=>parseInt(H)):D.startsWith("rgba(")?D.slice(5,-1).split(",").map(H=>parseInt(H)).slice(0,3):((0,a.warn)(`Not a valid color format: "${D}"`),[0,0,0])}function tt(D){const H=document.createElement("span");H.style.visibility="hidden",document.body.append(H);for(const L of D.keys()){H.style.color=L;const V=window.getComputedStyle(H).color;D.set(L,rt(V))}H.remove()}function st(D){const{a:H,b:L,c:V,d:j,e:G,f:W}=D.getTransform();return[H,L,V,j,G,W]}function wt(D){const{a:H,b:L,c:V,d:j,e:G,f:W}=D.getTransform().invertSelf();return[H,L,V,j,G,W]}function dt(D,H,L=!1,V=!0){if(H instanceof v){const{pageWidth:j,pageHeight:G}=H.rawDims,{style:W}=D,U=a.FeatureTest.isCSSRoundSupported,O=`var(--scale-factor) * ${j}px`,z=`var(--scale-factor) * ${G}px`,et=U?`round(${O}, 1px)`:`calc(${O})`,nt=U?`round(${z}, 1px)`:`calc(${z})`;!L||H.rotation%180===0?(W.width=et,W.height=nt):(W.width=nt,W.height=et)}V&&D.setAttribute("data-main-rotation",H.rotation)}},47:(r,t,s)=>{var c,u,d,f,m,xu,_,wu,b,p0;s.d(t,{DrawLayer:()=>o});var n=s(419),a=s(292);const A=class{constructor({pageIndex:M}){N(this,_);N(this,b);N(this,c,null);N(this,u,0);N(this,d,new Map);N(this,f,new Map);this.pageIndex=M}setParent(M){if(!l(this,c)){J(this,c,M);return}if(l(this,c)!==M){if(l(this,d).size>0)for(const g of l(this,d).values())g.remove(),M.append(g);J(this,c,M)}}static get _svgFactory(){return(0,a.shadow)(this,"_svgFactory",new n.DOMSVGFactory)}highlight(M,g,w,E=!1){const C=ws(this,u)._++,B=Y(this,_,wu).call(this,M.box);B.classList.add("highlight"),M.free&&B.classList.add("free");const I=A._svgFactory.createElement("defs");B.append(I);const rt=A._svgFactory.createElement("path");I.append(rt);const tt=`path_p${this.pageIndex}_${C}`;rt.setAttribute("id",tt),rt.setAttribute("d",M.toSVGPath()),E&&l(this,f).set(C,rt);const st=Y(this,b,p0).call(this,I,tt),wt=A._svgFactory.createElement("use");return B.append(wt),B.setAttribute("fill",g),B.setAttribute("fill-opacity",w),wt.setAttribute("href",`#${tt}`),l(this,d).set(C,B),{id:C,clipPathId:`url(#${st})`}}highlightOutline(M){const g=ws(this,u)._++,w=Y(this,_,wu).call(this,M.box);w.classList.add("highlightOutline");const E=A._svgFactory.createElement("defs");w.append(E);const C=A._svgFactory.createElement("path");E.append(C);const B=`path_p${this.pageIndex}_${g}`;C.setAttribute("id",B),C.setAttribute("d",M.toSVGPath()),C.setAttribute("vector-effect","non-scaling-stroke");let I;if(M.free){w.classList.add("free");const st=A._svgFactory.createElement("mask");E.append(st),I=`mask_p${this.pageIndex}_${g}`,st.setAttribute("id",I),st.setAttribute("maskUnits","objectBoundingBox");const wt=A._svgFactory.createElement("rect");st.append(wt),wt.setAttribute("width","1"),wt.setAttribute("height","1"),wt.setAttribute("fill","white");const dt=A._svgFactory.createElement("use");st.append(dt),dt.setAttribute("href",`#${B}`),dt.setAttribute("stroke","none"),dt.setAttribute("fill","black"),dt.setAttribute("fill-rule","nonzero"),dt.classList.add("mask")}const rt=A._svgFactory.createElement("use");w.append(rt),rt.setAttribute("href",`#${B}`),I&&rt.setAttribute("mask",`url(#${I})`);const tt=rt.cloneNode();return w.append(tt),rt.classList.add("mainOutline"),tt.classList.add("secondaryOutline"),l(this,d).set(g,w),g}finalizeLine(M,g){const w=l(this,f).get(M);l(this,f).delete(M),this.updateBox(M,g.box),w.setAttribute("d",g.toSVGPath())}updateLine(M,g){l(this,d).get(M).firstChild.firstChild.setAttribute("d",g.toSVGPath())}removeFreeHighlight(M){this.remove(M),l(this,f).delete(M)}updatePath(M,g){l(this,f).get(M).setAttribute("d",g.toSVGPath())}updateBox(M,g){var w;Y(w=A,m,xu).call(w,l(this,d).get(M),g)}show(M,g){l(this,d).get(M).classList.toggle("hidden",!g)}rotate(M,g){l(this,d).get(M).setAttribute("data-main-rotation",g)}changeColor(M,g){l(this,d).get(M).setAttribute("fill",g)}changeOpacity(M,g){l(this,d).get(M).setAttribute("fill-opacity",g)}addClass(M,g){l(this,d).get(M).classList.add(g)}removeClass(M,g){l(this,d).get(M).classList.remove(g)}remove(M){l(this,c)!==null&&(l(this,d).get(M).remove(),l(this,d).delete(M))}destroy(){J(this,c,null);for(const M of l(this,d).values())M.remove();l(this,d).clear()}};let o=A;c=new WeakMap,u=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakSet,xu=function(M,{x:g=0,y:w=0,width:E=1,height:C=1}={}){const{style:B}=M;B.top=`${100*w}%`,B.left=`${100*g}%`,B.width=`${100*E}%`,B.height=`${100*C}%`},_=new WeakSet,wu=function(M){var w;const g=A._svgFactory.create(1,1,!0);return l(this,c).append(g),g.setAttribute("aria-hidden",!0),Y(w=A,m,xu).call(w,g,M),g},b=new WeakSet,p0=function(M,g){const w=A._svgFactory.createElement("clipPath");M.append(w);const E=`clip_${g}`;w.setAttribute("id",E),w.setAttribute("clipPathUnits","objectBoundingBox");const C=A._svgFactory.createElement("use");return w.append(C),C.setAttribute("href",`#${g}`),C.classList.add("clip"),E},N(o,m)},731:(r,t,s)=>{var A,F,M,g,w,E,C,B,I,rt,tt,g0,wt,m0,Tt,v0,Qt,Qh,Dt,Zh,zt,Jh,oe,y0,Ae,Au,Gt,b0,Wt,ve,ie,xe,_e,ut,T,R,D,H,L,V,j,G,W,U,O,z,et,nt,Su,yt,Eu,Ht,_0,Bt,x0,at,w0,vt,Cu,bt,Uo,ot,eo,Et,A0,te,tc,Pe,Go,je,S0,ze,E0,oi,C0,bi,k0,K,ht,xt,St,It,Ot,ye,le,$t,ne,ue,he,Le,we,He,Ue,T0,ei,P0,Hi,M0,$,R0,Zt,ku,de,F0,Se,Tu,ci,I0,Bi,L0,Ar,D0,ds,N0,us,O0,jr,wa,ha,Pu,Wn,ec,$n,ic,Kn,io,di,Mu,Xn,rc,Ba,z0,$i,Ru,Ua,H0,Ga,B0,Dr,Fu,Os,nc,Tr,jo,hr,yr,br,Nr,Vr,Mn,Wr,cr,Zi,_r,$r,Pr,Vo,Yn,Wo,qn,sc,Sr,Iu,Qn,U0,da,G0,fs,Lu,ps,ac,ua,j0,gs,Fn,gn,ln,Qr,mn,vn,dr,In,Ln,Dn,ir,Oe,yn,pa,V0,ms,Du,Er,Nu,vs,Ou,Mr,oc;s.d(t,{AnnotationEditorLayer:()=>x});var n=s(292),a=s(310),o=s(830),c=s(976);const u=/\r\n?|\n/g,Ft=class extends a.AnnotationEditor{constructor(k){super({...k,name:"freeTextEditor"});N(this,tt);N(this,wt);N(this,Tt);N(this,Qt);N(this,zt);N(this,oe);N(this,Gt);N(this,A,this.editorDivBlur.bind(this));N(this,F,this.editorDivFocus.bind(this));N(this,M,this.editorDivInput.bind(this));N(this,g,this.editorDivKeydown.bind(this));N(this,w,this.editorDivPaste.bind(this));N(this,E,void 0);N(this,C,"");N(this,B,`${this.id}-editor`);N(this,I,void 0);N(this,rt,null);J(this,E,k.color||Ft._defaultColor||a.AnnotationEditor._defaultLineColor),J(this,I,k.fontSize||Ft._defaultFontSize)}static get _keyboardManager(){const k=Ft.prototype,X=Rt=>Rt.isEmpty(),pt=o.AnnotationEditorUIManager.TRANSLATE_SMALL,mt=o.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new o.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],k.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],k.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],k._translateEmpty,{args:[-pt,0],checker:X}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],k._translateEmpty,{args:[-mt,0],checker:X}],[["ArrowRight","mac+ArrowRight"],k._translateEmpty,{args:[pt,0],checker:X}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],k._translateEmpty,{args:[mt,0],checker:X}],[["ArrowUp","mac+ArrowUp"],k._translateEmpty,{args:[0,-pt],checker:X}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],k._translateEmpty,{args:[0,-mt],checker:X}],[["ArrowDown","mac+ArrowDown"],k._translateEmpty,{args:[0,pt],checker:X}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],k._translateEmpty,{args:[0,mt],checker:X}]]))}static initialize(k,X){a.AnnotationEditor.initialize(k,X,{strings:["pdfjs-free-text-default-content"]});const pt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(pt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(k,X){switch(k){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Ft._defaultFontSize=X;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Ft._defaultColor=X;break}}updateParams(k,X){switch(k){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,tt,g0).call(this,X);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,wt,m0).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,Ft._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,Ft._defaultColor||a.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,l(this,I)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,l(this,E)]]}_translateEmpty(k,X){this._uiManager.translateSelectedEditors(k,X,!0)}getInitialTranslation(){const k=this.parentScale;return[-Ft._internalPadding*k,-(Ft._internalPadding+l(this,I))*k]}rebuild(){!this.parent||(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",l(this,g)),this.editorDiv.addEventListener("focus",l(this,F)),this.editorDiv.addEventListener("blur",l(this,A)),this.editorDiv.addEventListener("input",l(this,M)),this.editorDiv.addEventListener("paste",l(this,w)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,B)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",l(this,g)),this.editorDiv.removeEventListener("focus",l(this,F)),this.editorDiv.removeEventListener("blur",l(this,A)),this.editorDiv.removeEventListener("input",l(this,M)),this.editorDiv.removeEventListener("paste",l(this,w)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(k){!this._focusEventsAllowed||(super.focusin(k),k.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var k;this.width||(this.enableEditMode(),this.editorDiv.focus(),(k=this._initialOptions)!=null&&k.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const k=l(this,C),X=J(this,C,Y(this,Tt,v0).call(this).trimEnd());if(k===X)return;const pt=mt=>{if(J(this,C,mt),!mt){this.remove();return}Y(this,zt,Jh).call(this),this._uiManager.rebuild(this),Y(this,Qt,Qh).call(this)};this.addCommands({cmd:()=>{pt(X)},undo:()=>{pt(k)},mustExec:!1}),Y(this,Qt,Qh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(k){this.enterInEditMode()}keydown(k){k.target===this.div&&k.key==="Enter"&&(this.enterInEditMode(),k.preventDefault())}editorDivKeydown(k){Ft._keyboardManager.exec(this,k)}editorDivFocus(k){this.isEditing=!0}editorDivBlur(k){this.isEditing=!1}editorDivInput(k){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let k,X;this.width&&(k=this.x,X=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,B)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),a.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(mt=>{var Rt;return(Rt=this.editorDiv)==null?void 0:Rt.setAttribute("default-content",mt)}),this.editorDiv.contentEditable=!0;const{style:pt}=this.editorDiv;if(pt.fontSize=`calc(${l(this,I)}px * var(--scale-factor))`,pt.color=l(this,E),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,o.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[mt,Rt]=this.parentDimensions;if(this.annotationElementId){const{position:qt}=l(this,rt);let[re,Xt]=this.getInitialTranslation();[re,Xt]=this.pageTranslationToScreen(re,Xt);const[be,fe]=this.pageDimensions,[Ye,We]=this.pageTranslation;let ui,pi;switch(this.rotation){case 0:ui=k+(qt[0]-Ye)/be,pi=X+this.height-(qt[1]-We)/fe;break;case 90:ui=k+(qt[0]-Ye)/be,pi=X-(qt[1]-We)/fe,[re,Xt]=[Xt,-re];break;case 180:ui=k-this.width+(qt[0]-Ye)/be,pi=X-(qt[1]-We)/fe,[re,Xt]=[-re,-Xt];break;case 270:ui=k+(qt[0]-Ye-this.height*fe)/be,pi=X+(qt[1]-We-this.width*be)/fe,[re,Xt]=[-Xt,re];break}this.setAt(ui*mt,pi*Rt,re,Xt)}else this.setAt(k*mt,X*Rt,this.width*mt,this.height*Rt);Y(this,zt,Jh).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(k){var ui,pi,Qe;const X=k.clipboardData||window.clipboardData,{types:pt}=X;if(pt.length===1&&pt[0]==="text/plain")return;k.preventDefault();const mt=Y(ui=Ft,Ae,Au).call(ui,X.getData("text")||"").replaceAll(u,`
`);if(!mt)return;const Rt=window.getSelection();if(!Rt.rangeCount)return;this.editorDiv.normalize(),Rt.deleteFromDocument();const qt=Rt.getRangeAt(0);if(!mt.includes(`
`)){qt.insertNode(document.createTextNode(mt)),this.editorDiv.normalize(),Rt.collapseToStart();return}const{startContainer:re,startOffset:Xt}=qt,be=[],fe=[];if(re.nodeType===Node.TEXT_NODE){const xi=re.parentElement;if(fe.push(re.nodeValue.slice(Xt).replaceAll(u,"")),xi!==this.editorDiv){let Xi=be;for(const Ui of this.editorDiv.childNodes){if(Ui===xi){Xi=fe;continue}Xi.push(Y(pi=Ft,Dt,Zh).call(pi,Ui))}}be.push(re.nodeValue.slice(0,Xt).replaceAll(u,""))}else if(re===this.editorDiv){let xi=be,Xi=0;for(const Ui of this.editorDiv.childNodes)Xi++===Xt&&(xi=fe),xi.push(Y(Qe=Ft,Dt,Zh).call(Qe,Ui))}J(this,C,`${be.join(`
`)}${mt}${fe.join(`
`)}`),Y(this,zt,Jh).call(this);const Ye=new Range;let We=be.reduce((xi,Xi)=>xi+Xi.length,0);for(const{firstChild:xi}of this.editorDiv.childNodes)if(xi.nodeType===Node.TEXT_NODE){const Xi=xi.nodeValue.length;if(We<=Xi){Ye.setStart(xi,We),Ye.setEnd(xi,We);break}We-=Xi}Rt.removeAllRanges(),Rt.addRange(Ye)}get contentDiv(){return this.editorDiv}static deserialize(k,X,pt){var qt;let mt=null;if(k instanceof c.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:re,fontColor:Xt},rect:be,rotation:fe,id:Ye},textContent:We,textPosition:ui,parent:{page:{pageNumber:pi}}}=k;if(!We||We.length===0)return null;mt=k={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(Xt),fontSize:re,value:We.join(`
`),position:ui,pageIndex:pi-1,rect:be.slice(0),rotation:fe,id:Ye,deleted:!1}}const Rt=super.deserialize(k,X,pt);return J(Rt,I,k.fontSize),J(Rt,E,n.Util.makeHexColor(...k.color)),J(Rt,C,Y(qt=Ft,Ae,Au).call(qt,k.value)),Rt.annotationElementId=k.id||null,J(Rt,rt,mt),Rt}serialize(k=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const X=Ft._internalPadding*this.parentScale,pt=this.getRect(X,X),mt=a.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,E)),Rt={annotationType:n.AnnotationEditorType.FREETEXT,color:mt,fontSize:l(this,I),value:Y(this,oe,y0).call(this),pageIndex:this.pageIndex,rect:pt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return k?Rt:this.annotationElementId&&!Y(this,Gt,b0).call(this,Rt)?null:(Rt.id=this.annotationElementId,Rt)}renderAnnotationElement(k){const X=super.renderAnnotationElement(k);if(this.deleted)return X;const{style:pt}=X;pt.fontSize=`calc(${l(this,I)}px * var(--scale-factor))`,pt.color=l(this,E),X.replaceChildren();for(const Rt of l(this,C).split(`
`)){const qt=document.createElement("div");qt.append(Rt?document.createTextNode(Rt):document.createElement("br")),X.append(qt)}const mt=Ft._internalPadding*this.parentScale;return k.updateEdited({rect:this.getRect(mt,mt)}),X}resetAnnotationElement(k){super.resetAnnotationElement(k),k.resetEdited()}};let d=Ft;A=new WeakMap,F=new WeakMap,M=new WeakMap,g=new WeakMap,w=new WeakMap,E=new WeakMap,C=new WeakMap,B=new WeakMap,I=new WeakMap,rt=new WeakMap,tt=new WeakSet,g0=function(k){const X=mt=>{this.editorDiv.style.fontSize=`calc(${mt}px * var(--scale-factor))`,this.translate(0,-(mt-l(this,I))*this.parentScale),J(this,I,mt),Y(this,Qt,Qh).call(this)},pt=l(this,I);this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,pt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},wt=new WeakSet,m0=function(k){const X=mt=>{J(this,E,this.editorDiv.style.color=mt)},pt=l(this,E);this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,pt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Tt=new WeakSet,v0=function(){var X;const k=[];this.editorDiv.normalize();for(const pt of this.editorDiv.childNodes)k.push(Y(X=Ft,Dt,Zh).call(X,pt));return k.join(`
`)},Qt=new WeakSet,Qh=function(){const[k,X]=this.parentDimensions;let pt;if(this.isAttachedToDOM)pt=this.div.getBoundingClientRect();else{const{currentLayer:mt,div:Rt}=this,qt=Rt.style.display,re=Rt.classList.contains("hidden");Rt.classList.remove("hidden"),Rt.style.display="hidden",mt.div.append(this.div),pt=Rt.getBoundingClientRect(),Rt.remove(),Rt.style.display=qt,Rt.classList.toggle("hidden",re)}this.rotation%180===this.parentRotation%180?(this.width=pt.width/k,this.height=pt.height/X):(this.width=pt.height/k,this.height=pt.width/X),this.fixAndSetPosition()},Dt=new WeakSet,Zh=function(k){return(k.nodeType===Node.TEXT_NODE?k.nodeValue:k.innerText).replaceAll(u,"")},zt=new WeakSet,Jh=function(){if(this.editorDiv.replaceChildren(),!!l(this,C))for(const k of l(this,C).split(`
`)){const X=document.createElement("div");X.append(k?document.createTextNode(k):document.createElement("br")),this.editorDiv.append(X)}},oe=new WeakSet,y0=function(){return l(this,C).replaceAll("\xA0"," ")},Ae=new WeakSet,Au=function(k){return k.replaceAll(" ","\xA0")},Gt=new WeakSet,b0=function(k){const{value:X,fontSize:pt,color:mt,pageIndex:Rt}=l(this,rt);return this._hasBeenMoved||k.value!==X||k.fontSize!==pt||k.color.some((qt,re)=>qt!==mt[re])||k.pageIndex!==Rt},N(d,Dt),N(d,Ae),ti(d,"_freeTextDefaultContent",""),ti(d,"_internalPadding",0),ti(d,"_defaultColor",null),ti(d,"_defaultFontSize",10),ti(d,"_type","freetext"),ti(d,"_editorType",n.AnnotationEditorType.FREETEXT);var f=s(61),m=s(259),S=s(419);const Q=class extends a.AnnotationEditor{constructor(k){super({...k,name:"highlightEditor"});N(this,nt);N(this,yt);N(this,Ht);N(this,Bt);N(this,at);N(this,vt);N(this,bt);N(this,Et);N(this,te);N(this,Pe);N(this,je);N(this,ze);N(this,Wt,null);N(this,ve,0);N(this,ie,void 0);N(this,xe,null);N(this,_e,null);N(this,ut,null);N(this,T,null);N(this,R,0);N(this,D,null);N(this,H,null);N(this,L,null);N(this,V,!1);N(this,j,Y(this,Et,A0).bind(this));N(this,G,null);N(this,W,void 0);N(this,U,null);N(this,O,"");N(this,z,void 0);N(this,et,"");this.color=k.color||Q._defaultColor,J(this,z,k.thickness||Q._defaultThickness),J(this,W,k.opacity||Q._defaultOpacity),J(this,ie,k.boxes||null),J(this,et,k.methodOfCreation||""),J(this,O,k.text||""),this._isDraggable=!1,k.highlightId>-1?(J(this,V,!0),Y(this,yt,Eu).call(this,k),Y(this,bt,Uo).call(this)):(J(this,Wt,k.anchorNode),J(this,ve,k.anchorOffset),J(this,T,k.focusNode),J(this,R,k.focusOffset),Y(this,nt,Su).call(this),Y(this,bt,Uo).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const k=Q.prototype;return(0,n.shadow)(this,"_keyboardManager",new o.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],k._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],k._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],k._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],k._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,V)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,z),methodOfCreation:l(this,et)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(k){return{numberOfColors:k.get("color").size}}static initialize(k,X){var pt;a.AnnotationEditor.initialize(k,X),Q._defaultColor||(Q._defaultColor=((pt=X.highlightColors)==null?void 0:pt.values().next().value)||"#fff066")}static updateDefaultParams(k,X){switch(k){case n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:Q._defaultColor=X;break;case n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:Q._defaultThickness=X;break}}translateInPage(k,X){}get toolbarPosition(){return l(this,G)}updateParams(k,X){switch(k){case n.AnnotationEditorParamsType.HIGHLIGHT_COLOR:Y(this,Ht,_0).call(this,X);break;case n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:Y(this,Bt,x0).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,Q._defaultColor],[n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,Q._defaultThickness]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||Q._defaultColor],[n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,l(this,z)||Q._defaultThickness],[n.AnnotationEditorParamsType.HIGHLIGHT_FREE,l(this,V)]]}async addEditToolbar(){const k=await super.addEditToolbar();return k?(this._uiManager.highlightColors&&(J(this,_e,new m.ColorPicker({editor:this})),k.addColorPicker(l(this,_e))),k):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(Y(this,Pe,Go).call(this))}getBaseTranslation(){return[0,0]}getRect(k,X){return super.getRect(k,X,Y(this,Pe,Go).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){Y(this,vt,Cu).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){!this.parent||(super.rebuild(),this.div!==null&&(Y(this,bt,Uo).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(k){var pt;let X=!1;this.parent&&!k?Y(this,vt,Cu).call(this):k&&(Y(this,bt,Uo).call(this,k),X=!this.parent&&((pt=this.div)==null?void 0:pt.classList.contains("selectedEditor"))),super.setParent(k),this.show(this._isVisible),X&&this.select()}rotate(k){var mt,Rt,qt;const{drawLayer:X}=this.parent;let pt;l(this,V)?(k=(k-this.rotation+360)%360,pt=Y(mt=Q,ot,eo).call(mt,l(this,H).box,k)):pt=Y(Rt=Q,ot,eo).call(Rt,this,k),X.rotate(l(this,L),k),X.rotate(l(this,U),k),X.updateBox(l(this,L),pt),X.updateBox(l(this,U),Y(qt=Q,ot,eo).call(qt,l(this,ut).box,k))}render(){if(this.div)return this.div;const k=super.render();l(this,O)&&(k.setAttribute("aria-label",l(this,O)),k.setAttribute("role","mark")),l(this,V)?k.classList.add("free"):this.div.addEventListener("keydown",l(this,j));const X=J(this,D,document.createElement("div"));k.append(X),X.setAttribute("aria-hidden","true"),X.className="internal",X.style.clipPath=l(this,xe);const[pt,mt]=this.parentDimensions;return this.setDims(this.width*pt,this.height*mt),(0,o.bindEvents)(this,l(this,D),["pointerover","pointerleave"]),this.enableEditing(),k}pointerover(){this.parent.drawLayer.addClass(l(this,U),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(l(this,U),"hovered")}_moveCaret(k){switch(this.parent.unselect(this),k){case 0:case 2:Y(this,te,tc).call(this,!0);break;case 1:case 3:Y(this,te,tc).call(this,!1);break}}select(){var k,X;super.select(),l(this,U)&&((k=this.parent)==null||k.drawLayer.removeClass(l(this,U),"hovered"),(X=this.parent)==null||X.drawLayer.addClass(l(this,U),"selected"))}unselect(){var k;super.unselect(),l(this,U)&&((k=this.parent)==null||k.drawLayer.removeClass(l(this,U),"selected"),l(this,V)||Y(this,te,tc).call(this,!1))}get _mustFixPosition(){return!l(this,V)}show(k=this._isVisible){super.show(k),this.parent&&(this.parent.drawLayer.show(l(this,L),k),this.parent.drawLayer.show(l(this,U),k))}static startHighlighting(k,X,{target:pt,x:mt,y:Rt}){const{x:qt,y:re,width:Xt,height:be}=pt.getBoundingClientRect(),fe=pi=>{Y(this,oi,C0).call(this,k,pi)},Ye={capture:!0,passive:!1},We=pi=>{pi.preventDefault(),pi.stopPropagation()},ui=pi=>{pt.removeEventListener("pointermove",fe),window.removeEventListener("blur",ui),window.removeEventListener("pointerup",ui),window.removeEventListener("pointerdown",We,Ye),window.removeEventListener("contextmenu",S.noContextMenu),Y(this,bi,k0).call(this,k,pi)};window.addEventListener("blur",ui),window.addEventListener("pointerup",ui),window.addEventListener("pointerdown",We,Ye),window.addEventListener("contextmenu",S.noContextMenu),pt.addEventListener("pointermove",fe),this._freeHighlight=new f.FreeOutliner({x:mt,y:Rt},[qt,re,Xt,be],k.scale,this._defaultThickness/2,X,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=k.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(k,X,pt){var pi;const mt=super.deserialize(k,X,pt),{rect:[Rt,qt,re,Xt],color:be,quadPoints:fe}=k;mt.color=n.Util.makeHexColor(...be),J(mt,W,k.opacity);const[Ye,We]=mt.pageDimensions;mt.width=(re-Rt)/Ye,mt.height=(Xt-qt)/We;const ui=J(mt,ie,[]);for(let Qe=0;Qe<fe.length;Qe+=8)ui.push({x:(fe[4]-re)/Ye,y:(Xt-(1-fe[Qe+5]))/We,width:(fe[Qe+2]-fe[Qe])/Ye,height:(fe[Qe+5]-fe[Qe+1])/We});return Y(pi=mt,nt,Su).call(pi),mt}serialize(k=!1){if(this.isEmpty()||k)return null;const X=this.getRect(0,0),pt=a.AnnotationEditor._colorManager.convert(this.color);return{annotationType:n.AnnotationEditorType.HIGHLIGHT,color:pt,opacity:l(this,W),thickness:l(this,z),quadPoints:Y(this,je,S0).call(this),outlines:Y(this,ze,E0).call(this,X),pageIndex:this.pageIndex,rect:X,rotation:Y(this,Pe,Go).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};let _=Q;Wt=new WeakMap,ve=new WeakMap,ie=new WeakMap,xe=new WeakMap,_e=new WeakMap,ut=new WeakMap,T=new WeakMap,R=new WeakMap,D=new WeakMap,H=new WeakMap,L=new WeakMap,V=new WeakMap,j=new WeakMap,G=new WeakMap,W=new WeakMap,U=new WeakMap,O=new WeakMap,z=new WeakMap,et=new WeakMap,nt=new WeakSet,Su=function(){const k=new f.Outliner(l(this,ie),.001);J(this,H,k.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=l(this,H).box;const X=new f.Outliner(l(this,ie),.0025,.001,this._uiManager.direction==="ltr");J(this,ut,X.getOutlines());const{lastPoint:pt}=l(this,ut).box;J(this,G,[(pt[0]-this.x)/this.width,(pt[1]-this.y)/this.height])},yt=new WeakSet,Eu=function({highlightOutlines:k,highlightId:X,clipPathId:pt}){var fe,Ye;J(this,H,k);const mt=1.5;if(J(this,ut,k.getNewOutline(l(this,z)/2+mt,.0025)),X>=0)J(this,L,X),J(this,xe,pt),this.parent.drawLayer.finalizeLine(X,k),J(this,U,this.parent.drawLayer.highlightOutline(l(this,ut)));else if(this.parent){const We=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(l(this,L),k),this.parent.drawLayer.updateBox(l(this,L),Y(fe=Q,ot,eo).call(fe,l(this,H).box,(We-this.rotation+360)%360)),this.parent.drawLayer.updateLine(l(this,U),l(this,ut)),this.parent.drawLayer.updateBox(l(this,U),Y(Ye=Q,ot,eo).call(Ye,l(this,ut).box,We))}const{x:Rt,y:qt,width:re,height:Xt}=k.box;switch(this.rotation){case 0:this.x=Rt,this.y=qt,this.width=re,this.height=Xt;break;case 90:{const[We,ui]=this.parentDimensions;this.x=qt,this.y=1-Rt,this.width=re*ui/We,this.height=Xt*We/ui;break}case 180:this.x=1-Rt,this.y=1-qt,this.width=re,this.height=Xt;break;case 270:{const[We,ui]=this.parentDimensions;this.x=1-qt,this.y=Rt,this.width=re*ui/We,this.height=Xt*We/ui;break}}const{lastPoint:be}=l(this,ut).box;J(this,G,[(be[0]-Rt)/re,(be[1]-qt)/Xt])},Ht=new WeakSet,_0=function(k){const X=mt=>{var Rt,qt;this.color=mt,(Rt=this.parent)==null||Rt.drawLayer.changeColor(l(this,L),mt),(qt=l(this,_e))==null||qt.updateColor(mt)},pt=this.color;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,pt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(k)},!0)},Bt=new WeakSet,x0=function(k){const X=l(this,z),pt=mt=>{J(this,z,mt),Y(this,at,w0).call(this,mt)};this.addCommands({cmd:pt.bind(this,k),undo:pt.bind(this,X),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:k},!0)},at=new WeakSet,w0=function(k){if(!l(this,V))return;Y(this,yt,Eu).call(this,{highlightOutlines:l(this,H).getNewOutline(k/2)}),this.fixAndSetPosition();const[X,pt]=this.parentDimensions;this.setDims(this.width*X,this.height*pt)},vt=new WeakSet,Cu=function(){l(this,L)===null||!this.parent||(this.parent.drawLayer.remove(l(this,L)),J(this,L,null),this.parent.drawLayer.remove(l(this,U)),J(this,U,null))},bt=new WeakSet,Uo=function(k=this.parent){l(this,L)===null&&({id:ws(this,L)._,clipPathId:ws(this,xe)._}=k.drawLayer.highlight(l(this,H),this.color,l(this,W)),J(this,U,k.drawLayer.highlightOutline(l(this,ut))),l(this,D)&&(l(this,D).style.clipPath=l(this,xe)))},ot=new WeakSet,eo=function({x:k,y:X,width:pt,height:mt},Rt){switch(Rt){case 90:return{x:1-X-mt,y:k,width:mt,height:pt};case 180:return{x:1-k-pt,y:1-X-mt,width:pt,height:mt};case 270:return{x:X,y:1-k-pt,width:mt,height:pt}}return{x:k,y:X,width:pt,height:mt}},Et=new WeakSet,A0=function(k){Q._keyboardManager.exec(this,k)},te=new WeakSet,tc=function(k){if(!l(this,Wt))return;const X=window.getSelection();k?X.setPosition(l(this,Wt),l(this,ve)):X.setPosition(l(this,T),l(this,R))},Pe=new WeakSet,Go=function(){return l(this,V)?this.rotation:0},je=new WeakSet,S0=function(){if(l(this,V))return null;const[k,X]=this.pageDimensions,pt=l(this,ie),mt=new Array(pt.length*8);let Rt=0;for(const{x:qt,y:re,width:Xt,height:be}of pt){const fe=qt*k,Ye=(1-re-be)*X;mt[Rt]=mt[Rt+4]=fe,mt[Rt+1]=mt[Rt+3]=Ye,mt[Rt+2]=mt[Rt+6]=fe+Xt*k,mt[Rt+5]=mt[Rt+7]=Ye+be*X,Rt+=8}return mt},ze=new WeakSet,E0=function(k){return l(this,H).serialize(k,Y(this,Pe,Go).call(this))},oi=new WeakSet,C0=function(k,X){this._freeHighlight.add(X)&&k.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},bi=new WeakSet,k0=function(k,X){this._freeHighlight.isEmpty()?k.drawLayer.removeFreeHighlight(this._freeHighlightId):k.createAndAddNewEditor(X,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},N(_,ot),N(_,oi),N(_,bi),ti(_,"_defaultColor",null),ti(_,"_defaultOpacity",1),ti(_,"_defaultThickness",12),ti(_,"_l10nPromise"),ti(_,"_type","highlight"),ti(_,"_editorType",n.AnnotationEditorType.HIGHLIGHT),ti(_,"_freeHighlightId",-1),ti(_,"_freeHighlight",null),ti(_,"_freeHighlightClipId","");const ar=class extends a.AnnotationEditor{constructor(k){super({...k,name:"inkEditor"});N(this,Ue);N(this,ei);N(this,Hi);N(this,$);N(this,Zt);N(this,de);N(this,Se);N(this,ci);N(this,Bi);N(this,Ar);N(this,ds);N(this,us);N(this,jr);N(this,ha);N(this,Wn);N(this,$n);N(this,Kn);N(this,di);N(this,Xn);N(this,Ga);N(this,Dr);N(this,Os);N(this,Tr);N(this,K,0);N(this,ht,0);N(this,xt,this.canvasPointermove.bind(this));N(this,St,this.canvasPointerleave.bind(this));N(this,It,this.canvasPointerup.bind(this));N(this,Ot,this.canvasPointerdown.bind(this));N(this,ye,null);N(this,le,new Path2D);N(this,$t,!1);N(this,ne,!1);N(this,ue,!1);N(this,he,null);N(this,Le,0);N(this,we,0);N(this,He,null);this.color=k.color||null,this.thickness=k.thickness||null,this.opacity=k.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(k,X){a.AnnotationEditor.initialize(k,X)}static updateDefaultParams(k,X){switch(k){case n.AnnotationEditorParamsType.INK_THICKNESS:ar._defaultThickness=X;break;case n.AnnotationEditorParamsType.INK_COLOR:ar._defaultColor=X;break;case n.AnnotationEditorParamsType.INK_OPACITY:ar._defaultOpacity=X/100;break}}updateParams(k,X){switch(k){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,Ue,T0).call(this,X);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,ei,P0).call(this,X);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,Hi,M0).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,ar._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,ar._defaultColor||a.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(ar._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ar._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||ar._defaultColor||a.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ar._defaultOpacity))]]}rebuild(){!this.parent||(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,Wn,ec).call(this),Y(this,$n,ic).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,Kn,io).call(this)),Y(this,Tr,jo).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,l(this,ye)&&(clearTimeout(l(this,ye)),J(this,ye,null)),l(this,he).disconnect(),J(this,he,null),super.remove())}setParent(k){!this.parent&&k?this._uiManager.removeShouldRescale(this):this.parent&&k===null&&this._uiManager.addShouldRescale(this),super.setParent(k)}onScaleChanging(){const[k,X]=this.parentDimensions,pt=this.width*k,mt=this.height*X;this.setDimensions(pt,mt)}enableEditMode(){l(this,$t)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",l(this,Ot)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",l(this,Ot)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){l(this,$t)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),J(this,$t,!0),this.div.classList.add("disabled"),Y(this,Tr,jo).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(k){!this._focusEventsAllowed||(super.focusin(k),this.enableEditMode())}canvasPointerdown(k){k.button!==0||!this.isInEditMode()||l(this,$t)||(this.setInForeground(),k.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),Y(this,de,F0).call(this,k.offsetX,k.offsetY))}canvasPointermove(k){k.preventDefault(),Y(this,Se,Tu).call(this,k.offsetX,k.offsetY)}canvasPointerup(k){k.preventDefault(),Y(this,ha,Pu).call(this,k)}canvasPointerleave(k){Y(this,ha,Pu).call(this,k)}get isResizable(){return!this.isEmpty()&&l(this,$t)}render(){if(this.div)return this.div;let k,X;this.width&&(k=this.x,X=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[pt,mt,Rt,qt]=Y(this,$,R0).call(this);if(this.setAt(pt,mt,0,0),this.setDims(Rt,qt),Y(this,Wn,ec).call(this),this.width){const[re,Xt]=this.parentDimensions;this.setAspectRatio(this.width*re,this.height*Xt),this.setAt(k*re,X*Xt,this.width*re,this.height*Xt),J(this,ue,!0),Y(this,Kn,io).call(this),this.setDims(this.width*re,this.height*Xt),Y(this,jr,wa).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,$n,ic).call(this),this.div}setDimensions(k,X){const pt=Math.round(k),mt=Math.round(X);if(l(this,Le)===pt&&l(this,we)===mt)return;J(this,Le,pt),J(this,we,mt),this.canvas.style.visibility="hidden";const[Rt,qt]=this.parentDimensions;this.width=k/Rt,this.height=X/qt,this.fixAndSetPosition(),l(this,$t)&&Y(this,di,Mu).call(this,k,X),Y(this,Kn,io).call(this),Y(this,jr,wa).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(k,X,pt){var Qe,xi,Xi;if(k instanceof c.InkAnnotationElement)return null;const mt=super.deserialize(k,X,pt);mt.thickness=k.thickness,mt.color=n.Util.makeHexColor(...k.color),mt.opacity=k.opacity;const[Rt,qt]=mt.pageDimensions,re=mt.width*Rt,Xt=mt.height*qt,be=mt.parentScale,fe=k.thickness/2;J(mt,$t,!0),J(mt,Le,Math.round(re)),J(mt,we,Math.round(Xt));const{paths:Ye,rect:We,rotation:ui}=k;for(let{bezier:Ui}of Ye){Ui=Y(Qe=ar,Ua,H0).call(Qe,Ui,We,ui);const Kr=[];mt.paths.push(Kr);let ys=be*(Ui[0]-fe),cn=be*(Ui[1]-fe);for(let Ei=2,rr=Ui.length;Ei<rr;Ei+=6){const Hs=be*(Ui[Ei]-fe),Zn=be*(Ui[Ei+1]-fe),Jn=be*(Ui[Ei+2]-fe),Wa=be*(Ui[Ei+3]-fe),nr=be*(Ui[Ei+4]-fe),$a=be*(Ui[Ei+5]-fe);Kr.push([[ys,cn],[Hs,Zn],[Jn,Wa],[nr,$a]]),ys=nr,cn=$a}const Fi=Y(this,Ba,z0).call(this,Kr);mt.bezierPath2D.push(Fi)}const pi=Y(xi=mt,Dr,Fu).call(xi);return J(mt,ht,Math.max(a.AnnotationEditor.MIN_SIZE,pi[2]-pi[0])),J(mt,K,Math.max(a.AnnotationEditor.MIN_SIZE,pi[3]-pi[1])),Y(Xi=mt,di,Mu).call(Xi,re,Xt),mt}serialize(){if(this.isEmpty())return null;const k=this.getRect(0,0),X=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:X,thickness:this.thickness,opacity:this.opacity,paths:Y(this,Ga,B0).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,k),pageIndex:this.pageIndex,rect:k,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};let v=ar;K=new WeakMap,ht=new WeakMap,xt=new WeakMap,St=new WeakMap,It=new WeakMap,Ot=new WeakMap,ye=new WeakMap,le=new WeakMap,$t=new WeakMap,ne=new WeakMap,ue=new WeakMap,he=new WeakMap,Le=new WeakMap,we=new WeakMap,He=new WeakMap,Ue=new WeakSet,T0=function(k){const X=mt=>{this.thickness=mt,Y(this,Tr,jo).call(this)},pt=this.thickness;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,pt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},ei=new WeakSet,P0=function(k){const X=mt=>{this.color=mt,Y(this,jr,wa).call(this)},pt=this.color;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,pt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Hi=new WeakSet,M0=function(k){const X=mt=>{this.opacity=mt,Y(this,jr,wa).call(this)};k/=100;const pt=this.opacity;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,pt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},$=new WeakSet,R0=function(){const{parentRotation:k,parentDimensions:[X,pt]}=this;switch(k){case 90:return[0,pt,pt,X];case 180:return[X,pt,X,pt];case 270:return[X,0,pt,X];default:return[0,0,X,pt]}},Zt=new WeakSet,ku=function(){const{ctx:k,color:X,opacity:pt,thickness:mt,parentScale:Rt,scaleFactor:qt}=this;k.lineWidth=mt*Rt/qt,k.lineCap="round",k.lineJoin="round",k.miterLimit=10,k.strokeStyle=`${X}${(0,o.opacityToHex)(pt)}`},de=new WeakSet,F0=function(k,X){this.canvas.addEventListener("contextmenu",S.noContextMenu),this.canvas.addEventListener("pointerleave",l(this,St)),this.canvas.addEventListener("pointermove",l(this,xt)),this.canvas.addEventListener("pointerup",l(this,It)),this.canvas.removeEventListener("pointerdown",l(this,Ot)),this.isEditing=!0,l(this,ue)||(J(this,ue,!0),Y(this,Kn,io).call(this),this.thickness||(this.thickness=ar._defaultThickness),this.color||(this.color=ar._defaultColor||a.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=ar._defaultOpacity)),this.currentPath.push([k,X]),J(this,ne,!1),Y(this,Zt,ku).call(this),J(this,He,()=>{Y(this,Ar,D0).call(this),l(this,He)&&window.requestAnimationFrame(l(this,He))}),window.requestAnimationFrame(l(this,He))},Se=new WeakSet,Tu=function(k,X){const[pt,mt]=this.currentPath.at(-1);if(this.currentPath.length>1&&k===pt&&X===mt)return;const Rt=this.currentPath;let qt=l(this,le);if(Rt.push([k,X]),J(this,ne,!0),Rt.length<=2){qt.moveTo(...Rt[0]),qt.lineTo(k,X);return}Rt.length===3&&(J(this,le,qt=new Path2D),qt.moveTo(...Rt[0])),Y(this,ds,N0).call(this,qt,...Rt.at(-3),...Rt.at(-2),k,X)},ci=new WeakSet,I0=function(){if(this.currentPath.length===0)return;const k=this.currentPath.at(-1);l(this,le).lineTo(...k)},Bi=new WeakSet,L0=function(k,X){J(this,He,null),k=Math.min(Math.max(k,0),this.canvas.width),X=Math.min(Math.max(X,0),this.canvas.height),Y(this,Se,Tu).call(this,k,X),Y(this,ci,I0).call(this);let pt;if(this.currentPath.length!==1)pt=Y(this,us,O0).call(this);else{const Xt=[k,X];pt=[[Xt,Xt.slice(),Xt.slice(),Xt]]}const mt=l(this,le),Rt=this.currentPath;this.currentPath=[],J(this,le,new Path2D);const qt=()=>{this.allRawPaths.push(Rt),this.paths.push(pt),this.bezierPath2D.push(mt),this._uiManager.rebuild(this)},re=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,Wn,ec).call(this),Y(this,$n,ic).call(this)),Y(this,Tr,jo).call(this))};this.addCommands({cmd:qt,undo:re,mustExec:!0})},Ar=new WeakSet,D0=function(){if(!l(this,ne))return;J(this,ne,!1);const k=Math.ceil(this.thickness*this.parentScale),X=this.currentPath.slice(-3),pt=X.map(qt=>qt[0]),mt=X.map(qt=>qt[1]);Math.min(...pt)-k,Math.max(...pt)+k,Math.min(...mt)-k,Math.max(...mt)+k;const{ctx:Rt}=this;Rt.save(),Rt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const qt of this.bezierPath2D)Rt.stroke(qt);Rt.stroke(l(this,le)),Rt.restore()},ds=new WeakSet,N0=function(k,X,pt,mt,Rt,qt,re){const Xt=(X+mt)/2,be=(pt+Rt)/2,fe=(mt+qt)/2,Ye=(Rt+re)/2;k.bezierCurveTo(Xt+2*(mt-Xt)/3,be+2*(Rt-be)/3,fe+2*(mt-fe)/3,Ye+2*(Rt-Ye)/3,fe,Ye)},us=new WeakSet,O0=function(){const k=this.currentPath;if(k.length<=2)return[[k[0],k[0],k.at(-1),k.at(-1)]];const X=[];let pt,[mt,Rt]=k[0];for(pt=1;pt<k.length-2;pt++){const[We,ui]=k[pt],[pi,Qe]=k[pt+1],xi=(We+pi)/2,Xi=(ui+Qe)/2,Ui=[mt+2*(We-mt)/3,Rt+2*(ui-Rt)/3],Kr=[xi+2*(We-xi)/3,Xi+2*(ui-Xi)/3];X.push([[mt,Rt],Ui,Kr,[xi,Xi]]),[mt,Rt]=[xi,Xi]}const[qt,re]=k[pt],[Xt,be]=k[pt+1],fe=[mt+2*(qt-mt)/3,Rt+2*(re-Rt)/3],Ye=[Xt+2*(qt-Xt)/3,be+2*(re-be)/3];return X.push([[mt,Rt],fe,Ye,[Xt,be]]),X},jr=new WeakSet,wa=function(){if(this.isEmpty()){Y(this,Xn,rc).call(this);return}Y(this,Zt,ku).call(this);const{canvas:k,ctx:X}=this;X.setTransform(1,0,0,1,0,0),X.clearRect(0,0,k.width,k.height),Y(this,Xn,rc).call(this);for(const pt of this.bezierPath2D)X.stroke(pt)},ha=new WeakSet,Pu=function(k){this.canvas.removeEventListener("pointerleave",l(this,St)),this.canvas.removeEventListener("pointermove",l(this,xt)),this.canvas.removeEventListener("pointerup",l(this,It)),this.canvas.addEventListener("pointerdown",l(this,Ot)),l(this,ye)&&clearTimeout(l(this,ye)),J(this,ye,setTimeout(()=>{J(this,ye,null),this.canvas.removeEventListener("contextmenu",S.noContextMenu)},10)),Y(this,Bi,L0).call(this,k.offsetX,k.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Wn=new WeakSet,ec=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},$n=new WeakSet,ic=function(){J(this,he,new ResizeObserver(k=>{const X=k[0].contentRect;X.width&&X.height&&this.setDimensions(X.width,X.height)})),l(this,he).observe(this.div)},Kn=new WeakSet,io=function(){if(!l(this,ue))return;const[k,X]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*k),this.canvas.height=Math.ceil(this.height*X),Y(this,Xn,rc).call(this)},di=new WeakSet,Mu=function(k,X){const pt=Y(this,Os,nc).call(this),mt=(k-pt)/l(this,ht),Rt=(X-pt)/l(this,K);this.scaleFactor=Math.min(mt,Rt)},Xn=new WeakSet,rc=function(){const k=Y(this,Os,nc).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+k,this.translationY*this.scaleFactor+k)},Ba=new WeakSet,z0=function(k){const X=new Path2D;for(let pt=0,mt=k.length;pt<mt;pt++){const[Rt,qt,re,Xt]=k[pt];pt===0&&X.moveTo(...Rt),X.bezierCurveTo(qt[0],qt[1],re[0],re[1],Xt[0],Xt[1])}return X},$i=new WeakSet,Ru=function(k,X,pt){const[mt,Rt,qt,re]=X;switch(pt){case 0:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]+=mt,k[Xt+1]=re-k[Xt+1];break;case 90:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=k[Xt+1]+mt,k[Xt+1]=fe+Rt}break;case 180:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]=qt-k[Xt],k[Xt+1]+=Rt;break;case 270:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=qt-k[Xt+1],k[Xt+1]=re-fe}break;default:throw new Error("Invalid rotation")}return k},Ua=new WeakSet,H0=function(k,X,pt){const[mt,Rt,qt,re]=X;switch(pt){case 0:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]-=mt,k[Xt+1]=re-k[Xt+1];break;case 90:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=k[Xt+1]-Rt,k[Xt+1]=fe-mt}break;case 180:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]=qt-k[Xt],k[Xt+1]-=Rt;break;case 270:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=re-k[Xt+1],k[Xt+1]=qt-fe}break;default:throw new Error("Invalid rotation")}return k},Ga=new WeakSet,B0=function(k,X,pt,mt){var be,fe;const Rt=[],qt=this.thickness/2,re=k*X+qt,Xt=k*pt+qt;for(const Ye of this.paths){const We=[],ui=[];for(let pi=0,Qe=Ye.length;pi<Qe;pi++){const[xi,Xi,Ui,Kr]=Ye[pi];if(xi[0]===Kr[0]&&xi[1]===Kr[1]&&Qe===1){const Wa=k*xi[0]+re,nr=k*xi[1]+Xt;We.push(Wa,nr),ui.push(Wa,nr);break}const ys=k*xi[0]+re,cn=k*xi[1]+Xt,Fi=k*Xi[0]+re,Ei=k*Xi[1]+Xt,rr=k*Ui[0]+re,Hs=k*Ui[1]+Xt,Zn=k*Kr[0]+re,Jn=k*Kr[1]+Xt;pi===0&&(We.push(ys,cn),ui.push(ys,cn)),We.push(Fi,Ei,rr,Hs,Zn,Jn),ui.push(Fi,Ei),pi===Qe-1&&ui.push(Zn,Jn)}Rt.push({bezier:Y(be=ar,$i,Ru).call(be,We,mt,this.rotation),points:Y(fe=ar,$i,Ru).call(fe,ui,mt,this.rotation)})}return Rt},Dr=new WeakSet,Fu=function(){let k=1/0,X=-1/0,pt=1/0,mt=-1/0;for(const Rt of this.paths)for(const[qt,re,Xt,be]of Rt){const fe=n.Util.bezierBoundingBox(...qt,...re,...Xt,...be);k=Math.min(k,fe[0]),pt=Math.min(pt,fe[1]),X=Math.max(X,fe[2]),mt=Math.max(mt,fe[3])}return[k,pt,X,mt]},Os=new WeakSet,nc=function(){return l(this,$t)?Math.ceil(this.thickness*this.parentScale):0},Tr=new WeakSet,jo=function(k=!1){if(this.isEmpty())return;if(!l(this,$t)){Y(this,jr,wa).call(this);return}const X=Y(this,Dr,Fu).call(this),pt=Y(this,Os,nc).call(this);J(this,ht,Math.max(a.AnnotationEditor.MIN_SIZE,X[2]-X[0])),J(this,K,Math.max(a.AnnotationEditor.MIN_SIZE,X[3]-X[1]));const mt=Math.ceil(pt+l(this,ht)*this.scaleFactor),Rt=Math.ceil(pt+l(this,K)*this.scaleFactor),[qt,re]=this.parentDimensions;this.width=mt/qt,this.height=Rt/re,this.setAspectRatio(mt,Rt);const Xt=this.translationX,be=this.translationY;this.translationX=-X[0],this.translationY=-X[1],Y(this,Kn,io).call(this),Y(this,jr,wa).call(this),J(this,Le,mt),J(this,we,Rt),this.setDims(mt,Rt);const fe=k?pt/this.scaleFactor/2:0;this.translate(Xt-this.translationX-fe,be-this.translationY-fe)},N(v,Ba),N(v,$i),N(v,Ua),ti(v,"_defaultColor",null),ti(v,"_defaultOpacity",1),ti(v,"_defaultThickness",1),ti(v,"_type","ink"),ti(v,"_editorType",n.AnnotationEditorType.INK);const fa=class extends a.AnnotationEditor{constructor(k){super({...k,name:"stampEditor"});N(this,Pr);N(this,Yn);N(this,qn);N(this,Sr);N(this,Qn);N(this,da);N(this,fs);N(this,ps);N(this,ua);N(this,hr,null);N(this,yr,null);N(this,br,null);N(this,Nr,null);N(this,Vr,null);N(this,Mn,"");N(this,Wr,null);N(this,cr,null);N(this,Zi,null);N(this,_r,!1);N(this,$r,!1);J(this,Nr,k.bitmapUrl),J(this,Vr,k.bitmapFile)}static initialize(k,X){a.AnnotationEditor.initialize(k,X)}static get supportedTypes(){const k=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",k.map(X=>`image/${X}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(k){return this.supportedTypes.includes(k)}static paste(k,X){X.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:k.getAsFile()})}remove(){var k,X;l(this,yr)&&(J(this,hr,null),this._uiManager.imageManager.deleteId(l(this,yr)),(k=l(this,Wr))==null||k.remove(),J(this,Wr,null),(X=l(this,cr))==null||X.disconnect(),J(this,cr,null),l(this,Zi)&&(clearTimeout(l(this,Zi)),J(this,Zi,null))),super.remove()}rebuild(){if(!this.parent){l(this,yr)&&Y(this,qn,sc).call(this);return}super.rebuild(),this.div!==null&&(l(this,yr)&&l(this,Wr)===null&&Y(this,qn,sc).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(l(this,br)||l(this,hr)||l(this,Nr)||l(this,Vr)||l(this,yr))}get isResizable(){return!0}render(){if(this.div)return this.div;let k,X;if(this.width&&(k=this.x,X=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),l(this,hr)?Y(this,Sr,Iu).call(this):Y(this,qn,sc).call(this),this.width){const[pt,mt]=this.parentDimensions;this.setAt(k*pt,X*mt,this.width*pt,this.height*mt)}return this.div}getImageForAltText(){return l(this,Wr)}static deserialize(k,X,pt){if(k instanceof c.StampAnnotationElement)return null;const mt=super.deserialize(k,X,pt),{rect:Rt,bitmapUrl:qt,bitmapId:re,isSvg:Xt,accessibilityData:be}=k;re&&pt.imageManager.isValidId(re)?J(mt,yr,re):J(mt,Nr,qt),J(mt,_r,Xt);const[fe,Ye]=mt.pageDimensions;return mt.width=(Rt[2]-Rt[0])/fe,mt.height=(Rt[3]-Rt[1])/Ye,be&&(mt.altTextData=be),mt}serialize(k=!1,X=null){if(this.isEmpty())return null;const pt={annotationType:n.AnnotationEditorType.STAMP,bitmapId:l(this,yr),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,_r),structTreeParentId:this._structTreeParentId};if(k)return pt.bitmapUrl=Y(this,ps,ac).call(this,!0),pt.accessibilityData=this.altTextData,pt;const{decorative:mt,altText:Rt}=this.altTextData;if(!mt&&Rt&&(pt.accessibilityData={type:"Figure",alt:Rt}),X===null)return pt;X.stamps||(X.stamps=new Map);const qt=l(this,_r)?(pt.rect[2]-pt.rect[0])*(pt.rect[3]-pt.rect[1]):null;if(!X.stamps.has(l(this,yr)))X.stamps.set(l(this,yr),{area:qt,serialized:pt}),pt.bitmap=Y(this,ps,ac).call(this,!1);else if(l(this,_r)){const re=X.stamps.get(l(this,yr));qt>re.area&&(re.area=qt,re.serialized.bitmap.close(),re.serialized.bitmap=Y(this,ps,ac).call(this,!1))}return pt}};let b=fa;hr=new WeakMap,yr=new WeakMap,br=new WeakMap,Nr=new WeakMap,Vr=new WeakMap,Mn=new WeakMap,Wr=new WeakMap,cr=new WeakMap,Zi=new WeakMap,_r=new WeakMap,$r=new WeakMap,Pr=new WeakSet,Vo=function(k,X=!1){if(!k){this.remove();return}J(this,hr,k.bitmap),X||(J(this,yr,k.id),J(this,_r,k.isSvg)),k.file&&J(this,Mn,k.file.name),Y(this,Sr,Iu).call(this)},Yn=new WeakSet,Wo=function(){J(this,br,null),this._uiManager.enableWaiting(!1),l(this,Wr)&&this.div.focus()},qn=new WeakSet,sc=function(){if(l(this,yr)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,yr)).then(X=>Y(this,Pr,Vo).call(this,X,!0)).finally(()=>Y(this,Yn,Wo).call(this));return}if(l(this,Nr)){const X=l(this,Nr);J(this,Nr,null),this._uiManager.enableWaiting(!0),J(this,br,this._uiManager.imageManager.getFromUrl(X).then(pt=>Y(this,Pr,Vo).call(this,pt)).finally(()=>Y(this,Yn,Wo).call(this)));return}if(l(this,Vr)){const X=l(this,Vr);J(this,Vr,null),this._uiManager.enableWaiting(!0),J(this,br,this._uiManager.imageManager.getFromFile(X).then(pt=>Y(this,Pr,Vo).call(this,pt)).finally(()=>Y(this,Yn,Wo).call(this)));return}const k=document.createElement("input");k.type="file",k.accept=fa.supportedTypesStr,J(this,br,new Promise(X=>{k.addEventListener("change",async()=>{if(!k.files||k.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const pt=await this._uiManager.imageManager.getFromFile(k.files[0]);Y(this,Pr,Vo).call(this,pt)}X()}),k.addEventListener("cancel",()=>{this.remove(),X()})}).finally(()=>Y(this,Yn,Wo).call(this))),k.click()},Sr=new WeakSet,Iu=function(){const{div:k}=this;let{width:X,height:pt}=l(this,hr);const[mt,Rt]=this.pageDimensions,qt=.75;if(this.width)X=this.width*mt,pt=this.height*Rt;else if(X>qt*mt||pt>qt*Rt){const fe=Math.min(qt*mt/X,qt*Rt/pt);X*=fe,pt*=fe}const[re,Xt]=this.parentDimensions;this.setDims(X*re/mt,pt*Xt/Rt),this._uiManager.enableWaiting(!1);const be=J(this,Wr,document.createElement("canvas"));k.append(be),k.hidden=!1,Y(this,fs,Lu).call(this,X,pt),Y(this,ua,j0).call(this),l(this,$r)||(this.parent.addUndoableEditor(this),J(this,$r,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,Mn)&&be.setAttribute("aria-label",l(this,Mn))},Qn=new WeakSet,U0=function(k,X){var qt;const[pt,mt]=this.parentDimensions;this.width=k/pt,this.height=X/mt,this.setDims(k,X),(qt=this._initialOptions)!=null&&qt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,l(this,Zi)!==null&&clearTimeout(l(this,Zi)),J(this,Zi,setTimeout(()=>{J(this,Zi,null),Y(this,fs,Lu).call(this,k,X)},200))},da=new WeakSet,G0=function(k,X){const{width:pt,height:mt}=l(this,hr);let Rt=pt,qt=mt,re=l(this,hr);for(;Rt>2*k||qt>2*X;){const Xt=Rt,be=qt;Rt>2*k&&(Rt=Rt>=16384?Math.floor(Rt/2)-1:Math.ceil(Rt/2)),qt>2*X&&(qt=qt>=16384?Math.floor(qt/2)-1:Math.ceil(qt/2));const fe=new OffscreenCanvas(Rt,qt);fe.getContext("2d").drawImage(re,0,0,Xt,be,0,0,Rt,qt),re=fe.transferToImageBitmap()}return re},fs=new WeakSet,Lu=function(k,X){k=Math.ceil(k),X=Math.ceil(X);const pt=l(this,Wr);if(!pt||pt.width===k&&pt.height===X)return;pt.width=k,pt.height=X;const mt=l(this,_r)?l(this,hr):Y(this,da,G0).call(this,k,X);if(this._uiManager.hasMLManager&&!this.hasAltText()){const qt=new OffscreenCanvas(k,X);qt.getContext("2d").drawImage(mt,0,0,mt.width,mt.height,0,0,k,X),qt.convertToBlob().then(re=>{const Xt=new FileReader;Xt.onload=()=>{const be=Xt.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:be}}).then(fe=>{const Ye=(fe==null?void 0:fe.output)||"";this.parent&&Ye&&!this.hasAltText()&&(this.altTextData={altText:Ye,decorative:!1})})},Xt.readAsDataURL(re)})}const Rt=pt.getContext("2d");Rt.filter=this._uiManager.hcmFilter,Rt.drawImage(mt,0,0,mt.width,mt.height,0,0,k,X)},ps=new WeakSet,ac=function(k){if(k){if(l(this,_r)){const pt=this._uiManager.imageManager.getSvgUrl(l(this,yr));if(pt)return pt}const X=document.createElement("canvas");return{width:X.width,height:X.height}=l(this,hr),X.getContext("2d").drawImage(l(this,hr),0,0),X.toDataURL()}if(l(this,_r)){const[X,pt]=this.pageDimensions,mt=Math.round(this.width*X*S.PixelsPerInch.PDF_TO_CSS_UNITS),Rt=Math.round(this.height*pt*S.PixelsPerInch.PDF_TO_CSS_UNITS),qt=new OffscreenCanvas(mt,Rt);return qt.getContext("2d").drawImage(l(this,hr),0,0,l(this,hr).width,l(this,hr).height,0,0,mt,Rt),qt.transferToImageBitmap()}return structuredClone(l(this,hr))},ua=new WeakSet,j0=function(){J(this,cr,new ResizeObserver(k=>{const X=k[0].contentRect;X.width&&X.height&&Y(this,Qn,U0).call(this,X.width,X.height)})),l(this,cr).observe(this.div)},ti(b,"_type","stamp"),ti(b,"_editorType",n.AnnotationEditorType.STAMP);const hn=class{constructor({uiManager:kt,pageIndex:k,div:X,accessibilityManager:pt,annotationLayer:mt,drawLayer:Rt,textLayer:qt,viewport:re,l10n:Xt}){N(this,pa);N(this,ms);N(this,Er);N(this,vs);N(this,Mr);N(this,gs,void 0);N(this,Fn,!1);N(this,gn,null);N(this,ln,null);N(this,Qr,null);N(this,mn,null);N(this,vn,null);N(this,dr,new Map);N(this,In,!1);N(this,Ln,!1);N(this,Dn,!1);N(this,ir,null);N(this,Oe,void 0);const be=[...l(hn,yn).values()];if(!hn._initialized){hn._initialized=!0;for(const fe of be)fe.initialize(Xt,kt)}kt.registerEditorTypes(be),J(this,Oe,kt),this.pageIndex=k,this.div=X,J(this,gs,pt),J(this,gn,mt),this.viewport=re,J(this,ir,qt),this.drawLayer=Rt,l(this,Oe).addLayer(this)}get isEmpty(){return l(this,dr).size===0}get isInvisible(){return this.isEmpty&&l(this,Oe).getMode()===n.AnnotationEditorType.NONE}updateToolbar(kt){l(this,Oe).updateToolbar(kt)}updateMode(kt=l(this,Oe).getMode()){switch(Y(this,Mr,oc).call(this),kt){case n.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case n.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case n.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:k}=this.div;for(const X of l(hn,yn).values())k.toggle(`${X._type}Editing`,kt===X._editorType);this.div.hidden=!1}hasTextLayer(kt){var k;return kt===((k=l(this,ir))==null?void 0:k.div)}addInkEditorIfNeeded(kt){if(l(this,Oe).getMode()===n.AnnotationEditorType.INK){if(!kt){for(const k of l(this,dr).values())if(k.isEmpty()){k.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(kt){l(this,Oe).setEditingState(kt)}addCommands(kt){l(this,Oe).addCommands(kt)}togglePointerEvents(kt=!1){this.div.classList.toggle("disabled",!kt)}toggleAnnotationLayerPointerEvents(kt=!1){var k;(k=l(this,gn))==null||k.div.classList.toggle("disabled",!kt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const kt=new Set;for(const X of l(this,dr).values())X.enableEditing(),X.show(!0),X.annotationElementId&&(l(this,Oe).removeChangedExistingAnnotation(X),kt.add(X.annotationElementId));if(!l(this,gn))return;const k=l(this,gn).getEditableAnnotations();for(const X of k){if(X.hide(),l(this,Oe).isDeletedAnnotationElement(X.data.id)||kt.has(X.data.id))continue;const pt=this.deserialize(X);!pt||(this.addOrRebuild(pt),pt.enableEditing())}}disable(){var pt;J(this,Dn,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const kt=new Map,k=new Map;for(const mt of l(this,dr).values())if(mt.disableEditing(),!!mt.annotationElementId){if(mt.serialize()!==null){kt.set(mt.annotationElementId,mt);continue}else k.set(mt.annotationElementId,mt);(pt=this.getEditableAnnotation(mt.annotationElementId))==null||pt.show(),mt.remove()}if(l(this,gn)){const mt=l(this,gn).getEditableAnnotations();for(const Rt of mt){const{id:qt}=Rt.data;if(l(this,Oe).isDeletedAnnotationElement(qt))continue;let re=k.get(qt);if(re){re.resetAnnotationElement(Rt),re.show(!1),Rt.show();continue}re=kt.get(qt),re&&(l(this,Oe).addChangedExistingAnnotation(re),re.renderAnnotationElement(Rt),re.show(!1)),Rt.show()}}Y(this,Mr,oc).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:X}=this.div;for(const mt of l(hn,yn).values())X.remove(`${mt._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),J(this,Dn,!1)}getEditableAnnotation(kt){var k;return((k=l(this,gn))==null?void 0:k.getEditableAnnotation(kt))||null}setActiveEditor(kt){l(this,Oe).getActive()!==kt&&l(this,Oe).setActiveEditor(kt)}enableTextSelection(){var kt;this.div.tabIndex=-1,(kt=l(this,ir))!=null&&kt.div&&!l(this,mn)&&(J(this,mn,Y(this,pa,V0).bind(this)),l(this,ir).div.addEventListener("pointerdown",l(this,mn)),l(this,ir).div.classList.add("highlighting"))}disableTextSelection(){var kt;this.div.tabIndex=0,(kt=l(this,ir))!=null&&kt.div&&l(this,mn)&&(l(this,ir).div.removeEventListener("pointerdown",l(this,mn)),J(this,mn,null),l(this,ir).div.classList.remove("highlighting"))}enableClick(){l(this,Qr)||(J(this,Qr,this.pointerdown.bind(this)),J(this,ln,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",l(this,Qr)),this.div.addEventListener("pointerup",l(this,ln)))}disableClick(){!l(this,Qr)||(this.div.removeEventListener("pointerdown",l(this,Qr)),this.div.removeEventListener("pointerup",l(this,ln)),J(this,Qr,null),J(this,ln,null))}attach(kt){l(this,dr).set(kt.id,kt);const{annotationElementId:k}=kt;k&&l(this,Oe).isDeletedAnnotationElement(k)&&l(this,Oe).removeDeletedAnnotationElement(kt)}detach(kt){var k;l(this,dr).delete(kt.id),(k=l(this,gs))==null||k.removePointerInTextLayer(kt.contentDiv),!l(this,Dn)&&kt.annotationElementId&&l(this,Oe).addDeletedAnnotationElement(kt)}remove(kt){this.detach(kt),l(this,Oe).removeEditor(kt),kt.div.remove(),kt.isAttachedToDOM=!1,l(this,Ln)||this.addInkEditorIfNeeded(!1)}changeParent(kt){var k;kt.parent!==this&&(kt.parent&&kt.annotationElementId&&(l(this,Oe).addDeletedAnnotationElement(kt.annotationElementId),a.AnnotationEditor.deleteAnnotationElement(kt),kt.annotationElementId=null),this.attach(kt),(k=kt.parent)==null||k.detach(kt),kt.setParent(this),kt.div&&kt.isAttachedToDOM&&(kt.div.remove(),this.div.append(kt.div)))}add(kt){if(!(kt.parent===this&&kt.isAttachedToDOM)){if(this.changeParent(kt),l(this,Oe).addEditor(kt),this.attach(kt),!kt.isAttachedToDOM){const k=kt.render();this.div.append(k),kt.isAttachedToDOM=!0}kt.fixAndSetPosition(),kt.onceAdded(),l(this,Oe).addToAnnotationStorage(kt),kt._reportTelemetry(kt.telemetryInitialData)}}moveEditorInDOM(kt){var X;if(!kt.isAttachedToDOM)return;const{activeElement:k}=document;kt.div.contains(k)&&!l(this,vn)&&(kt._focusEventsAllowed=!1,J(this,vn,setTimeout(()=>{J(this,vn,null),kt.div.contains(document.activeElement)?kt._focusEventsAllowed=!0:(kt.div.addEventListener("focusin",()=>{kt._focusEventsAllowed=!0},{once:!0}),k.focus())},0))),kt._structTreeParentId=(X=l(this,gs))==null?void 0:X.moveElementInDOM(this.div,kt.div,kt.contentDiv,!0)}addOrRebuild(kt){kt.needsToBeRebuilt()?(kt.parent||(kt.parent=this),kt.rebuild(),kt.show()):this.add(kt)}addUndoableEditor(kt){const k=()=>kt._uiManager.rebuild(kt),X=()=>{kt.remove()};this.addCommands({cmd:k,undo:X,mustExec:!1})}getNextId(){return l(this,Oe).getId()}canCreateNewEmptyEditor(){var kt;return(kt=l(this,ms,Du))==null?void 0:kt.canCreateNewEmptyEditor()}pasteEditor(kt,k){l(this,Oe).updateToolbar(kt),l(this,Oe).updateMode(kt);const{offsetX:X,offsetY:pt}=Y(this,vs,Ou).call(this),mt=this.getNextId(),Rt=Y(this,Er,Nu).call(this,{parent:this,id:mt,x:X,y:pt,uiManager:l(this,Oe),isCentered:!0,...k});Rt&&this.add(Rt)}deserialize(kt){var k;return((k=l(hn,yn).get(kt.annotationType??kt.annotationEditorType))==null?void 0:k.deserialize(kt,this,l(this,Oe)))||null}createAndAddNewEditor(kt,k,X={}){const pt=this.getNextId(),mt=Y(this,Er,Nu).call(this,{parent:this,id:pt,x:kt.offsetX,y:kt.offsetY,uiManager:l(this,Oe),isCentered:k,...X});return mt&&this.add(mt),mt}addNewEditor(){this.createAndAddNewEditor(Y(this,vs,Ou).call(this),!0)}setSelected(kt){l(this,Oe).setSelected(kt)}toggleSelected(kt){l(this,Oe).toggleSelected(kt)}isSelected(kt){return l(this,Oe).isSelected(kt)}unselect(kt){l(this,Oe).unselect(kt)}pointerup(kt){const{isMac:k}=n.FeatureTest.platform;if(!(kt.button!==0||kt.ctrlKey&&k)&&kt.target===this.div&&l(this,In)){if(J(this,In,!1),!l(this,Fn)){J(this,Fn,!0);return}if(l(this,Oe).getMode()===n.AnnotationEditorType.STAMP){l(this,Oe).unselectAll();return}this.createAndAddNewEditor(kt,!1)}}pointerdown(kt){if(l(this,Oe).getMode()===n.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),l(this,In)){J(this,In,!1);return}const{isMac:k}=n.FeatureTest.platform;if(kt.button!==0||kt.ctrlKey&&k||kt.target!==this.div)return;J(this,In,!0);const X=l(this,Oe).getActive();J(this,Fn,!X||X.isEmpty())}findNewParent(kt,k,X){const pt=l(this,Oe).findParent(k,X);return pt===null||pt===this?!1:(pt.changeParent(kt),!0)}destroy(){var kt,k;((kt=l(this,Oe).getActive())==null?void 0:kt.parent)===this&&(l(this,Oe).commitOrRemove(),l(this,Oe).setActiveEditor(null)),l(this,vn)&&(clearTimeout(l(this,vn)),J(this,vn,null));for(const X of l(this,dr).values())(k=l(this,gs))==null||k.removePointerInTextLayer(X.contentDiv),X.setParent(null),X.isAttachedToDOM=!1,X.div.remove();this.div=null,l(this,dr).clear(),l(this,Oe).removeLayer(this)}render({viewport:kt}){this.viewport=kt,(0,S.setLayerDimensions)(this.div,kt);for(const k of l(this,Oe).getEditors(this.pageIndex))this.add(k),k.rebuild();this.updateMode()}update({viewport:kt}){l(this,Oe).commitOrRemove(),Y(this,Mr,oc).call(this);const k=this.viewport.rotation,X=kt.rotation;if(this.viewport=kt,(0,S.setLayerDimensions)(this.div,{rotation:X}),k!==X)for(const pt of l(this,dr).values())pt.rotate(X);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:kt,pageHeight:k}=this.viewport.rawDims;return[kt,k]}get scale(){return l(this,Oe).viewParameters.realScale}};let x=hn;gs=new WeakMap,Fn=new WeakMap,gn=new WeakMap,ln=new WeakMap,Qr=new WeakMap,mn=new WeakMap,vn=new WeakMap,dr=new WeakMap,In=new WeakMap,Ln=new WeakMap,Dn=new WeakMap,ir=new WeakMap,Oe=new WeakMap,yn=new WeakMap,pa=new WeakSet,V0=function(kt){if(l(this,Oe).unselectAll(),kt.target===l(this,ir).div){const{isMac:k}=n.FeatureTest.platform;if(kt.button!==0||kt.ctrlKey&&k)return;l(this,Oe).showAllEditors("highlight",!0,!0),l(this,ir).div.classList.add("free"),_.startHighlighting(this,l(this,Oe).direction==="ltr",kt),l(this,ir).div.addEventListener("pointerup",()=>{l(this,ir).div.classList.remove("free")},{once:!0}),kt.preventDefault()}},ms=new WeakSet,Du=function(){return l(hn,yn).get(l(this,Oe).getMode())},Er=new WeakSet,Nu=function(kt){const k=l(this,ms,Du);return k?new k.prototype.constructor(kt):null},vs=new WeakSet,Ou=function(){const{x:kt,y:k,width:X,height:pt}=this.div.getBoundingClientRect(),mt=Math.max(0,kt),Rt=Math.max(0,k),qt=Math.min(window.innerWidth,kt+X),re=Math.min(window.innerHeight,k+pt),Xt=(mt+qt)/2-kt,be=(Rt+re)/2-k,[fe,Ye]=this.viewport.rotation%180===0?[Xt,be]:[be,Xt];return{offsetX:fe,offsetY:Ye}},Mr=new WeakSet,oc=function(){J(this,Ln,!0);for(const kt of l(this,dr).values())kt.isEmpty()&&kt.remove();J(this,Ln,!1)},ti(x,"_initialized",!1),N(x,yn,new Map([d,v,b,_].map(kt=>[kt._editorType,kt])))},259:(r,t,s)=>{var u,d,f,m,S,_,v,b,x,A,F,M,g,zu,E,Hu,B,W0,rt,Aa,st,$0,dt,Ks;s.d(t,{ColorPicker:()=>c});var n=s(292),a=s(830),o=s(419);const Lt=class{constructor({editor:ct=null,uiManager:Dt=null}){N(this,g);N(this,E);N(this,B);N(this,rt);N(this,st);N(this,dt);N(this,u,Y(this,B,W0).bind(this));N(this,d,Y(this,st,$0).bind(this));N(this,f,null);N(this,m,null);N(this,S,void 0);N(this,_,null);N(this,v,!1);N(this,b,!1);N(this,x,null);N(this,A,void 0);N(this,F,null);N(this,M,void 0);var ee;ct?(J(this,b,!1),J(this,M,n.AnnotationEditorParamsType.HIGHLIGHT_COLOR),J(this,x,ct)):(J(this,b,!0),J(this,M,n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),J(this,F,(ct==null?void 0:ct._uiManager)||Dt),J(this,A,l(this,F)._eventBus),J(this,S,(ct==null?void 0:ct.color)||((ee=l(this,F))==null?void 0:ee.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,n.shadow)(this,"_keyboardManager",new a.KeyboardManager([[["Escape","mac+Escape"],Lt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Lt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Lt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Lt.prototype._moveToPrevious],[["Home","mac+Home"],Lt.prototype._moveToBeginning],[["End","mac+End"],Lt.prototype._moveToEnd]]))}renderButton(){const ct=J(this,f,document.createElement("button"));ct.className="colorPicker",ct.tabIndex="0",ct.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),ct.setAttribute("aria-haspopup",!0),ct.addEventListener("click",Y(this,rt,Aa).bind(this)),ct.addEventListener("keydown",l(this,u));const Dt=J(this,m,document.createElement("span"));return Dt.className="swatch",Dt.setAttribute("aria-hidden",!0),Dt.style.backgroundColor=l(this,S),ct.append(Dt),ct}renderMainDropdown(){const ct=J(this,_,Y(this,g,zu).call(this));return ct.setAttribute("aria-orientation","horizontal"),ct.setAttribute("aria-labelledby","highlightColorPickerLabel"),ct}_colorSelectFromKeyboard(ct){if(ct.target===l(this,f)){Y(this,rt,Aa).call(this,ct);return}const Dt=ct.target.getAttribute("data-color");!Dt||Y(this,E,Hu).call(this,Dt,ct)}_moveToNext(ct){var Dt,ee;if(!l(this,dt,Ks)){Y(this,rt,Aa).call(this,ct);return}if(ct.target===l(this,f)){(Dt=l(this,_).firstChild)==null||Dt.focus();return}(ee=ct.target.nextSibling)==null||ee.focus()}_moveToPrevious(ct){var Dt,ee;if(ct.target===((Dt=l(this,_))==null?void 0:Dt.firstChild)||ct.target===l(this,f)){l(this,dt,Ks)&&this._hideDropdownFromKeyboard();return}l(this,dt,Ks)||Y(this,rt,Aa).call(this,ct),(ee=ct.target.previousSibling)==null||ee.focus()}_moveToBeginning(ct){var Dt;if(!l(this,dt,Ks)){Y(this,rt,Aa).call(this,ct);return}(Dt=l(this,_).firstChild)==null||Dt.focus()}_moveToEnd(ct){var Dt;if(!l(this,dt,Ks)){Y(this,rt,Aa).call(this,ct);return}(Dt=l(this,_).lastChild)==null||Dt.focus()}hideDropdown(){var ct;(ct=l(this,_))==null||ct.classList.add("hidden"),window.removeEventListener("pointerdown",l(this,d))}_hideDropdownFromKeyboard(){var ct;if(!l(this,b)){if(!l(this,dt,Ks)){(ct=l(this,x))==null||ct.unselect();return}this.hideDropdown(),l(this,f).focus({preventScroll:!0,focusVisible:l(this,v)})}}updateColor(ct){if(l(this,m)&&(l(this,m).style.backgroundColor=ct),!l(this,_))return;const Dt=l(this,F).highlightColors.values();for(const ee of l(this,_).children)ee.setAttribute("aria-selected",Dt.next().value===ct)}destroy(){var ct,Dt;(ct=l(this,f))==null||ct.remove(),J(this,f,null),J(this,m,null),(Dt=l(this,_))==null||Dt.remove(),J(this,_,null)}};let c=Lt;u=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakMap,S=new WeakMap,_=new WeakMap,v=new WeakMap,b=new WeakMap,x=new WeakMap,A=new WeakMap,F=new WeakMap,M=new WeakMap,g=new WeakSet,zu=function(){const ct=document.createElement("div");ct.addEventListener("contextmenu",o.noContextMenu),ct.className="dropdown",ct.role="listbox",ct.setAttribute("aria-multiselectable",!1),ct.setAttribute("aria-orientation","vertical"),ct.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[Dt,ee]of l(this,F).highlightColors){const zt=document.createElement("button");zt.tabIndex="0",zt.role="option",zt.setAttribute("data-color",ee),zt.title=Dt,zt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${Dt}`);const Jt=document.createElement("span");zt.append(Jt),Jt.className="swatch",Jt.style.backgroundColor=ee,zt.setAttribute("aria-selected",ee===l(this,S)),zt.addEventListener("click",Y(this,E,Hu).bind(this,ee)),ct.append(zt)}return ct.addEventListener("keydown",l(this,u)),ct},E=new WeakSet,Hu=function(ct,Dt){Dt.stopPropagation(),l(this,A).dispatch("switchannotationeditorparams",{source:this,type:l(this,M),value:ct})},B=new WeakSet,W0=function(ct){Lt._keyboardManager.exec(this,ct)},rt=new WeakSet,Aa=function(ct){if(l(this,dt,Ks)){this.hideDropdown();return}if(J(this,v,ct.detail===0),window.addEventListener("pointerdown",l(this,d)),l(this,_)){l(this,_).classList.remove("hidden");return}const Dt=J(this,_,Y(this,g,zu).call(this));l(this,f).append(Dt)},st=new WeakSet,$0=function(ct){var Dt;(Dt=l(this,_))!=null&&Dt.contains(ct.target)||this.hideDropdown()},dt=new WeakSet,Ks=function(){return l(this,_)&&!l(this,_).classList.contains("hidden")}},310:(r,t,s)=>{var m,S,_,v,b,x,A,F,Bu,w,E,C,B,I,rt,tt,st,wt,dt,Tt,Lt,Qt,ct,Dt,ee,zt,Jt,oe,ge,Ae,Ve,Uu,lt,Gu,Wt,ju,ie,K0,_e,X0,T,Vu,D,Wu,L,$u,j,Y0,W,q0,O,Q0,et,Z0,gt,Ku,Nt,$o;s.d(t,{AnnotationEditor:()=>d});var n=s(830),a=s(292),o=s(419);const g=class{constructor(Z){N(this,F);N(this,m,"");N(this,S,!1);N(this,_,null);N(this,v,null);N(this,b,null);N(this,x,!1);N(this,A,null);J(this,A,Z)}static initialize(Z){g._l10nPromise||(g._l10nPromise=Z)}async render(){const Z=J(this,_,document.createElement("button"));Z.className="altText";const at=await g._l10nPromise.get("pdfjs-editor-alt-text-button-label");Z.textContent=at,Z.setAttribute("aria-label",at),Z.tabIndex="0",Z.addEventListener("contextmenu",o.noContextMenu),Z.addEventListener("pointerdown",vt=>vt.stopPropagation());const _t=vt=>{vt.preventDefault(),l(this,A)._uiManager.editAltText(l(this,A))};return Z.addEventListener("click",_t,{capture:!0}),Z.addEventListener("keydown",vt=>{vt.target===Z&&vt.key==="Enter"&&(J(this,x,!0),_t(vt))}),await Y(this,F,Bu).call(this),Z}finish(){!l(this,_)||(l(this,_).focus({focusVisible:l(this,x)}),J(this,x,!1))}isEmpty(){return!l(this,m)&&!l(this,S)}get data(){return{altText:l(this,m),decorative:l(this,S)}}set data({altText:Z,decorative:at}){l(this,m)===Z&&l(this,S)===at||(J(this,m,Z),J(this,S,at),Y(this,F,Bu).call(this))}toggle(Z=!1){!l(this,_)||(!Z&&l(this,b)&&(clearTimeout(l(this,b)),J(this,b,null)),l(this,_).disabled=!Z)}destroy(){var Z;(Z=l(this,_))==null||Z.remove(),J(this,_,null),J(this,v,null)}};let c=g;m=new WeakMap,S=new WeakMap,_=new WeakMap,v=new WeakMap,b=new WeakMap,x=new WeakMap,A=new WeakMap,F=new WeakSet,Bu=async function(){var _t,vt;const Z=l(this,_);if(!Z)return;if(!l(this,m)&&!l(this,S)){Z.classList.remove("done"),(_t=l(this,v))==null||_t.remove();return}Z.classList.add("done"),g._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(jt=>{Z.setAttribute("aria-label",jt)});let at=l(this,v);if(!at){J(this,v,at=document.createElement("span")),at.className="tooltip",at.setAttribute("role","tooltip");const jt=at.id=`alt-text-tooltip-${l(this,A).id}`;Z.setAttribute("aria-describedby",jt);const bt=100;Z.addEventListener("mouseenter",()=>{J(this,b,setTimeout(()=>{J(this,b,null),l(this,v).classList.add("show"),l(this,A)._reportTelemetry({action:"alt_text_tooltip"})},bt))}),Z.addEventListener("mouseleave",()=>{var q;l(this,b)&&(clearTimeout(l(this,b)),J(this,b,null)),(q=l(this,v))==null||q.classList.remove("show")})}at.innerText=l(this,S)?await g._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):l(this,m),at.parentNode||Z.append(at),(vt=l(this,A).getImageForAltText())==null||vt.setAttribute("aria-describedby",at.id)},ti(c,"_l10nPromise",null);var u=s(362);const Pt=class{constructor(Z){N(this,Ve);N(this,Wt);N(this,ie);N(this,_e);N(this,T);N(this,D);N(this,L);N(this,j);N(this,W);N(this,O);N(this,et);N(this,gt);N(this,Nt);N(this,w,null);N(this,E,null);N(this,C,!1);N(this,B,!1);N(this,I,null);N(this,rt,null);N(this,tt,this.focusin.bind(this));N(this,st,this.focusout.bind(this));N(this,wt,null);N(this,dt,"");N(this,Tt,!1);N(this,Lt,null);N(this,Qt,!1);N(this,ct,!1);N(this,Dt,!1);N(this,ee,null);N(this,zt,0);N(this,Jt,0);N(this,oe,null);ti(this,"_initialOptions",Object.create(null));ti(this,"_isVisible",!0);ti(this,"_uiManager",null);ti(this,"_focusEventsAllowed",!0);ti(this,"_l10nPromise",null);N(this,ge,!1);N(this,Ae,Pt._zIndex++);this.constructor===Pt&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Z.parent,this.id=Z.id,this.width=this.height=null,this.pageIndex=Z.parent.pageIndex,this.name=Z.name,this.div=null,this._uiManager=Z.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Z.isCentered,this._structTreeParentId=null;const{rotation:at,rawDims:{pageWidth:_t,pageHeight:vt,pageX:jt,pageY:bt}}=this.parent.viewport;this.rotation=at,this.pageRotation=(360+at-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[_t,vt],this.pageTranslation=[jt,bt];const[q,ot]=this.parentDimensions;this.x=Z.x/q,this.y=Z.y/ot,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const Z=Pt.prototype._resizeWithKeyboard,at=n.AnnotationEditorUIManager.TRANSLATE_SMALL,_t=n.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_resizerKeyboardManager",new n.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],Z,{args:[-at,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Z,{args:[-_t,0]}],[["ArrowRight","mac+ArrowRight"],Z,{args:[at,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Z,{args:[_t,0]}],[["ArrowUp","mac+ArrowUp"],Z,{args:[0,-at]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Z,{args:[0,-_t]}],[["ArrowDown","mac+ArrowDown"],Z,{args:[0,at]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Z,{args:[0,_t]}],[["Escape","mac+Escape"],Pt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Z){const at=new f({id:Z.parent.getNextId(),parent:Z.parent,uiManager:Z._uiManager});at.annotationElementId=Z.annotationElementId,at.deleted=!0,at._uiManager.addToAnnotationStorage(at)}static initialize(Z,at,_t){if(Pt._l10nPromise||(Pt._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(jt=>[jt,Z.get(jt.replaceAll(/([A-Z])/g,bt=>`-${bt.toLowerCase()}`))]))),_t==null?void 0:_t.strings)for(const jt of _t.strings)Pt._l10nPromise.set(jt,Z.get(jt));if(Pt._borderLineWidth!==-1)return;const vt=getComputedStyle(document.documentElement);Pt._borderLineWidth=parseFloat(vt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Z,at){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Z){return!1}static paste(Z,at){(0,a.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,ge)}set _isDraggable(Z){var at;J(this,ge,Z),(at=this.div)==null||at.classList.toggle("draggable",Z)}get isEnterHandled(){return!0}center(){const[Z,at]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*at/(Z*2),this.y+=this.width*Z/(at*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*at/(Z*2),this.y-=this.width*Z/(at*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Z){this._uiManager.addCommands(Z)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Ae)}setParent(Z){Z!==null?(this.pageIndex=Z.pageIndex,this.pageDimensions=Z.pageDimensions):Y(this,Nt,$o).call(this),this.parent=Z}focusin(Z){!this._focusEventsAllowed||(l(this,Tt)?J(this,Tt,!1):this.parent.setSelected(this))}focusout(Z){var at,_t;!this._focusEventsAllowed||!this.isAttachedToDOM||(at=Z.relatedTarget)!=null&&at.closest(`#${this.id}`)||(Z.preventDefault(),(_t=this.parent)!=null&&_t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Z,at,_t,vt){const[jt,bt]=this.parentDimensions;[_t,vt]=this.screenToPageTranslation(_t,vt),this.x=(Z+_t)/jt,this.y=(at+vt)/bt,this.fixAndSetPosition()}translate(Z,at){Y(this,Ve,Uu).call(this,this.parentDimensions,Z,at)}translateInPage(Z,at){l(this,Lt)||J(this,Lt,[this.x,this.y]),Y(this,Ve,Uu).call(this,this.pageDimensions,Z,at),this.div.scrollIntoView({block:"nearest"})}drag(Z,at){l(this,Lt)||J(this,Lt,[this.x,this.y]);const[_t,vt]=this.parentDimensions;if(this.x+=Z/_t,this.y+=at/vt,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ft,y:Et}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ft,Et)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:jt,y:bt}=this;const[q,ot]=this.getBaseTranslation();jt+=q,bt+=ot,this.div.style.left=`${(100*jt).toFixed(2)}%`,this.div.style.top=`${(100*bt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!l(this,Lt)&&(l(this,Lt)[0]!==this.x||l(this,Lt)[1]!==this.y)}getBaseTranslation(){const[Z,at]=this.parentDimensions,{_borderLineWidth:_t}=Pt,vt=_t/Z,jt=_t/at;switch(this.rotation){case 90:return[-vt,jt];case 180:return[vt,jt];case 270:return[vt,-jt];default:return[-vt,-jt]}}get _mustFixPosition(){return!0}fixAndSetPosition(Z=this.rotation){const[at,_t]=this.pageDimensions;let{x:vt,y:jt,width:bt,height:q}=this;if(bt*=at,q*=_t,vt*=at,jt*=_t,this._mustFixPosition)switch(Z){case 0:vt=Math.max(0,Math.min(at-bt,vt)),jt=Math.max(0,Math.min(_t-q,jt));break;case 90:vt=Math.max(0,Math.min(at-q,vt)),jt=Math.min(_t,Math.max(bt,jt));break;case 180:vt=Math.min(at,Math.max(bt,vt)),jt=Math.min(_t,Math.max(q,jt));break;case 270:vt=Math.min(at,Math.max(q,vt)),jt=Math.max(0,Math.min(_t-bt,jt));break}this.x=vt/=at,this.y=jt/=_t;const[ot,ft]=this.getBaseTranslation();vt+=ot,jt+=ft;const{style:Et}=this.div;Et.left=`${(100*vt).toFixed(2)}%`,Et.top=`${(100*jt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Z,at){var _t;return Y(_t=Pt,lt,Gu).call(_t,Z,at,this.parentRotation)}pageTranslationToScreen(Z,at){var _t;return Y(_t=Pt,lt,Gu).call(_t,Z,at,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Z,pageDimensions:[at,_t]}=this,vt=at*Z,jt=_t*Z;return a.FeatureTest.isCSSRoundSupported?[Math.round(vt),Math.round(jt)]:[vt,jt]}setDims(Z,at){const[_t,vt]=this.parentDimensions;this.div.style.width=`${(100*Z/_t).toFixed(2)}%`,l(this,B)||(this.div.style.height=`${(100*at/vt).toFixed(2)}%`)}fixDims(){const{style:Z}=this.div,{height:at,width:_t}=Z,vt=_t.endsWith("%"),jt=!l(this,B)&&at.endsWith("%");if(vt&&jt)return;const[bt,q]=this.parentDimensions;vt||(Z.width=`${(100*parseFloat(_t)/bt).toFixed(2)}%`),!l(this,B)&&!jt&&(Z.height=`${(100*parseFloat(at)/q).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var Z;(Z=l(this,E))==null||Z.finish()}async addEditToolbar(){return l(this,wt)||l(this,ct)?l(this,wt):(J(this,wt,new u.EditorToolbar(this)),this.div.append(l(this,wt).render()),l(this,E)&&l(this,wt).addAltTextButton(await l(this,E).render()),l(this,wt))}removeEditToolbar(){var Z;!l(this,wt)||(l(this,wt).remove(),J(this,wt,null),(Z=l(this,E))==null||Z.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,E)||(c.initialize(Pt._l10nPromise),J(this,E,new c(this)),await this.addEditToolbar())}get altTextData(){var Z;return(Z=l(this,E))==null?void 0:Z.data}set altTextData(Z){!l(this,E)||(l(this,E).data=Z)}hasAltText(){var Z;return!((Z=l(this,E))!=null&&Z.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,C)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",l(this,tt)),this.div.addEventListener("focusout",l(this,st));const[Z,at]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*at/Z).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Z/at).toFixed(2)}%`);const[_t,vt]=this.getInitialTranslation();return this.translate(_t,vt),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Z){const{isMac:at}=a.FeatureTest.platform;if(Z.button!==0||Z.ctrlKey&&at){Z.preventDefault();return}if(J(this,Tt,!0),this._isDraggable){Y(this,j,Y0).call(this,Z);return}Y(this,L,$u).call(this,Z)}moveInDOM(){l(this,ee)&&clearTimeout(l(this,ee)),J(this,ee,setTimeout(()=>{var Z;J(this,ee,null),(Z=this.parent)==null||Z.moveEditorInDOM(this)},0))}_setParentAndPosition(Z,at,_t){Z.changeParent(this),this.x=at,this.y=_t,this.fixAndSetPosition()}getRect(Z,at,_t=this.rotation){const vt=this.parentScale,[jt,bt]=this.pageDimensions,[q,ot]=this.pageTranslation,ft=Z/vt,Et=at/vt,Kt=this.x*jt,te=this.y*bt,me=this.width*jt,Pe=this.height*bt;switch(_t){case 0:return[Kt+ft+q,bt-te-Et-Pe+ot,Kt+ft+me+q,bt-te-Et+ot];case 90:return[Kt+Et+q,bt-te+ft+ot,Kt+Et+Pe+q,bt-te+ft+me+ot];case 180:return[Kt-ft-me+q,bt-te+Et+ot,Kt-ft+q,bt-te+Et+Pe+ot];case 270:return[Kt-Et-Pe+q,bt-te-ft-me+ot,Kt-Et+q,bt-te-ft+ot];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Z,at){const[_t,vt,jt,bt]=Z,q=jt-_t,ot=bt-vt;switch(this.rotation){case 0:return[_t,at-bt,q,ot];case 90:return[_t,at-vt,ot,q];case 180:return[jt,at-vt,q,ot];case 270:return[jt,at-bt,ot,q];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){J(this,ct,!0)}disableEditMode(){J(this,ct,!1)}isInEditMode(){return l(this,ct)}shouldGetKeyboardEvents(){return l(this,Dt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Z,at;(Z=this.div)==null||Z.addEventListener("focusin",l(this,tt)),(at=this.div)==null||at.addEventListener("focusout",l(this,st))}rotate(Z){}serialize(Z=!1,at=null){(0,a.unreachable)("An editor must be serializable")}static deserialize(Z,at,_t){const vt=new this.prototype.constructor({parent:at,id:at.getNextId(),uiManager:_t});vt.rotation=Z.rotation;const[jt,bt]=vt.pageDimensions,[q,ot,ft,Et]=vt.getRectInCurrentCoords(Z.rect,bt);return vt.x=q/jt,vt.y=ot/bt,vt.width=ft/jt,vt.height=Et/bt,vt}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",l(this,tt)),this.div.removeEventListener("focusout",l(this,st)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,ee)&&(clearTimeout(l(this,ee)),J(this,ee,null)),Y(this,Nt,$o).call(this),this.removeEditToolbar(),l(this,oe)){for(const Z of l(this,oe).values())clearTimeout(Z);J(this,oe,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,ie,K0).call(this),l(this,I).classList.remove("hidden"),(0,n.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(Z){if(!this.isResizable||Z.target!==this.div||Z.key!=="Enter")return;this._uiManager.setSelected(this),J(this,rt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const at=l(this,I).children;if(!l(this,w)){J(this,w,Array.from(at));const bt=Y(this,W,q0).bind(this),q=Y(this,O,Q0).bind(this);for(const ot of l(this,w)){const ft=ot.getAttribute("data-resizer-name");ot.setAttribute("role","spinbutton"),ot.addEventListener("keydown",bt),ot.addEventListener("blur",q),ot.addEventListener("focus",Y(this,et,Z0).bind(this,ft)),Pt._l10nPromise.get(`pdfjs-editor-resizer-label-${ft}`).then(Et=>ot.setAttribute("aria-label",Et))}}const _t=l(this,w)[0];let vt=0;for(const bt of at){if(bt===_t)break;vt++}const jt=(360-this.rotation+this.parentRotation)%360/90*(l(this,w).length/4);if(jt!==vt){if(jt<vt)for(let q=0;q<vt-jt;q++)l(this,I).append(l(this,I).firstChild);else if(jt>vt)for(let q=0;q<jt-vt;q++)l(this,I).firstChild.before(l(this,I).lastChild);let bt=0;for(const q of at){const ot=l(this,w)[bt++].getAttribute("data-resizer-name");Pt._l10nPromise.get(`pdfjs-editor-resizer-label-${ot}`).then(ft=>q.setAttribute("aria-label",ft))}}Y(this,gt,Ku).call(this,0),J(this,Dt,!0),l(this,I).firstChild.focus({focusVisible:!0}),Z.preventDefault(),Z.stopImmediatePropagation()}_resizeWithKeyboard(Z,at){!l(this,Dt)||Y(this,D,Wu).call(this,l(this,dt),{movementX:Z,movementY:at})}_stopResizingWithKeyboard(){Y(this,Nt,$o).call(this),this.div.focus()}select(){var Z,at;if(this.makeResizable(),(Z=this.div)==null||Z.classList.add("selectedEditor"),!l(this,wt)){this.addEditToolbar().then(()=>{var _t,vt;(_t=this.div)!=null&&_t.classList.contains("selectedEditor")&&((vt=l(this,wt))==null||vt.show())});return}(at=l(this,wt))==null||at.show()}unselect(){var Z,at,_t,vt;(Z=l(this,I))==null||Z.classList.add("hidden"),(at=this.div)==null||at.classList.remove("selectedEditor"),(_t=this.div)!=null&&_t.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(vt=l(this,wt))==null||vt.hide()}updateParams(Z,at){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,Qt)}set isEditing(Z){J(this,Qt,Z),this.parent&&(Z?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Z,at){J(this,B,!0);const _t=Z/at,{style:vt}=this.div;vt.aspectRatio=_t,vt.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(Z,at=!1){if(at){l(this,oe)||J(this,oe,new Map);const{action:_t}=Z;let vt=l(this,oe).get(_t);vt&&clearTimeout(vt),vt=setTimeout(()=>{this._reportTelemetry(Z),l(this,oe).delete(_t),l(this,oe).size===0&&J(this,oe,null)},Pt._telemetryTimeout),l(this,oe).set(_t,vt);return}Z.type||(Z.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:Z}})}show(Z=this._isVisible){this.div.classList.toggle("hidden",!Z),this._isVisible=Z}enable(){this.div&&(this.div.tabIndex=0),J(this,C,!1)}disable(){this.div&&(this.div.tabIndex=-1),J(this,C,!0)}renderAnnotationElement(Z){let at=Z.container.querySelector(".annotationContent");if(!at)at=document.createElement("div"),at.classList.add("annotationContent",this.editorType),Z.container.prepend(at);else if(at.nodeName==="CANVAS"){const _t=at;at=document.createElement("div"),at.classList.add("annotationContent",this.editorType),_t.before(at)}return at}resetAnnotationElement(Z){const{firstChild:at}=Z.container;at.nodeName==="DIV"&&at.classList.contains("annotationContent")&&at.remove()}};let d=Pt;w=new WeakMap,E=new WeakMap,C=new WeakMap,B=new WeakMap,I=new WeakMap,rt=new WeakMap,tt=new WeakMap,st=new WeakMap,wt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,ge=new WeakMap,Ae=new WeakMap,Ve=new WeakSet,Uu=function([Z,at],_t,vt){[_t,vt]=this.screenToPageTranslation(_t,vt),this.x+=_t/Z,this.y+=vt/at,this.fixAndSetPosition()},lt=new WeakSet,Gu=function(Z,at,_t){switch(_t){case 90:return[at,-Z];case 180:return[-Z,-at];case 270:return[-at,Z];default:return[Z,at]}},Wt=new WeakSet,ju=function(Z){switch(Z){case 90:{const[at,_t]=this.pageDimensions;return[0,-at/_t,_t/at,0]}case 180:return[-1,0,0,-1];case 270:{const[at,_t]=this.pageDimensions;return[0,at/_t,-_t/at,0]}default:return[1,0,0,1]}},ie=new WeakSet,K0=function(){if(l(this,I))return;J(this,I,document.createElement("div")),l(this,I).classList.add("resizers");const Z=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const at of Z){const _t=document.createElement("div");l(this,I).append(_t),_t.classList.add("resizer",at),_t.setAttribute("data-resizer-name",at),_t.addEventListener("pointerdown",Y(this,_e,X0).bind(this,at)),_t.addEventListener("contextmenu",o.noContextMenu),_t.tabIndex=-1}this.div.prepend(l(this,I))},_e=new WeakSet,X0=function(Z,at){var Pe;at.preventDefault();const{isMac:_t}=a.FeatureTest.platform;if(at.button!==0||at.ctrlKey&&_t)return;(Pe=l(this,E))==null||Pe.toggle(!1);const vt=Y(this,D,Wu).bind(this,Z),jt=this._isDraggable;this._isDraggable=!1;const bt={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",vt,bt),window.addEventListener("contextmenu",o.noContextMenu);const q=this.x,ot=this.y,ft=this.width,Et=this.height,Kt=this.parent.div.style.cursor,te=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(at.target).cursor;const me=()=>{var Ti;this.parent.togglePointerEvents(!0),(Ti=l(this,E))==null||Ti.toggle(!0),this._isDraggable=jt,window.removeEventListener("pointerup",me),window.removeEventListener("blur",me),window.removeEventListener("pointermove",vt,bt),window.removeEventListener("contextmenu",o.noContextMenu),this.parent.div.style.cursor=Kt,this.div.style.cursor=te,Y(this,T,Vu).call(this,q,ot,ft,Et)};window.addEventListener("pointerup",me),window.addEventListener("blur",me)},T=new WeakSet,Vu=function(Z,at,_t,vt){const jt=this.x,bt=this.y,q=this.width,ot=this.height;jt===Z&&bt===at&&q===_t&&ot===vt||this.addCommands({cmd:()=>{this.width=q,this.height=ot,this.x=jt,this.y=bt;const[ft,Et]=this.parentDimensions;this.setDims(ft*q,Et*ot),this.fixAndSetPosition()},undo:()=>{this.width=_t,this.height=vt,this.x=Z,this.y=at;const[ft,Et]=this.parentDimensions;this.setDims(ft*_t,Et*vt),this.fixAndSetPosition()},mustExec:!0})},D=new WeakSet,Wu=function(Z,at){const[_t,vt]=this.parentDimensions,jt=this.x,bt=this.y,q=this.width,ot=this.height,ft=Pt.MIN_SIZE/_t,Et=Pt.MIN_SIZE/vt,Kt=$t=>Math.round($t*1e4)/1e4,te=Y(this,Wt,ju).call(this,this.rotation),me=($t,ne)=>[te[0]*$t+te[2]*ne,te[1]*$t+te[3]*ne],Pe=Y(this,Wt,ju).call(this,360-this.rotation),Ti=($t,ne)=>[Pe[0]*$t+Pe[2]*ne,Pe[1]*$t+Pe[3]*ne];let je,hi,ze=!1,vi=!1;switch(Z){case"topLeft":ze=!0,je=($t,ne)=>[0,0],hi=($t,ne)=>[$t,ne];break;case"topMiddle":je=($t,ne)=>[$t/2,0],hi=($t,ne)=>[$t/2,ne];break;case"topRight":ze=!0,je=($t,ne)=>[$t,0],hi=($t,ne)=>[0,ne];break;case"middleRight":vi=!0,je=($t,ne)=>[$t,ne/2],hi=($t,ne)=>[0,ne/2];break;case"bottomRight":ze=!0,je=($t,ne)=>[$t,ne],hi=($t,ne)=>[0,0];break;case"bottomMiddle":je=($t,ne)=>[$t/2,ne],hi=($t,ne)=>[$t/2,0];break;case"bottomLeft":ze=!0,je=($t,ne)=>[0,ne],hi=($t,ne)=>[$t,0];break;case"middleLeft":vi=!0,je=($t,ne)=>[0,ne/2],hi=($t,ne)=>[$t,ne/2];break}const oi=je(q,ot),er=hi(q,ot);let bi=me(...er);const Me=Kt(jt+bi[0]),Q=Kt(bt+bi[1]);let K=1,ht=1,[xt,St]=this.screenToPageTranslation(at.movementX,at.movementY);if([xt,St]=Ti(xt/_t,St/vt),ze){const $t=Math.hypot(q,ot);K=ht=Math.max(Math.min(Math.hypot(er[0]-oi[0]-xt,er[1]-oi[1]-St)/$t,1/q,1/ot),ft/q,Et/ot)}else vi?K=Math.max(ft,Math.min(1,Math.abs(er[0]-oi[0]-xt)))/q:ht=Math.max(Et,Math.min(1,Math.abs(er[1]-oi[1]-St)))/ot;const It=Kt(q*K),Ot=Kt(ot*ht);bi=me(...hi(It,Ot));const ye=Me-bi[0],le=Q-bi[1];this.width=It,this.height=Ot,this.x=ye,this.y=le,this.setDims(_t*It,vt*Ot),this.fixAndSetPosition()},L=new WeakSet,$u=function(Z){const{isMac:at}=a.FeatureTest.platform;Z.ctrlKey&&!at||Z.shiftKey||Z.metaKey&&at?this.parent.toggleSelected(this):this.parent.setSelected(this)},j=new WeakSet,Y0=function(Z){const at=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let _t,vt;at&&(this.div.classList.add("moving"),_t={passive:!0,capture:!0},J(this,zt,Z.clientX),J(this,Jt,Z.clientY),vt=bt=>{const{clientX:q,clientY:ot}=bt,[ft,Et]=this.screenToPageTranslation(q-l(this,zt),ot-l(this,Jt));J(this,zt,q),J(this,Jt,ot),this._uiManager.dragSelectedEditors(ft,Et)},window.addEventListener("pointermove",vt,_t));const jt=()=>{window.removeEventListener("pointerup",jt),window.removeEventListener("blur",jt),at&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",vt,_t)),J(this,Tt,!1),this._uiManager.endDragSession()||Y(this,L,$u).call(this,Z)};window.addEventListener("pointerup",jt),window.addEventListener("blur",jt)},W=new WeakSet,q0=function(Z){Pt._resizerKeyboardManager.exec(this,Z)},O=new WeakSet,Q0=function(Z){var at;l(this,Dt)&&((at=Z.relatedTarget)==null?void 0:at.parentNode)!==l(this,I)&&Y(this,Nt,$o).call(this)},et=new WeakSet,Z0=function(Z){J(this,dt,l(this,Dt)?Z:"")},gt=new WeakSet,Ku=function(Z){if(l(this,w))for(const at of l(this,w))at.tabIndex=Z},Nt=new WeakSet,$o=function(){if(J(this,Dt,!1),Y(this,gt,Ku).call(this,-1),l(this,rt)){const{savedX:Z,savedY:at,savedWidth:_t,savedHeight:vt}=l(this,rt);Y(this,T,Vu).call(this,Z,at,_t,vt),J(this,rt,null)}},N(d,lt),ti(d,"_borderLineWidth",-1),ti(d,"_colorManager",new n.ColorManager),ti(d,"_zIndex",1),ti(d,"_telemetryTimeout",1e3);class f extends d{constructor(Z){super(Z),this.annotationElementId=Z.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(r,t,s)=>{var f,m,S,_,J0,b,lc,A,t1,M,e1,w,Xu,C,B,I,rt,tt,st,wt,dt,Tt,Lt,Qt,ct,Dt,ee,zt,Jt,oe,ge,Ae,Yu,lt,Ft,Wt,ve,ie,xe,_e,ut,Ko,R,Xo,H,i1;s.d(t,{FreeOutliner:()=>u,Outliner:()=>a});var n=s(292);class a{constructor(j,G=0,W=0,U=!0){N(this,_);N(this,b);N(this,A);N(this,M);N(this,w);N(this,f,void 0);N(this,m,[]);N(this,S,[]);let O=1/0,z=-1/0,et=1/0,nt=-1/0;const gt=10**-4;for(const{x:at,y:_t,width:vt,height:jt}of j){const bt=Math.floor((at-G)/gt)*gt,q=Math.ceil((at+vt+G)/gt)*gt,ot=Math.floor((_t-G)/gt)*gt,ft=Math.ceil((_t+jt+G)/gt)*gt,Et=[bt,ot,ft,!0],Kt=[q,ot,ft,!1];l(this,m).push(Et,Kt),O=Math.min(O,bt),z=Math.max(z,q),et=Math.min(et,ot),nt=Math.max(nt,ft)}const yt=z-O+2*W,Nt=nt-et+2*W,Ht=O-W,Pt=et-W,Bt=l(this,m).at(U?-1:-2),Z=[Bt[0],Bt[2]];for(const at of l(this,m)){const[_t,vt,jt]=at;at[0]=(_t-Ht)/yt,at[1]=(vt-Pt)/Nt,at[2]=(jt-Pt)/Nt}J(this,f,{x:Ht,y:Pt,width:yt,height:Nt,lastPoint:Z})}getOutlines(){l(this,m).sort((G,W)=>G[0]-W[0]||G[1]-W[1]||G[2]-W[2]);const j=[];for(const G of l(this,m))G[3]?(j.push(...Y(this,w,Xu).call(this,G)),Y(this,A,t1).call(this,G)):(Y(this,M,e1).call(this,G),j.push(...Y(this,w,Xu).call(this,G)));return Y(this,_,J0).call(this,j)}}f=new WeakMap,m=new WeakMap,S=new WeakMap,_=new WeakSet,J0=function(j){const G=[],W=new Set;for(const z of j){const[et,nt,gt]=z;G.push([et,nt,z],[et,gt,z])}G.sort((z,et)=>z[1]-et[1]||z[0]-et[0]);for(let z=0,et=G.length;z<et;z+=2){const nt=G[z][2],gt=G[z+1][2];nt.push(gt),gt.push(nt),W.add(nt),W.add(gt)}const U=[];let O;for(;W.size>0;){const z=W.values().next().value;let[et,nt,gt,yt,Nt]=z;W.delete(z);let Ht=et,Pt=nt;for(O=[et,gt],U.push(O);;){let Bt;if(W.has(yt))Bt=yt;else if(W.has(Nt))Bt=Nt;else break;W.delete(Bt),[et,nt,gt,yt,Nt]=Bt,Ht!==et&&(O.push(Ht,Pt,et,Pt===nt?nt:gt),Ht=et),Pt=Pt===nt?gt:nt}O.push(Ht,Pt)}return new c(U,l(this,f))},b=new WeakSet,lc=function(j){const G=l(this,S);let W=0,U=G.length-1;for(;W<=U;){const O=W+U>>1,z=G[O][0];if(z===j)return O;z<j?W=O+1:U=O-1}return U+1},A=new WeakSet,t1=function([,j,G]){const W=Y(this,b,lc).call(this,j);l(this,S).splice(W,0,[j,G])},M=new WeakSet,e1=function([,j,G]){const W=Y(this,b,lc).call(this,j);for(let U=W;U<l(this,S).length;U++){const[O,z]=l(this,S)[U];if(O!==j)break;if(O===j&&z===G){l(this,S).splice(U,1);return}}for(let U=W-1;U>=0;U--){const[O,z]=l(this,S)[U];if(O!==j)break;if(O===j&&z===G){l(this,S).splice(U,1);return}}},w=new WeakSet,Xu=function(j){const[G,W,U]=j,O=[[G,W,U]],z=Y(this,b,lc).call(this,U);for(let et=0;et<z;et++){const[nt,gt]=l(this,S)[et];for(let yt=0,Nt=O.length;yt<Nt;yt++){const[,Ht,Pt]=O[yt];if(!(gt<=Ht||Pt<=nt)){if(Ht>=nt){if(Pt>gt)O[yt][1]=gt;else{if(Nt===1)return[];O.splice(yt,1),yt--,Nt--}continue}O[yt][2]=nt,Pt>gt&&O.push([G,gt,Pt])}}}return O};class o{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(j,G){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof d}}class c extends o{constructor(G,W){super();N(this,C,void 0);N(this,B,void 0);J(this,B,G),J(this,C,W)}toSVGPath(){const G=[];for(const W of l(this,B)){let[U,O]=W;G.push(`M${U} ${O}`);for(let z=2;z<W.length;z+=2){const et=W[z],nt=W[z+1];et===U?(G.push(`V${nt}`),O=nt):nt===O&&(G.push(`H${et}`),U=et)}G.push("Z")}return G.join(" ")}serialize([G,W,U,O],z){const et=[],nt=U-G,gt=O-W;for(const yt of l(this,B)){const Nt=new Array(yt.length);for(let Ht=0;Ht<yt.length;Ht+=2)Nt[Ht]=G+yt[Ht]*nt,Nt[Ht+1]=O-yt[Ht+1]*gt;et.push(Nt)}return et}get box(){return l(this,C)}}C=new WeakMap,B=new WeakMap;const Gt=class{constructor({x:j,y:G},W,U,O,z,et=0){N(this,Ae);N(this,I,void 0);N(this,rt,[]);N(this,tt,void 0);N(this,st,void 0);N(this,wt,[]);N(this,dt,new Float64Array(18));N(this,Tt,void 0);N(this,Lt,void 0);N(this,Qt,void 0);N(this,ct,void 0);N(this,Dt,void 0);N(this,ee,void 0);N(this,zt,[]);J(this,I,W),J(this,ee,O*U),J(this,st,z),l(this,dt).set([NaN,NaN,NaN,NaN,j,G],6),J(this,tt,et),J(this,ct,l(Gt,Jt)*U),J(this,Qt,l(Gt,ge)*U),J(this,Dt,U),l(this,zt).push(j,G)}get free(){return!0}isEmpty(){return isNaN(l(this,dt)[8])}add({x:j,y:G}){var Et;J(this,Tt,j),J(this,Lt,G);const[W,U,O,z]=l(this,I);let[et,nt,gt,yt]=l(this,dt).subarray(8,12);const Nt=j-gt,Ht=G-yt,Pt=Math.hypot(Nt,Ht);if(Pt<l(this,Qt))return!1;const Bt=Pt-l(this,ct),Z=Bt/Pt,at=Z*Nt,_t=Z*Ht;let vt=et,jt=nt;et=gt,nt=yt,gt+=at,yt+=_t,(Et=l(this,zt))==null||Et.push(j,G);const bt=-_t/Bt,q=at/Bt,ot=bt*l(this,ee),ft=q*l(this,ee);return l(this,dt).set(l(this,dt).subarray(2,8),0),l(this,dt).set([gt+ot,yt+ft],4),l(this,dt).set(l(this,dt).subarray(14,18),12),l(this,dt).set([gt-ot,yt-ft],16),isNaN(l(this,dt)[6])?(l(this,wt).length===0&&(l(this,dt).set([et+ot,nt+ft],2),l(this,wt).push(NaN,NaN,NaN,NaN,(et+ot-W)/O,(nt+ft-U)/z),l(this,dt).set([et-ot,nt-ft],14),l(this,rt).push(NaN,NaN,NaN,NaN,(et-ot-W)/O,(nt-ft-U)/z)),l(this,dt).set([vt,jt,et,nt,gt,yt],6),!this.isEmpty()):(l(this,dt).set([vt,jt,et,nt,gt,yt],6),Math.abs(Math.atan2(jt-nt,vt-et)-Math.atan2(_t,at))<Math.PI/2?([et,nt,gt,yt]=l(this,dt).subarray(2,6),l(this,wt).push(NaN,NaN,NaN,NaN,((et+gt)/2-W)/O,((nt+yt)/2-U)/z),[et,nt,vt,jt]=l(this,dt).subarray(14,18),l(this,rt).push(NaN,NaN,NaN,NaN,((vt+et)/2-W)/O,((jt+nt)/2-U)/z),!0):([vt,jt,et,nt,gt,yt]=l(this,dt).subarray(0,6),l(this,wt).push(((vt+5*et)/6-W)/O,((jt+5*nt)/6-U)/z,((5*et+gt)/6-W)/O,((5*nt+yt)/6-U)/z,((et+gt)/2-W)/O,((nt+yt)/2-U)/z),[gt,yt,et,nt,vt,jt]=l(this,dt).subarray(12,18),l(this,rt).push(((vt+5*et)/6-W)/O,((jt+5*nt)/6-U)/z,((5*et+gt)/6-W)/O,((5*nt+yt)/6-U)/z,((et+gt)/2-W)/O,((nt+yt)/2-U)/z),!0))}toSVGPath(){if(this.isEmpty())return"";const j=l(this,wt),G=l(this,rt),W=l(this,dt).subarray(4,6),U=l(this,dt).subarray(16,18),[O,z,et,nt]=l(this,I),[gt,yt,Nt,Ht]=Y(this,Ae,Yu).call(this);if(isNaN(l(this,dt)[6])&&!this.isEmpty())return`M${(l(this,dt)[2]-O)/et} ${(l(this,dt)[3]-z)/nt} L${(l(this,dt)[4]-O)/et} ${(l(this,dt)[5]-z)/nt} L${gt} ${yt} L${Nt} ${Ht} L${(l(this,dt)[16]-O)/et} ${(l(this,dt)[17]-z)/nt} L${(l(this,dt)[14]-O)/et} ${(l(this,dt)[15]-z)/nt} Z`;const Pt=[];Pt.push(`M${j[4]} ${j[5]}`);for(let Bt=6;Bt<j.length;Bt+=6)isNaN(j[Bt])?Pt.push(`L${j[Bt+4]} ${j[Bt+5]}`):Pt.push(`C${j[Bt]} ${j[Bt+1]} ${j[Bt+2]} ${j[Bt+3]} ${j[Bt+4]} ${j[Bt+5]}`);Pt.push(`L${(W[0]-O)/et} ${(W[1]-z)/nt} L${gt} ${yt} L${Nt} ${Ht} L${(U[0]-O)/et} ${(U[1]-z)/nt}`);for(let Bt=G.length-6;Bt>=6;Bt-=6)isNaN(G[Bt])?Pt.push(`L${G[Bt+4]} ${G[Bt+5]}`):Pt.push(`C${G[Bt]} ${G[Bt+1]} ${G[Bt+2]} ${G[Bt+3]} ${G[Bt+4]} ${G[Bt+5]}`);return Pt.push(`L${G[4]} ${G[5]} Z`),Pt.join(" ")}getOutlines(){var _t;const j=l(this,wt),G=l(this,rt),W=l(this,dt),U=W.subarray(4,6),O=W.subarray(16,18),[z,et,nt,gt]=l(this,I),yt=new Float64Array((((_t=l(this,zt))==null?void 0:_t.length)??0)+2);for(let vt=0,jt=yt.length-2;vt<jt;vt+=2)yt[vt]=(l(this,zt)[vt]-z)/nt,yt[vt+1]=(l(this,zt)[vt+1]-et)/gt;yt[yt.length-2]=(l(this,Tt)-z)/nt,yt[yt.length-1]=(l(this,Lt)-et)/gt;const[Nt,Ht,Pt,Bt]=Y(this,Ae,Yu).call(this);if(isNaN(W[6])&&!this.isEmpty()){const vt=new Float64Array(36);return vt.set([NaN,NaN,NaN,NaN,(W[2]-z)/nt,(W[3]-et)/gt,NaN,NaN,NaN,NaN,(W[4]-z)/nt,(W[5]-et)/gt,NaN,NaN,NaN,NaN,Nt,Ht,NaN,NaN,NaN,NaN,Pt,Bt,NaN,NaN,NaN,NaN,(W[16]-z)/nt,(W[17]-et)/gt,NaN,NaN,NaN,NaN,(W[14]-z)/nt,(W[15]-et)/gt],0),new d(vt,yt,l(this,I),l(this,Dt),l(this,tt),l(this,st))}const Z=new Float64Array(l(this,wt).length+24+l(this,rt).length);let at=j.length;for(let vt=0;vt<at;vt+=2){if(isNaN(j[vt])){Z[vt]=Z[vt+1]=NaN;continue}Z[vt]=j[vt],Z[vt+1]=j[vt+1]}Z.set([NaN,NaN,NaN,NaN,(U[0]-z)/nt,(U[1]-et)/gt,NaN,NaN,NaN,NaN,Nt,Ht,NaN,NaN,NaN,NaN,Pt,Bt,NaN,NaN,NaN,NaN,(O[0]-z)/nt,(O[1]-et)/gt],at),at+=24;for(let vt=G.length-6;vt>=6;vt-=6)for(let jt=0;jt<6;jt+=2){if(isNaN(G[vt+jt])){Z[at]=Z[at+1]=NaN,at+=2;continue}Z[at]=G[vt+jt],Z[at+1]=G[vt+jt+1],at+=2}return Z.set([NaN,NaN,NaN,NaN,G[4],G[5]],at),new d(Z,yt,l(this,I),l(this,Dt),l(this,tt),l(this,st))}};let u=Gt;I=new WeakMap,rt=new WeakMap,tt=new WeakMap,st=new WeakMap,wt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,ge=new WeakMap,Ae=new WeakSet,Yu=function(){const j=l(this,dt).subarray(4,6),G=l(this,dt).subarray(16,18),[W,U,O,z]=l(this,I);return[(l(this,Tt)+(j[0]-G[0])/2-W)/O,(l(this,Lt)+(j[1]-G[1])/2-U)/z,(l(this,Tt)+(G[0]-j[0])/2-W)/O,(l(this,Lt)+(G[1]-j[1])/2-U)/z]},N(u,Jt,8),N(u,oe,2),N(u,ge,l(Gt,Jt)+l(Gt,oe));class d extends o{constructor(G,W,U,O,z,et){super();N(this,ut);N(this,R);N(this,H);N(this,lt,void 0);N(this,Ft,null);N(this,Wt,void 0);N(this,ve,void 0);N(this,ie,void 0);N(this,xe,void 0);N(this,_e,void 0);J(this,_e,G),J(this,ie,W),J(this,lt,U),J(this,xe,O),J(this,Wt,z),J(this,ve,et),Y(this,H,i1).call(this,et);const{x:nt,y:gt,width:yt,height:Nt}=l(this,Ft);for(let Ht=0,Pt=G.length;Ht<Pt;Ht+=2)G[Ht]=(G[Ht]-nt)/yt,G[Ht+1]=(G[Ht+1]-gt)/Nt;for(let Ht=0,Pt=W.length;Ht<Pt;Ht+=2)W[Ht]=(W[Ht]-nt)/yt,W[Ht+1]=(W[Ht+1]-gt)/Nt}toSVGPath(){const G=[`M${l(this,_e)[4]} ${l(this,_e)[5]}`];for(let W=6,U=l(this,_e).length;W<U;W+=6){if(isNaN(l(this,_e)[W])){G.push(`L${l(this,_e)[W+4]} ${l(this,_e)[W+5]}`);continue}G.push(`C${l(this,_e)[W]} ${l(this,_e)[W+1]} ${l(this,_e)[W+2]} ${l(this,_e)[W+3]} ${l(this,_e)[W+4]} ${l(this,_e)[W+5]}`)}return G.push("Z"),G.join(" ")}serialize([G,W,U,O],z){const et=U-G,nt=O-W;let gt,yt;switch(z){case 0:gt=Y(this,ut,Ko).call(this,l(this,_e),G,O,et,-nt),yt=Y(this,ut,Ko).call(this,l(this,ie),G,O,et,-nt);break;case 90:gt=Y(this,R,Xo).call(this,l(this,_e),G,W,et,nt),yt=Y(this,R,Xo).call(this,l(this,ie),G,W,et,nt);break;case 180:gt=Y(this,ut,Ko).call(this,l(this,_e),U,W,-et,nt),yt=Y(this,ut,Ko).call(this,l(this,ie),U,W,-et,nt);break;case 270:gt=Y(this,R,Xo).call(this,l(this,_e),U,O,-et,-nt),yt=Y(this,R,Xo).call(this,l(this,ie),U,O,-et,-nt);break}return{outline:Array.from(gt),points:[Array.from(yt)]}}get box(){return l(this,Ft)}getNewOutline(G,W){const{x:U,y:O,width:z,height:et}=l(this,Ft),[nt,gt,yt,Nt]=l(this,lt),Ht=z*yt,Pt=et*Nt,Bt=U*yt+nt,Z=O*Nt+gt,at=new u({x:l(this,ie)[0]*Ht+Bt,y:l(this,ie)[1]*Pt+Z},l(this,lt),l(this,xe),G,l(this,ve),W??l(this,Wt));for(let _t=2;_t<l(this,ie).length;_t+=2)at.add({x:l(this,ie)[_t]*Ht+Bt,y:l(this,ie)[_t+1]*Pt+Z});return at.getOutlines()}}lt=new WeakMap,Ft=new WeakMap,Wt=new WeakMap,ve=new WeakMap,ie=new WeakMap,xe=new WeakMap,_e=new WeakMap,ut=new WeakSet,Ko=function(G,W,U,O,z){const et=new Float64Array(G.length);for(let nt=0,gt=G.length;nt<gt;nt+=2)et[nt]=W+G[nt]*O,et[nt+1]=U+G[nt+1]*z;return et},R=new WeakSet,Xo=function(G,W,U,O,z){const et=new Float64Array(G.length);for(let nt=0,gt=G.length;nt<gt;nt+=2)et[nt]=W+G[nt+1]*O,et[nt+1]=U+G[nt]*z;return et},H=new WeakSet,i1=function(G){const W=l(this,_e);let U=W[4],O=W[5],z=U,et=O,nt=U,gt=O,yt=U,Nt=O;const Ht=G?Math.max:Math.min;for(let _t=6,vt=W.length;_t<vt;_t+=6){if(isNaN(W[_t]))z=Math.min(z,W[_t+4]),et=Math.min(et,W[_t+5]),nt=Math.max(nt,W[_t+4]),gt=Math.max(gt,W[_t+5]),Nt<W[_t+5]?(yt=W[_t+4],Nt=W[_t+5]):Nt===W[_t+5]&&(yt=Ht(yt,W[_t+4]));else{const jt=n.Util.bezierBoundingBox(U,O,...W.slice(_t,_t+6));z=Math.min(z,jt[0]),et=Math.min(et,jt[1]),nt=Math.max(nt,jt[2]),gt=Math.max(gt,jt[3]),Nt<jt[3]?(yt=jt[2],Nt=jt[3]):Nt===jt[3]&&(yt=Ht(yt,jt[2]))}U=W[_t+4],O=W[_t+5]}const Pt=z-l(this,Wt),Bt=et-l(this,Wt),Z=nt-z+2*l(this,Wt),at=gt-et+2*l(this,Wt);J(this,Ft,{x:Pt,y:Bt,width:Z,height:at,lastPoint:[yt,Nt]})}},362:(r,t,s)=>{var c,u,d,f,m,r1,_,n1,b,s1,A,hc,M,a1,w,qu,B,I,rt,tt,o1,wt,l1,Tt,h1;s.d(t,{EditorToolbar:()=>a,HighlightToolbar:()=>o});var n=s(419);const C=class{constructor(ct){N(this,_);N(this,b);N(this,A);N(this,M);N(this,w);N(this,c,null);N(this,u,null);N(this,d,void 0);N(this,f,null);J(this,d,ct)}render(){const ct=J(this,c,document.createElement("div"));ct.className="editToolbar",ct.setAttribute("role","toolbar"),ct.addEventListener("contextmenu",n.noContextMenu),ct.addEventListener("pointerdown",Y(C,m,r1));const Dt=J(this,f,document.createElement("div"));Dt.className="buttons",ct.append(Dt);const ee=l(this,d).toolbarPosition;if(ee){const{style:zt}=ct,Jt=l(this,d)._uiManager.direction==="ltr"?1-ee[0]:ee[0];zt.insetInlineEnd=`${100*Jt}%`,zt.top=`calc(${100*ee[1]}% + var(--editor-toolbar-vert-offset))`}return Y(this,M,a1).call(this),ct}hide(){var ct;l(this,c).classList.add("hidden"),(ct=l(this,u))==null||ct.hideDropdown()}show(){l(this,c).classList.remove("hidden")}addAltTextButton(ct){Y(this,A,hc).call(this,ct),l(this,f).prepend(ct,l(this,w,qu))}addColorPicker(ct){J(this,u,ct);const Dt=ct.renderButton();Y(this,A,hc).call(this,Dt),l(this,f).prepend(Dt,l(this,w,qu))}remove(){var ct;l(this,c).remove(),(ct=l(this,u))==null||ct.destroy(),J(this,u,null)}};let a=C;c=new WeakMap,u=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakSet,r1=function(ct){ct.stopPropagation()},_=new WeakSet,n1=function(ct){l(this,d)._focusEventsAllowed=!1,ct.preventDefault(),ct.stopPropagation()},b=new WeakSet,s1=function(ct){l(this,d)._focusEventsAllowed=!0,ct.preventDefault(),ct.stopPropagation()},A=new WeakSet,hc=function(ct){ct.addEventListener("focusin",Y(this,_,n1).bind(this),{capture:!0}),ct.addEventListener("focusout",Y(this,b,s1).bind(this),{capture:!0}),ct.addEventListener("contextmenu",n.noContextMenu)},M=new WeakSet,a1=function(){const ct=document.createElement("button");ct.className="delete",ct.tabIndex=0,ct.setAttribute("data-l10n-id",`pdfjs-editor-remove-${l(this,d).editorType}-button`),Y(this,A,hc).call(this,ct),ct.addEventListener("click",Dt=>{l(this,d)._uiManager.delete()}),l(this,f).append(ct)},w=new WeakSet,qu=function(){const ct=document.createElement("div");return ct.className="divider",ct},N(a,m);class o{constructor(ct){N(this,tt);N(this,wt);N(this,Tt);N(this,B,null);N(this,I,null);N(this,rt,void 0);J(this,rt,ct)}show(ct,Dt,ee){const[zt,Jt]=Y(this,wt,l1).call(this,Dt,ee),{style:oe}=l(this,I)||J(this,I,Y(this,tt,o1).call(this));ct.append(l(this,I)),oe.insetInlineEnd=`${100*zt}%`,oe.top=`calc(${100*Jt}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,I).remove()}}B=new WeakMap,I=new WeakMap,rt=new WeakMap,tt=new WeakSet,o1=function(){const ct=J(this,I,document.createElement("div"));ct.className="editToolbar",ct.setAttribute("role","toolbar"),ct.addEventListener("contextmenu",n.noContextMenu);const Dt=J(this,B,document.createElement("div"));return Dt.className="buttons",ct.append(Dt),Y(this,Tt,h1).call(this),ct},wt=new WeakSet,l1=function(ct,Dt){let ee=0,zt=0;for(const Jt of ct){const oe=Jt.y+Jt.height;if(oe<ee)continue;const ge=Jt.x+(Dt?Jt.width:0);if(oe>ee){zt=ge,ee=oe;continue}Dt?ge>zt&&(zt=ge):ge<zt&&(zt=ge)}return[Dt?1-zt:zt,ee]},Tt=new WeakSet,h1=function(){const ct=document.createElement("button");ct.className="highlightButton",ct.tabIndex=0,ct.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const Dt=document.createElement("span");ct.append(Dt),Dt.className="visuallyHidden",Dt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),ct.addEventListener("contextmenu",n.noContextMenu),ct.addEventListener("click",()=>{l(this,rt).highlightSelection("floating_button")}),l(this,B).append(ct)}},830:(r,t,s)=>{var b,x,A,F,M,Qu,E,C,B,I,rt,c1,wt,dt,Tt,Lt,Qt,ct,Dt,ee,zt,Jt,oe,ge,Ae,Ve,Gt,lt,Ft,Wt,ve,ie,xe,_e,ut,T,R,D,H,L,V,j,G,W,U,O,z,et,nt,gt,yt,Nt,Ht,Pt,Bt,Z,at,_t,vt,cc,bt,d1,ot,u1,Et,dc,te,f1,Pe,p1,je,g1,ze,Zu,oi,Ju,bi,tf,Q,ef,ht,rf,St,Yr,Ot,Xs,le,m1,ne,v1,he,nf,we,y1,Ue,Yo,ei,sf;s.d(t,{AnnotationEditorUIManager:()=>v,ColorManager:()=>_,KeyboardManager:()=>S,bindEvents:()=>c,opacityToHex:()=>u});var n=s(292),a=s(419),o=s(362);function c(qe,$,At){for(const Zt of At)$.addEventListener(Zt,qe[Zt].bind(qe))}function u(qe){return Math.round(Math.min(255,Math.max(1,255*qe))).toString(16).padStart(2,"0")}class d{constructor(){N(this,b,0)}get id(){return`${n.AnnotationEditorPrefix}${ws(this,b)._++}`}}b=new WeakMap;const w=class{constructor(){N(this,M);N(this,x,(0,n.getUuid)());N(this,A,0);N(this,F,null)}static get _isSVGFittingCanvas(){const $='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',At=new OffscreenCanvas(1,3).getContext("2d"),Zt=new Image;Zt.src=$;const ae=Zt.decode().then(()=>(At.drawImage(Zt,0,0,1,1,0,0,1,3),new Uint32Array(At.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",ae)}async getFromFile($){const{lastModified:At,name:Zt,size:ae,type:de}=$;return Y(this,M,Qu).call(this,`${At}_${Zt}_${ae}_${de}`,$)}async getFromUrl($){return Y(this,M,Qu).call(this,$,$)}async getFromId($){l(this,F)||J(this,F,new Map);const At=l(this,F).get($);return At?At.bitmap?(At.refCounter+=1,At):At.file?this.getFromFile(At.file):this.getFromUrl(At.url):null}getSvgUrl($){const At=l(this,F).get($);return At!=null&&At.isSvg?At.svgUrl:null}deleteId($){l(this,F)||J(this,F,new Map);const At=l(this,F).get($);!At||(At.refCounter-=1,At.refCounter===0&&(At.bitmap=null))}isValidId($){return $.startsWith(`image_${l(this,x)}_`)}};let f=w;x=new WeakMap,A=new WeakMap,F=new WeakMap,M=new WeakSet,Qu=async function($,At){l(this,F)||J(this,F,new Map);let Zt=l(this,F).get($);if(Zt===null)return null;if(Zt!=null&&Zt.bitmap)return Zt.refCounter+=1,Zt;try{Zt||(Zt={bitmap:null,id:`image_${l(this,x)}_${ws(this,A)._++}`,refCounter:0,isSvg:!1});let ae;if(typeof At=="string"?(Zt.url=At,ae=await(0,a.fetchData)(At,"blob")):ae=Zt.file=At,ae.type==="image/svg+xml"){const de=w._isSVGFittingCanvas,Ce=new FileReader,Se=new Image,ri=new Promise((ci,vr)=>{Se.onload=()=>{Zt.bitmap=Se,Zt.isSvg=!0,ci()},Ce.onload=async()=>{const Bi=Zt.svgUrl=Ce.result;Se.src=await de?`${Bi}#svgView(preserveAspectRatio(none))`:Bi},Se.onerror=Ce.onerror=vr});Ce.readAsDataURL(ae),await ri}else Zt.bitmap=await createImageBitmap(ae);Zt.refCounter=1}catch(ae){console.error(ae),Zt=null}return l(this,F).set($,Zt),Zt&&l(this,F).set(Zt.id,Zt),Zt};class m{constructor($=128){N(this,E,[]);N(this,C,!1);N(this,B,void 0);N(this,I,-1);J(this,B,$)}add({cmd:$,undo:At,post:Zt,mustExec:ae,type:de=NaN,overwriteIfSameType:Ce=!1,keepUndo:Se=!1}){if(ae&&$(),l(this,C))return;const ri={cmd:$,undo:At,post:Zt,type:de};if(l(this,I)===-1){l(this,E).length>0&&(l(this,E).length=0),J(this,I,0),l(this,E).push(ri);return}if(Ce&&l(this,E)[l(this,I)].type===de){Se&&(ri.undo=l(this,E)[l(this,I)].undo),l(this,E)[l(this,I)]=ri;return}const ci=l(this,I)+1;ci===l(this,B)?l(this,E).splice(0,1):(J(this,I,ci),ci<l(this,E).length&&l(this,E).splice(ci)),l(this,E).push(ri)}undo(){if(l(this,I)===-1)return;J(this,C,!0);const{undo:$,post:At}=l(this,E)[l(this,I)];$(),At==null||At(),J(this,C,!1),J(this,I,l(this,I)-1)}redo(){if(l(this,I)<l(this,E).length-1){J(this,I,l(this,I)+1),J(this,C,!0);const{cmd:$,post:At}=l(this,E)[l(this,I)];$(),At==null||At(),J(this,C,!1)}}hasSomethingToUndo(){return l(this,I)!==-1}hasSomethingToRedo(){return l(this,I)<l(this,E).length-1}destroy(){J(this,E,null)}}E=new WeakMap,C=new WeakMap,B=new WeakMap,I=new WeakMap;class S{constructor($){N(this,rt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:At}=n.FeatureTest.platform;for(const[Zt,ae,de={}]of $)for(const Ce of Zt){const Se=Ce.startsWith("mac+");At&&Se?(this.callbacks.set(Ce.slice(4),{callback:ae,options:de}),this.allKeys.add(Ce.split("+").at(-1))):!At&&!Se&&(this.callbacks.set(Ce,{callback:ae,options:de}),this.allKeys.add(Ce.split("+").at(-1)))}}exec($,At){if(!this.allKeys.has(At.key))return;const Zt=this.callbacks.get(Y(this,rt,c1).call(this,At));if(!Zt)return;const{callback:ae,options:{bubbles:de=!1,args:Ce=[],checker:Se=null}}=Zt;Se&&!Se($,At)||(ae.bind($,...Ce,At)(),de||(At.stopPropagation(),At.preventDefault()))}}rt=new WeakSet,c1=function($){$.altKey&&this.buffer.push("alt"),$.ctrlKey&&this.buffer.push("ctrl"),$.metaKey&&this.buffer.push("meta"),$.shiftKey&&this.buffer.push("shift"),this.buffer.push($.key);const At=this.buffer.join("+");return this.buffer.length=0,At};const st=class{get _colors(){const $=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)($),(0,n.shadow)(this,"_colors",$)}convert($){const At=(0,a.getRGB)($);if(!window.matchMedia("(forced-colors: active)").matches)return At;for(const[Zt,ae]of this._colors)if(ae.every((de,Ce)=>de===At[Ce]))return st._colorsMapping.get(Zt);return At}getHexCode($){const At=this._colors.get($);return At?n.Util.makeHexColor(...At):$}};let _=st;ti(_,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));const Hi=class{constructor($,At,Zt,ae,de,Ce,Se,ri,ci){N(this,vt);N(this,bt);N(this,ot);N(this,Et);N(this,te);N(this,Pe);N(this,je);N(this,ze);N(this,oi);N(this,bi);N(this,Q);N(this,ht);N(this,St);N(this,Ot);N(this,le);N(this,ne);N(this,he);N(this,we);N(this,Ue);N(this,ei);N(this,wt,null);N(this,dt,new Map);N(this,Tt,new Map);N(this,Lt,null);N(this,Qt,null);N(this,ct,null);N(this,Dt,new m);N(this,ee,0);N(this,zt,new Set);N(this,Jt,null);N(this,oe,null);N(this,ge,new Set);N(this,Ae,!1);N(this,Ve,null);N(this,Gt,null);N(this,lt,null);N(this,Ft,!1);N(this,Wt,null);N(this,ve,new d);N(this,ie,!1);N(this,xe,!1);N(this,_e,null);N(this,ut,null);N(this,T,null);N(this,R,n.AnnotationEditorType.NONE);N(this,D,new Set);N(this,H,null);N(this,L,null);N(this,V,null);N(this,j,this.blur.bind(this));N(this,G,this.focus.bind(this));N(this,W,this.copy.bind(this));N(this,U,this.cut.bind(this));N(this,O,this.paste.bind(this));N(this,z,this.keydown.bind(this));N(this,et,this.keyup.bind(this));N(this,nt,this.onEditingAction.bind(this));N(this,gt,this.onPageChanging.bind(this));N(this,yt,this.onScaleChanging.bind(this));N(this,Nt,Y(this,ot,u1).bind(this));N(this,Ht,this.onRotationChanging.bind(this));N(this,Pt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});N(this,Bt,[0,0]);N(this,Z,null);N(this,at,null);N(this,_t,null);J(this,at,$),J(this,_t,At),J(this,Lt,Zt),this._eventBus=ae,this._eventBus._on("editingaction",l(this,nt)),this._eventBus._on("pagechanging",l(this,gt)),this._eventBus._on("scalechanging",l(this,yt)),this._eventBus._on("rotationchanging",l(this,Ht)),Y(this,te,f1).call(this),Y(this,oi,Ju).call(this),J(this,Qt,de.annotationStorage),J(this,Ve,de.filterFactory),J(this,L,Ce),J(this,lt,Se||null),J(this,Ae,ri),J(this,T,ci||null),this.viewParameters={realScale:a.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const $=Hi.prototype,At=Ce=>l(Ce,at).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Ce.hasSomethingToControl(),Zt=(Ce,{target:Se})=>{if(Se instanceof HTMLInputElement){const{type:ri}=Se;return ri!=="text"&&ri!=="number"}return!0},ae=this.TRANSLATE_SMALL,de=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new S([[["ctrl+a","mac+meta+a"],$.selectAll,{checker:Zt}],[["ctrl+z","mac+meta+z"],$.undo,{checker:Zt}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],$.redo,{checker:Zt}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],$.delete,{checker:Zt}],[["Enter","mac+Enter"],$.addNewEditorFromKeyboard,{checker:(Ce,{target:Se})=>!(Se instanceof HTMLButtonElement)&&l(Ce,at).contains(Se)&&!Ce.isEnterHandled}],[[" ","mac+ "],$.addNewEditorFromKeyboard,{checker:(Ce,{target:Se})=>!(Se instanceof HTMLButtonElement)&&l(Ce,at).contains(document.activeElement)}],[["Escape","mac+Escape"],$.unselectAll],[["ArrowLeft","mac+ArrowLeft"],$.translateSelectedEditors,{args:[-ae,0],checker:At}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],$.translateSelectedEditors,{args:[-de,0],checker:At}],[["ArrowRight","mac+ArrowRight"],$.translateSelectedEditors,{args:[ae,0],checker:At}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],$.translateSelectedEditors,{args:[de,0],checker:At}],[["ArrowUp","mac+ArrowUp"],$.translateSelectedEditors,{args:[0,-ae],checker:At}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],$.translateSelectedEditors,{args:[0,-de],checker:At}],[["ArrowDown","mac+ArrowDown"],$.translateSelectedEditors,{args:[0,ae],checker:At}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],$.translateSelectedEditors,{args:[0,de],checker:At}]]))}destroy(){var $,At;Y(this,bi,tf).call(this),Y(this,ze,Zu).call(this),this._eventBus._off("editingaction",l(this,nt)),this._eventBus._off("pagechanging",l(this,gt)),this._eventBus._off("scalechanging",l(this,yt)),this._eventBus._off("rotationchanging",l(this,Ht));for(const Zt of l(this,Tt).values())Zt.destroy();l(this,Tt).clear(),l(this,dt).clear(),l(this,ge).clear(),J(this,wt,null),l(this,D).clear(),l(this,Dt).destroy(),($=l(this,Lt))==null||$.destroy(),(At=l(this,Wt))==null||At.hide(),J(this,Wt,null),l(this,Gt)&&(clearTimeout(l(this,Gt)),J(this,Gt,null)),l(this,Z)&&(clearTimeout(l(this,Z)),J(this,Z,null)),Y(this,Pe,p1).call(this)}async mlGuess($){var At;return((At=l(this,T))==null?void 0:At.guess($))||null}get hasMLManager(){return!!l(this,T)}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",l(this,L)?l(this,Ve).addHCMFilter(l(this,L).foreground,l(this,L).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(l(this,at)).direction)}get highlightColors(){return(0,n.shadow)(this,"highlightColors",l(this,lt)?new Map(l(this,lt).split(",").map($=>$.split("=").map(At=>At.trim()))):null)}get highlightColorNames(){return(0,n.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,$=>$.reverse())):null)}setMainHighlightColorPicker($){J(this,ut,$)}editAltText($){var At;(At=l(this,Lt))==null||At.editAltText(this,$)}onPageChanging({pageNumber:$}){J(this,ee,$-1)}focusMainContainer(){l(this,at).focus()}findParent($,At){for(const Zt of l(this,Tt).values()){const{x:ae,y:de,width:Ce,height:Se}=Zt.div.getBoundingClientRect();if($>=ae&&$<=ae+Ce&&At>=de&&At<=de+Se)return Zt}return null}disableUserSelect($=!1){l(this,_t).classList.toggle("noUserSelect",$)}addShouldRescale($){l(this,ge).add($)}removeShouldRescale($){l(this,ge).delete($)}onScaleChanging({scale:$}){this.commitOrRemove(),this.viewParameters.realScale=$*a.PixelsPerInch.PDF_TO_CSS_UNITS;for(const At of l(this,ge))At.onScaleChanging()}onRotationChanging({pagesRotation:$}){this.commitOrRemove(),this.viewParameters.rotation=$}highlightSelection($=""){const At=document.getSelection();if(!At||At.isCollapsed)return;const{anchorNode:Zt,anchorOffset:ae,focusNode:de,focusOffset:Ce}=At,Se=At.toString(),ri=Y(this,vt,cc).call(this,At).closest(".textLayer"),ci=this.getSelectionBoxes(ri);if(ci){At.empty(),l(this,R)===n.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:n.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const vr of l(this,Tt).values())if(vr.hasTextLayer(ri)){vr.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:$,boxes:ci,anchorNode:Zt,anchorOffset:ae,focusNode:de,focusOffset:Ce,text:Se});break}}}addToAnnotationStorage($){!$.isEmpty()&&l(this,Qt)&&!l(this,Qt).has($.id)&&l(this,Qt).setValue($.id,$)}blur(){if(this.isShiftKeyDown=!1,l(this,Ft)&&(J(this,Ft,!1),Y(this,Et,dc).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:$}=document;for(const At of l(this,D))if(At.div.contains($)){J(this,_e,[At,$]),At._focusEventsAllowed=!1;break}}focus(){if(!l(this,_e))return;const[$,At]=l(this,_e);J(this,_e,null),At.addEventListener("focusin",()=>{$._focusEventsAllowed=!0},{once:!0}),At.focus()}addEditListeners(){Y(this,oi,Ju).call(this),Y(this,Q,ef).call(this)}removeEditListeners(){Y(this,bi,tf).call(this),Y(this,ht,rf).call(this)}copy($){var Zt;if($.preventDefault(),(Zt=l(this,wt))==null||Zt.commitOrRemove(),!this.hasSelection)return;const At=[];for(const ae of l(this,D)){const de=ae.serialize(!0);de&&At.push(de)}At.length!==0&&$.clipboardData.setData("application/pdfjs",JSON.stringify(At))}cut($){this.copy($),this.delete()}paste($){$.preventDefault();const{clipboardData:At}=$;for(const de of At.items)for(const Ce of l(this,oe))if(Ce.isHandlingMimeForPasting(de.type)){Ce.paste(de,this.currentLayer);return}let Zt=At.getData("application/pdfjs");if(!Zt)return;try{Zt=JSON.parse(Zt)}catch(de){(0,n.warn)(`paste: "${de.message}".`);return}if(!Array.isArray(Zt))return;this.unselectAll();const ae=this.currentLayer;try{const de=[];for(const ri of Zt){const ci=ae.deserialize(ri);if(!ci)return;de.push(ci)}const Ce=()=>{for(const ri of de)Y(this,he,nf).call(this,ri);Y(this,ei,sf).call(this,de)},Se=()=>{for(const ri of de)ri.remove()};this.addCommands({cmd:Ce,undo:Se,mustExec:!0})}catch(de){(0,n.warn)(`paste: "${de.message}".`)}}keydown($){!this.isShiftKeyDown&&$.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,R)!==n.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&Hi._keyboardManager.exec(this,$)}keyup($){this.isShiftKeyDown&&$.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Ft)&&(J(this,Ft,!1),Y(this,Et,dc).call(this,"main_toolbar")))}onEditingAction({name:$}){switch($){case"undo":case"redo":case"delete":case"selectAll":this[$]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState($){$?(Y(this,je,g1).call(this),Y(this,Q,ef).call(this),Y(this,St,Yr).call(this,{isEditing:l(this,R)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,Ue,Yo).call(this),hasSomethingToUndo:l(this,Dt).hasSomethingToUndo(),hasSomethingToRedo:l(this,Dt).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,ze,Zu).call(this),Y(this,ht,rf).call(this),Y(this,St,Yr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes($){if(!l(this,oe)){J(this,oe,$);for(const At of l(this,oe))Y(this,Ot,Xs).call(this,At.defaultPropertiesToUpdate)}}getId(){return l(this,ve).id}get currentLayer(){return l(this,Tt).get(l(this,ee))}getLayer($){return l(this,Tt).get($)}get currentPageIndex(){return l(this,ee)}addLayer($){l(this,Tt).set($.pageIndex,$),l(this,ie)?$.enable():$.disable()}removeLayer($){l(this,Tt).delete($.pageIndex)}updateMode($,At=null,Zt=!1){if(l(this,R)!==$){if(J(this,R,$),$===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,ne,v1).call(this);return}this.setEditingState(!0),Y(this,le,m1).call(this),this.unselectAll();for(const ae of l(this,Tt).values())ae.updateMode($);if(!At&&Zt){this.addNewEditorFromKeyboard();return}if(At){for(const ae of l(this,dt).values())if(ae.annotationElementId===At){this.setSelected(ae),ae.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar($){$!==l(this,R)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:$})}updateParams($,At){var Zt;if(l(this,oe)){switch($){case n.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Zt=l(this,ut))==null||Zt.updateColor(At);break;case n.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,V)||J(this,V,new Map)).set($,At),this.showAllEditors("highlight",At);break}for(const ae of l(this,D))ae.updateParams($,At);for(const ae of l(this,oe))ae.updateDefaultParams($,At)}}showAllEditors($,At,Zt=!1){var ae;for(const de of l(this,dt).values())de.editorType===$&&de.show(At);(((ae=l(this,V))==null?void 0:ae.get(n.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==At&&Y(this,Ot,Xs).call(this,[[n.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,At]])}enableWaiting($=!1){if(l(this,xe)!==$){J(this,xe,$);for(const At of l(this,Tt).values())$?At.disableClick():At.enableClick(),At.div.classList.toggle("waiting",$)}}getEditors($){const At=[];for(const Zt of l(this,dt).values())Zt.pageIndex===$&&At.push(Zt);return At}getEditor($){return l(this,dt).get($)}addEditor($){l(this,dt).set($.id,$)}removeEditor($){var At;$.div.contains(document.activeElement)&&(l(this,Gt)&&clearTimeout(l(this,Gt)),J(this,Gt,setTimeout(()=>{this.focusMainContainer(),J(this,Gt,null)},0))),l(this,dt).delete($.id),this.unselect($),(!$.annotationElementId||!l(this,zt).has($.annotationElementId))&&((At=l(this,Qt))==null||At.remove($.id))}addDeletedAnnotationElement($){l(this,zt).add($.annotationElementId),this.addChangedExistingAnnotation($),$.deleted=!0}isDeletedAnnotationElement($){return l(this,zt).has($)}removeDeletedAnnotationElement($){l(this,zt).delete($.annotationElementId),this.removeChangedExistingAnnotation($),$.deleted=!1}setActiveEditor($){l(this,wt)!==$&&(J(this,wt,$),$&&Y(this,Ot,Xs).call(this,$.propertiesToUpdate))}updateUI($){l(this,we,y1)===$&&Y(this,Ot,Xs).call(this,$.propertiesToUpdate)}toggleSelected($){if(l(this,D).has($)){l(this,D).delete($),$.unselect(),Y(this,St,Yr).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,D).add($),$.select(),Y(this,Ot,Xs).call(this,$.propertiesToUpdate),Y(this,St,Yr).call(this,{hasSelectedEditor:!0})}setSelected($){for(const At of l(this,D))At!==$&&At.unselect();l(this,D).clear(),l(this,D).add($),$.select(),Y(this,Ot,Xs).call(this,$.propertiesToUpdate),Y(this,St,Yr).call(this,{hasSelectedEditor:!0})}isSelected($){return l(this,D).has($)}get firstSelectedEditor(){return l(this,D).values().next().value}unselect($){$.unselect(),l(this,D).delete($),Y(this,St,Yr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,D).size!==0}get isEnterHandled(){return l(this,D).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){l(this,Dt).undo(),Y(this,St,Yr).call(this,{hasSomethingToUndo:l(this,Dt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,Ue,Yo).call(this)})}redo(){l(this,Dt).redo(),Y(this,St,Yr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,Dt).hasSomethingToRedo(),isEmpty:Y(this,Ue,Yo).call(this)})}addCommands($){l(this,Dt).add($),Y(this,St,Yr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,Ue,Yo).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const $=[...l(this,D)],At=()=>{for(const ae of $)ae.remove()},Zt=()=>{for(const ae of $)Y(this,he,nf).call(this,ae)};this.addCommands({cmd:At,undo:Zt,mustExec:!0})}commitOrRemove(){var $;($=l(this,wt))==null||$.commitOrRemove()}hasSomethingToControl(){return l(this,wt)||this.hasSelection}selectAll(){for(const $ of l(this,D))$.commit();Y(this,ei,sf).call(this,l(this,dt).values())}unselectAll(){if(!(l(this,wt)&&(l(this,wt).commitOrRemove(),l(this,R)!==n.AnnotationEditorType.NONE))&&this.hasSelection){for(const $ of l(this,D))$.unselect();l(this,D).clear(),Y(this,St,Yr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors($,At,Zt=!1){if(Zt||this.commitOrRemove(),!this.hasSelection)return;l(this,Bt)[0]+=$,l(this,Bt)[1]+=At;const[ae,de]=l(this,Bt),Ce=[...l(this,D)],Se=1e3;l(this,Z)&&clearTimeout(l(this,Z)),J(this,Z,setTimeout(()=>{J(this,Z,null),l(this,Bt)[0]=l(this,Bt)[1]=0,this.addCommands({cmd:()=>{for(const ri of Ce)l(this,dt).has(ri.id)&&ri.translateInPage(ae,de)},undo:()=>{for(const ri of Ce)l(this,dt).has(ri.id)&&ri.translateInPage(-ae,-de)},mustExec:!1})},Se));for(const ri of Ce)ri.translateInPage($,At)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),J(this,Jt,new Map);for(const $ of l(this,D))l(this,Jt).set($,{savedX:$.x,savedY:$.y,savedPageIndex:$.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Jt))return!1;this.disableUserSelect(!1);const $=l(this,Jt);J(this,Jt,null);let At=!1;for(const[{x:ae,y:de,pageIndex:Ce},Se]of $)Se.newX=ae,Se.newY=de,Se.newPageIndex=Ce,At||(At=ae!==Se.savedX||de!==Se.savedY||Ce!==Se.savedPageIndex);if(!At)return!1;const Zt=(ae,de,Ce,Se)=>{if(l(this,dt).has(ae.id)){const ri=l(this,Tt).get(Se);ri?ae._setParentAndPosition(ri,de,Ce):(ae.pageIndex=Se,ae.x=de,ae.y=Ce)}};return this.addCommands({cmd:()=>{for(const[ae,{newX:de,newY:Ce,newPageIndex:Se}]of $)Zt(ae,de,Ce,Se)},undo:()=>{for(const[ae,{savedX:de,savedY:Ce,savedPageIndex:Se}]of $)Zt(ae,de,Ce,Se)},mustExec:!0}),!0}dragSelectedEditors($,At){if(l(this,Jt))for(const Zt of l(this,Jt).keys())Zt.drag($,At)}rebuild($){if($.parent===null){const At=this.getLayer($.pageIndex);At?(At.changeParent($),At.addOrRebuild($)):(this.addEditor($),this.addToAnnotationStorage($),$.rebuild())}else $.parent.addOrRebuild($)}get isEditorHandlingKeyboard(){var $;return(($=this.getActive())==null?void 0:$.shouldGetKeyboardEvents())||l(this,D).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive($){return l(this,wt)===$}getActive(){return l(this,wt)}getMode(){return l(this,R)}get imageManager(){return(0,n.shadow)(this,"imageManager",new f)}getSelectionBoxes($){if(!$)return null;const At=document.getSelection();for(let ci=0,vr=At.rangeCount;ci<vr;ci++)if(!$.contains(At.getRangeAt(ci).commonAncestorContainer))return null;const{x:Zt,y:ae,width:de,height:Ce}=$.getBoundingClientRect();let Se;switch($.getAttribute("data-main-rotation")){case"90":Se=(ci,vr,Bi,qr)=>({x:(vr-ae)/Ce,y:1-(ci+Bi-Zt)/de,width:qr/Ce,height:Bi/de});break;case"180":Se=(ci,vr,Bi,qr)=>({x:1-(ci+Bi-Zt)/de,y:1-(vr+qr-ae)/Ce,width:Bi/de,height:qr/Ce});break;case"270":Se=(ci,vr,Bi,qr)=>({x:1-(vr+qr-ae)/Ce,y:(ci-Zt)/de,width:qr/Ce,height:Bi/de});break;default:Se=(ci,vr,Bi,qr)=>({x:(ci-Zt)/de,y:(vr-ae)/Ce,width:Bi/de,height:qr/Ce});break}const ri=[];for(let ci=0,vr=At.rangeCount;ci<vr;ci++){const Bi=At.getRangeAt(ci);if(!Bi.collapsed)for(const{x:qr,y:Ar,width:fh,height:ds}of Bi.getClientRects())fh===0||ds===0||ri.push(Se(qr,Ar,fh,ds))}return ri.length===0?null:ri}addChangedExistingAnnotation({annotationElementId:$,id:At}){(l(this,ct)||J(this,ct,new Map)).set($,At)}removeChangedExistingAnnotation({annotationElementId:$}){var At;(At=l(this,ct))==null||At.delete($)}renderAnnotationElement($){var ae;const At=(ae=l(this,ct))==null?void 0:ae.get($.data.id);if(!At)return;const Zt=l(this,Qt).getRawValue(At);!Zt||l(this,R)===n.AnnotationEditorType.NONE&&!Zt.hasBeenModified||Zt.renderAnnotationElement($)}};let v=Hi;wt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,ge=new WeakMap,Ae=new WeakMap,Ve=new WeakMap,Gt=new WeakMap,lt=new WeakMap,Ft=new WeakMap,Wt=new WeakMap,ve=new WeakMap,ie=new WeakMap,xe=new WeakMap,_e=new WeakMap,ut=new WeakMap,T=new WeakMap,R=new WeakMap,D=new WeakMap,H=new WeakMap,L=new WeakMap,V=new WeakMap,j=new WeakMap,G=new WeakMap,W=new WeakMap,U=new WeakMap,O=new WeakMap,z=new WeakMap,et=new WeakMap,nt=new WeakMap,gt=new WeakMap,yt=new WeakMap,Nt=new WeakMap,Ht=new WeakMap,Pt=new WeakMap,Bt=new WeakMap,Z=new WeakMap,at=new WeakMap,_t=new WeakMap,vt=new WeakSet,cc=function({anchorNode:$}){return $.nodeType===Node.TEXT_NODE?$.parentElement:$},bt=new WeakSet,d1=function(){const $=document.getSelection();if(!$||$.isCollapsed)return;const At=Y(this,vt,cc).call(this,$).closest(".textLayer"),Zt=this.getSelectionBoxes(At);!Zt||(l(this,Wt)||J(this,Wt,new o.HighlightToolbar(this)),l(this,Wt).show(At,Zt,this.direction==="ltr"))},ot=new WeakSet,u1=function(){var Zt,ae,de;const $=document.getSelection();if(!$||$.isCollapsed){l(this,H)&&((Zt=l(this,Wt))==null||Zt.hide(),J(this,H,null),Y(this,St,Yr).call(this,{hasSelectedText:!1}));return}const{anchorNode:At}=$;if(At!==l(this,H)){if(!Y(this,vt,cc).call(this,$).closest(".textLayer")){l(this,H)&&((ae=l(this,Wt))==null||ae.hide(),J(this,H,null),Y(this,St,Yr).call(this,{hasSelectedText:!1}));return}if((de=l(this,Wt))==null||de.hide(),J(this,H,At),Y(this,St,Yr).call(this,{hasSelectedText:!0}),!(l(this,R)!==n.AnnotationEditorType.HIGHLIGHT&&l(this,R)!==n.AnnotationEditorType.NONE)&&(l(this,R)===n.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),J(this,Ft,this.isShiftKeyDown),!this.isShiftKeyDown)){const Ce=Se=>{Se.type==="pointerup"&&Se.button!==0||(window.removeEventListener("pointerup",Ce),window.removeEventListener("blur",Ce),Se.type==="pointerup"&&Y(this,Et,dc).call(this,"main_toolbar"))};window.addEventListener("pointerup",Ce),window.addEventListener("blur",Ce)}}},Et=new WeakSet,dc=function($=""){l(this,R)===n.AnnotationEditorType.HIGHLIGHT?this.highlightSelection($):l(this,Ae)&&Y(this,bt,d1).call(this)},te=new WeakSet,f1=function(){document.addEventListener("selectionchange",l(this,Nt))},Pe=new WeakSet,p1=function(){document.removeEventListener("selectionchange",l(this,Nt))},je=new WeakSet,g1=function(){window.addEventListener("focus",l(this,G)),window.addEventListener("blur",l(this,j))},ze=new WeakSet,Zu=function(){window.removeEventListener("focus",l(this,G)),window.removeEventListener("blur",l(this,j))},oi=new WeakSet,Ju=function(){window.addEventListener("keydown",l(this,z)),window.addEventListener("keyup",l(this,et))},bi=new WeakSet,tf=function(){window.removeEventListener("keydown",l(this,z)),window.removeEventListener("keyup",l(this,et))},Q=new WeakSet,ef=function(){document.addEventListener("copy",l(this,W)),document.addEventListener("cut",l(this,U)),document.addEventListener("paste",l(this,O))},ht=new WeakSet,rf=function(){document.removeEventListener("copy",l(this,W)),document.removeEventListener("cut",l(this,U)),document.removeEventListener("paste",l(this,O))},St=new WeakSet,Yr=function($){Object.entries($).some(([At,Zt])=>l(this,Pt)[At]!==Zt)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,Pt),$)}),l(this,R)===n.AnnotationEditorType.HIGHLIGHT&&$.hasSelectedEditor===!1&&Y(this,Ot,Xs).call(this,[[n.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},Ot=new WeakSet,Xs=function($){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:$})},le=new WeakSet,m1=function(){if(!l(this,ie)){J(this,ie,!0);for(const $ of l(this,Tt).values())$.enable();for(const $ of l(this,dt).values())$.enable()}},ne=new WeakSet,v1=function(){if(this.unselectAll(),l(this,ie)){J(this,ie,!1);for(const $ of l(this,Tt).values())$.disable();for(const $ of l(this,dt).values())$.disable()}},he=new WeakSet,nf=function($){const At=l(this,Tt).get($.pageIndex);At?At.addOrRebuild($):(this.addEditor($),this.addToAnnotationStorage($))},we=new WeakSet,y1=function(){let $=null;for($ of l(this,D));return $},Ue=new WeakSet,Yo=function(){if(l(this,dt).size===0)return!0;if(l(this,dt).size===1)for(const $ of l(this,dt).values())return $.isEmpty();return!1},ei=new WeakSet,sf=function($){for(const At of l(this,D))At.unselect();l(this,D).clear();for(const At of $)At.isEmpty()||(l(this,D).add(At),At.select());Y(this,St,Yr).call(this,{hasSelectedEditor:this.hasSelection})},ti(v,"TRANSLATE_SMALL",1),ti(v,"TRANSLATE_BIG",10)},94:(r,t,s)=>{s.d(t,{PDFFetchStream:()=>d});var n=s(292),a=s(490);function o(S,_,v){return{method:"GET",headers:S,signal:v.signal,mode:"cors",credentials:_?"include":"same-origin",redirect:"follow"}}function c(S){const _=new Headers;for(const v in S){const b=S[v];b!==void 0&&_.append(v,b)}return _}function u(S){return S instanceof Uint8Array?S.buffer:S instanceof ArrayBuffer?S:((0,n.warn)(`getArrayBuffer - unexpected data format: ${S}`),new Uint8Array(S).buffer)}class d{constructor(_){this.source=_,this.isHttp=/^https?:/i.test(_.url),this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _;return((_=this._fullRequestReader)==null?void 0:_._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f(this),this._fullRequestReader}getRangeReader(_,v){if(v<=this._progressiveDataLength)return null;const b=new m(this,_,v);return this._rangeRequestReaders.push(b),b}cancelAllRequests(_){var v;(v=this._fullRequestReader)==null||v.cancel(_);for(const b of this._rangeRequestReaders.slice(0))b.cancel(_)}}class f{constructor(_){this._stream=_,this._reader=null,this._loaded=0,this._filename=null;const v=_.source;this._withCredentials=v.withCredentials||!1,this._contentLength=v.length,this._headersCapability=Promise.withResolvers(),this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._headers=c(this._stream.httpHeaders);const b=v.url;fetch(b,o(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,a.validateResponseStatus)(x.status))throw(0,a.createResponseStatusError)(x.status,b);this._reader=x.body.getReader(),this._headersCapability.resolve();const A=g=>x.headers.get(g),{allowRangeRequests:F,suggestedLength:M}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=F,this._contentLength=M||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(A),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._headersCapability.promise;const{value:_,done:v}=await this._reader.read();return v?{value:_,done:v}:(this._loaded+=_.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded,total:this._contentLength}),{value:u(_),done:!1})}cancel(_){var v;(v=this._reader)==null||v.cancel(_),this._abortController.abort()}}class m{constructor(_,v,b){this._stream=_,this._reader=null,this._loaded=0;const x=_.source;this._withCredentials=x.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!x.disableStream,this._abortController=new AbortController,this._headers=c(this._stream.httpHeaders),this._headers.append("Range",`bytes=${v}-${b-1}`);const A=x.url;fetch(A,o(this._headers,this._withCredentials,this._abortController)).then(F=>{if(!(0,a.validateResponseStatus)(F.status))throw(0,a.createResponseStatusError)(F.status,A);this._readCapability.resolve(),this._reader=F.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._readCapability.promise;const{value:_,done:v}=await this._reader.read();return v?{value:_,done:v}:(this._loaded+=_.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded}),{value:u(_),done:!1})}cancel(_){var v;(v=this._reader)==null||v.cancel(_),this._abortController.abort()}}},10:(r,t,s)=>{var c;s.d(t,{FontFaceObject:()=>o,FontLoader:()=>a});var n=s(292);class a{constructor({ownerDocument:d=globalThis.document,styleElement:f=null}){N(this,c,new Set);this._document=d,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(d){this.nativeFontFaces.add(d),this._document.fonts.add(d)}removeNativeFontFace(d){this.nativeFontFaces.delete(d),this._document.fonts.delete(d)}insertRule(d){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const f=this.styleElement.sheet;f.insertRule(d,f.cssRules.length)}clear(){for(const d of this.nativeFontFaces)this._document.fonts.delete(d);this.nativeFontFaces.clear(),l(this,c).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:d,_inspectFont:f}){if(!(!d||l(this,c).has(d.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:m,src:S,style:_}=d,v=new FontFace(m,S,_);this.addNativeFontFace(v);try{await v.load(),l(this,c).add(m),f==null||f(d)}catch{(0,n.warn)(`Cannot load system font: ${d.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(v)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(d){if(d.attached||d.missingFile&&!d.systemFontInfo)return;if(d.attached=!0,d.systemFontInfo){await this.loadSystemFont(d);return}if(this.isFontLoadingAPISupported){const m=d.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(S){throw(0,n.warn)(`Failed to load font '${m.family}': '${S}'.`),d.disableFontFace=!0,S}}return}const f=d.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const S=this._queueLoadingCallback(m);this._prepareFontLoadEvent(d,S)})}}get isFontLoadingAPISupported(){var f;const d=!!((f=this._document)!=null&&f.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",d)}get isSyncFontLoadingSupported(){let d=!1;return(n.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(d=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",d)}_queueLoadingCallback(d){function f(){for((0,n.assert)(!S.done,"completeRequest() cannot be called twice."),S.done=!0;m.length>0&&m[0].done;){const _=m.shift();setTimeout(_.callback,0)}}const{loadingRequests:m}=this,S={done:!1,complete:f,callback:d};return m.push(S),S}get _loadTestFont(){const d=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",d)}_prepareFontLoadEvent(d,f){function m(tt,st){return tt.charCodeAt(st)<<24|tt.charCodeAt(st+1)<<16|tt.charCodeAt(st+2)<<8|tt.charCodeAt(st+3)&255}function S(tt,st,wt,dt){const Tt=tt.substring(0,st),Lt=tt.substring(st+wt);return Tt+dt+Lt}let _,v;const b=this._document.createElement("canvas");b.width=1,b.height=1;const x=b.getContext("2d");let A=0;function F(tt,st){if(++A>30){(0,n.warn)("Load test font never loaded."),st();return}if(x.font="30px "+tt,x.fillText(".",0,20),x.getImageData(0,0,1,1).data[3]>0){st();return}setTimeout(F.bind(null,tt,st))}const M=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=S(g,976,M.length,M);const w=16,E=1482184792;let C=m(g,w);for(_=0,v=M.length-3;_<v;_+=4)C=C-E+m(M,_)|0;_<M.length&&(C=C-E+m(M+"XXX",_)|0),g=S(g,w,4,(0,n.string32)(C));const B=`url(data:font/opentype;base64,${btoa(g)});`,I=`@font-face {font-family:"${M}";src:${B}}`;this.insertRule(I);const rt=this._document.createElement("div");rt.style.visibility="hidden",rt.style.width=rt.style.height="10px",rt.style.position="absolute",rt.style.top=rt.style.left="0px";for(const tt of[d.loadedName,M]){const st=this._document.createElement("span");st.textContent="Hi",st.style.fontFamily=tt,rt.append(st)}this._document.body.append(rt),F(M,()=>{rt.remove(),f.complete()})}}c=new WeakMap;class o{constructor(d,{disableFontFace:f=!1,ignoreErrors:m=!1,inspectFont:S=null}){this.compiledGlyphs=Object.create(null);for(const _ in d)this[_]=d[_];this.disableFontFace=f===!0,this.ignoreErrors=m===!0,this._inspectFont=S}createNativeFontFace(){var f;if(!this.data||this.disableFontFace)return null;let d;if(!this.cssFontInfo)d=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),d=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(f=this._inspectFont)==null||f.call(this,this),d}createFontFaceRule(){var S;if(!this.data||this.disableFontFace)return null;const d=(0,n.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(d)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let _=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_}src:${f}}`}return(S=this._inspectFont)==null||S.call(this,this,f),m}getPathGenerator(d,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let m;try{m=d.get(this.loadedName+"_path_"+f)}catch(_){if(!this.ignoreErrors)throw _;(0,n.warn)(`getPathGenerator - ignoring character: "${_}".`)}if(!Array.isArray(m)||m.length===0)return this.compiledGlyphs[f]=function(_,v){};const S=[];for(let _=0,v=m.length;_<v;)switch(m[_++]){case n.FontRenderOps.BEZIER_CURVE_TO:{const[b,x,A,F,M,g]=m.slice(_,_+6);S.push(w=>w.bezierCurveTo(b,x,A,F,M,g)),_+=6}break;case n.FontRenderOps.MOVE_TO:{const[b,x]=m.slice(_,_+2);S.push(A=>A.moveTo(b,x)),_+=2}break;case n.FontRenderOps.LINE_TO:{const[b,x]=m.slice(_,_+2);S.push(A=>A.lineTo(b,x)),_+=2}break;case n.FontRenderOps.QUADRATIC_CURVE_TO:{const[b,x,A,F]=m.slice(_,_+4);S.push(M=>M.quadraticCurveTo(b,x,A,F)),_+=4}break;case n.FontRenderOps.RESTORE:S.push(b=>b.restore());break;case n.FontRenderOps.SAVE:S.push(b=>b.save());break;case n.FontRenderOps.SCALE:(0,n.assert)(S.length===2,"Scale command is only valid at the third position.");break;case n.FontRenderOps.TRANSFORM:{const[b,x,A,F,M,g]=m.slice(_,_+6);S.push(w=>w.transform(b,x,A,F,M,g)),_+=6}break;case n.FontRenderOps.TRANSLATE:{const[b,x]=m.slice(_,_+2);S.push(A=>A.translate(b,x)),_+=2}break}return this.compiledGlyphs[f]=function(_,v){S[0](_),S[1](_),_.scale(v,-v);for(let b=2,x=S.length;b<x;b++)S[b](_)}}}},62:(r,t,s)=>{var o,c;s.d(t,{Metadata:()=>a});var n=s(292);class a{constructor({parsedData:d,rawData:f}){N(this,o,void 0);N(this,c,void 0);J(this,o,d),J(this,c,f)}getRaw(){return l(this,c)}get(d){return l(this,o).get(d)??null}getAll(){return(0,n.objectFromMap)(l(this,o))}has(d){return l(this,o).has(d)}}o=new WeakMap,c=new WeakMap},457:(r,t,s)=>{s.d(t,{PDFNetworkStream:()=>f});var n=s(292),a=s(490);const o=200,c=206;function u(_){const v=_.response;return typeof v!="string"?v:(0,n.stringToBytes)(v).buffer}class d{constructor(v,b={}){this.url=v,this.isHttp=/^https?:/i.test(v),this.httpHeaders=this.isHttp&&b.httpHeaders||Object.create(null),this.withCredentials=b.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(v,b,x){const A={begin:v,end:b};for(const F in x)A[F]=x[F];return this.request(A)}requestFull(v){return this.request(v)}request(v){const b=new XMLHttpRequest,x=this.currXhrId++,A=this.pendingRequests[x]={xhr:b};b.open("GET",this.url),b.withCredentials=this.withCredentials;for(const F in this.httpHeaders){const M=this.httpHeaders[F];M!==void 0&&b.setRequestHeader(F,M)}return this.isHttp&&"begin"in v&&"end"in v?(b.setRequestHeader("Range",`bytes=${v.begin}-${v.end-1}`),A.expectedStatus=c):A.expectedStatus=o,b.responseType="arraybuffer",v.onError&&(b.onerror=function(F){v.onError(b.status)}),b.onreadystatechange=this.onStateChange.bind(this,x),b.onprogress=this.onProgress.bind(this,x),A.onHeadersReceived=v.onHeadersReceived,A.onDone=v.onDone,A.onError=v.onError,A.onProgress=v.onProgress,b.send(null),x}onProgress(v,b){var A;const x=this.pendingRequests[v];!x||((A=x.onProgress)==null||A.call(x,b))}onStateChange(v,b){var g,w,E;const x=this.pendingRequests[v];if(!x)return;const A=x.xhr;if(A.readyState>=2&&x.onHeadersReceived&&(x.onHeadersReceived(),delete x.onHeadersReceived),A.readyState!==4||!(v in this.pendingRequests))return;if(delete this.pendingRequests[v],A.status===0&&this.isHttp){(g=x.onError)==null||g.call(x,A.status);return}const F=A.status||o;if(!(F===o&&x.expectedStatus===c)&&F!==x.expectedStatus){(w=x.onError)==null||w.call(x,A.status);return}const M=u(A);if(F===c){const C=A.getResponseHeader("Content-Range"),B=/bytes (\d+)-(\d+)\/(\d+)/.exec(C);x.onDone({begin:parseInt(B[1],10),chunk:M})}else M?x.onDone({begin:0,chunk:M}):(E=x.onError)==null||E.call(x,A.status)}getRequestXhr(v){return this.pendingRequests[v].xhr}isPendingRequest(v){return v in this.pendingRequests}abortRequest(v){const b=this.pendingRequests[v].xhr;delete this.pendingRequests[v],b.abort()}}class f{constructor(v){this._source=v,this._manager=new d(v.url,{httpHeaders:v.httpHeaders,withCredentials:v.withCredentials}),this._rangeChunkSize=v.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(v){const b=this._rangeRequestReaders.indexOf(v);b>=0&&this._rangeRequestReaders.splice(b,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(v,b){const x=new S(this._manager,v,b);return x.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(x),x}cancelAllRequests(v){var b;(b=this._fullRequestReader)==null||b.cancel(v);for(const x of this._rangeRequestReaders.slice(0))x.cancel(v)}}class m{constructor(v,b){this._manager=v;const x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._fullRequestId=v.requestFull(x),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=b.disableRange||!1,this._contentLength=b.length,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const v=this._fullRequestId,b=this._manager.getRequestXhr(v),x=M=>b.getResponseHeader(M),{allowRangeRequests:A,suggestedLength:F}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});A&&(this._isRangeSupported=!0),this._contentLength=F||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(x),this._isRangeSupported&&this._manager.abortRequest(v),this._headersReceivedCapability.resolve()}_onDone(v){if(v&&(this._requests.length>0?this._requests.shift().resolve({value:v.chunk,done:!1}):this._cachedChunks.push(v.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(v){this._storedError=(0,a.createResponseStatusError)(v,this._url),this._headersReceivedCapability.reject(this._storedError);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(v){var b;(b=this.onProgress)==null||b.call(this,{loaded:v.loaded,total:v.lengthComputable?v.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=Promise.withResolvers();return this._requests.push(v),v.promise}cancel(v){this._done=!0,this._headersReceivedCapability.reject(v);for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class S{constructor(v,b,x){this._manager=v;const A={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._requestId=v.requestRange(b,x,A),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var v;(v=this.onClosed)==null||v.call(this,this)}_onDone(v){const b=v.chunk;this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunk=b,this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(v){this._storedError=(0,a.createResponseStatusError)(v,this._url);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(v){var b;this.isStreamingSupported||((b=this.onProgress)==null||b.call(this,{loaded:v.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const v=Promise.withResolvers();return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(r,t,s)=>{s.d(t,{createResponseStatusError:()=>d,extractFilenameFromHeader:()=>u,validateRangeRequestCapabilities:()=>c,validateResponseStatus:()=>f});var n=s(292);function a(m){let S=!0,_=v("filename\\*","i").exec(m);if(_){_=_[1];let w=F(_);return w=unescape(w),w=M(w),w=g(w),x(w)}if(_=A(m),_){const w=g(_);return x(w)}if(_=v("filename","i").exec(m),_){_=_[1];let w=F(_);return w=g(w),x(w)}function v(w,E){return new RegExp("(?:^|;)\\s*"+w+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',E)}function b(w,E){if(w){if(!/^[\x00-\xFF]+$/.test(E))return E;try{const C=new TextDecoder(w,{fatal:!0}),B=(0,n.stringToBytes)(E);E=C.decode(B),S=!1}catch{}}return E}function x(w){return S&&/[\x80-\xff]/.test(w)&&(w=b("utf-8",w),S&&(w=b("iso-8859-1",w))),w}function A(w){const E=[];let C;const B=v("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(C=B.exec(w))!==null;){let[,rt,tt,st]=C;if(rt=parseInt(rt,10),rt in E){if(rt===0)break;continue}E[rt]=[tt,st]}const I=[];for(let rt=0;rt<E.length&&rt in E;++rt){let[tt,st]=E[rt];st=F(st),tt&&(st=unescape(st),rt===0&&(st=M(st))),I.push(st)}return I.join("")}function F(w){if(w.startsWith('"')){const E=w.slice(1).split('\\"');for(let C=0;C<E.length;++C){const B=E[C].indexOf('"');B!==-1&&(E[C]=E[C].slice(0,B),E.length=C+1),E[C]=E[C].replaceAll(/\\(.)/g,"$1")}w=E.join('"')}return w}function M(w){const E=w.indexOf("'");if(E===-1)return w;const C=w.slice(0,E),B=w.slice(E+1).replace(/^[^']*'/,"");return b(C,B)}function g(w){return!w.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(w)?w:w.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(E,C,B,I){if(B==="q"||B==="Q")return I=I.replaceAll("_"," "),I=I.replaceAll(/=([0-9a-fA-F]{2})/g,function(rt,tt){return String.fromCharCode(parseInt(tt,16))}),b(C,I);try{I=atob(I)}catch{}return b(C,I)})}return""}var o=s(419);function c({getResponseHeader:m,isHttp:S,rangeChunkSize:_,disableRange:v}){const b={allowRangeRequests:!1,suggestedLength:void 0},x=parseInt(m("Content-Length"),10);return!Number.isInteger(x)||(b.suggestedLength=x,x<=2*_)||v||!S||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(b.allowRangeRequests=!0),b}function u(m){const S=m("Content-Disposition");if(S){let _=a(S);if(_.includes("%"))try{_=decodeURIComponent(_)}catch{}if((0,o.isPdfFile)(_))return _}return null}function d(m,S){return m===404||m===0&&S.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+S+'".'):new n.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${S}".`,m)}function f(m){return m===200||m===206}},786:(r,t,s)=>{s.a(r,async(n,a)=>{try{let u=function(E){const C=_.parse(E);return C.protocol==="file:"||C.host?C:/^[a-z]:[/\\]/i.test(E)?_.parse(`file:///${E}`):(C.host||(C.protocol="file:"),C)},d=function(E,C){return{protocol:E.protocol,auth:E.auth,host:E.hostname,port:E.port,path:E.path,method:"GET",headers:C}};s.d(t,{PDFNodeStream:()=>b});var o=s(292),c=s(490);let f,m,S,_;o.isNodeJS&&(f=await $s(()=>import("./__vite-browser-external-b25bb000.js"),[]),m=await $s(()=>import("./__vite-browser-external-b25bb000.js"),[]),S=await $s(()=>import("./__vite-browser-external-b25bb000.js"),[]),_=await $s(()=>import("./__vite-browser-external-b25bb000.js"),[]));const v=/^file:\/\/\/[a-zA-Z]:\//;class b{constructor(C){this.source=C,this.url=u(C.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new g(this):new F(this),this._fullRequestReader}getRangeReader(C,B){if(B<=this._progressiveDataLength)return null;const I=this.isFsUrl?new w(this,C,B):new M(this,C,B);return this._rangeRequestReaders.push(I),I}cancelAllRequests(C){var B;(B=this._fullRequestReader)==null||B.cancel(C);for(const I of this._rangeRequestReaders.slice(0))I.cancel(C)}}class x{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null;const B=C.source;this._contentLength=B.length,this._loaded=0,this._filename=null,this._disableRange=B.disableRange||!1,this._rangeChunkSize=B.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!B.disableStream,this._isRangeSupported=!B.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var B;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=C.length,(B=this.onProgress)==null||B.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",B=>{this._error(B)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const B=C.source;this._isStreamingSupported=!B.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var B;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=C.length,(B=this.onProgress)==null||B.call(this,{loaded:this._loaded}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",B=>{this._error(B)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class F extends x{constructor(C){super(C);const B=I=>{if(I.statusCode===404){const wt=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=wt,this._headersCapability.reject(wt);return}this._headersCapability.resolve(),this._setReadableStream(I);const rt=wt=>this._readableStream.headers[wt.toLowerCase()],{allowRangeRequests:tt,suggestedLength:st}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:rt,isHttp:C.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=tt,this._contentLength=st||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(rt)};this._request=null,this._url.protocol==="http:"?this._request=m.request(d(this._url,C.httpHeaders),B):this._request=S.request(d(this._url,C.httpHeaders),B),this._request.on("error",I=>{this._storedError=I,this._headersCapability.reject(I)}),this._request.end()}}class M extends A{constructor(C,B,I){super(C),this._httpHeaders={};for(const tt in C.httpHeaders){const st=C.httpHeaders[tt];st!==void 0&&(this._httpHeaders[tt]=st)}this._httpHeaders.Range=`bytes=${B}-${I-1}`;const rt=tt=>{if(tt.statusCode===404){const st=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=st;return}this._setReadableStream(tt)};this._request=null,this._url.protocol==="http:"?this._request=m.request(d(this._url,this._httpHeaders),rt):this._request=S.request(d(this._url,this._httpHeaders),rt),this._request.on("error",tt=>{this._storedError=tt}),this._request.end()}}class g extends x{constructor(C){super(C);let B=decodeURIComponent(this._url.path);v.test(this._url.href)&&(B=B.replace(/^\//,"")),f.promises.lstat(B).then(I=>{this._contentLength=I.size,this._setReadableStream(f.createReadStream(B)),this._headersCapability.resolve()},I=>{I.code==="ENOENT"&&(I=new o.MissingPDFException(`Missing PDF "${B}".`)),this._storedError=I,this._headersCapability.reject(I)})}}class w extends A{constructor(C,B,I){super(C);let rt=decodeURIComponent(this._url.path);v.test(this._url.href)&&(rt=rt.replace(/^\//,"")),this._setReadableStream(f.createReadStream(rt,{start:B,end:I-1}))}}a()}catch(u){a(u)}},1)},573:(r,t,s)=>{s.a(r,async(n,a)=>{try{s.d(t,{NodeCMapReaderFactory:()=>v,NodeCanvasFactory:()=>_,NodeFilterFactory:()=>S,NodeStandardFontDataFactory:()=>b});var o=s(583),c=s(292);let u,d,f;if(c.isNodeJS){u=await $s(()=>import("./__vite-browser-external-b25bb000.js"),[]);try{d=await $s(()=>import("./__vite-browser-external-b25bb000.js"),[])}catch{}try{f=await $s(()=>import("./index-60f13653.js"),[])}catch{}}const m=function(x){return u.promises.readFile(x).then(A=>new Uint8Array(A))};class S extends o.BaseFilterFactory{}class _ extends o.BaseCanvasFactory{_createCanvas(A,F){return d.createCanvas(A,F)}}class v extends o.BaseCMapReaderFactory{_fetchData(A,F){return m(A).then(M=>({cMapData:M,compressionType:F}))}}class b extends o.BaseStandardFontDataFactory{_fetchData(A){return m(A)}}a()}catch(u){a(u)}},1)},626:(r,t,s)=>{var d,f,m,S,_,v,b,x,A,af;s.d(t,{OptionalContentConfig:()=>u});var n=s(292),a=s(651);const o=Symbol("INTERNAL");class c{constructor(g,{name:w,intent:E,usage:C}){N(this,d,!1);N(this,f,!1);N(this,m,!1);N(this,S,!0);J(this,d,!!(g&n.RenderingIntentFlag.DISPLAY)),J(this,f,!!(g&n.RenderingIntentFlag.PRINT)),this.name=w,this.intent=E,this.usage=C}get visible(){if(l(this,m))return l(this,S);if(!l(this,S))return!1;const{print:g,view:w}=this.usage;return l(this,d)?(w==null?void 0:w.viewState)!=="OFF":l(this,f)?(g==null?void 0:g.printState)!=="OFF":!0}_setVisible(g,w,E=!1){g!==o&&(0,n.unreachable)("Internal method `_setVisible` called."),J(this,m,E),J(this,S,w)}}d=new WeakMap,f=new WeakMap,m=new WeakMap,S=new WeakMap;class u{constructor(g,w=n.RenderingIntentFlag.DISPLAY){N(this,A);N(this,_,null);N(this,v,new Map);N(this,b,null);N(this,x,null);if(this.renderingIntent=w,this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,J(this,x,g.order);for(const E of g.groups)l(this,v).set(E.id,new c(w,E));if(g.baseState==="OFF")for(const E of l(this,v).values())E._setVisible(o,!1);for(const E of g.on)l(this,v).get(E)._setVisible(o,!0);for(const E of g.off)l(this,v).get(E)._setVisible(o,!1);J(this,b,this.getHash())}}isVisible(g){if(l(this,v).size===0)return!0;if(!g)return(0,n.info)("Optional content group not defined."),!0;if(g.type==="OCG")return l(this,v).has(g.id)?l(this,v).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return Y(this,A,af).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const w of g.ids){if(!l(this,v).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(l(this,v).get(w).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const w of g.ids){if(!l(this,v).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(!l(this,v).get(w).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const w of g.ids){if(!l(this,v).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(!l(this,v).get(w).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const w of g.ids){if(!l(this,v).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(l(this,v).get(w).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,w=!0){const E=l(this,v).get(g);if(!E){(0,n.warn)(`Optional content group not found: ${g}`);return}E._setVisible(o,!!w,!0),J(this,_,null)}setOCGState({state:g,preserveRB:w}){let E;for(const C of g){switch(C){case"ON":case"OFF":case"Toggle":E=C;continue}const B=l(this,v).get(C);if(B)switch(E){case"ON":B._setVisible(o,!0);break;case"OFF":B._setVisible(o,!1);break;case"Toggle":B._setVisible(o,!B.visible);break}}J(this,_,null)}get hasInitialVisibility(){return l(this,b)===null||this.getHash()===l(this,b)}getOrder(){return l(this,v).size?l(this,x)?l(this,x).slice():[...l(this,v).keys()]:null}getGroups(){return l(this,v).size>0?(0,n.objectFromMap)(l(this,v)):null}getGroup(g){return l(this,v).get(g)||null}getHash(){if(l(this,_)!==null)return l(this,_);const g=new a.MurmurHash3_64;for(const[w,E]of l(this,v))g.update(`${w}:${E.visible}`);return J(this,_,g.hexdigest())}}_=new WeakMap,v=new WeakMap,b=new WeakMap,x=new WeakMap,A=new WeakSet,af=function(g){const w=g.length;if(w<2)return!0;const E=g[0];for(let C=1;C<w;C++){const B=g[C];let I;if(Array.isArray(B))I=Y(this,A,af).call(this,B);else if(l(this,v).has(B))I=l(this,v).get(B).visible;else return(0,n.warn)(`Optional content group not found: ${B}`),!0;switch(E){case"And":if(!I)return!1;break;case"Or":if(I)return!0;break;case"Not":return!I;default:return!0}}return E==="And"}},814:(r,t,s)=>{s.d(t,{cleanupTextLayer:()=>S,renderTextLayer:()=>F,updateTextLayer:()=>M});var n=s(292),a=s(419);const o=1e5,c=30,u=.8,d=new Map;let f=null;function m(){if(!f){const g=document.createElement("canvas");g.className="hiddenCanvasElement",document.body.append(g),f=g.getContext("2d",{alpha:!1})}return f}function S(){f==null||f.canvas.remove(),f=null}function _(g){const w=d.get(g);if(w)return w;const E=m(),C=E.font;E.canvas.width=E.canvas.height=c,E.font=`${c}px ${g}`;const B=E.measureText("");let I=B.fontBoundingBoxAscent,rt=Math.abs(B.fontBoundingBoxDescent);if(I){const st=I/(I+rt);return d.set(g,st),E.canvas.width=E.canvas.height=0,E.font=C,st}E.strokeStyle="red",E.clearRect(0,0,c,c),E.strokeText("g",0,0);let tt=E.getImageData(0,0,c,c).data;rt=0;for(let st=tt.length-1-3;st>=0;st-=4)if(tt[st]>0){rt=Math.ceil(st/4/c);break}E.clearRect(0,0,c,c),E.strokeText("A",0,c),tt=E.getImageData(0,0,c,c).data,I=0;for(let st=0,wt=tt.length;st<wt;st+=4)if(tt[st]>0){I=c-Math.floor(st/4/c);break}if(E.canvas.width=E.canvas.height=0,E.font=C,I){const st=I/(I+rt);return d.set(g,st),st}return d.set(g,u),u}function v(g,w,E){const C=document.createElement("span"),B={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};g._textDivs.push(C);const I=n.Util.transform(g._transform,w.transform);let rt=Math.atan2(I[1],I[0]);const tt=E[w.fontName];tt.vertical&&(rt+=Math.PI/2);const st=g._fontInspectorEnabled&&tt.fontSubstitution||tt.fontFamily,wt=Math.hypot(I[2],I[3]),dt=wt*_(st);let Tt,Lt;rt===0?(Tt=I[4],Lt=I[5]-dt):(Tt=I[4]+dt*Math.sin(rt),Lt=I[5]-dt*Math.cos(rt));const Qt="calc(var(--scale-factor)*",ct=C.style;g._container===g._rootContainer?(ct.left=`${(100*Tt/g._pageWidth).toFixed(2)}%`,ct.top=`${(100*Lt/g._pageHeight).toFixed(2)}%`):(ct.left=`${Qt}${Tt.toFixed(2)}px)`,ct.top=`${Qt}${Lt.toFixed(2)}px)`),ct.fontSize=`${Qt}${wt.toFixed(2)}px)`,ct.fontFamily=st,B.fontSize=wt,C.setAttribute("role","presentation"),C.textContent=w.str,C.dir=w.dir,g._fontInspectorEnabled&&(C.dataset.fontName=tt.fontSubstitutionLoadedName||w.fontName),rt!==0&&(B.angle=rt*(180/Math.PI));let Dt=!1;if(w.str.length>1)Dt=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const ee=Math.abs(w.transform[0]),zt=Math.abs(w.transform[3]);ee!==zt&&Math.max(ee,zt)/Math.min(ee,zt)>1.5&&(Dt=!0)}Dt&&(B.canvasWidth=tt.vertical?w.height:w.width),g._textDivProperties.set(C,B),g._isReadableStream&&g._layoutText(C)}function b(g){const{div:w,scale:E,properties:C,ctx:B,prevFontSize:I,prevFontFamily:rt}=g,{style:tt}=w;let st="";if(C.canvasWidth!==0&&C.hasText){const{fontFamily:wt}=tt,{canvasWidth:dt,fontSize:Tt}=C;(I!==Tt||rt!==wt)&&(B.font=`${Tt*E}px ${wt}`,g.prevFontSize=Tt,g.prevFontFamily=wt);const{width:Lt}=B.measureText(w.textContent);Lt>0&&(st=`scaleX(${dt*E/Lt})`)}C.angle!==0&&(st=`rotate(${C.angle}deg) ${st}`),st.length>0&&(tt.transform=st)}function x(g){if(g._canceled)return;const w=g._textDivs,E=g._capability;if(w.length>o){E.resolve();return}if(!g._isReadableStream)for(const C of w)g._layoutText(C);E.resolve()}class A{constructor({textContentSource:w,container:E,viewport:C,textDivs:B,textDivProperties:I,textContentItemsStr:rt}){var Tt;this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=E,this._textDivs=B||[],this._textContentItemsStr=rt||[],this._fontInspectorEnabled=!!((Tt=globalThis.FontInspector)!=null&&Tt.enabled),this._reader=null,this._textDivProperties=I||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:m()};const{pageWidth:tt,pageHeight:st,pageX:wt,pageY:dt}=C.rawDims;this._transform=[1,0,0,-1,-wt,dt+st],this._pageWidth=tt,this._pageHeight=st,(0,a.setLayerDimensions)(E,C),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(w,E){for(const C of w){if(C.str===void 0){if(C.type==="beginMarkedContentProps"||C.type==="beginMarkedContent"){const B=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),C.id!==null&&this._container.setAttribute("id",`${C.id}`),B.append(this._container)}else C.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(C.str),v(this,C,E)}}_layoutText(w){const E=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,b(this._layoutTextParams),E.hasText&&this._container.append(w),E.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),this._container.append(C)}}_render(){const{promise:w,resolve:E,reject:C}=Promise.withResolvers();let B=Object.create(null);if(this._isReadableStream){const I=()=>{this._reader.read().then(({value:rt,done:tt})=>{if(tt){E();return}Object.assign(B,rt.styles),this._processItems(rt.items,B),I()},C)};this._reader=this._textContentSource.getReader(),I()}else if(this._textContentSource){const{items:I,styles:rt}=this._textContentSource;this._processItems(I,rt),E()}else throw new Error('No "textContentSource" parameter specified.');w.then(()=>{B=null,x(this)},this._capability.reject)}}function F(g){const w=new A(g);return w._render(),w}function M({container:g,viewport:w,textDivs:E,textDivProperties:C,mustRotate:B=!0,mustRescale:I=!0}){if(B&&(0,a.setLayerDimensions)(g,{rotation:w.rotation}),I){const rt=m(),tt={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:rt};for(const st of E)tt.properties=C.get(st),tt.div=st,b(tt)}}},585:(r,t,s)=>{s.d(t,{PDFDataTransportStream:()=>o});var n=s(292),a=s(419);class o{constructor(f,{disableRange:m=!1,disableStream:S=!1}){(0,n.assert)(f,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:_,initialData:v,progressiveDone:b,contentDispositionFilename:x}=f;if(this._queuedChunks=[],this._progressiveDone=b,this._contentDispositionFilename=x,(v==null?void 0:v.length)>0){const A=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;this._queuedChunks.push(A)}this._pdfDataRangeTransport=f,this._isStreamingSupported=!S,this._isRangeSupported=!m,this._contentLength=_,this._fullRequestReader=null,this._rangeReaders=[],f.addRangeListener((A,F)=>{this._onReceiveData({begin:A,chunk:F})}),f.addProgressListener((A,F)=>{this._onProgress({loaded:A,total:F})}),f.addProgressiveReadListener(A=>{this._onReceiveData({chunk:A})}),f.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),f.transportReady()}_onReceiveData({begin:f,chunk:m}){const S=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(f===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(S):this._queuedChunks.push(S);else{const _=this._rangeReaders.some(function(v){return v._begin!==f?!1:(v._enqueue(S),!0)});(0,n.assert)(_,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){var m,S,_,v;f.total===void 0?(S=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||S.call(m,{loaded:f.loaded}):(v=(_=this._fullRequestReader)==null?void 0:_.onProgress)==null||v.call(_,{loaded:f.loaded,total:f.total})}_onProgressiveDone(){var f;(f=this._fullRequestReader)==null||f.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const m=this._rangeReaders.indexOf(f);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new c(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,m){if(m<=this._progressiveDataLength)return null;const S=new u(this,f,m);return this._pdfDataRangeTransport.requestDataRange(f,m),this._rangeReaders.push(S),S}cancelAllRequests(f){var m;(m=this._fullRequestReader)==null||m.cancel(f);for(const S of this._rangeReaders.slice(0))S.cancel(f);this._pdfDataRangeTransport.abort()}}class c{constructor(f,m,S=!1,_=null){this._stream=f,this._done=S||!1,this._filename=(0,a.isPdfFile)(_)?_:null,this._queuedChunks=m||[],this._loaded=0;for(const v of this._queuedChunks)this._loaded+=v.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=Promise.withResolvers();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class u{constructor(f,m,S){this._stream=f,this._begin=m,this._end=S,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const f=Promise.withResolvers();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(r,t,s)=>{var a,o;s.d(t,{GlobalWorkerOptions:()=>n});class n{static get workerPort(){return l(this,a)}static set workerPort(u){if(!(typeof Worker<"u"&&u instanceof Worker)&&u!==null)throw new Error("Invalid `workerPort` type.");J(this,a,u)}static get workerSrc(){return l(this,o)}static set workerSrc(u){if(typeof u!="string")throw new Error("Invalid `workerSrc` type.");J(this,o,u)}}a=new WeakMap,o=new WeakMap,N(n,a,null),N(n,o,"")},284:(r,t,s)=>{s.d(t,{XfaLayer:()=>a});var n=s(50);class a{static setupStorage(c,u,d,f,m){const S=f.getValue(u,{value:null});switch(d.name){case"textarea":if(S.value!==null&&(c.textContent=S.value),m==="print")break;c.addEventListener("input",_=>{f.setValue(u,{value:_.target.value})});break;case"input":if(d.attributes.type==="radio"||d.attributes.type==="checkbox"){if(S.value===d.attributes.xfaOn?c.setAttribute("checked",!0):S.value===d.attributes.xfaOff&&c.removeAttribute("checked"),m==="print")break;c.addEventListener("change",_=>{f.setValue(u,{value:_.target.checked?_.target.getAttribute("xfaOn"):_.target.getAttribute("xfaOff")})})}else{if(S.value!==null&&c.setAttribute("value",S.value),m==="print")break;c.addEventListener("input",_=>{f.setValue(u,{value:_.target.value})})}break;case"select":if(S.value!==null){c.setAttribute("value",S.value);for(const _ of d.children)_.attributes.value===S.value?_.attributes.selected=!0:_.attributes.hasOwnProperty("selected")&&delete _.attributes.selected}c.addEventListener("input",_=>{const v=_.target.options,b=v.selectedIndex===-1?"":v[v.selectedIndex].value;f.setValue(u,{value:b})});break}}static setAttributes({html:c,element:u,storage:d=null,intent:f,linkService:m}){const{attributes:S}=u,_=c instanceof HTMLAnchorElement;S.type==="radio"&&(S.name=`${S.name}-${f}`);for(const[v,b]of Object.entries(S))if(b!=null)switch(v){case"class":b.length&&c.setAttribute(v,b.join(" "));break;case"dataId":break;case"id":c.setAttribute("data-element-id",b);break;case"style":Object.assign(c.style,b);break;case"textContent":c.textContent=b;break;default:(!_||v!=="href"&&v!=="newWindow")&&c.setAttribute(v,b)}_&&m.addLinkAttributes(c,S.href,S.newWindow),d&&S.dataId&&this.setupStorage(c,S.dataId,u,d)}static render(c){var A,F;const u=c.annotationStorage,d=c.linkService,f=c.xfaHtml,m=c.intent||"display",S=document.createElement(f.name);f.attributes&&this.setAttributes({html:S,element:f,intent:m,linkService:d});const _=m!=="richText",v=c.div;if(v.append(S),c.viewport){const M=`matrix(${c.viewport.transform.join(",")})`;v.style.transform=M}_&&v.setAttribute("class","xfaLayer xfaFont");const b=[];if(f.children.length===0){if(f.value){const M=document.createTextNode(f.value);S.append(M),_&&n.XfaText.shouldBuildText(f.name)&&b.push(M)}return{textDivs:b}}const x=[[f,-1,S]];for(;x.length>0;){const[M,g,w]=x.at(-1);if(g+1===M.children.length){x.pop();continue}const E=M.children[++x.at(-1)[1]];if(E===null)continue;const{name:C}=E;if(C==="#text"){const I=document.createTextNode(E.value);b.push(I),w.append(I);continue}const B=(A=E==null?void 0:E.attributes)!=null&&A.xmlns?document.createElementNS(E.attributes.xmlns,C):document.createElement(C);if(w.append(B),E.attributes&&this.setAttributes({html:B,element:E,storage:u,intent:m,linkService:d}),((F=E.children)==null?void 0:F.length)>0)x.push([E,-1,B]);else if(E.value){const I=document.createTextNode(E.value);_&&n.XfaText.shouldBuildText(C)&&b.push(I),B.append(I)}}for(const M of v.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))M.setAttribute("readOnly",!0);return{textDivs:b}}static update(c){const u=`matrix(${c.viewport.transform.join(",")})`;c.div.style.transform=u,c.div.hidden=!1}}},50:(r,t,s)=>{s.d(t,{XfaText:()=>n});class n{static textContent(o){const c=[],u={items:c,styles:Object.create(null)};function d(f){var _;if(!f)return;let m=null;const S=f.name;if(S==="#text")m=f.value;else if(n.shouldBuildText(S))(_=f==null?void 0:f.attributes)!=null&&_.textContent?m=f.attributes.textContent:f.value&&(m=f.value);else return;if(m!==null&&c.push({str:m}),!!f.children)for(const v of f.children)d(v)}return d(o),u}static shouldBuildText(o){return!(o==="textarea"||o==="input"||o==="option"||o==="select")}}},228:(r,t,s)=>{s.a(r,async(n,a)=>{try{s.d(t,{AbortException:()=>o.AbortException,AnnotationEditorLayer:()=>f.AnnotationEditorLayer,AnnotationEditorParamsType:()=>o.AnnotationEditorParamsType,AnnotationEditorType:()=>o.AnnotationEditorType,AnnotationEditorUIManager:()=>m.AnnotationEditorUIManager,AnnotationLayer:()=>S.AnnotationLayer,AnnotationMode:()=>o.AnnotationMode,CMapCompressionType:()=>o.CMapCompressionType,ColorPicker:()=>_.ColorPicker,DOMSVGFactory:()=>u.DOMSVGFactory,DrawLayer:()=>v.DrawLayer,FeatureTest:()=>o.FeatureTest,GlobalWorkerOptions:()=>b.GlobalWorkerOptions,ImageKind:()=>o.ImageKind,InvalidPDFException:()=>o.InvalidPDFException,MissingPDFException:()=>o.MissingPDFException,OPS:()=>o.OPS,Outliner:()=>x.Outliner,PDFDataRangeTransport:()=>c.PDFDataRangeTransport,PDFDateString:()=>u.PDFDateString,PDFWorker:()=>c.PDFWorker,PasswordResponses:()=>o.PasswordResponses,PermissionFlag:()=>o.PermissionFlag,PixelsPerInch:()=>u.PixelsPerInch,RenderingCancelledException:()=>u.RenderingCancelledException,UnexpectedResponseException:()=>o.UnexpectedResponseException,Util:()=>o.Util,VerbosityLevel:()=>o.VerbosityLevel,XfaLayer:()=>A.XfaLayer,build:()=>c.build,createValidAbsoluteUrl:()=>o.createValidAbsoluteUrl,fetchData:()=>u.fetchData,getDocument:()=>c.getDocument,getFilenameFromUrl:()=>u.getFilenameFromUrl,getPdfFilenameFromUrl:()=>u.getPdfFilenameFromUrl,getXfaPageViewport:()=>u.getXfaPageViewport,isDataScheme:()=>u.isDataScheme,isPdfFile:()=>u.isPdfFile,noContextMenu:()=>u.noContextMenu,normalizeUnicode:()=>o.normalizeUnicode,renderTextLayer:()=>d.renderTextLayer,setLayerDimensions:()=>u.setLayerDimensions,shadow:()=>o.shadow,updateTextLayer:()=>d.updateTextLayer,version:()=>c.version});var o=s(292),c=s(831),u=s(419),d=s(814),f=s(731),m=s(830),S=s(976),_=s(259),v=s(47),b=s(164),x=s(61),A=s(284),F=n([c]);c=(F.then?(await F)():F)[0];const M="4.2.67",g="49b388101";a()}catch(M){a(M)}})},178:(r,t,s)=>{var d,b1,m,_1,_,uc;s.d(t,{MessageHandler:()=>u});var n=s(292);const a={UNKNOWN:0,DATA:1,ERROR:2},o={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function c(b){switch(b instanceof Error||typeof b=="object"&&b!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),b.name){case"AbortException":return new n.AbortException(b.message);case"MissingPDFException":return new n.MissingPDFException(b.message);case"PasswordException":return new n.PasswordException(b.message,b.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(b.message,b.status);case"UnknownErrorException":return new n.UnknownErrorException(b.message,b.details);default:return new n.UnknownErrorException(b.message,b.toString())}}class u{constructor(x,A,F){N(this,d);N(this,m);N(this,_);this.sourceName=x,this.targetName=A,this.comObj=F,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=M=>{const g=M.data;if(g.targetName!==this.sourceName)return;if(g.stream){Y(this,m,_1).call(this,g);return}if(g.callback){const E=g.callbackId,C=this.callbackCapabilities[E];if(!C)throw new Error(`Cannot resolve callback ${E}`);if(delete this.callbackCapabilities[E],g.callback===a.DATA)C.resolve(g.data);else if(g.callback===a.ERROR)C.reject(c(g.reason));else throw new Error("Unexpected callback case");return}const w=this.actionHandler[g.action];if(!w)throw new Error(`Unknown action from worker: ${g.action}`);if(g.callbackId){const E=this.sourceName,C=g.sourceName;new Promise(function(B){B(w(g.data))}).then(function(B){F.postMessage({sourceName:E,targetName:C,callback:a.DATA,callbackId:g.callbackId,data:B})},function(B){F.postMessage({sourceName:E,targetName:C,callback:a.ERROR,callbackId:g.callbackId,reason:c(B)})});return}if(g.streamId){Y(this,d,b1).call(this,g);return}w(g.data)},F.addEventListener("message",this._onComObjOnMessage)}on(x,A){const F=this.actionHandler;if(F[x])throw new Error(`There is already an actionName called "${x}"`);F[x]=A}send(x,A,F){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,data:A},F)}sendWithPromise(x,A,F){const M=this.callbackId++,g=Promise.withResolvers();this.callbackCapabilities[M]=g;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,callbackId:M,data:A},F)}catch(w){g.reject(w)}return g.promise}sendWithStream(x,A,F,M){const g=this.streamId++,w=this.sourceName,E=this.targetName,C=this.comObj;return new ReadableStream({start:B=>{const I=Promise.withResolvers();return this.streamControllers[g]={controller:B,startCall:I,pullCall:null,cancelCall:null,isClosed:!1},C.postMessage({sourceName:w,targetName:E,action:x,streamId:g,data:A,desiredSize:B.desiredSize},M),I.promise},pull:B=>{const I=Promise.withResolvers();return this.streamControllers[g].pullCall=I,C.postMessage({sourceName:w,targetName:E,stream:o.PULL,streamId:g,desiredSize:B.desiredSize}),I.promise},cancel:B=>{(0,n.assert)(B instanceof Error,"cancel must have a valid reason");const I=Promise.withResolvers();return this.streamControllers[g].cancelCall=I,this.streamControllers[g].isClosed=!0,C.postMessage({sourceName:w,targetName:E,stream:o.CANCEL,streamId:g,reason:c(B)}),I.promise}},F)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}d=new WeakSet,b1=function(x){const A=x.streamId,F=this.sourceName,M=x.sourceName,g=this.comObj,w=this,E=this.actionHandler[x.action],C={enqueue(B,I=1,rt){if(this.isCancelled)return;const tt=this.desiredSize;this.desiredSize-=I,tt>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),g.postMessage({sourceName:F,targetName:M,stream:o.ENQUEUE,streamId:A,chunk:B},rt)},close(){this.isCancelled||(this.isCancelled=!0,g.postMessage({sourceName:F,targetName:M,stream:o.CLOSE,streamId:A}),delete w.streamSinks[A])},error(B){(0,n.assert)(B instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,g.postMessage({sourceName:F,targetName:M,stream:o.ERROR,streamId:A,reason:c(B)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:x.desiredSize,ready:null};C.sinkCapability.resolve(),C.ready=C.sinkCapability.promise,this.streamSinks[A]=C,new Promise(function(B){B(E(x.data,C))}).then(function(){g.postMessage({sourceName:F,targetName:M,stream:o.START_COMPLETE,streamId:A,success:!0})},function(B){g.postMessage({sourceName:F,targetName:M,stream:o.START_COMPLETE,streamId:A,reason:c(B)})})},m=new WeakSet,_1=function(x){const A=x.streamId,F=this.sourceName,M=x.sourceName,g=this.comObj,w=this.streamControllers[A],E=this.streamSinks[A];switch(x.stream){case o.START_COMPLETE:x.success?w.startCall.resolve():w.startCall.reject(c(x.reason));break;case o.PULL_COMPLETE:x.success?w.pullCall.resolve():w.pullCall.reject(c(x.reason));break;case o.PULL:if(!E){g.postMessage({sourceName:F,targetName:M,stream:o.PULL_COMPLETE,streamId:A,success:!0});break}E.desiredSize<=0&&x.desiredSize>0&&E.sinkCapability.resolve(),E.desiredSize=x.desiredSize,new Promise(function(C){var B;C((B=E.onPull)==null?void 0:B.call(E))}).then(function(){g.postMessage({sourceName:F,targetName:M,stream:o.PULL_COMPLETE,streamId:A,success:!0})},function(C){g.postMessage({sourceName:F,targetName:M,stream:o.PULL_COMPLETE,streamId:A,reason:c(C)})});break;case o.ENQUEUE:if((0,n.assert)(w,"enqueue should have stream controller"),w.isClosed)break;w.controller.enqueue(x.chunk);break;case o.CLOSE:if((0,n.assert)(w,"close should have stream controller"),w.isClosed)break;w.isClosed=!0,w.controller.close(),Y(this,_,uc).call(this,w,A);break;case o.ERROR:(0,n.assert)(w,"error should have stream controller"),w.controller.error(c(x.reason)),Y(this,_,uc).call(this,w,A);break;case o.CANCEL_COMPLETE:x.success?w.cancelCall.resolve():w.cancelCall.reject(c(x.reason)),Y(this,_,uc).call(this,w,A);break;case o.CANCEL:if(!E)break;new Promise(function(C){var B;C((B=E.onCancel)==null?void 0:B.call(E,c(x.reason)))}).then(function(){g.postMessage({sourceName:F,targetName:M,stream:o.CANCEL_COMPLETE,streamId:A,success:!0})},function(C){g.postMessage({sourceName:F,targetName:M,stream:o.CANCEL_COMPLETE,streamId:A,reason:c(C)})}),E.sinkCapability.reject(c(x.reason)),E.isCancelled=!0,delete this.streamSinks[A];break;default:throw new Error("Unexpected stream case")}},_=new WeakSet,uc=async function(x,A){var F,M,g;await Promise.allSettled([(F=x.startCall)==null?void 0:F.promise,(M=x.pullCall)==null?void 0:M.promise,(g=x.cancelCall)==null?void 0:g.promise]),delete this.streamControllers[A]}},651:(r,t,s)=>{s.d(t,{MurmurHash3_64:()=>c});const n=3285377520,a=4294901760,o=65535;class c{constructor(d){this.h1=d?d&4294967295:n,this.h2=d?d&4294967295:n}update(d){let f,m;if(typeof d=="string"){f=new Uint8Array(d.length*2),m=0;for(let C=0,B=d.length;C<B;C++){const I=d.charCodeAt(C);I<=255?f[m++]=I:(f[m++]=I>>>8,f[m++]=I&255)}}else if(ArrayBuffer.isView(d))f=d.slice(),m=f.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const S=m>>2,_=m-S*4,v=new Uint32Array(f.buffer,0,S);let b=0,x=0,A=this.h1,F=this.h2;const M=3432918353,g=461845907,w=M&o,E=g&o;for(let C=0;C<S;C++)C&1?(b=v[C],b=b*M&a|b*w&o,b=b<<15|b>>>17,b=b*g&a|b*E&o,A^=b,A=A<<13|A>>>19,A=A*5+3864292196):(x=v[C],x=x*M&a|x*w&o,x=x<<15|x>>>17,x=x*g&a|x*E&o,F^=x,F=F<<13|F>>>19,F=F*5+3864292196);switch(b=0,_){case 3:b^=f[S*4+2]<<16;case 2:b^=f[S*4+1]<<8;case 1:b^=f[S*4],b=b*M&a|b*w&o,b=b<<15|b>>>17,b=b*g&a|b*E&o,S&1?A^=b:F^=b}this.h1=A,this.h2=F}hexdigest(){let d=this.h1,f=this.h2;return d^=f>>>1,d=d*3981806797&a|d*36045&o,f=f*4283543511&a|((f<<16|d>>>16)*2950163797&a)>>>16,d^=f>>>1,d=d*444984403&a|d*60499&o,f=f*3301882366&a|((f<<16|d>>>16)*3120437893&a)>>>16,d^=f>>>1,(d>>>0).toString(16).padStart(8,"0")+(f>>>0).toString(16).padStart(8,"0")}}},292:(r,t,s)=>{var V,fc,G,of;s.d(t,{AbortException:()=>ge,AnnotationBorderStyleType:()=>F,AnnotationEditorParamsType:()=>_,AnnotationEditorPrefix:()=>m,AnnotationEditorType:()=>S,AnnotationMode:()=>f,AnnotationPrefix:()=>H,AnnotationType:()=>A,BaseException:()=>Qt,CMapCompressionType:()=>g,FONT_IDENTITY_MATRIX:()=>o,FeatureTest:()=>ve,FontRenderOps:()=>L,FormatError:()=>oe,IDENTITY_MATRIX:()=>a,ImageKind:()=>x,InvalidPDFException:()=>ee,LINE_FACTOR:()=>u,MAX_IMAGE_SIZE_TO_CACHE:()=>c,MissingPDFException:()=>zt,OPS:()=>w,PasswordException:()=>ct,PasswordResponses:()=>E,PermissionFlag:()=>v,RenderingIntentFlag:()=>d,TextRenderingMode:()=>b,UnexpectedResponseException:()=>Jt,UnknownErrorException:()=>Dt,Util:()=>xe,VerbosityLevel:()=>M,assert:()=>wt,bytesToString:()=>Ae,createValidAbsoluteUrl:()=>Tt,getUuid:()=>D,getVerbosityLevel:()=>I,info:()=>rt,isNodeJS:()=>n,normalizeUnicode:()=>R,objectFromMap:()=>lt,setVerbosityLevel:()=>B,shadow:()=>Lt,string32:()=>Gt,stringToBytes:()=>Ve,unreachable:()=>st,warn:()=>tt});const n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),a=[1,0,0,1,0,0],o=[.001,0,0,.001,0,0],c=1e7,u=1.35,d={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},m="pdfjs_internal_editor_",S={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},_={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},v={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},b={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},x={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},A={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},F={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},M={ERRORS:0,WARNINGS:1,INFOS:5},g={NONE:0,BINARY:1},w={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},E={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let C=M.WARNINGS;function B(U){Number.isInteger(U)&&(C=U)}function I(){return C}function rt(U){C>=M.INFOS&&console.log(`Info: ${U}`)}function tt(U){C>=M.WARNINGS&&console.log(`Warning: ${U}`)}function st(U){throw new Error(U)}function wt(U,O){U||st(O)}function dt(U){switch(U==null?void 0:U.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Tt(U,O=null,z=null){var et;if(!U)return null;try{if(z&&typeof U=="string"&&(z.addDefaultProtocol&&U.startsWith("www.")&&((et=U.match(/\./g))==null?void 0:et.length)>=2&&(U=`http://${U}`),z.tryConvertEncoding))try{U=_e(U)}catch{}const nt=O?new URL(U,O):new URL(U);if(dt(nt))return nt}catch{}return null}function Lt(U,O,z,et=!1){return Object.defineProperty(U,O,{value:z,enumerable:!et,configurable:!0,writable:!1}),z}const Qt=function(){function U(O,z){this.constructor===U&&st("Cannot initialize BaseException."),this.message=O,this.name=z}return U.prototype=new Error,U.constructor=U,U}();class ct extends Qt{constructor(O,z){super(O,"PasswordException"),this.code=z}}class Dt extends Qt{constructor(O,z){super(O,"UnknownErrorException"),this.details=z}}class ee extends Qt{constructor(O){super(O,"InvalidPDFException")}}class zt extends Qt{constructor(O){super(O,"MissingPDFException")}}class Jt extends Qt{constructor(O,z){super(O,"UnexpectedResponseException"),this.status=z}}class oe extends Qt{constructor(O){super(O,"FormatError")}}class ge extends Qt{constructor(O){super(O,"AbortException")}}function Ae(U){(typeof U!="object"||(U==null?void 0:U.length)===void 0)&&st("Invalid argument for bytesToString");const O=U.length,z=8192;if(O<z)return String.fromCharCode.apply(null,U);const et=[];for(let nt=0;nt<O;nt+=z){const gt=Math.min(nt+z,O),yt=U.subarray(nt,gt);et.push(String.fromCharCode.apply(null,yt))}return et.join("")}function Ve(U){typeof U!="string"&&st("Invalid argument for stringToBytes");const O=U.length,z=new Uint8Array(O);for(let et=0;et<O;++et)z[et]=U.charCodeAt(et)&255;return z}function Gt(U){return String.fromCharCode(U>>24&255,U>>16&255,U>>8&255,U&255)}function lt(U){const O=Object.create(null);for(const[z,et]of U)O[z]=et;return O}function Ft(){const U=new Uint8Array(4);return U[0]=1,new Uint32Array(U.buffer,0,1)[0]===1}function Wt(){try{return new Function(""),!0}catch{return!1}}class ve{static get isLittleEndian(){return Lt(this,"isLittleEndian",Ft())}static get isEvalSupported(){return Lt(this,"isEvalSupported",Wt())}static get isOffscreenCanvasSupported(){return Lt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Lt(this,"platform",{isMac:navigator.platform.includes("Mac")}):Lt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var O,z;return Lt(this,"isCSSRoundSupported",(z=(O=globalThis.CSS)==null?void 0:O.supports)==null?void 0:z.call(O,"width: round(1.5px, 1px)"))}}const ie=Array.from(Array(256).keys(),U=>U.toString(16).padStart(2,"0"));class xe{static makeHexColor(O,z,et){return`#${ie[O]}${ie[z]}${ie[et]}`}static scaleMinMax(O,z){let et;O[0]?(O[0]<0&&(et=z[0],z[0]=z[2],z[2]=et),z[0]*=O[0],z[2]*=O[0],O[3]<0&&(et=z[1],z[1]=z[3],z[3]=et),z[1]*=O[3],z[3]*=O[3]):(et=z[0],z[0]=z[1],z[1]=et,et=z[2],z[2]=z[3],z[3]=et,O[1]<0&&(et=z[1],z[1]=z[3],z[3]=et),z[1]*=O[1],z[3]*=O[1],O[2]<0&&(et=z[0],z[0]=z[2],z[2]=et),z[0]*=O[2],z[2]*=O[2]),z[0]+=O[4],z[1]+=O[5],z[2]+=O[4],z[3]+=O[5]}static transform(O,z){return[O[0]*z[0]+O[2]*z[1],O[1]*z[0]+O[3]*z[1],O[0]*z[2]+O[2]*z[3],O[1]*z[2]+O[3]*z[3],O[0]*z[4]+O[2]*z[5]+O[4],O[1]*z[4]+O[3]*z[5]+O[5]]}static applyTransform(O,z){const et=O[0]*z[0]+O[1]*z[2]+z[4],nt=O[0]*z[1]+O[1]*z[3]+z[5];return[et,nt]}static applyInverseTransform(O,z){const et=z[0]*z[3]-z[1]*z[2],nt=(O[0]*z[3]-O[1]*z[2]+z[2]*z[5]-z[4]*z[3])/et,gt=(-O[0]*z[1]+O[1]*z[0]+z[4]*z[1]-z[5]*z[0])/et;return[nt,gt]}static getAxialAlignedBoundingBox(O,z){const et=this.applyTransform(O,z),nt=this.applyTransform(O.slice(2,4),z),gt=this.applyTransform([O[0],O[3]],z),yt=this.applyTransform([O[2],O[1]],z);return[Math.min(et[0],nt[0],gt[0],yt[0]),Math.min(et[1],nt[1],gt[1],yt[1]),Math.max(et[0],nt[0],gt[0],yt[0]),Math.max(et[1],nt[1],gt[1],yt[1])]}static inverseTransform(O){const z=O[0]*O[3]-O[1]*O[2];return[O[3]/z,-O[1]/z,-O[2]/z,O[0]/z,(O[2]*O[5]-O[4]*O[3])/z,(O[4]*O[1]-O[5]*O[0])/z]}static singularValueDecompose2dScale(O){const z=[O[0],O[2],O[1],O[3]],et=O[0]*z[0]+O[1]*z[2],nt=O[0]*z[1]+O[1]*z[3],gt=O[2]*z[0]+O[3]*z[2],yt=O[2]*z[1]+O[3]*z[3],Nt=(et+yt)/2,Ht=Math.sqrt((et+yt)**2-4*(et*yt-gt*nt))/2,Pt=Nt+Ht||1,Bt=Nt-Ht||1;return[Math.sqrt(Pt),Math.sqrt(Bt)]}static normalizeRect(O){const z=O.slice(0);return O[0]>O[2]&&(z[0]=O[2],z[2]=O[0]),O[1]>O[3]&&(z[1]=O[3],z[3]=O[1]),z}static intersect(O,z){const et=Math.max(Math.min(O[0],O[2]),Math.min(z[0],z[2])),nt=Math.min(Math.max(O[0],O[2]),Math.max(z[0],z[2]));if(et>nt)return null;const gt=Math.max(Math.min(O[1],O[3]),Math.min(z[1],z[3])),yt=Math.min(Math.max(O[1],O[3]),Math.max(z[1],z[3]));return gt>yt?null:[et,gt,nt,yt]}static bezierBoundingBox(O,z,et,nt,gt,yt,Nt,Ht,Pt){return Pt?(Pt[0]=Math.min(Pt[0],O,Nt),Pt[1]=Math.min(Pt[1],z,Ht),Pt[2]=Math.max(Pt[2],O,Nt),Pt[3]=Math.max(Pt[3],z,Ht)):Pt=[Math.min(O,Nt),Math.min(z,Ht),Math.max(O,Nt),Math.max(z,Ht)],Y(this,G,of).call(this,O,et,gt,Nt,z,nt,yt,Ht,3*(-O+3*(et-gt)+Nt),6*(O-2*et+gt),3*(et-O),Pt),Y(this,G,of).call(this,O,et,gt,Nt,z,nt,yt,Ht,3*(-z+3*(nt-yt)+Ht),6*(z-2*nt+yt),3*(nt-z),Pt),Pt}}V=new WeakSet,fc=function(O,z,et,nt,gt,yt,Nt,Ht,Pt,Bt){if(Pt<=0||Pt>=1)return;const Z=1-Pt,at=Pt*Pt,_t=at*Pt,vt=Z*(Z*(Z*O+3*Pt*z)+3*at*et)+_t*nt,jt=Z*(Z*(Z*gt+3*Pt*yt)+3*at*Nt)+_t*Ht;Bt[0]=Math.min(Bt[0],vt),Bt[1]=Math.min(Bt[1],jt),Bt[2]=Math.max(Bt[2],vt),Bt[3]=Math.max(Bt[3],jt)},G=new WeakSet,of=function(O,z,et,nt,gt,yt,Nt,Ht,Pt,Bt,Z,at){if(Math.abs(Pt)<1e-12){Math.abs(Bt)>=1e-12&&Y(this,V,fc).call(this,O,z,et,nt,gt,yt,Nt,Ht,-Z/Bt,at);return}const _t=Bt**2-4*Z*Pt;if(_t<0)return;const vt=Math.sqrt(_t),jt=2*Pt;Y(this,V,fc).call(this,O,z,et,nt,gt,yt,Nt,Ht,(-Bt+vt)/jt,at),Y(this,V,fc).call(this,O,z,et,nt,gt,yt,Nt,Ht,(-Bt-vt)/jt,at)},N(xe,V),N(xe,G);function _e(U){return decodeURIComponent(escape(U))}let ut=null,T=null;function R(U){return ut||(ut=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,T=new Map([["\uFB05","\u017Ft"]])),U.replaceAll(ut,(O,z,et)=>z?z.normalize("NFKC"):T.get(et))}function D(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const U=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(U);else for(let O=0;O<32;O++)U[O]=Math.floor(Math.random()*255);return Ae(U)}const H="pdfjs_internal_id_",L={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8}}},Pi={};function Mi(r){var t=Pi[r];if(t!==void 0)return t.exports;var s=Pi[r]={exports:{}};return Oi[r](s,s.exports,Mi),s.exports}(()=>{var r=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",t=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",s=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",n=o=>{o&&o.d<1&&(o.d=1,o.forEach(c=>c.r--),o.forEach(c=>c.r--?c.r++:c()))},a=o=>o.map(c=>{if(c!==null&&typeof c=="object"){if(c[r])return c;if(c.then){var u=[];u.d=0,c.then(m=>{d[t]=m,n(u)},m=>{d[s]=m,n(u)});var d={};return d[r]=m=>m(u),d}}var f={};return f[r]=m=>{},f[t]=c,f});Mi.a=(o,c,u)=>{var d;u&&((d=[]).d=-1);var f=new Set,m=o.exports,S,_,v,b=new Promise((x,A)=>{v=A,_=x});b[t]=m,b[r]=x=>(d&&x(d),f.forEach(x),b.catch(A=>{})),o.exports=b,c(x=>{S=a(x);var A,F=()=>S.map(g=>{if(g[s])throw g[s];return g[t]}),M=new Promise(g=>{A=()=>g(F),A.r=0;var w=E=>E!==d&&!f.has(E)&&(f.add(E),E&&!E.d&&(A.r++,E.push(A)));S.map(E=>E[r](w))});return A.r?M:F()},x=>(x?v(b[s]=x):_(m),n(d))),d&&d.d<0&&(d.d=0)}})(),Mi.d=(r,t)=>{for(var s in t)Mi.o(t,s)&&!Mi.o(r,s)&&Object.defineProperty(r,s,{enumerable:!0,get:t[s]})},Mi.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var Be=Mi(228);Be=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=Be),Be.AbortException,Be.AnnotationEditorLayer,Be.AnnotationEditorParamsType,Be.AnnotationEditorType,Be.AnnotationEditorUIManager,Be.AnnotationLayer,Be.AnnotationMode,Be.CMapCompressionType,Be.ColorPicker,Be.DOMSVGFactory,Be.DrawLayer,Be.FeatureTest;var pc=Be.GlobalWorkerOptions;Be.ImageKind,Be.InvalidPDFException,Be.MissingPDFException,Be.OPS,Be.Outliner,Be.PDFDataRangeTransport,Be.PDFDateString,Be.PDFWorker,Be.PasswordResponses,Be.PermissionFlag,Be.PixelsPerInch,Be.RenderingCancelledException,Be.UnexpectedResponseException,Be.Util,Be.VerbosityLevel,Be.XfaLayer,Be.build,Be.createValidAbsoluteUrl,Be.fetchData;var x1=Be.getDocument;Be.getFilenameFromUrl,Be.getPdfFilenameFromUrl,Be.getXfaPageViewport,Be.isDataScheme,Be.isPdfFile,Be.noContextMenu,Be.normalizeUnicode,Be.renderTextLayer,Be.setLayerDimensions,Be.shadow,Be.updateTextLayer,Be.version;const qo=0,As=1,Sa=2,lf=4;function hf(r,t){return s=>r(t(s))}function w1(r,t){return t(r)}function cf(r,t){return s=>r(t,s)}function df(r,t){return()=>r(t)}function Qo(r,t){return t(r),r}function ji(...r){return r}function A1(r){r()}function uf(r){return()=>r}function S1(...r){return()=>{r.map(A1)}}function gc(r){return r!==void 0}function Ea(){}function Ci(r,t){return r(As,t)}function ii(r,t){r(qo,t)}function mc(r){r(Sa)}function Ir(r){return r(lf)}function Ne(r,t){return Ci(r,cf(t,qo))}function Hn(r,t){const s=r(As,n=>{s(),t(n)});return s}function _i(){const r=[];return(t,s)=>{switch(t){case Sa:r.splice(0,r.length);return;case As:return r.push(s),()=>{const n=r.indexOf(s);n>-1&&r.splice(n,1)};case qo:r.slice().forEach(n=>{n(s)});return;default:throw new Error(`unrecognized action ${t}`)}}}function Ee(r){let t=r;const s=_i();return(n,a)=>{switch(n){case As:a(t);break;case qo:t=a;break;case lf:return t}return s(n,a)}}function E1(r){let t,s;const n=()=>t&&t();return function(a,o){switch(a){case As:return o?s===o?void 0:(n(),s=o,t=Ci(r,o),t):(n(),Ea);case Sa:n(),s=null;return;default:throw new Error(`unrecognized action ${a}`)}}}function rn(r){return Qo(_i(),t=>Ne(r,t))}function Br(r,t){return Qo(Ee(t),s=>Ne(r,s))}function C1(...r){return t=>r.reduceRight(w1,t)}function ce(r,...t){const s=C1(...t);return(n,a)=>{switch(n){case As:return Ci(r,s(a));case Sa:mc(r);return}}}function ff(r,t){return r===t}function Vi(r=ff){let t;return s=>n=>{r(t,n)||(t=n,s(n))}}function $e(r){return t=>s=>{r(s)&&t(s)}}function Fe(r){return t=>hf(t,r)}function Bn(r){return t=>()=>t(r)}function Un(r,t){return s=>n=>s(t=r(t,n))}function Ca(r){return t=>s=>{r>0?r--:t(s)}}function Ss(r){let t=null,s;return n=>a=>{t=a,!s&&(s=setTimeout(()=>{s=void 0,n(t)},r))}}function pf(r){let t,s;return n=>a=>{t=a,s&&clearTimeout(s),s=setTimeout(()=>{n(t)},r)}}function li(...r){const t=new Array(r.length);let s=0,n=null;const a=Math.pow(2,r.length)-1;return r.forEach((o,c)=>{const u=Math.pow(2,c);Ci(o,d=>{const f=s;s=s|u,t[c]=d,f!==a&&s===a&&n&&(n(),n=null)})}),o=>c=>{const u=()=>o([c].concat(t));s===a?u():n=u}}function gf(...r){return function(t,s){switch(t){case As:return S1(...r.map(n=>Ci(n,s)));case Sa:return;default:throw new Error(`unrecognized action ${t}`)}}}function Ke(r,t=ff){return ce(r,Vi(t))}function wr(...r){const t=_i(),s=new Array(r.length);let n=0;const a=Math.pow(2,r.length)-1;return r.forEach((o,c)=>{const u=Math.pow(2,c);Ci(o,d=>{s[c]=d,n=n|u,n===a&&ii(t,s)})}),function(o,c){switch(o){case As:return n===a&&c(s),Ci(t,c);case Sa:return mc(t);default:throw new Error(`unrecognized action ${o}`)}}}function ki(r,t=[],{singleton:s}={singleton:!0}){return{id:k1(),constructor:r,dependencies:t,singleton:s}}const k1=()=>Symbol();function T1(r){const t=new Map,s=({id:n,constructor:a,dependencies:o,singleton:c})=>{if(c&&t.has(n))return t.get(n);const u=a(o.map(d=>s(d)));return c&&t.set(n,u),u};return s(r)}function P1(r,t){const s={},n={};let a=0;const o=r.length;for(;a<o;)n[r[a]]=1,a+=1;for(const c in t)n.hasOwnProperty(c)||(s[c]=t[c]);return s}const Zo=typeof document<"u"?se.useLayoutEffect:se.useEffect;function mf(r,t,s){const n=Object.keys(t.required||{}),a=Object.keys(t.optional||{}),o=Object.keys(t.methods||{}),c=Object.keys(t.events||{}),u=se.createContext({});function d(A,F){A.propsReady&&ii(A.propsReady,!1);for(const M of n){const g=A[t.required[M]];ii(g,F[M])}for(const M of a)if(M in F){const g=A[t.optional[M]];ii(g,F[M])}A.propsReady&&ii(A.propsReady,!0)}function f(A){return o.reduce((F,M)=>(F[M]=g=>{const w=A[t.methods[M]];ii(w,g)},F),{})}function m(A){return c.reduce((F,M)=>(F[M]=E1(A[t.events[M]]),F),{})}const S=se.forwardRef((A,F)=>{const{children:M,...g}=A,[w]=se.useState(()=>Qo(T1(r),C=>d(C,g))),[E]=se.useState(df(m,w));return Zo(()=>{for(const C of c)C in g&&Ci(E[C],g[C]);return()=>{Object.values(E).map(mc)}},[g,E,w]),Zo(()=>{d(w,g)}),se.useImperativeHandle(F,uf(f(w))),se.createElement(u.Provider,{value:w},s?se.createElement(s,P1([...n,...a,...c],g),M):M)}),_=A=>se.useCallback(cf(ii,se.useContext(u)[A]),[A]),v=A=>{const F=se.useContext(u)[A],M=se.useCallback(g=>Ci(F,g),[F]);return se.useSyncExternalStore(M,()=>Ir(F),()=>Ir(F))},b=A=>{const F=se.useContext(u)[A],[M,g]=se.useState(df(Ir,F));return Zo(()=>Ci(F,w=>{w!==M&&g(uf(w))}),[F,M]),M},x=se.version.startsWith("18")?v:b;return{Component:S,usePublisher:_,useEmitterValue:x,useEmitter:(A,F)=>{const M=se.useContext(u)[A];Zo(()=>Ci(M,F),[F,M])}}}const M1=typeof document<"u"?se.useLayoutEffect:se.useEffect,R1=M1;var nn=(r=>(r[r.DEBUG=0]="DEBUG",r[r.INFO=1]="INFO",r[r.WARN=2]="WARN",r[r.ERROR=3]="ERROR",r))(nn||{});const F1={[0]:"debug",[1]:"log",[2]:"warn",[3]:"error"},I1=()=>typeof globalThis>"u"?window:globalThis,Es=ki(()=>{const r=Ee(3);return{log:Ee((t,s,n=1)=>{var a;const o=(a=I1().VIRTUOSO_LOG_LEVEL)!=null?a:Ir(r);n>=o&&console[F1[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,s)}),logLevel:r}},[],{singleton:!0});function vc(r,t=!0){const s=se.useRef(null);let n=a=>{};if(typeof ResizeObserver<"u"){const a=se.useMemo(()=>new ResizeObserver(o=>{requestAnimationFrame(()=>{const c=o[0].target;c.offsetParent!==null&&r(c)})}),[r]);n=o=>{o&&t?(a.observe(o),s.current=o):(s.current&&a.unobserve(s.current),s.current=null)}}return{ref:s,callbackRef:n}}function Ys(r,t=!0){return vc(r,t).callbackRef}function L1(r,t,s,n,a,o,c){const u=se.useCallback(d=>{const f=D1(d.children,t,"offsetHeight",a);let m=d.parentElement;for(;!m.dataset.virtuosoScroller;)m=m.parentElement;const S=m.lastElementChild.dataset.viewportType==="window",_=c?c.scrollTop:S?window.pageYOffset||document.documentElement.scrollTop:m.scrollTop,v=c?c.scrollHeight:S?document.documentElement.scrollHeight:m.scrollHeight,b=c?c.offsetHeight:S?window.innerHeight:m.offsetHeight;n({scrollTop:Math.max(_,0),scrollHeight:v,viewportHeight:b}),o==null||o(N1("row-gap",getComputedStyle(d).rowGap,a)),f!==null&&r(f)},[r,t,a,o,c,n]);return vc(u,s)}function D1(r,t,s,n){const a=r.length;if(a===0)return null;const o=[];for(let c=0;c<a;c++){const u=r.item(c);if(!u||u.dataset.index===void 0)continue;const d=parseInt(u.dataset.index),f=parseFloat(u.dataset.knownSize),m=t(u,s);if(m===0&&n("Zero-sized element, this should not happen",{child:u},nn.ERROR),m===f)continue;const S=o[o.length-1];o.length===0||S.size!==m||S.endIndex!==d-1?o.push({startIndex:d,endIndex:d,size:m}):o[o.length-1].endIndex++}return o}function N1(r,t,s){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&s(`${r} was not resolved to pixel value correctly`,t,nn.WARN),t==="normal"?0:parseInt(t??"0",10)}function Cs(r,t){return Math.round(r.getBoundingClientRect()[t])}function vf(r,t){return Math.abs(r-t)<1.01}function yf(r,t,s,n=Ea,a){const o=se.useRef(null),c=se.useRef(null),u=se.useRef(null),d=se.useCallback(S=>{const _=S.target,v=_===window||_===document,b=v?window.pageYOffset||document.documentElement.scrollTop:_.scrollTop,x=v?document.documentElement.scrollHeight:_.scrollHeight,A=v?window.innerHeight:_.offsetHeight,F=()=>{r({scrollTop:Math.max(b,0),scrollHeight:x,viewportHeight:A})};S.suppressFlushSync?F():Pw.flushSync(F),c.current!==null&&(b===c.current||b<=0||b===x-A)&&(c.current=null,t(!0),u.current&&(clearTimeout(u.current),u.current=null))},[r,t]);se.useEffect(()=>{const S=a||o.current;return n(a||o.current),d({target:S,suppressFlushSync:!0}),S.addEventListener("scroll",d,{passive:!0}),()=>{n(null),S.removeEventListener("scroll",d)}},[o,d,s,n,a]);function f(S){const _=o.current;if(!_||"offsetHeight"in _&&_.offsetHeight===0)return;const v=S.behavior==="smooth";let b,x,A;_===window?(x=Math.max(Cs(document.documentElement,"height"),document.documentElement.scrollHeight),b=window.innerHeight,A=document.documentElement.scrollTop):(x=_.scrollHeight,b=Cs(_,"height"),A=_.scrollTop);const F=x-b;if(S.top=Math.ceil(Math.max(Math.min(F,S.top),0)),vf(b,x)||S.top===A){r({scrollTop:A,scrollHeight:x,viewportHeight:b}),v&&t(!0);return}v?(c.current=S.top,u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{u.current=null,c.current=null,t(!0)},1e3)):c.current=null,_.scrollTo(S)}function m(S){o.current.scrollBy(S)}return{scrollerRef:o,scrollByCallback:m,scrollToCallback:f}}const Ur=ki(()=>{const r=_i(),t=_i(),s=Ee(0),n=_i(),a=Ee(0),o=_i(),c=_i(),u=Ee(0),d=Ee(0),f=Ee(0),m=Ee(0),S=_i(),_=_i(),v=Ee(!1);return Ne(ce(r,Fe(({scrollTop:b})=>b)),t),Ne(ce(r,Fe(({scrollHeight:b})=>b)),c),Ne(t,a),{scrollContainerState:r,scrollTop:t,viewportHeight:o,headerHeight:u,fixedHeaderHeight:d,fixedFooterHeight:f,footerHeight:m,scrollHeight:c,smoothScrollTargetReached:n,scrollTo:S,scrollBy:_,statefulScrollTop:a,deviation:s,scrollingInProgress:v}},[],{singleton:!0}),ro={lvl:0};function bf(r,t,s,n=ro,a=ro){return{k:r,v:t,lvl:s,l:n,r:a}}function Ii(r){return r===ro}function ka(){return ro}function yc(r,t){if(Ii(r))return ro;const{k:s,l:n,r:a}=r;if(t===s){if(Ii(n))return a;if(Ii(a))return n;{const[o,c]=_f(n);return Jo(fr(r,{k:o,v:c,l:xf(n)}))}}else return t<s?Jo(fr(r,{l:yc(n,t)})):Jo(fr(r,{r:yc(a,t)}))}function no(r,t){if(!Ii(r))return t===r.k?r.v:t<r.k?no(r.l,t):no(r.r,t)}function An(r,t,s="k"){if(Ii(r))return[-1/0,void 0];if(Number(r[s])===t)return[r.k,r.v];if(Number(r[s])<t){const n=An(r.r,t,s);return n[0]===-1/0?[r.k,r.v]:n}return An(r.l,t,s)}function sn(r,t,s){return Ii(r)?bf(t,s,1):t===r.k?fr(r,{k:t,v:s}):t<r.k?wf(fr(r,{l:sn(r.l,t,s)})):wf(fr(r,{r:sn(r.r,t,s)}))}function bc(r,t,s){if(Ii(r))return[];const{k:n,v:a,l:o,r:c}=r;let u=[];return n>t&&(u=u.concat(bc(o,t,s))),n>=t&&n<=s&&u.push({k:n,v:a}),n<=s&&(u=u.concat(bc(c,t,s))),u}function qs(r){return Ii(r)?[]:[...qs(r.l),{k:r.k,v:r.v},...qs(r.r)]}function _f(r){return Ii(r.r)?[r.k,r.v]:_f(r.r)}function xf(r){return Ii(r.r)?r.l:Jo(fr(r,{r:xf(r.r)}))}function fr(r,t){return bf(t.k!==void 0?t.k:r.k,t.v!==void 0?t.v:r.v,t.lvl!==void 0?t.lvl:r.lvl,t.l!==void 0?t.l:r.l,t.r!==void 0?t.r:r.r)}function _c(r){return Ii(r)||r.lvl>r.r.lvl}function wf(r){return xc(Sf(r))}function Jo(r){const{l:t,r:s,lvl:n}=r;if(s.lvl>=n-1&&t.lvl>=n-1)return r;if(n>s.lvl+1){if(_c(t))return Sf(fr(r,{lvl:n-1}));if(!Ii(t)&&!Ii(t.r))return fr(t.r,{l:fr(t,{r:t.r.l}),r:fr(r,{l:t.r.r,lvl:n-1}),lvl:n});throw new Error("Unexpected empty nodes")}else{if(_c(r))return xc(fr(r,{lvl:n-1}));if(!Ii(s)&&!Ii(s.l)){const a=s.l,o=_c(a)?s.lvl-1:s.lvl;return fr(a,{l:fr(r,{r:a.l,lvl:n-1}),r:xc(fr(s,{l:a.r,lvl:o})),lvl:a.lvl+1})}else throw new Error("Unexpected empty nodes")}}function tl(r,t,s){if(Ii(r))return[];const n=An(r,t)[0];return O1(bc(r,n,s))}function Af(r,t){const s=r.length;if(s===0)return[];let{index:n,value:a}=t(r[0]);const o=[];for(let c=1;c<s;c++){const{index:u,value:d}=t(r[c]);o.push({start:n,end:u-1,value:a}),n=u,a=d}return o.push({start:n,end:1/0,value:a}),o}function O1(r){return Af(r,({k:t,v:s})=>({index:t,value:s}))}function xc(r){const{r:t,lvl:s}=r;return!Ii(t)&&!Ii(t.r)&&t.lvl===s&&t.r.lvl===s?fr(t,{l:fr(r,{r:t.l}),lvl:s+1}):r}function Sf(r){const{l:t}=r;return!Ii(t)&&t.lvl===r.lvl?fr(t,{r:fr(r,{l:t.r})}):r}function el(r,t,s,n=0){let a=r.length-1;for(;n<=a;){const o=Math.floor((n+a)/2),c=r[o],u=s(c,t);if(u===0)return o;if(u===-1){if(a-n<2)return o-1;a=o-1}else{if(a===n)return o;n=o+1}}throw new Error(`Failed binary finding record in array - ${r.join(",")}, searched for ${t}`)}function Ef(r,t,s){return r[el(r,t,s)]}function z1(r,t,s,n){const a=el(r,t,n),o=el(r,s,n,a);return r.slice(a,o+1)}const wc=ki(()=>({recalcInProgress:Ee(!1)}),[],{singleton:!0});function H1(r){const{size:t,startIndex:s,endIndex:n}=r;return a=>a.start===s&&(a.end===n||a.end===1/0)&&a.value===t}function Cf(r,t){let s=0,n=0;for(;s<r;)s+=t[n+1]-t[n]-1,n++;return n-(s===r?0:1)}function B1(r,t){let s=Ii(r)?0:1/0;for(const n of t){const{size:a,startIndex:o,endIndex:c}=n;if(s=Math.min(s,o),Ii(r)){r=sn(r,0,a);continue}const u=tl(r,o-1,c+1);if(u.some(H1(n)))continue;let d=!1,f=!1;for(const{start:m,end:S,value:_}of u)d?(c>=m||a===_)&&(r=yc(r,m)):(f=_!==a,d=!0),S>c&&c>=m&&_!==a&&(r=sn(r,c+1,_));f&&(r=sn(r,o,a))}return[r,s]}function U1(){return{offsetTree:[],sizeTree:ka(),groupOffsetTree:ka(),lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]}}function Ac({index:r},t){return t===r?0:t<r?-1:1}function G1({offset:r},t){return t===r?0:t<r?-1:1}function j1(r){return{index:r.index,value:r}}function V1(r,t,s,n=0){return n>0&&(t=Math.max(t,Ef(r,n,Ac).offset)),Af(z1(r,t,s,G1),j1)}function Sc(r,t,s,n){let a=r,o=0,c=0,u=0,d=0;if(t!==0){d=el(a,t-1,Ac),u=a[d].offset;const f=An(s,t-1);o=f[0],c=f[1],a.length&&a[d].size===An(s,t)[1]&&(d-=1),a=a.slice(0,d+1)}else a=[];for(const{start:f,value:m}of tl(s,t,1/0)){const S=f-o,_=S*c+u+S*n;a.push({offset:_,size:m,index:f}),o=f,u=_,c=m}return{offsetTree:a,lastIndex:o,lastOffset:u,lastSize:c}}function W1(r,[t,s,n,a]){t.length>0&&n("received item sizes",t,nn.DEBUG);const o=r.sizeTree;let c=o,u=0;if(s.length>0&&Ii(o)&&t.length===2){const _=t[0].size,v=t[1].size;c=s.reduce((b,x)=>sn(sn(b,x,_),x+1,v),c)}else[c,u]=B1(c,t);if(c===o)return r;const{offsetTree:d,lastIndex:f,lastSize:m,lastOffset:S}=Sc(r.offsetTree,u,c,a);return{sizeTree:c,offsetTree:d,lastIndex:f,lastOffset:S,lastSize:m,groupOffsetTree:s.reduce((_,v)=>sn(_,v,so(v,d,a)),ka()),groupIndices:s}}function so(r,t,s){if(t.length===0)return 0;const{offset:n,index:a,size:o}=Ef(t,r,Ac),c=r-a,u=o*c+(c-1)*s+n;return u>0?u+s:u}function $1(r){return typeof r.groupIndex<"u"}function kf(r,t,s){if($1(r))return t.groupIndices[r.groupIndex]+1;{const n=r.index==="LAST"?s:r.index;let a=Tf(n,t);return a=Math.max(0,a,Math.min(s,a)),a}}function Tf(r,t){if(!il(t))return r;let s=0;for(;t.groupIndices[s]<=r+s;)s++;return r+s}function il(r){return!Ii(r.groupOffsetTree)}function K1(r){return qs(r).map(({k:t,v:s},n,a)=>{const o=a[n+1],c=o?o.k-1:1/0;return{startIndex:t,endIndex:c,size:s}})}const X1={offsetHeight:"height",offsetWidth:"width"},Gn=ki(([{log:r},{recalcInProgress:t}])=>{const s=_i(),n=_i(),a=Br(n,0),o=_i(),c=_i(),u=Ee(0),d=Ee([]),f=Ee(void 0),m=Ee(void 0),S=Ee((E,C)=>Cs(E,X1[C])),_=Ee(void 0),v=Ee(0),b=U1(),x=Br(ce(s,li(d,r,v),Un(W1,b),Vi()),b),A=Br(ce(d,Vi(),Un((E,C)=>({prev:E.current,current:C}),{prev:[],current:[]}),Fe(({prev:E})=>E)),[]);Ne(ce(d,$e(E=>E.length>0),li(x,v),Fe(([E,C,B])=>{const I=E.reduce((rt,tt,st)=>sn(rt,tt,so(tt,C.offsetTree,B)||st),ka());return{...C,groupIndices:E,groupOffsetTree:I}})),x),Ne(ce(n,li(x),$e(([E,{lastIndex:C}])=>E<C),Fe(([E,{lastIndex:C,lastSize:B}])=>[{startIndex:E,endIndex:C,size:B}])),s),Ne(f,m);const F=Br(ce(f,Fe(E=>E===void 0)),!0);Ne(ce(m,$e(E=>E!==void 0&&Ii(Ir(x).sizeTree)),Fe(E=>[{startIndex:0,endIndex:0,size:E}])),s);const M=rn(ce(s,li(x),Un(({sizes:E},[C,B])=>({changed:B!==E,sizes:B}),{changed:!1,sizes:b}),Fe(E=>E.changed)));Ci(ce(u,Un((E,C)=>({diff:E.prev-C,prev:C}),{diff:0,prev:0}),Fe(E=>E.diff)),E=>{const{groupIndices:C}=Ir(x);if(E>0)ii(t,!0),ii(o,E+Cf(E,C));else if(E<0){const B=Ir(A);B.length>0&&(E-=Cf(-E,B)),ii(c,E)}}),Ci(ce(u,li(r)),([E,C])=>{E<0&&C("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:u},nn.ERROR)});const g=rn(o);Ne(ce(o,li(x),Fe(([E,C])=>{const B=C.groupIndices.length>0,I=[],rt=C.lastSize;if(B){const tt=no(C.sizeTree,0);let st=0,wt=0;for(;st<E;){const Tt=C.groupIndices[wt],Lt=C.groupIndices.length===wt+1?1/0:C.groupIndices[wt+1]-Tt-1;I.push({startIndex:Tt,endIndex:Tt,size:tt}),I.push({startIndex:Tt+1,endIndex:Tt+1+Lt-1,size:rt}),wt++,st+=Lt+1}const dt=qs(C.sizeTree);return st!==E&&dt.shift(),dt.reduce((Tt,{k:Lt,v:Qt})=>{let ct=Tt.ranges;return Tt.prevSize!==0&&(ct=[...Tt.ranges,{startIndex:Tt.prevIndex,endIndex:Lt+E-1,size:Tt.prevSize}]),{ranges:ct,prevIndex:Lt+E,prevSize:Qt}},{ranges:I,prevIndex:E,prevSize:0}).ranges}return qs(C.sizeTree).reduce((tt,{k:st,v:wt})=>({ranges:[...tt.ranges,{startIndex:tt.prevIndex,endIndex:st+E-1,size:tt.prevSize}],prevIndex:st+E,prevSize:wt}),{ranges:[],prevIndex:0,prevSize:rt}).ranges})),s);const w=rn(ce(c,li(x,v),Fe(([E,{offsetTree:C},B])=>{const I=-E;return so(I,C,B)})));return Ne(ce(c,li(x,v),Fe(([E,C,B])=>{if(C.groupIndices.length>0){if(Ii(C.sizeTree))return C;let I=ka();const rt=Ir(A);let tt=0,st=0,wt=0;for(;tt<-E;){wt=rt[st];const dt=rt[st+1]-wt-1;st++,tt+=dt+1}if(I=qs(C.sizeTree).reduce((dt,{k:Tt,v:Lt})=>sn(dt,Math.max(0,Tt+E),Lt),I),tt!==-E){const dt=no(C.sizeTree,wt);I=sn(I,0,dt);const Tt=An(C.sizeTree,-E+1)[1];I=sn(I,1,Tt)}return{...C,sizeTree:I,...Sc(C.offsetTree,0,I,B)}}else{const I=qs(C.sizeTree).reduce((rt,{k:tt,v:st})=>sn(rt,Math.max(0,tt+E),st),ka());return{...C,sizeTree:I,...Sc(C.offsetTree,0,I,B)}}})),x),{data:_,totalCount:n,sizeRanges:s,groupIndices:d,defaultItemSize:m,fixedItemSize:f,unshiftWith:o,shiftWith:c,shiftWithOffset:w,beforeUnshiftWith:g,firstItemIndex:u,gap:v,sizes:x,listRefresh:M,statefulTotalCount:a,trackItemSizes:F,itemSize:S}},ji(Es,wc),{singleton:!0}),Y1=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function Pf(r){const t=typeof r=="number"?{index:r}:r;return t.align||(t.align="start"),(!t.behavior||!Y1)&&(t.behavior="auto"),t.offset||(t.offset=0),t}const ao=ki(([{sizes:r,totalCount:t,listRefresh:s,gap:n},{scrollingInProgress:a,viewportHeight:o,scrollTo:c,smoothScrollTargetReached:u,headerHeight:d,footerHeight:f,fixedHeaderHeight:m,fixedFooterHeight:S},{log:_}])=>{const v=_i(),b=_i(),x=Ee(0);let A=null,F=null,M=null;function g(){A&&(A(),A=null),M&&(M(),M=null),F&&(clearTimeout(F),F=null),ii(a,!1)}return Ne(ce(v,li(r,o,t,x,d,f,_),li(n,m,S),Fe(([[w,E,C,B,I,rt,tt,st],wt,dt,Tt])=>{const Lt=Pf(w),{align:Qt,behavior:ct,offset:Dt}=Lt,ee=B-1,zt=kf(Lt,E,ee);let Jt=so(zt,E.offsetTree,wt)+rt;Qt==="end"?(Jt+=dt+An(E.sizeTree,zt)[1]-C+Tt,zt===ee&&(Jt+=tt)):Qt==="center"?Jt+=(dt+An(E.sizeTree,zt)[1]-C+Tt)/2:Jt-=I,Dt&&(Jt+=Dt);const oe=ge=>{g(),ge?(st("retrying to scroll to",{location:w},nn.DEBUG),ii(v,w)):(ii(b,!0),st("list did not change, scroll successful",{},nn.DEBUG))};if(g(),ct==="smooth"){let ge=!1;M=Ci(s,Ae=>{ge=ge||Ae}),A=Hn(u,()=>{oe(ge)})}else A=Hn(ce(s,q1(150)),oe);return F=setTimeout(()=>{g()},1200),ii(a,!0),st("scrolling from index to",{index:zt,top:Jt,behavior:ct},nn.DEBUG),{top:Jt,behavior:ct}})),c),{scrollToIndex:v,scrollTargetReached:b,topListHeight:x}},ji(Gn,Ur,Es),{singleton:!0});function q1(r){return t=>{const s=setTimeout(()=>{t(!1)},r);return n=>{n&&(t(!0),clearTimeout(s))}}}const oo="up",lo="down",Q1="none",Z1={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},J1=0,ho=ki(([{scrollContainerState:r,scrollTop:t,viewportHeight:s,headerHeight:n,footerHeight:a,scrollBy:o}])=>{const c=Ee(!1),u=Ee(!0),d=_i(),f=_i(),m=Ee(4),S=Ee(J1),_=Br(ce(gf(ce(Ke(t),Ca(1),Bn(!0)),ce(Ke(t),Ca(1),Bn(!1),pf(100))),Vi()),!1),v=Br(ce(gf(ce(o,Bn(!0)),ce(o,Bn(!1),pf(200))),Vi()),!1);Ne(ce(wr(Ke(t),Ke(S)),Fe(([M,g])=>M<=g),Vi()),u),Ne(ce(u,Ss(50)),f);const b=rn(ce(wr(r,Ke(s),Ke(n),Ke(a),Ke(m)),Un((M,[{scrollTop:g,scrollHeight:w},E,C,B,I])=>{const rt=g+E-w>-I,tt={viewportHeight:E,scrollTop:g,scrollHeight:w};if(rt){let wt,dt;return g>M.state.scrollTop?(wt="SCROLLED_DOWN",dt=M.state.scrollTop-g):(wt="SIZE_DECREASED",dt=M.state.scrollTop-g||M.scrollTopDelta),{atBottom:!0,state:tt,atBottomBecause:wt,scrollTopDelta:dt}}let st;return tt.scrollHeight>M.state.scrollHeight?st="SIZE_INCREASED":E<M.state.viewportHeight?st="VIEWPORT_HEIGHT_DECREASING":g<M.state.scrollTop?st="SCROLLING_UPWARDS":st="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:st,state:tt}},Z1),Vi((M,g)=>M&&M.atBottom===g.atBottom))),x=Br(ce(r,Un((M,{scrollTop:g,scrollHeight:w,viewportHeight:E})=>{if(vf(M.scrollHeight,w))return{scrollTop:g,scrollHeight:w,jump:0,changed:!1};{const C=w-(g+E)<1;return M.scrollTop!==g&&C?{scrollHeight:w,scrollTop:g,jump:M.scrollTop-g,changed:!0}:{scrollHeight:w,scrollTop:g,jump:0,changed:!0}}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),$e(M=>M.changed),Fe(M=>M.jump)),0);Ne(ce(b,Fe(M=>M.atBottom)),c),Ne(ce(c,Ss(50)),d);const A=Ee(lo);Ne(ce(r,Fe(({scrollTop:M})=>M),Vi(),Un((M,g)=>Ir(v)?{direction:M.direction,prevScrollTop:g}:{direction:g<M.prevScrollTop?oo:lo,prevScrollTop:g},{direction:lo,prevScrollTop:0}),Fe(M=>M.direction)),A),Ne(ce(r,Ss(50),Bn(Q1)),A);const F=Ee(0);return Ne(ce(_,$e(M=>!M),Bn(0)),F),Ne(ce(t,Ss(100),li(_),$e(([M,g])=>!!g),Un(([M,g],[w])=>[g,w],[0,0]),Fe(([M,g])=>g-M)),F),{isScrolling:_,isAtTop:u,isAtBottom:c,atBottomState:b,atTopStateChange:f,atBottomStateChange:d,scrollDirection:A,atBottomThreshold:m,atTopThreshold:S,scrollVelocity:F,lastJumpDueToItemResize:x}},ji(Ur)),ks=ki(([{log:r}])=>{const t=Ee(!1),s=rn(ce(t,$e(n=>n),Vi()));return Ci(t,n=>{n&&Ir(r)("props updated",{},nn.DEBUG)}),{propsReady:t,didMount:s}},ji(Es),{singleton:!0});function Ec(r,t){r==0?t():requestAnimationFrame(()=>Ec(r-1,t))}function Cc(r,t){const s=t-1;return typeof r=="number"?r:r.index==="LAST"?s:r.index}const co=ki(([{sizes:r,listRefresh:t,defaultItemSize:s},{scrollTop:n},{scrollToIndex:a,scrollTargetReached:o},{didMount:c}])=>{const u=Ee(!0),d=Ee(0),f=Ee(!0);return Ne(ce(c,li(d),$e(([m,S])=>!!S),Bn(!1)),u),Ne(ce(c,li(d),$e(([m,S])=>!!S),Bn(!1)),f),Ci(ce(wr(t,c),li(u,r,s,f),$e(([[,m],S,{sizeTree:_},v,b])=>m&&(!Ii(_)||gc(v))&&!S&&!b),li(d)),([,m])=>{Hn(o,()=>{ii(f,!0)}),Ec(4,()=>{Hn(n,()=>{ii(u,!0)}),ii(a,m)})}),{scrolledToInitialItem:u,initialTopMostItemIndex:d,initialItemFinalLocationReached:f}},ji(Gn,Ur,ao,ks),{singleton:!0});function Mf(r){return r?r==="smooth"?"smooth":"auto":!1}const tv=(r,t)=>typeof r=="function"?Mf(r(t)):t&&Mf(r),ev=ki(([{totalCount:r,listRefresh:t},{isAtBottom:s,atBottomState:n},{scrollToIndex:a},{scrolledToInitialItem:o},{propsReady:c,didMount:u},{log:d},{scrollingInProgress:f}])=>{const m=Ee(!1),S=_i();let _=null;function v(x){ii(a,{index:"LAST",align:"end",behavior:x})}Ci(ce(wr(ce(Ke(r),Ca(1)),u),li(Ke(m),s,o,f),Fe(([[x,A],F,M,g,w])=>{let E=A&&g,C="auto";return E&&(C=tv(F,M||w),E=E&&!!C),{totalCount:x,shouldFollow:E,followOutputBehavior:C}}),$e(({shouldFollow:x})=>x)),({totalCount:x,followOutputBehavior:A})=>{_&&(_(),_=null),_=Hn(t,()=>{Ir(d)("following output to ",{totalCount:x},nn.DEBUG),v(A),_=null})});function b(x){const A=Hn(n,F=>{x&&!F.atBottom&&F.notAtBottomBecause==="SIZE_INCREASED"&&!_&&(Ir(d)("scrolling to bottom due to increased size",{},nn.DEBUG),v("auto"))});setTimeout(A,100)}return Ci(ce(wr(Ke(m),r,c),$e(([x,,A])=>x&&A),Un(({value:x},[,A])=>({refreshed:x===A,value:A}),{refreshed:!1,value:0}),$e(({refreshed:x})=>x),li(m,r)),([,x])=>{Ir(o)&&b(x!==!1)}),Ci(S,()=>{b(Ir(m)!==!1)}),Ci(wr(Ke(m),n),([x,A])=>{x&&!A.atBottom&&A.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&v("auto")}),{followOutput:m,autoscrollToBottom:S}},ji(Gn,ho,ao,co,ks,Es,Ur));function iv(r){return r.reduce((t,s)=>(t.groupIndices.push(t.totalCount),t.totalCount+=s+1,t),{totalCount:0,groupIndices:[]})}const Rf=ki(([{totalCount:r,groupIndices:t,sizes:s},{scrollTop:n,headerHeight:a}])=>{const o=_i(),c=_i(),u=rn(ce(o,Fe(iv)));return Ne(ce(u,Fe(d=>d.totalCount)),r),Ne(ce(u,Fe(d=>d.groupIndices)),t),Ne(ce(wr(n,s,a),$e(([d,f])=>il(f)),Fe(([d,f,m])=>An(f.groupOffsetTree,Math.max(d-m,0),"v")[0]),Vi(),Fe(d=>[d])),c),{groupCounts:o,topItemsIndexes:c}},ji(Gn,Ur));function uo(r,t){return!!(r&&r[0]===t[0]&&r[1]===t[1])}function Ff(r,t){return!!(r&&r.startIndex===t.startIndex&&r.endIndex===t.endIndex)}const rl="top",nl="bottom",If="none";function Lf(r,t,s){return typeof r=="number"?s===oo&&t===rl||s===lo&&t===nl?r:0:s===oo?t===rl?r.main:r.reverse:t===nl?r.main:r.reverse}function Df(r,t){return typeof r=="number"?r:r[t]||0}const kc=ki(([{scrollTop:r,viewportHeight:t,deviation:s,headerHeight:n,fixedHeaderHeight:a}])=>{const o=_i(),c=Ee(0),u=Ee(0),d=Ee(0),f=Br(ce(wr(Ke(r),Ke(t),Ke(n),Ke(o,uo),Ke(d),Ke(c),Ke(a),Ke(s),Ke(u)),Fe(([m,S,_,[v,b],x,A,F,M,g])=>{const w=m-M,E=A+F,C=Math.max(_-w,0);let B=If;const I=Df(g,rl),rt=Df(g,nl);return v-=M,v+=_+F,b+=_+F,b-=M,v>m+E-I&&(B=oo),b<m-C+S+rt&&(B=lo),B!==If?[Math.max(w-_-Lf(x,rl,B)-I,0),w-C-F+S+Lf(x,nl,B)+rt]:null}),$e(m=>m!=null),Vi(uo)),[0,0]);return{listBoundary:o,overscan:d,topListHeight:c,increaseViewportBy:u,visibleRange:f}},ji(Ur),{singleton:!0});function rv(r,t,s){if(il(t)){const n=Tf(r,t);return[{index:An(t.groupOffsetTree,n)[0],size:0,offset:0},{index:n,size:0,offset:0,data:s&&s[0]}]}return[{index:r,size:0,offset:0,data:s&&s[0]}]}const Tc={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0};function Nf(r,t,s){if(r.length===0)return[];if(!il(t))return r.map(f=>({...f,index:f.index+s,originalIndex:f.index}));const n=r[0].index,a=r[r.length-1].index,o=[],c=tl(t.groupOffsetTree,n,a);let u,d=0;for(const f of r){(!u||u.end<f.index)&&(u=c.shift(),d=t.groupIndices.indexOf(u.start));let m;f.index===u.start?m={type:"group",index:d}:m={index:f.index-(d+1)+s,groupIndex:d},o.push({...m,size:f.size,offset:f.offset,originalIndex:f.index,data:f.data})}return o}function sl(r,t,s,n,a,o){const{lastSize:c,lastOffset:u,lastIndex:d}=a;let f=0,m=0;if(r.length>0){f=r[0].offset;const x=r[r.length-1];m=x.offset+x.size}const S=s-d,_=u+S*c+(S-1)*n,v=f,b=_-m;return{items:Nf(r,a,o),topItems:Nf(t,a,o),topListHeight:t.reduce((x,A)=>A.size+x,0),offsetTop:f,offsetBottom:b,top:v,bottom:m,totalCount:s,firstItemIndex:o}}function Of(r,t,s,n,a,o){let c=0;if(s.groupIndices.length>0)for(const m of s.groupIndices){if(m-c>=r)break;c++}const u=r+c,d=Cc(t,u),f=Array.from({length:u}).map((m,S)=>({index:S+d,size:0,offset:0,data:o[S+d]}));return sl(f,[],u,a,s,n)}const Qs=ki(([{sizes:r,totalCount:t,data:s,firstItemIndex:n,gap:a},o,{visibleRange:c,listBoundary:u,topListHeight:d},{scrolledToInitialItem:f,initialTopMostItemIndex:m},{topListHeight:S},_,{didMount:v},{recalcInProgress:b}])=>{const x=Ee([]),A=Ee(0),F=_i();Ne(o.topItemsIndexes,x);const M=Br(ce(wr(v,b,Ke(c,uo),Ke(t),Ke(r),Ke(m),f,Ke(x),Ke(n),Ke(a),s),$e(([C,B,,I,,,,,,,rt])=>{const tt=rt&&rt.length!==I;return C&&!B&&!tt}),Fe(([,,[C,B],I,rt,tt,st,wt,dt,Tt,Lt])=>{const Qt=rt,{sizeTree:ct,offsetTree:Dt}=Qt,ee=Ir(A);if(I===0)return{...Tc,totalCount:I};if(C===0&&B===0)return ee===0?{...Tc,totalCount:I}:Of(ee,tt,rt,dt,Tt,Lt||[]);if(Ii(ct))return ee>0?null:sl(rv(Cc(tt,I),Qt,Lt),[],I,Tt,Qt,dt);const zt=[];if(wt.length>0){const Ve=wt[0],Gt=wt[wt.length-1];let lt=0;for(const Ft of tl(ct,Ve,Gt)){const Wt=Ft.value,ve=Math.max(Ft.start,Ve),ie=Math.min(Ft.end,Gt);for(let xe=ve;xe<=ie;xe++)zt.push({index:xe,size:Wt,offset:lt,data:Lt&&Lt[xe]}),lt+=Wt}}if(!st)return sl([],zt,I,Tt,Qt,dt);const Jt=wt.length>0?wt[wt.length-1]+1:0,oe=V1(Dt,C,B,Jt);if(oe.length===0)return null;const ge=I-1,Ae=Qo([],Ve=>{for(const Gt of oe){const lt=Gt.value;let Ft=lt.offset,Wt=Gt.start;const ve=lt.size;if(lt.offset<C){Wt+=Math.floor((C-lt.offset+Tt)/(ve+Tt));const xe=Wt-Gt.start;Ft+=xe*ve+xe*Tt}Wt<Jt&&(Ft+=(Jt-Wt)*ve,Wt=Jt);const ie=Math.min(Gt.end,ge);for(let xe=Wt;xe<=ie&&!(Ft>=B);xe++)Ve.push({index:xe,size:ve,offset:Ft,data:Lt&&Lt[xe]}),Ft+=ve+Tt}});return sl(Ae,zt,I,Tt,Qt,dt)}),$e(C=>C!==null),Vi()),Tc);Ne(ce(s,$e(gc),Fe(C=>C==null?void 0:C.length)),t),Ne(ce(M,Fe(C=>C.topListHeight)),S),Ne(S,d),Ne(ce(M,Fe(C=>[C.top,C.bottom])),u),Ne(ce(M,Fe(C=>C.items)),F);const g=rn(ce(M,$e(({items:C})=>C.length>0),li(t,s),$e(([{items:C},B])=>C[C.length-1].originalIndex===B-1),Fe(([,C,B])=>[C-1,B]),Vi(uo),Fe(([C])=>C))),w=rn(ce(M,Ss(200),$e(({items:C,topItems:B})=>C.length>0&&C[0].originalIndex===B.length),Fe(({items:C})=>C[0].index),Vi())),E=rn(ce(M,$e(({items:C})=>C.length>0),Fe(({items:C})=>{let B=0,I=C.length-1;for(;C[B].type==="group"&&B<I;)B++;for(;C[I].type==="group"&&I>B;)I--;return{startIndex:C[B].index,endIndex:C[I].index}}),Vi(Ff)));return{listState:M,topItemsIndexes:x,endReached:g,startReached:w,rangeChanged:E,itemsRendered:F,initialItemCount:A,..._}},ji(Gn,Rf,kc,co,ao,ho,ks,wc),{singleton:!0}),nv=ki(([{sizes:r,firstItemIndex:t,data:s,gap:n},{initialTopMostItemIndex:a},{initialItemCount:o,listState:c},{didMount:u}])=>(Ne(ce(u,li(o),$e(([,d])=>d!==0),li(a,r,t,n,s),Fe(([[,d],f,m,S,_,v=[]])=>Of(d,f,m,S,_,v))),c),{}),ji(Gn,co,Qs,ks),{singleton:!0}),zf=ki(([{scrollVelocity:r}])=>{const t=Ee(!1),s=_i(),n=Ee(!1);return Ne(ce(r,li(n,t,s),$e(([a,o])=>!!o),Fe(([a,o,c,u])=>{const{exit:d,enter:f}=o;if(c){if(d(a,u))return!1}else if(f(a,u))return!0;return c}),Vi()),t),Ci(ce(wr(t,r,s),li(n)),([[a,o,c],u])=>a&&u&&u.change&&u.change(o,c)),{isSeeking:t,scrollSeekConfiguration:n,scrollVelocity:r,scrollSeekRangeChanged:s}},ji(ho),{singleton:!0}),sv=ki(([{topItemsIndexes:r}])=>{const t=Ee(0);return Ne(ce(t,$e(s=>s>0),Fe(s=>Array.from({length:s}).map((n,a)=>a))),r),{topItemCount:t}},ji(Qs)),Hf=ki(([{footerHeight:r,headerHeight:t,fixedHeaderHeight:s,fixedFooterHeight:n},{listState:a}])=>{const o=_i(),c=Br(ce(wr(r,n,t,s,a),Fe(([u,d,f,m,S])=>u+d+f+m+S.offsetBottom+S.bottom)),0);return Ne(Ke(c),o),{totalListHeight:c,totalListHeightChanged:o}},ji(Ur,Qs),{singleton:!0});function Bf(r){let t=!1,s;return()=>(t||(t=!0,s=r()),s)}const av=Bf(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),ov=ki(([{scrollBy:r,scrollTop:t,deviation:s,scrollingInProgress:n},{isScrolling:a,isAtBottom:o,scrollDirection:c,lastJumpDueToItemResize:u},{listState:d},{beforeUnshiftWith:f,shiftWithOffset:m,sizes:S,gap:_},{log:v},{recalcInProgress:b}])=>{const x=rn(ce(d,li(u),Un(([,F,M,g],[{items:w,totalCount:E,bottom:C,offsetBottom:B},I])=>{const rt=C+B;let tt=0;return M===E&&F.length>0&&w.length>0&&(w[0].originalIndex===0&&F[0].originalIndex===0||(tt=rt-g,tt!==0&&(tt+=I))),[tt,w,E,rt]},[0,[],0,0]),$e(([F])=>F!==0),li(t,c,n,o,v,b),$e(([,F,M,g,,,w])=>!w&&!g&&F!==0&&M===oo),Fe(([[F],,,,,M])=>(M("Upward scrolling compensation",{amount:F},nn.DEBUG),F))));function A(F){F>0?(ii(r,{top:-F,behavior:"auto"}),ii(s,0)):(ii(s,0),ii(r,{top:-F,behavior:"auto"}))}return Ci(ce(x,li(s,a)),([F,M,g])=>{g&&av()?ii(s,M-F):A(-F)}),Ci(ce(wr(Br(a,!1),s,b),$e(([F,M,g])=>!F&&!g&&M!==0),Fe(([F,M])=>M),Ss(1)),A),Ne(ce(m,Fe(F=>({top:-F}))),r),Ci(ce(f,li(S,_),Fe(([F,{lastSize:M,groupIndices:g,sizeTree:w},E])=>{function C(B){return B*(M+E)}if(g.length===0)return C(F);{let B=0;const I=no(w,0);let rt=0,tt=0;for(;rt<F;){rt++,B+=I;let st=g.length===tt+1?1/0:g[tt+1]-g[tt]-1;rt+st>F&&(B-=I,st=F-rt+1),rt+=st,B+=C(st),tt++}return B}})),F=>{ii(s,F),requestAnimationFrame(()=>{ii(r,{top:F}),requestAnimationFrame(()=>{ii(s,0),ii(b,!1)})})}),{deviation:s}},ji(Ur,ho,Qs,Gn,Es,wc)),lv=ki(([{didMount:r},{scrollTo:t},{listState:s}])=>{const n=Ee(0);return Ci(ce(r,li(n),$e(([,a])=>a!==0),Fe(([,a])=>({top:a}))),a=>{Hn(ce(s,Ca(1),$e(o=>o.items.length>1)),()=>{requestAnimationFrame(()=>{ii(t,a)})})}),{initialScrollTop:n}},ji(ks,Ur,Qs),{singleton:!0}),hv=ki(([{viewportHeight:r},{totalListHeight:t}])=>{const s=Ee(!1),n=Br(ce(wr(s,r,t),$e(([a])=>a),Fe(([,a,o])=>Math.max(0,a-o)),Ss(0),Vi()),0);return{alignToBottom:s,paddingTopAddition:n}},ji(Ur,Hf),{singleton:!0}),Pc=ki(([{scrollTo:r,scrollContainerState:t}])=>{const s=_i(),n=_i(),a=_i(),o=Ee(!1),c=Ee(void 0);return Ne(ce(wr(s,n),Fe(([{viewportHeight:u,scrollTop:d,scrollHeight:f},{offsetTop:m}])=>({scrollTop:Math.max(0,d-m),scrollHeight:f,viewportHeight:u}))),t),Ne(ce(r,li(n),Fe(([u,{offsetTop:d}])=>({...u,top:u.top+d}))),a),{useWindowScroll:o,customScrollParent:c,windowScrollContainerState:s,windowViewportRect:n,windowScrollTo:a}},ji(Ur)),cv=({itemTop:r,itemBottom:t,viewportTop:s,viewportBottom:n,locationParams:{behavior:a,align:o,...c}})=>r<s?{...c,behavior:a,align:o??"start"}:t>n?{...c,behavior:a,align:o??"end"}:null,dv=ki(([{sizes:r,totalCount:t,gap:s},{scrollTop:n,viewportHeight:a,headerHeight:o,fixedHeaderHeight:c,fixedFooterHeight:u,scrollingInProgress:d},{scrollToIndex:f}])=>{const m=_i();return Ne(ce(m,li(r,a,t,o,c,u,n),li(s),Fe(([[S,_,v,b,x,A,F,M],g])=>{const{done:w,behavior:E,align:C,calculateViewLocation:B=cv,...I}=S,rt=kf(S,_,b-1),tt=so(rt,_.offsetTree,g)+x+A,st=tt+An(_.sizeTree,rt)[1],wt=M+A,dt=M+v-F,Tt=B({itemTop:tt,itemBottom:st,viewportTop:wt,viewportBottom:dt,locationParams:{behavior:E,align:C,...I}});return Tt?w&&Hn(ce(d,$e(Lt=>Lt===!1),Ca(Ir(d)?1:2)),w):w&&w(),Tt}),$e(S=>S!==null)),f),{scrollIntoView:m}},ji(Gn,Ur,ao,Qs,Es),{singleton:!0}),uv=ki(([{sizes:r,sizeRanges:t},{scrollTop:s},{initialTopMostItemIndex:n},{didMount:a},{useWindowScroll:o,windowScrollContainerState:c,windowViewportRect:u}])=>{const d=_i(),f=Ee(void 0),m=Ee(null),S=Ee(null);return Ne(c,m),Ne(u,S),Ci(ce(d,li(r,s,o,m,S)),([_,v,b,x,A,F])=>{const M=K1(v.sizeTree);x&&A!==null&&F!==null&&(b=A.scrollTop-F.offsetTop),_({ranges:M,scrollTop:b})}),Ne(ce(f,$e(gc),Fe(fv)),n),Ne(ce(a,li(f),$e(([,_])=>_!==void 0),Vi(),Fe(([,_])=>_.ranges)),t),{getState:d,restoreStateFrom:f}},ji(Gn,Ur,co,ks,Pc));function fv(r){return{offset:r.scrollTop,index:0,align:"start"}}const pv=ki(([r,t,s,n,a,o,c,u,d,f])=>({...r,...t,...s,...n,...a,...o,...c,...u,...d,...f}),ji(kc,nv,ks,zf,Hf,lv,hv,Pc,dv,Es)),gv=ki(([{totalCount:r,sizeRanges:t,fixedItemSize:s,defaultItemSize:n,trackItemSizes:a,itemSize:o,data:c,firstItemIndex:u,groupIndices:d,statefulTotalCount:f,gap:m,sizes:S},{initialTopMostItemIndex:_,scrolledToInitialItem:v,initialItemFinalLocationReached:b},x,A,F,{listState:M,topItemsIndexes:g,...w},{scrollToIndex:E},C,{topItemCount:B},{groupCounts:I},rt])=>(Ne(w.rangeChanged,rt.scrollSeekRangeChanged),Ne(ce(rt.windowViewportRect,Fe(tt=>tt.visibleHeight)),x.viewportHeight),{totalCount:r,data:c,firstItemIndex:u,sizeRanges:t,initialTopMostItemIndex:_,scrolledToInitialItem:v,initialItemFinalLocationReached:b,topItemsIndexes:g,topItemCount:B,groupCounts:I,fixedItemHeight:s,defaultItemHeight:n,gap:m,...F,statefulTotalCount:f,listState:M,scrollToIndex:E,trackItemSizes:a,itemSize:o,groupIndices:d,...w,...rt,...x,sizes:S,...A}),ji(Gn,co,Ur,uv,ev,Qs,ao,ov,sv,Rf,pv)),Mc="-webkit-sticky",Uf="sticky",Gf=Bf(()=>{if(typeof document>"u")return Uf;const r=document.createElement("div");return r.style.position=Mc,r.style.position===Mc?Mc:Uf});function jf(r,t){const s=se.useRef(null),n=se.useCallback(u=>{if(u===null||!u.offsetParent)return;const d=u.getBoundingClientRect(),f=d.width;let m,S;if(t){const _=t.getBoundingClientRect(),v=d.top-_.top;m=_.height-Math.max(0,v),S=v+t.scrollTop}else m=window.innerHeight-Math.max(0,d.top),S=d.top+window.pageYOffset;s.current={offsetTop:S,visibleHeight:m,visibleWidth:f},r(s.current)},[r,t]),{callbackRef:a,ref:o}=vc(n),c=se.useCallback(()=>{n(o.current)},[n,o]);return se.useEffect(()=>{if(t){t.addEventListener("scroll",c);const u=new ResizeObserver(()=>{requestAnimationFrame(c)});return u.observe(t),()=>{t.removeEventListener("scroll",c),u.unobserve(t)}}else return window.addEventListener("scroll",c),window.addEventListener("resize",c),()=>{window.removeEventListener("scroll",c),window.removeEventListener("resize",c)}},[c,t]),a}const Vf=se.createContext(void 0),Wf=se.createContext(void 0);function $f(r){return r}const mv=ki(()=>{const r=Ee(d=>`Item ${d}`),t=Ee(null),s=Ee(d=>`Group ${d}`),n=Ee({}),a=Ee($f),o=Ee("div"),c=Ee(Ea),u=(d,f=null)=>Br(ce(n,Fe(m=>m[d]),Vi()),f);return{context:t,itemContent:r,groupContent:s,components:n,computeItemKey:a,headerFooterTag:o,scrollerRef:c,FooterComponent:u("Footer"),HeaderComponent:u("Header"),TopItemListComponent:u("TopItemList"),ListComponent:u("List","div"),ItemComponent:u("Item","div"),GroupComponent:u("Group","div"),ScrollerComponent:u("Scroller","div"),EmptyPlaceholder:u("EmptyPlaceholder"),ScrollSeekPlaceholder:u("ScrollSeekPlaceholder")}}),vv=ki(([r,t])=>({...r,...t}),ji(gv,mv)),yv=({height:r})=>se.createElement("div",{style:{height:r}}),bv={position:Gf(),zIndex:1,overflowAnchor:"none"},_v={overflowAnchor:"none"},Kf=se.memo(function({showTopList:r=!1}){const t=gi("listState"),s=un("sizeRanges"),n=gi("useWindowScroll"),a=gi("customScrollParent"),o=un("windowScrollContainerState"),c=un("scrollContainerState"),u=a||n?o:c,d=gi("itemContent"),f=gi("context"),m=gi("groupContent"),S=gi("trackItemSizes"),_=gi("itemSize"),v=gi("log"),b=un("gap"),{callbackRef:x}=L1(s,_,S,r?Ea:u,v,b,a),[A,F]=se.useState(0);Rc("deviation",dt=>{A!==dt&&F(dt)});const M=gi("EmptyPlaceholder"),g=gi("ScrollSeekPlaceholder")||yv,w=gi("ListComponent"),E=gi("ItemComponent"),C=gi("GroupComponent"),B=gi("computeItemKey"),I=gi("isSeeking"),rt=gi("groupIndices").length>0,tt=gi("alignToBottom"),st=gi("initialItemFinalLocationReached"),wt=r?{}:{boxSizing:"border-box",paddingTop:t.offsetTop,paddingBottom:t.offsetBottom,marginTop:A!==0?A:tt?"auto":0,...st?{}:{visibility:"hidden"}};return!r&&t.totalCount===0&&M?se.createElement(M,Gr(M,f)):se.createElement(w,{...Gr(w,f),ref:x,style:wt,"data-testid":r?"virtuoso-top-item-list":"virtuoso-item-list"},(r?t.topItems:t.items).map(dt=>{const Tt=dt.originalIndex,Lt=B(Tt+t.firstItemIndex,dt.data,f);return I?se.createElement(g,{...Gr(g,f),key:Lt,index:dt.index,height:dt.size,type:dt.type||"item",...dt.type==="group"?{}:{groupIndex:dt.groupIndex}}):dt.type==="group"?se.createElement(C,{...Gr(C,f),key:Lt,"data-index":Tt,"data-known-size":dt.size,"data-item-index":dt.index,style:bv},m(dt.index,f)):se.createElement(E,{...Gr(E,f),...Av(E,dt.data),key:Lt,"data-index":Tt,"data-known-size":dt.size,"data-item-index":dt.index,"data-item-group-index":dt.groupIndex,style:_v},rt?d(dt.index,dt.groupIndex,dt.data,f):d(dt.index,dt.data,f))}))}),xv={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},al=r=>({width:"100%",height:"100%",position:"absolute",top:0,...r?{display:"flex",flexDirection:"column"}:{}}),wv={width:"100%",position:Gf(),top:0,zIndex:1};function Gr(r,t){if(typeof r!="string")return{context:t}}function Av(r,t){return{item:typeof r=="string"?void 0:t}}const Sv=se.memo(function(){const r=gi("HeaderComponent"),t=un("headerHeight"),s=gi("headerFooterTag"),n=Ys(o=>t(Cs(o,"height"))),a=gi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null}),Ev=se.memo(function(){const r=gi("FooterComponent"),t=un("footerHeight"),s=gi("headerFooterTag"),n=Ys(o=>t(Cs(o,"height"))),a=gi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null});function Xf({usePublisher:r,useEmitter:t,useEmitterValue:s}){return se.memo(function({style:n,children:a,...o}){const c=r("scrollContainerState"),u=s("ScrollerComponent"),d=r("smoothScrollTargetReached"),f=s("scrollerRef"),m=s("context"),{scrollerRef:S,scrollByCallback:_,scrollToCallback:v}=yf(c,d,u,f);return t("scrollTo",v),t("scrollBy",_),se.createElement(u,{ref:S,style:{...xv,...n},"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0,...o,...Gr(u,m)},a)})}function Yf({usePublisher:r,useEmitter:t,useEmitterValue:s}){return se.memo(function({style:n,children:a,...o}){const c=r("windowScrollContainerState"),u=s("ScrollerComponent"),d=r("smoothScrollTargetReached"),f=s("totalListHeight"),m=s("deviation"),S=s("customScrollParent"),_=s("context"),{scrollerRef:v,scrollByCallback:b,scrollToCallback:x}=yf(c,d,u,Ea,S);return R1(()=>(v.current=S||window,()=>{v.current=null}),[v,S]),t("windowScrollTo",x),t("scrollBy",b),se.createElement(u,{style:{position:"relative",...n,...f!==0?{height:f+m}:{}},"data-virtuoso-scroller":!0,...o,...Gr(u,_)},a)})}const Cv=({children:r})=>{const t=se.useContext(Vf),s=un("viewportHeight"),n=un("fixedItemHeight"),a=gi("alignToBottom"),o=Ys(hf(s,c=>Cs(c,"height")));return se.useEffect(()=>{t&&(s(t.viewportHeight),n(t.itemHeight))},[t,s,n]),se.createElement("div",{style:al(a),ref:o,"data-viewport-type":"element"},r)},kv=({children:r})=>{const t=se.useContext(Vf),s=un("windowViewportRect"),n=un("fixedItemHeight"),a=gi("customScrollParent"),o=jf(s,a),c=gi("alignToBottom");return se.useEffect(()=>{t&&(n(t.itemHeight),s({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,s,n]),se.createElement("div",{ref:o,style:al(c),"data-viewport-type":"window"},r)},Tv=({children:r})=>{const t=gi("TopItemListComponent")||"div",s=gi("headerHeight"),n={...wv,marginTop:`${s}px`},a=gi("context");return se.createElement(t,{style:n,...Gr(t,a)},r)},Pv=se.memo(function(r){const t=gi("useWindowScroll"),s=gi("topItemsIndexes").length>0,n=gi("customScrollParent"),a=n||t?Fv:Rv,o=n||t?kv:Cv;return se.createElement(a,{...r},s&&se.createElement(Tv,null,se.createElement(Kf,{showTopList:!0})),se.createElement(o,null,se.createElement(Sv,null),se.createElement(Kf,null),se.createElement(Ev,null)))}),{Component:Mv,usePublisher:un,useEmitterValue:gi,useEmitter:Rc}=mf(vv,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},Pv),Rv=Xf({usePublisher:un,useEmitterValue:gi,useEmitter:Rc}),Fv=Yf({usePublisher:un,useEmitterValue:gi,useEmitter:Rc}),Iv=Mv,qf={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},Lv={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},{round:Qf,ceil:Zf,floor:ol,min:Fc,max:fo}=Math;function Dv(r){return{...Lv,items:r}}function Jf(r,t,s){return Array.from({length:t-r+1}).map((n,a)=>{const o=s===null?null:s[a+r];return{index:a+r,data:o}})}function Nv(r,t){return r&&r.column===t.column&&r.row===t.row}function ll(r,t){return r&&r.width===t.width&&r.height===t.height}const Ov=ki(([{overscan:r,visibleRange:t,listBoundary:s},{scrollTop:n,viewportHeight:a,scrollBy:o,scrollTo:c,smoothScrollTargetReached:u,scrollContainerState:d,footerHeight:f,headerHeight:m},S,_,{propsReady:v,didMount:b},{windowViewportRect:x,useWindowScroll:A,customScrollParent:F,windowScrollContainerState:M,windowScrollTo:g},w])=>{const E=Ee(0),C=Ee(0),B=Ee(qf),I=Ee({height:0,width:0}),rt=Ee({height:0,width:0}),tt=_i(),st=_i(),wt=Ee(0),dt=Ee(null),Tt=Ee({row:0,column:0}),Lt=_i(),Qt=_i(),ct=Ee(!1),Dt=Ee(0),ee=Ee(!0),zt=Ee(!1);Ci(ce(b,li(Dt),$e(([Gt,lt])=>!!lt)),()=>{ii(ee,!1),ii(C,0)}),Ci(ce(wr(b,ee,rt,I,Dt,zt),$e(([Gt,lt,Ft,Wt,,ve])=>Gt&&!lt&&Ft.height!==0&&Wt.height!==0&&!ve)),([,,,,Gt])=>{ii(zt,!0),Ec(1,()=>{ii(tt,Gt)}),Hn(ce(n),()=>{ii(s,[0,0]),ii(ee,!0)})}),Ne(ce(Qt,$e(Gt=>Gt!=null&&Gt.scrollTop>0),Bn(0)),C),Ci(ce(b,li(Qt),$e(([,Gt])=>Gt!=null)),([,Gt])=>{!Gt||(ii(I,Gt.viewport),ii(rt,Gt==null?void 0:Gt.item),ii(Tt,Gt.gap),Gt.scrollTop>0&&(ii(ct,!0),Hn(ce(n,Ca(1)),lt=>{ii(ct,!1)}),ii(c,{top:Gt.scrollTop})))}),Ne(ce(I,Fe(({height:Gt})=>Gt)),a),Ne(ce(wr(Ke(I,ll),Ke(rt,ll),Ke(Tt,(Gt,lt)=>Gt&&Gt.column===lt.column&&Gt.row===lt.row),Ke(n)),Fe(([Gt,lt,Ft,Wt])=>({viewport:Gt,item:lt,gap:Ft,scrollTop:Wt}))),Lt),Ne(ce(wr(Ke(E),t,Ke(Tt,Nv),Ke(rt,ll),Ke(I,ll),Ke(dt),Ke(C),Ke(ct),Ke(ee),Ke(Dt)),$e(([,,,,,,,Gt])=>!Gt),Fe(([Gt,[lt,Ft],Wt,ve,ie,xe,_e,,ut,T])=>{const{row:R,column:D}=Wt,{height:H,width:L}=ve,{width:V}=ie;if(_e===0&&(Gt===0||V===0))return qf;if(L===0){const gt=Cc(T,Gt),yt=gt===0?Math.max(_e-1,0):gt;return Dv(Jf(gt,yt,xe))}const j=ep(V,L,D);let G,W;ut?lt===0&&Ft===0&&_e>0?(G=0,W=_e-1):(G=j*ol((lt+R)/(H+R)),W=j*Zf((Ft+R)/(H+R))-1,W=Fc(Gt-1,fo(W,j-1)),G=Fc(W,fo(0,G))):(G=0,W=-1);const U=Jf(G,W,xe),{top:O,bottom:z}=tp(ie,Wt,ve,U),et=Zf(Gt/j),nt=et*H+(et-1)*R-z;return{items:U,offsetTop:O,offsetBottom:nt,top:O,bottom:z,itemHeight:H,itemWidth:L}})),B),Ne(ce(dt,$e(Gt=>Gt!==null),Fe(Gt=>Gt.length)),E),Ne(ce(wr(I,rt,B,Tt),$e(([Gt,lt,{items:Ft}])=>Ft.length>0&&lt.height!==0&&Gt.height!==0),Fe(([Gt,lt,{items:Ft},Wt])=>{const{top:ve,bottom:ie}=tp(Gt,Wt,lt,Ft);return[ve,ie]}),Vi(uo)),s);const Jt=Ee(!1);Ne(ce(n,li(Jt),Fe(([Gt,lt])=>lt||Gt!==0)),Jt);const oe=rn(ce(Ke(B),$e(({items:Gt})=>Gt.length>0),li(E,Jt),$e(([{items:Gt},lt,Ft])=>Ft&&Gt[Gt.length-1].index===lt-1),Fe(([,Gt])=>Gt-1),Vi())),ge=rn(ce(Ke(B),$e(({items:Gt})=>Gt.length>0&&Gt[0].index===0),Bn(0),Vi())),Ae=rn(ce(Ke(B),li(ct),$e(([{items:Gt},lt])=>Gt.length>0&&!lt),Fe(([{items:Gt}])=>({startIndex:Gt[0].index,endIndex:Gt[Gt.length-1].index})),Vi(Ff),Ss(0)));Ne(Ae,_.scrollSeekRangeChanged),Ne(ce(tt,li(I,rt,E,Tt),Fe(([Gt,lt,Ft,Wt,ve])=>{const ie=Pf(Gt),{align:xe,behavior:_e,offset:ut}=ie;let T=ie.index;T==="LAST"&&(T=Wt-1),T=fo(0,T,Fc(Wt-1,T));let R=Ic(lt,ve,Ft,T);return xe==="end"?R=Qf(R-lt.height+Ft.height):xe==="center"&&(R=Qf(R-lt.height/2+Ft.height/2)),ut&&(R+=ut),{top:R,behavior:_e}})),c);const Ve=Br(ce(B,Fe(Gt=>Gt.offsetBottom+Gt.bottom)),0);return Ne(ce(x,Fe(Gt=>({width:Gt.visibleWidth,height:Gt.visibleHeight}))),I),{data:dt,totalCount:E,viewportDimensions:I,itemDimensions:rt,scrollTop:n,scrollHeight:st,overscan:r,scrollBy:o,scrollTo:c,scrollToIndex:tt,smoothScrollTargetReached:u,windowViewportRect:x,windowScrollTo:g,useWindowScroll:A,customScrollParent:F,windowScrollContainerState:M,deviation:wt,scrollContainerState:d,footerHeight:f,headerHeight:m,initialItemCount:C,gap:Tt,restoreStateFrom:Qt,..._,initialTopMostItemIndex:Dt,gridState:B,totalListHeight:Ve,...S,startReached:ge,endReached:oe,rangeChanged:Ae,stateChanged:Lt,propsReady:v,stateRestoreInProgress:ct,...w}},ji(kc,Ur,ho,zf,ks,Pc,Es));function tp(r,t,s,n){const{height:a}=s;if(a===void 0||n.length===0)return{top:0,bottom:0};const o=Ic(r,t,s,n[0].index),c=Ic(r,t,s,n[n.length-1].index)+a;return{top:o,bottom:c}}function Ic(r,t,s,n){const a=ep(r.width,s.width,t.column),o=ol(n/a),c=o*s.height+fo(0,o-1)*t.row;return c>0?c+t.row:c}function ep(r,t,s){return fo(1,ol((r+s)/(ol(t)+s)))}const zv=ki(()=>{const r=Ee(f=>`Item ${f}`),t=Ee({}),s=Ee(null),n=Ee("virtuoso-grid-item"),a=Ee("virtuoso-grid-list"),o=Ee($f),c=Ee("div"),u=Ee(Ea),d=(f,m=null)=>Br(ce(t,Fe(S=>S[f]),Vi()),m);return{context:s,itemContent:r,components:t,computeItemKey:o,itemClassName:n,listClassName:a,headerFooterTag:c,scrollerRef:u,FooterComponent:d("Footer"),HeaderComponent:d("Header"),ListComponent:d("List","div"),ItemComponent:d("Item","div"),ScrollerComponent:d("Scroller","div"),ScrollSeekPlaceholder:d("ScrollSeekPlaceholder","div")}}),Hv=ki(([r,t])=>({...r,...t}),ji(Ov,zv)),Bv=se.memo(function(){const r=qi("gridState"),t=qi("listClassName"),s=qi("itemClassName"),n=qi("itemContent"),a=qi("computeItemKey"),o=qi("isSeeking"),c=Sn("scrollHeight"),u=qi("ItemComponent"),d=qi("ListComponent"),f=qi("ScrollSeekPlaceholder"),m=qi("context"),S=Sn("itemDimensions"),_=Sn("gap"),v=qi("log"),b=qi("stateRestoreInProgress"),x=Ys(A=>{const F=A.parentElement.parentElement.scrollHeight;c(F);const M=A.firstChild;if(M){const{width:g,height:w}=M.getBoundingClientRect();S({width:g,height:w})}_({row:rp("row-gap",getComputedStyle(A).rowGap,v),column:rp("column-gap",getComputedStyle(A).columnGap,v)})});return b?null:se.createElement(d,{ref:x,className:t,...Gr(d,m),style:{paddingTop:r.offsetTop,paddingBottom:r.offsetBottom},"data-testid":"virtuoso-item-list"},r.items.map(A=>{const F=a(A.index,A.data,m);return o?se.createElement(f,{key:F,...Gr(f,m),index:A.index,height:r.itemHeight,width:r.itemWidth}):se.createElement(u,{...Gr(u,m),className:s,"data-index":A.index,key:F},n(A.index,A.data,m))}))}),Uv=se.memo(function(){const r=qi("HeaderComponent"),t=Sn("headerHeight"),s=qi("headerFooterTag"),n=Ys(o=>t(Cs(o,"height"))),a=qi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null}),Gv=se.memo(function(){const r=qi("FooterComponent"),t=Sn("footerHeight"),s=qi("headerFooterTag"),n=Ys(o=>t(Cs(o,"height"))),a=qi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null}),jv=({children:r})=>{const t=se.useContext(Wf),s=Sn("itemDimensions"),n=Sn("viewportDimensions"),a=Ys(o=>{n(o.getBoundingClientRect())});return se.useEffect(()=>{t&&(n({height:t.viewportHeight,width:t.viewportWidth}),s({height:t.itemHeight,width:t.itemWidth}))},[t,n,s]),se.createElement("div",{style:al(!1),ref:a},r)},Vv=({children:r})=>{const t=se.useContext(Wf),s=Sn("windowViewportRect"),n=Sn("itemDimensions"),a=qi("customScrollParent"),o=jf(s,a);return se.useEffect(()=>{t&&(n({height:t.itemHeight,width:t.itemWidth}),s({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,s,n]),se.createElement("div",{ref:o,style:al(!1)},r)},Wv=se.memo(function({...r}){const t=qi("useWindowScroll"),s=qi("customScrollParent"),n=s||t?Kv:$v,a=s||t?Vv:jv;return se.createElement(n,{...r},se.createElement(a,null,se.createElement(Uv,null),se.createElement(Bv,null),se.createElement(Gv,null)))}),{Component:Iw,usePublisher:Sn,useEmitterValue:qi,useEmitter:ip}=mf(Hv,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged"}},Wv),$v=Xf({usePublisher:Sn,useEmitterValue:qi,useEmitter:ip}),Kv=Yf({usePublisher:Sn,useEmitterValue:qi,useEmitter:ip});function rp(r,t,s){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&s(`${r} was not resolved to pixel value correctly`,t,nn.WARN),t==="normal"?0:parseInt(t??"0",10)}var np={exports:{}},hl={},cl={},si={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._registerNode=r.Konva=r.glob=void 0;const t=Math.PI/180;function s(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}r.glob=typeof a0<"u"?a0:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},r.Konva={_global:r.glob,version:"9.3.6",isBrowser:s(),isUnminified:/param/.test(function(a){}.toString()),dblClickWindow:400,getAngle(a){return r.Konva.angleDeg?a*t:a},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return r.Konva.DD.isDragging},isTransforming(){var a;return(a=r.Konva.Transformer)===null||a===void 0?void 0:a.isTransforming()},isDragReady(){return!!r.Konva.DD.node},releaseCanvasOnDestroy:!0,document:r.glob.document,_injectGlobal(a){r.glob.Konva=a}};const n=a=>{r.Konva[a.prototype.getClassName()]=a};r._registerNode=n,r.Konva._injectGlobal(r.Konva)})(si);var Qi={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=r.Transform=void 0;const t=si;class s{constructor(w=[1,0,0,1,0,0]){this.dirty=!1,this.m=w&&w.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new s(this.m)}copyInto(w){w.m[0]=this.m[0],w.m[1]=this.m[1],w.m[2]=this.m[2],w.m[3]=this.m[3],w.m[4]=this.m[4],w.m[5]=this.m[5]}point(w){var E=this.m;return{x:E[0]*w.x+E[2]*w.y+E[4],y:E[1]*w.x+E[3]*w.y+E[5]}}translate(w,E){return this.m[4]+=this.m[0]*w+this.m[2]*E,this.m[5]+=this.m[1]*w+this.m[3]*E,this}scale(w,E){return this.m[0]*=w,this.m[1]*=w,this.m[2]*=E,this.m[3]*=E,this}rotate(w){var E=Math.cos(w),C=Math.sin(w),B=this.m[0]*E+this.m[2]*C,I=this.m[1]*E+this.m[3]*C,rt=this.m[0]*-C+this.m[2]*E,tt=this.m[1]*-C+this.m[3]*E;return this.m[0]=B,this.m[1]=I,this.m[2]=rt,this.m[3]=tt,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(w,E){var C=this.m[0]+this.m[2]*E,B=this.m[1]+this.m[3]*E,I=this.m[2]+this.m[0]*w,rt=this.m[3]+this.m[1]*w;return this.m[0]=C,this.m[1]=B,this.m[2]=I,this.m[3]=rt,this}multiply(w){var E=this.m[0]*w.m[0]+this.m[2]*w.m[1],C=this.m[1]*w.m[0]+this.m[3]*w.m[1],B=this.m[0]*w.m[2]+this.m[2]*w.m[3],I=this.m[1]*w.m[2]+this.m[3]*w.m[3],rt=this.m[0]*w.m[4]+this.m[2]*w.m[5]+this.m[4],tt=this.m[1]*w.m[4]+this.m[3]*w.m[5]+this.m[5];return this.m[0]=E,this.m[1]=C,this.m[2]=B,this.m[3]=I,this.m[4]=rt,this.m[5]=tt,this}invert(){var w=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*w,C=-this.m[1]*w,B=-this.m[2]*w,I=this.m[0]*w,rt=w*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),tt=w*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=C,this.m[2]=B,this.m[3]=I,this.m[4]=rt,this.m[5]=tt,this}getMatrix(){return this.m}decompose(){var w=this.m[0],E=this.m[1],C=this.m[2],B=this.m[3],I=this.m[4],rt=this.m[5],tt=w*B-E*C;let st={x:I,y:rt,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(w!=0||E!=0){var wt=Math.sqrt(w*w+E*E);st.rotation=E>0?Math.acos(w/wt):-Math.acos(w/wt),st.scaleX=wt,st.scaleY=tt/wt,st.skewX=(w*C+E*B)/tt,st.skewY=0}else if(C!=0||B!=0){var dt=Math.sqrt(C*C+B*B);st.rotation=Math.PI/2-(B>0?Math.acos(-C/dt):-Math.acos(C/dt)),st.scaleX=tt/dt,st.scaleY=dt,st.skewX=0,st.skewY=(w*C+E*B)/tt}return st.rotation=r.Util._getRotation(st.rotation),st}}r.Transform=s;var n="[object Array]",a="[object Number]",o="[object String]",c="[object Boolean]",u=Math.PI/180,d=180/Math.PI,f="#",m="",S="0",_="Konva warning: ",v="Konva error: ",b="rgb(",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},A=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,F=[];const M=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(g){setTimeout(g,60)};r.Util={_isElement(g){return!!(g&&g.nodeType==1)},_isFunction(g){return!!(g&&g.constructor&&g.call&&g.apply)},_isPlainObject(g){return!!g&&g.constructor===Object},_isArray(g){return Object.prototype.toString.call(g)===n},_isNumber(g){return Object.prototype.toString.call(g)===a&&!isNaN(g)&&isFinite(g)},_isString(g){return Object.prototype.toString.call(g)===o},_isBoolean(g){return Object.prototype.toString.call(g)===c},isObject(g){return g instanceof Object},isValidSelector(g){if(typeof g!="string")return!1;var w=g[0];return w==="#"||w==="."||w===w.toUpperCase()},_sign(g){return g===0||g>0?1:-1},requestAnimFrame(g){F.push(g),F.length===1&&M(function(){const w=F;F=[],w.forEach(function(E){E()})})},createCanvasElement(){var g=document.createElement("canvas");try{g.style=g.style||{}}catch{}return g},createImageElement(){return document.createElement("img")},_isInDocument(g){for(;g=g.parentNode;)if(g==document)return!0;return!1},_urlToImage(g,w){var E=r.Util.createImageElement();E.onload=function(){w(E)},E.src=g},_rgbToHex(g,w,E){return((1<<24)+(g<<16)+(w<<8)+E).toString(16).slice(1)},_hexToRgb(g){g=g.replace(f,m);var w=parseInt(g,16);return{r:w>>16&255,g:w>>8&255,b:w&255}},getRandomColor(){for(var g=(Math.random()*16777215<<0).toString(16);g.length<6;)g=S+g;return f+g},getRGB(g){var w;return g in x?(w=x[g],{r:w[0],g:w[1],b:w[2]}):g[0]===f?this._hexToRgb(g.substring(1)):g.substr(0,4)===b?(w=A.exec(g.replace(/ /g,"")),{r:parseInt(w[1],10),g:parseInt(w[2],10),b:parseInt(w[3],10)}):{r:0,g:0,b:0}},colorToRGBA(g){return g=g||"black",r.Util._namedColorToRBA(g)||r.Util._hex3ColorToRGBA(g)||r.Util._hex4ColorToRGBA(g)||r.Util._hex6ColorToRGBA(g)||r.Util._hex8ColorToRGBA(g)||r.Util._rgbColorToRGBA(g)||r.Util._rgbaColorToRGBA(g)||r.Util._hslColorToRGBA(g)},_namedColorToRBA(g){var w=x[g.toLowerCase()];return w?{r:w[0],g:w[1],b:w[2],a:1}:null},_rgbColorToRGBA(g){if(g.indexOf("rgb(")===0){g=g.match(/rgb\(([^)]+)\)/)[1];var w=g.split(/ *, */).map(Number);return{r:w[0],g:w[1],b:w[2],a:1}}},_rgbaColorToRGBA(g){if(g.indexOf("rgba(")===0){g=g.match(/rgba\(([^)]+)\)/)[1];var w=g.split(/ *, */).map((E,C)=>E.slice(-1)==="%"?C===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:w[0],g:w[1],b:w[2],a:w[3]}}},_hex8ColorToRGBA(g){if(g[0]==="#"&&g.length===9)return{r:parseInt(g.slice(1,3),16),g:parseInt(g.slice(3,5),16),b:parseInt(g.slice(5,7),16),a:parseInt(g.slice(7,9),16)/255}},_hex6ColorToRGBA(g){if(g[0]==="#"&&g.length===7)return{r:parseInt(g.slice(1,3),16),g:parseInt(g.slice(3,5),16),b:parseInt(g.slice(5,7),16),a:1}},_hex4ColorToRGBA(g){if(g[0]==="#"&&g.length===5)return{r:parseInt(g[1]+g[1],16),g:parseInt(g[2]+g[2],16),b:parseInt(g[3]+g[3],16),a:parseInt(g[4]+g[4],16)/255}},_hex3ColorToRGBA(g){if(g[0]==="#"&&g.length===4)return{r:parseInt(g[1]+g[1],16),g:parseInt(g[2]+g[2],16),b:parseInt(g[3]+g[3],16),a:1}},_hslColorToRGBA(g){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(g)){const[w,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(g),C=Number(E[0])/360,B=Number(E[1])/100,I=Number(E[2])/100;let rt,tt,st;if(B===0)return st=I*255,{r:Math.round(st),g:Math.round(st),b:Math.round(st),a:1};I<.5?rt=I*(1+B):rt=I+B-I*B;const wt=2*I-rt,dt=[0,0,0];for(let Tt=0;Tt<3;Tt++)tt=C+1/3*-(Tt-1),tt<0&&tt++,tt>1&&tt--,6*tt<1?st=wt+(rt-wt)*6*tt:2*tt<1?st=rt:3*tt<2?st=wt+(rt-wt)*(2/3-tt)*6:st=wt,dt[Tt]=st*255;return{r:Math.round(dt[0]),g:Math.round(dt[1]),b:Math.round(dt[2]),a:1}}},haveIntersection(g,w){return!(w.x>g.x+g.width||w.x+w.width<g.x||w.y>g.y+g.height||w.y+w.height<g.y)},cloneObject(g){var w={};for(var E in g)this._isPlainObject(g[E])?w[E]=this.cloneObject(g[E]):this._isArray(g[E])?w[E]=this.cloneArray(g[E]):w[E]=g[E];return w},cloneArray(g){return g.slice(0)},degToRad(g){return g*u},radToDeg(g){return g*d},_degToRad(g){return r.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),r.Util.degToRad(g)},_radToDeg(g){return r.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),r.Util.radToDeg(g)},_getRotation(g){return t.Konva.angleDeg?r.Util.radToDeg(g):g},_capitalize(g){return g.charAt(0).toUpperCase()+g.slice(1)},throw(g){throw new Error(v+g)},error(g){console.error(v+g)},warn(g){!t.Konva.showWarnings||console.warn(_+g)},each(g,w){for(var E in g)w(E,g[E])},_inRange(g,w,E){return w<=g&&g<E},_getProjectionToSegment(g,w,E,C,B,I){var rt,tt,st,wt=(g-E)*(g-E)+(w-C)*(w-C);if(wt==0)rt=g,tt=w,st=(B-E)*(B-E)+(I-C)*(I-C);else{var dt=((B-g)*(E-g)+(I-w)*(C-w))/wt;dt<0?(rt=g,tt=w,st=(g-B)*(g-B)+(w-I)*(w-I)):dt>1?(rt=E,tt=C,st=(E-B)*(E-B)+(C-I)*(C-I)):(rt=g+dt*(E-g),tt=w+dt*(C-w),st=(rt-B)*(rt-B)+(tt-I)*(tt-I))}return[rt,tt,st]},_getProjectionToLine(g,w,E){var C=r.Util.cloneObject(g),B=Number.MAX_VALUE;return w.forEach(function(I,rt){if(!(!E&&rt===w.length-1)){var tt=w[(rt+1)%w.length],st=r.Util._getProjectionToSegment(I.x,I.y,tt.x,tt.y,g.x,g.y),wt=st[0],dt=st[1],Tt=st[2];Tt<B&&(C.x=wt,C.y=dt,B=Tt)}}),C},_prepareArrayForTween(g,w,E){var C,B=[],I=[];if(g.length>w.length){var rt=w;w=g,g=rt}for(C=0;C<g.length;C+=2)B.push({x:g[C],y:g[C+1]});for(C=0;C<w.length;C+=2)I.push({x:w[C],y:w[C+1]});var tt=[];return I.forEach(function(st){var wt=r.Util._getProjectionToLine(st,B,E);tt.push(wt.x),tt.push(wt.y)}),tt},_prepareToStringify(g){var w;g.visitedByCircularReferenceRemoval=!0;for(var E in g)if(g.hasOwnProperty(E)&&g[E]&&typeof g[E]=="object"){if(w=Object.getOwnPropertyDescriptor(g,E),g[E].visitedByCircularReferenceRemoval||r.Util._isElement(g[E]))if(w.configurable)delete g[E];else return null;else if(r.Util._prepareToStringify(g[E])===null)if(w.configurable)delete g[E];else return null}return delete g.visitedByCircularReferenceRemoval,g},_assign(g,w){for(var E in w)g[E]=w[E];return g},_getFirstPointerId(g){return g.touches?g.changedTouches[0].identifier:g.pointerId||999},releaseCanvas(...g){!t.Konva.releaseCanvasOnDestroy||g.forEach(w=>{w.width=0,w.height=0})},drawRoundedRectPath(g,w,E,C){let B=0,I=0,rt=0,tt=0;typeof C=="number"?B=I=rt=tt=Math.min(C,w/2,E/2):(B=Math.min(C[0]||0,w/2,E/2),I=Math.min(C[1]||0,w/2,E/2),tt=Math.min(C[2]||0,w/2,E/2),rt=Math.min(C[3]||0,w/2,E/2)),g.moveTo(B,0),g.lineTo(w-I,0),g.arc(w-I,I,I,Math.PI*3/2,0,!1),g.lineTo(w,E-tt),g.arc(w-tt,E-tt,tt,0,Math.PI/2,!1),g.lineTo(rt,E),g.arc(rt,E-rt,rt,Math.PI/2,Math.PI,!1),g.lineTo(0,B),g.arc(B,B,B,Math.PI,Math.PI*3/2,!1)}}})(Qi);var Wi={},ai={},De={};Object.defineProperty(De,"__esModule",{value:!0}),De.getComponentValidator=De.getBooleanValidator=De.getNumberArrayValidator=De.getFunctionValidator=De.getStringOrGradientValidator=De.getStringValidator=De.getNumberOrAutoValidator=De.getNumberOrArrayOfNumbersValidator=De.getNumberValidator=De.alphaComponent=De.RGBComponent=void 0;const ns=si,Ji=Qi;function ss(r){return Ji.Util._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||Ji.Util._isBoolean(r)?r:Object.prototype.toString.call(r)}function Xv(r){return r>255?255:r<0?0:Math.round(r)}De.RGBComponent=Xv;function Yv(r){return r>1?1:r<1e-4?1e-4:r}De.alphaComponent=Yv;function qv(){if(ns.Konva.isUnminified)return function(r,t){return Ji.Util._isNumber(r)||Ji.Util.warn(ss(r)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),r}}De.getNumberValidator=qv;function Qv(r){if(ns.Konva.isUnminified)return function(t,s){let n=Ji.Util._isNumber(t),a=Ji.Util._isArray(t)&&t.length==r;return!n&&!a&&Ji.Util.warn(ss(t)+' is a not valid value for "'+s+'" attribute. The value should be a number or Array<number>('+r+")"),t}}De.getNumberOrArrayOfNumbersValidator=Qv;function Zv(){if(ns.Konva.isUnminified)return function(r,t){var s=Ji.Util._isNumber(r),n=r==="auto";return s||n||Ji.Util.warn(ss(r)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),r}}De.getNumberOrAutoValidator=Zv;function Jv(){if(ns.Konva.isUnminified)return function(r,t){return Ji.Util._isString(r)||Ji.Util.warn(ss(r)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),r}}De.getStringValidator=Jv;function ty(){if(ns.Konva.isUnminified)return function(r,t){const s=Ji.Util._isString(r),n=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return s||n||Ji.Util.warn(ss(r)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),r}}De.getStringOrGradientValidator=ty;function ey(){if(ns.Konva.isUnminified)return function(r,t){return Ji.Util._isFunction(r)||Ji.Util.warn(ss(r)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),r}}De.getFunctionValidator=ey;function iy(){if(ns.Konva.isUnminified)return function(r,t){const s=Int8Array?Object.getPrototypeOf(Int8Array):null;return s&&r instanceof s||(Ji.Util._isArray(r)?r.forEach(function(n){Ji.Util._isNumber(n)||Ji.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Ji.Util.warn(ss(r)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),r}}De.getNumberArrayValidator=iy;function ry(){if(ns.Konva.isUnminified)return function(r,t){var s=r===!0||r===!1;return s||Ji.Util.warn(ss(r)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),r}}De.getBooleanValidator=ry;function ny(r){if(ns.Konva.isUnminified)return function(t,s){return t==null||Ji.Util.isObject(t)||Ji.Util.warn(ss(t)+' is a not valid value for "'+s+'" attribute. The value should be an object with properties '+r),t}}De.getComponentValidator=ny,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Factory=void 0;const t=Qi,s=De;var n="get",a="set";r.Factory={addGetterSetter(o,c,u,d,f){r.Factory.addGetter(o,c,u),r.Factory.addSetter(o,c,d,f),r.Factory.addOverloadedGetterSetter(o,c)},addGetter(o,c,u){var d=n+t.Util._capitalize(c);o.prototype[d]=o.prototype[d]||function(){var f=this.attrs[c];return f===void 0?u:f}},addSetter(o,c,u,d){var f=a+t.Util._capitalize(c);o.prototype[f]||r.Factory.overWriteSetter(o,c,u,d)},overWriteSetter(o,c,u,d){var f=a+t.Util._capitalize(c);o.prototype[f]=function(m){return u&&m!==void 0&&m!==null&&(m=u.call(this,m,c)),this._setAttr(c,m),d&&d.call(this),this}},addComponentsGetterSetter(o,c,u,d,f){var m=u.length,S=t.Util._capitalize,_=n+S(c),v=a+S(c),b,x;o.prototype[_]=function(){var F={};for(b=0;b<m;b++)x=u[b],F[x]=this.getAttr(c+S(x));return F};var A=(0,s.getComponentValidator)(u);o.prototype[v]=function(F){var M=this.attrs[c],g;d&&(F=d.call(this,F)),A&&A.call(this,F,c);for(g in F)!F.hasOwnProperty(g)||this._setAttr(c+S(g),F[g]);return F||u.forEach(w=>{this._setAttr(c+S(w),void 0)}),this._fireChangeEvent(c,M,F),f&&f.call(this),this},r.Factory.addOverloadedGetterSetter(o,c)},addOverloadedGetterSetter(o,c){var u=t.Util._capitalize(c),d=a+u,f=n+u;o.prototype[c]=function(){return arguments.length?(this[d](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(o,c,u,d){t.Util.error("Adding deprecated "+c);var f=n+t.Util._capitalize(c),m=c+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[f]=function(){t.Util.error(m);var S=this.attrs[c];return S===void 0?u:S},r.Factory.addSetter(o,c,d,function(){t.Util.error(m)}),r.Factory.addOverloadedGetterSetter(o,c)},backCompat(o,c){t.Util.each(c,function(u,d){var f=o.prototype[d],m=n+t.Util._capitalize(u),S=a+t.Util._capitalize(u);function _(){f.apply(this,arguments),t.Util.error('"'+u+'" method is deprecated and will be removed soon. Use ""'+d+'" instead.')}o.prototype[u]=_,o.prototype[m]=_,o.prototype[S]=_})},afterSetFilter(){this._filterUpToDate=!1}}}(ai);var En={},as={};Object.defineProperty(as,"__esModule",{value:!0}),as.HitContext=as.SceneContext=as.Context=void 0;const sp=Qi,sy=si;function ay(r){var t=[],s=r.length,n=sp.Util,a,o;for(a=0;a<s;a++)o=r[a],n._isNumber(o)?o=Math.round(o*1e3)/1e3:n._isString(o)||(o=o+""),t.push(o);return t}var ap=",",oy="(",ly=")",hy="([",cy="])",dy=";",uy="()",fy="=",op=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],py=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const gy=100;class dl{constructor(t){this.canvas=t,sy.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,s){var n=this.traceArr,a=n.length,o="",c,u,d,f;for(c=0;c<a;c++)u=n[c],d=u.method,d?(f=u.args,o+=d,t?o+=uy:sp.Util._isArray(f[0])?o+=hy+f.join(ap)+cy:(s&&(f=f.map(m=>typeof m=="number"?Math.floor(m):m)),o+=oy+f.join(ap)+ly)):(o+=u.property,t||(o+=fy+u.val)),o+=dy;return o}clearTrace(){this.traceArr=[]}_trace(t){var s=this.traceArr,n;s.push(t),n=s.length,n>=gy&&s.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var s=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,s.getWidth()/s.pixelRatio,s.getHeight()/s.pixelRatio)}_applyLineCap(t){const s=t.attrs.lineCap;s&&this.setAttr("lineCap",s)}_applyOpacity(t){var s=t.getAbsoluteOpacity();s!==1&&this.setAttr("globalAlpha",s)}_applyLineJoin(t){const s=t.attrs.lineJoin;s&&this.setAttr("lineJoin",s)}setAttr(t,s){this._context[t]=s}arc(t,s,n,a,o,c){this._context.arc(t,s,n,a,o,c)}arcTo(t,s,n,a,o){this._context.arcTo(t,s,n,a,o)}beginPath(){this._context.beginPath()}bezierCurveTo(t,s,n,a,o,c){this._context.bezierCurveTo(t,s,n,a,o,c)}clearRect(t,s,n,a){this._context.clearRect(t,s,n,a)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,s){var n=arguments;if(n.length===2)return this._context.createImageData(t,s);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,s,n,a){return this._context.createLinearGradient(t,s,n,a)}createPattern(t,s){return this._context.createPattern(t,s)}createRadialGradient(t,s,n,a,o,c){return this._context.createRadialGradient(t,s,n,a,o,c)}drawImage(t,s,n,a,o,c,u,d,f){var m=arguments,S=this._context;m.length===3?S.drawImage(t,s,n):m.length===5?S.drawImage(t,s,n,a,o):m.length===9&&S.drawImage(t,s,n,a,o,c,u,d,f)}ellipse(t,s,n,a,o,c,u,d){this._context.ellipse(t,s,n,a,o,c,u,d)}isPointInPath(t,s,n,a){return n?this._context.isPointInPath(n,t,s,a):this._context.isPointInPath(t,s,a)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,s,n,a){this._context.fillRect(t,s,n,a)}strokeRect(t,s,n,a){this._context.strokeRect(t,s,n,a)}fillText(t,s,n,a){a?this._context.fillText(t,s,n,a):this._context.fillText(t,s,n)}measureText(t){return this._context.measureText(t)}getImageData(t,s,n,a){return this._context.getImageData(t,s,n,a)}lineTo(t,s){this._context.lineTo(t,s)}moveTo(t,s){this._context.moveTo(t,s)}rect(t,s,n,a){this._context.rect(t,s,n,a)}roundRect(t,s,n,a,o){this._context.roundRect(t,s,n,a,o)}putImageData(t,s,n){this._context.putImageData(t,s,n)}quadraticCurveTo(t,s,n,a){this._context.quadraticCurveTo(t,s,n,a)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,s){this._context.scale(t,s)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,s,n,a,o,c){this._context.setTransform(t,s,n,a,o,c)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,s,n,a){this._context.strokeText(t,s,n,a)}transform(t,s,n,a,o,c){this._context.transform(t,s,n,a,o,c)}translate(t,s){this._context.translate(t,s)}_enableTrace(){var t=this,s=op.length,n=this.setAttr,a,o,c=function(u){var d=t[u],f;t[u]=function(){return o=ay(Array.prototype.slice.call(arguments,0)),f=d.apply(t,arguments),t._trace({method:u,args:o}),f}};for(a=0;a<s;a++)c(op[a]);t.setAttr=function(){n.apply(t,arguments);var u=arguments[0],d=arguments[1];(u==="shadowOffsetX"||u==="shadowOffsetY"||u==="shadowBlur")&&(d=d/this.canvas.getPixelRatio()),t._trace({property:u,val:d})}}_applyGlobalCompositeOperation(t){const s=t.attrs.globalCompositeOperation;var n=!s||s==="source-over";n||this.setAttr("globalCompositeOperation",s)}}as.Context=dl,py.forEach(function(r){Object.defineProperty(dl.prototype,r,{get(){return this._context[r]},set(t){this._context[r]=t}})});class my extends dl{constructor(t,{willReadFrequently:s=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:s})}_fillColor(t){var s=t.fill();this.setAttr("fillStyle",s),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var s=t._getLinearGradient();s&&(this.setAttr("fillStyle",s),t._fillFunc(this))}_fillRadialGradient(t){const s=t._getRadialGradient();s&&(this.setAttr("fillStyle",s),t._fillFunc(this))}_fill(t){const s=t.fill(),n=t.getFillPriority();if(s&&n==="color"){this._fillColor(t);return}const a=t.getFillPatternImage();if(a&&n==="pattern"){this._fillPattern(t);return}const o=t.getFillLinearGradientColorStops();if(o&&n==="linear-gradient"){this._fillLinearGradient(t);return}const c=t.getFillRadialGradientColorStops();if(c&&n==="radial-gradient"){this._fillRadialGradient(t);return}s?this._fillColor(t):a?this._fillPattern(t):o?this._fillLinearGradient(t):c&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const s=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),a=t.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(s.x,s.y,n.x,n.y);if(a){for(var c=0;c<a.length;c+=2)o.addColorStop(a[c],a[c+1]);this.setAttr("strokeStyle",o)}}_stroke(t){var s=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();var a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),s&&t.dashEnabled()&&(this.setLineDash(s),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var o=t.getStrokeLinearGradientColorStops();o?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var s,n,a,o=(s=t.getShadowRGBA())!==null&&s!==void 0?s:"black",c=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,u=(a=t.getShadowOffset())!==null&&a!==void 0?a:{x:0,y:0},d=t.getAbsoluteScale(),f=this.canvas.getPixelRatio(),m=d.x*f,S=d.y*f;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",c*Math.min(Math.abs(m),Math.abs(S))),this.setAttr("shadowOffsetX",u.x*m),this.setAttr("shadowOffsetY",u.y*S)}}as.SceneContext=my;class vy extends dl{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const o=t.getStrokeScaleEnabled();if(!o){this.save();var s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(t);var n=t.hitStrokeWidth(),a=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",a),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),o||this.restore()}}}as.HitContext=vy,Object.defineProperty(En,"__esModule",{value:!0}),En.HitCanvas=En.SceneCanvas=En.Canvas=void 0;const ul=Qi,lp=as,hp=si,yy=ai,by=De;var fl;function _y(){if(fl)return fl;var r=ul.Util.createCanvasElement(),t=r.getContext("2d");return fl=function(){var s=hp.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return s/n}(),ul.Util.releaseCanvas(r),fl}class pl{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var s=t||{},n=s.pixelRatio||hp.Konva.pixelRatio||_y();this.pixelRatio=n,this._canvas=ul.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var s=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/s,this.getHeight()/s)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var s=this.pixelRatio,n=this.getContext()._context;n.scale(s,s)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var s=this.pixelRatio,n=this.getContext()._context;n.scale(s,s)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,s){this.setWidth(t||0),this.setHeight(s||0)}toDataURL(t,s){try{return this._canvas.toDataURL(t,s)}catch{try{return this._canvas.toDataURL()}catch(n){return ul.Util.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}En.Canvas=pl,yy.Factory.addGetterSetter(pl,"pixelRatio",void 0,(0,by.getNumberValidator)());class xy extends pl{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new lp.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}En.SceneCanvas=xy;class wy extends pl{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new lp.HitContext(this),this.setSize(t.width,t.height)}}En.HitCanvas=wy;var gl={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DD=void 0;const t=si,s=Qi;r.DD={get isDragging(){var n=!1;return r.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){var n;return r.DD._dragElements.forEach(a=>{n=a.node}),n},_dragElements:new Map,_drag(n){const a=[];r.DD._dragElements.forEach((o,c)=>{const{node:u}=o,d=u.getStage();d.setPointersPositions(n),o.pointerId===void 0&&(o.pointerId=s.Util._getFirstPointerId(n));const f=d._changedPointerPositions.find(_=>_.id===o.pointerId);if(f){if(o.dragStatus!=="dragging"){var m=u.dragDistance(),S=Math.max(Math.abs(f.x-o.startPointerPos.x),Math.abs(f.y-o.startPointerPos.y));if(S<m||(u.startDrag({evt:n}),!u.isDragging()))return}u._setDragPosition(n,o),a.push(u)}}),a.forEach(o=>{o.fire("dragmove",{type:"dragmove",target:o,evt:n},!0)})},_endDragBefore(n){const a=[];r.DD._dragElements.forEach(o=>{const{node:c}=o,u=c.getStage();if(n&&u.setPointersPositions(n),!u._changedPointerPositions.find(f=>f.id===o.pointerId))return;(o.dragStatus==="dragging"||o.dragStatus==="stopped")&&(r.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,o.dragStatus="stopped");const d=o.node.getLayer()||o.node instanceof t.Konva.Stage&&o.node;d&&a.indexOf(d)===-1&&a.push(d)}),a.forEach(o=>{o.draw()})},_endDragAfter(n){r.DD._dragElements.forEach((a,o)=>{a.dragStatus==="stopped"&&a.node.fire("dragend",{type:"dragend",target:a.node,evt:n},!0),a.dragStatus!=="dragging"&&r.DD._dragElements.delete(o)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",r.DD._endDragBefore,!0),window.addEventListener("touchend",r.DD._endDragBefore,!0),window.addEventListener("mousemove",r.DD._drag),window.addEventListener("touchmove",r.DD._drag),window.addEventListener("mouseup",r.DD._endDragAfter,!1),window.addEventListener("touchend",r.DD._endDragAfter,!1))})(gl),Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.Node=void 0;const mi=Qi,po=ai,go=En,Ts=si,fn=gl,sr=De;var ml="absoluteOpacity",vl="allEventListeners",os="absoluteTransform",cp="absoluteScale",Zs="canvas",Ay="Change",Sy="children",Ey="konva",Lc="listening",dp="mouseenter",up="mouseleave",fp="set",pp="Shape",yl=" ",gp="stage",Ps="transform",Cy="Stage",Dc="visible",ky=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(yl);let Ty=1,Xe=class{constructor(r){this._id=Ty++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(r),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(r){(r===Ps||r===os)&&this._cache.get(r)?this._cache.get(r).dirty=!0:r?this._cache.delete(r):this._cache.clear()}_getCache(r,t){var s=this._cache.get(r),n=r===Ps||r===os,a=s===void 0||n&&s.dirty===!0;return a&&(s=t.call(this),this._cache.set(r,s)),s}_calculate(r,t,s){if(!this._attachedDepsListeners.get(r)){const n=t.map(a=>a+"Change.konva").join(yl);this.on(n,()=>{this._clearCache(r)}),this._attachedDepsListeners.set(r,!0)}return this._getCache(r,s)}_getCanvasCache(){return this._cache.get(Zs)}_clearSelfAndDescendantCache(r){this._clearCache(r),r===os&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Zs)){const{scene:r,filter:t,hit:s}=this._cache.get(Zs);mi.Util.releaseCanvas(r,t,s),this._cache.delete(Zs)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(r){var t=r||{},s={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(s=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var n=Math.ceil(t.width||s.width),a=Math.ceil(t.height||s.height),o=t.pixelRatio,c=t.x===void 0?Math.floor(s.x):t.x,u=t.y===void 0?Math.floor(s.y):t.y,d=t.offset||0,f=t.drawBorder||!1,m=t.hitCanvasPixelRatio||1;if(!n||!a){mi.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const S=Math.abs(Math.round(s.x)-c)>.5?1:0,_=Math.abs(Math.round(s.y)-u)>.5?1:0;n+=d*2+S,a+=d*2+_,c-=d,u-=d;var v=new go.SceneCanvas({pixelRatio:o,width:n,height:a}),b=new go.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),x=new go.HitCanvas({pixelRatio:m,width:n,height:a}),A=v.getContext(),F=x.getContext();return x.isCache=!0,v.isCache=!0,this._cache.delete(Zs),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,b.getContext()._context.imageSmoothingEnabled=!1),A.save(),F.save(),A.translate(-c,-u),F.translate(-c,-u),this._isUnderCache=!0,this._clearSelfAndDescendantCache(ml),this._clearSelfAndDescendantCache(cp),this.drawScene(v,this),this.drawHit(x,this),this._isUnderCache=!1,A.restore(),F.restore(),f&&(A.save(),A.beginPath(),A.rect(0,0,n,a),A.closePath(),A.setAttr("strokeStyle","red"),A.setAttr("lineWidth",5),A.stroke(),A.restore()),this._cache.set(Zs,{scene:v,filter:b,hit:x,x:c,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(Zs)}getClientRect(r){throw new Error('abstract "getClientRect" method call')}_transformedRect(r,t){var s=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],n=1/0,a=1/0,o=-1/0,c=-1/0,u=this.getAbsoluteTransform(t);return s.forEach(function(d){var f=u.point(d);n===void 0&&(n=o=f.x,a=c=f.y),n=Math.min(n,f.x),a=Math.min(a,f.y),o=Math.max(o,f.x),c=Math.max(c,f.y)}),{x:n,y:a,width:o-n,height:c-a}}_drawCachedSceneCanvas(r){r.save(),r._applyOpacity(this),r._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();r.translate(t.x,t.y);var s=this._getCachedSceneCanvas(),n=s.pixelRatio;r.drawImage(s._canvas,0,0,s.width/n,s.height/n),r.restore()}_drawCachedHitCanvas(r){var t=this._getCanvasCache(),s=t.hit;r.save(),r.translate(t.x,t.y),r.drawImage(s._canvas,0,0,s.width/s.pixelRatio,s.height/s.pixelRatio),r.restore()}_getCachedSceneCanvas(){var r=this.filters(),t=this._getCanvasCache(),s=t.scene,n=t.filter,a=n.getContext(),o,c,u,d;if(r){if(!this._filterUpToDate){var f=s.pixelRatio;n.setSize(s.width/s.pixelRatio,s.height/s.pixelRatio);try{for(o=r.length,a.clear(),a.drawImage(s._canvas,0,0,s.getWidth()/f,s.getHeight()/f),c=a.getImageData(0,0,n.getWidth(),n.getHeight()),u=0;u<o;u++){if(d=r[u],typeof d!="function"){mi.Util.error("Filter should be type of function, but got "+typeof d+" instead. Please check correct filters");continue}d.call(this,c),a.putImageData(c,0,0)}}catch(m){mi.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return s}on(r,t){if(this._cache&&this._cache.delete(vl),arguments.length===3)return this._delegate.apply(this,arguments);var s=r.split(yl),n=s.length,a,o,c,u,d;for(a=0;a<n;a++)o=s[a],c=o.split("."),u=c[0],d=c[1]||"",this.eventListeners[u]||(this.eventListeners[u]=[]),this.eventListeners[u].push({name:d,handler:t});return this}off(r,t){var s=(r||"").split(yl),n=s.length,a,o,c,u,d,f;if(this._cache&&this._cache.delete(vl),!r)for(o in this.eventListeners)this._off(o);for(a=0;a<n;a++)if(c=s[a],u=c.split("."),d=u[0],f=u[1],d)this.eventListeners[d]&&this._off(d,f,t);else for(o in this.eventListeners)this._off(o,f,t);return this}dispatchEvent(r){var t={target:this,type:r.type,evt:r};return this.fire(r.type,t),this}addEventListener(r,t){return this.on(r,function(s){t.call(this,s.evt)}),this}removeEventListener(r){return this.off(r),this}_delegate(r,t,s){var n=this;this.on(r,function(a){for(var o=a.target.findAncestors(t,!0,n),c=0;c<o.length;c++)a=mi.Util.cloneObject(a),a.currentTarget=o[c],s.call(o[c],a)})}remove(){return this.isDragging()&&this.stopDrag(),fn.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(os),this._clearSelfAndDescendantCache(ml),this._clearSelfAndDescendantCache(cp),this._clearSelfAndDescendantCache(gp),this._clearSelfAndDescendantCache(Dc),this._clearSelfAndDescendantCache(Lc)}_remove(){this._clearCaches();var r=this.getParent();r&&r.children&&(r.children.splice(this.index,1),r._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(r){var t="get"+mi.Util._capitalize(r);return mi.Util._isFunction(this[t])?this[t]():this.attrs[r]}getAncestors(){for(var r=this.getParent(),t=[];r;)t.push(r),r=r.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(r){return this._batchTransformChanges(()=>{var t,s;if(!r)return this;for(t in r)t!==Sy&&(s=fp+mi.Util._capitalize(t),mi.Util._isFunction(this[s])?this[s](r[t]):this._setAttr(t,r[t]))}),this}isListening(){return this._getCache(Lc,this._isListening)}_isListening(r){if(!this.listening())return!1;const t=this.getParent();return t&&t!==r&&this!==r?t._isListening(r):!0}isVisible(){return this._getCache(Dc,this._isVisible)}_isVisible(r){if(!this.visible())return!1;const t=this.getParent();return t&&t!==r&&this!==r?t._isVisible(r):!0}shouldDrawHit(r,t=!1){if(r)return this._isVisible(r)&&this._isListening(r);var s=this.getLayer(),n=!1;fn.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===s)&&(n=!0)});var a=!t&&!Ts.Konva.hitOnDragEnabled&&(n||Ts.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var r=this.getDepth(),t=this,s=0,n,a,o,c;function u(f){for(n=[],a=f.length,o=0;o<a;o++)c=f[o],s++,c.nodeType!==pp&&(n=n.concat(c.getChildren().slice())),c._id===t._id&&(o=a);n.length>0&&n[0].getDepth()<=r&&u(n)}const d=this.getStage();return t.nodeType!==Cy&&d&&u(d.getChildren()),s}getDepth(){for(var r=0,t=this.parent;t;)r++,t=t.parent;return r}_batchTransformChanges(r){this._batchingTransformChange=!0,r(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ps),this._clearSelfAndDescendantCache(os)),this._needClearTransformCache=!1}setPosition(r){return this._batchTransformChanges(()=>{this.x(r.x),this.y(r.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const r=this.getStage();if(!r)return null;var t=r.getPointerPosition();if(!t)return null;var s=this.getAbsoluteTransform().copy();return s.invert(),s.point(t)}getAbsolutePosition(r){let t=!1,s=this.parent;for(;s;){if(s.isCached()){t=!0;break}s=s.parent}t&&!r&&(r=!0);var n=this.getAbsoluteTransform(r).getMatrix(),a=new mi.Transform,o=this.offset();return a.m=n.slice(),a.translate(o.x,o.y),a.getTranslation()}setAbsolutePosition(r){const{x:t,y:s,...n}=this._clearTransform();this.attrs.x=t,this.attrs.y=s,this._clearCache(Ps);var a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(r.x,r.y),r={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(n),this.setPosition({x:r.x,y:r.y}),this._clearCache(Ps),this._clearSelfAndDescendantCache(os),this}_setTransform(r){var t;for(t in r)this.attrs[t]=r[t]}_clearTransform(){var r={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,r}move(r){var t=r.x,s=r.y,n=this.x(),a=this.y();return t!==void 0&&(n+=t),s!==void 0&&(a+=s),this.setPosition({x:n,y:a}),this}_eachAncestorReverse(r,t){var s=[],n=this.getParent(),a,o;if(!(t&&t._id===this._id)){for(s.unshift(this);n&&(!t||n._id!==t._id);)s.unshift(n),n=n.parent;for(a=s.length,o=0;o<a;o++)r(s[o])}}rotate(r){return this.rotation(this.rotation()+r),this}moveToTop(){if(!this.parent)return mi.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var r=this.index,t=this.parent.getChildren().length;return r<t-1?(this.parent.children.splice(r,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return mi.Util.warn("Node has no parent. moveUp function is ignored."),!1;var r=this.index,t=this.parent.getChildren().length;return r<t-1?(this.parent.children.splice(r,1),this.parent.children.splice(r+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return mi.Util.warn("Node has no parent. moveDown function is ignored."),!1;var r=this.index;return r>0?(this.parent.children.splice(r,1),this.parent.children.splice(r-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return mi.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var r=this.index;return r>0?(this.parent.children.splice(r,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(r){if(!this.parent)return mi.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(r<0||r>=this.parent.children.length)&&mi.Util.warn("Unexpected value "+r+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(r,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(ml,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var r=this.opacity(),t=this.getParent();return t&&!t._isUnderCache&&(r*=t.getAbsoluteOpacity()),r}moveTo(r){return this.getParent()!==r&&(this._remove(),r.add(this)),this}toObject(){var r=this.getAttrs(),t,s,n,a,o;const c={attrs:{},className:this.getClassName()};for(t in r)s=r[t],o=mi.Util.isObject(s)&&!mi.Util._isPlainObject(s)&&!mi.Util._isArray(s),!o&&(n=typeof this[t]=="function"&&this[t],delete r[t],a=n?n.call(this):null,r[t]=s,a!==s&&(c.attrs[t]=s));return mi.Util._prepareToStringify(c)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(r,t,s){var n=[];t&&this._isMatch(r)&&n.push(this);for(var a=this.parent;a;){if(a===s)return n;a._isMatch(r)&&n.push(a),a=a.parent}return n}isAncestorOf(r){return!1}findAncestor(r,t,s){return this.findAncestors(r,t,s)[0]}_isMatch(r){if(!r)return!1;if(typeof r=="function")return r(this);var t=r.replace(/ /g,"").split(","),s=t.length,n,a;for(n=0;n<s;n++)if(a=t[n],mi.Util.isValidSelector(a)||(mi.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),mi.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),mi.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){var r=this.getParent();return r?r.getLayer():null}getStage(){return this._getCache(gp,this._getStage)}_getStage(){var r=this.getParent();return r?r.getStage():null}fire(r,t={},s){return t.target=t.target||this,s?this._fireAndBubble(r,t):this._fire(r,t),this}getAbsoluteTransform(r){return r?this._getAbsoluteTransform(r):this._getCache(os,this._getAbsoluteTransform)}_getAbsoluteTransform(r){var t;if(r)return t=new mi.Transform,this._eachAncestorReverse(function(n){var a=n.transformsEnabled();a==="all"?t.multiply(n.getTransform()):a==="position"&&t.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},r),t;t=this._cache.get(os)||new mi.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();var s=this.transformsEnabled();if(s==="all")t.multiply(this.getTransform());else if(s==="position"){const n=this.attrs.x||0,a=this.attrs.y||0,o=this.attrs.offsetX||0,c=this.attrs.offsetY||0;t.translate(n-o,a-c)}return t.dirty=!1,t}getAbsoluteScale(r){for(var t=this;t;)t._isUnderCache&&(r=t),t=t.getParent();const s=this.getAbsoluteTransform(r).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ps,this._getTransform)}_getTransform(){var r,t,s=this._cache.get(Ps)||new mi.Transform;s.reset();var n=this.x(),a=this.y(),o=Ts.Konva.getAngle(this.rotation()),c=(r=this.attrs.scaleX)!==null&&r!==void 0?r:1,u=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,d=this.attrs.skewX||0,f=this.attrs.skewY||0,m=this.attrs.offsetX||0,S=this.attrs.offsetY||0;return(n!==0||a!==0)&&s.translate(n,a),o!==0&&s.rotate(o),(d!==0||f!==0)&&s.skew(d,f),(c!==1||u!==1)&&s.scale(c,u),(m!==0||S!==0)&&s.translate(-1*m,-1*S),s.dirty=!1,s}clone(r){var t=mi.Util.cloneObject(this.attrs),s,n,a,o,c;for(s in r)t[s]=r[s];var u=new this.constructor(t);for(s in this.eventListeners)for(n=this.eventListeners[s],a=n.length,o=0;o<a;o++)c=n[o],c.name.indexOf(Ey)<0&&(u.eventListeners[s]||(u.eventListeners[s]=[]),u.eventListeners[s].push(c));return u}_toKonvaCanvas(r){r=r||{};var t=this.getClientRect(),s=this.getStage(),n=r.x!==void 0?r.x:Math.floor(t.x),a=r.y!==void 0?r.y:Math.floor(t.y),o=r.pixelRatio||1,c=new go.SceneCanvas({width:r.width||Math.ceil(t.width)||(s?s.width():0),height:r.height||Math.ceil(t.height)||(s?s.height():0),pixelRatio:o}),u=c.getContext();const d=new go.SceneCanvas({width:c.width/c.pixelRatio+Math.abs(n),height:c.height/c.pixelRatio+Math.abs(a),pixelRatio:c.pixelRatio});return r.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(n||a)&&u.translate(-1*n,-1*a),this.drawScene(c,void 0,d),u.restore(),c}toCanvas(r){return this._toKonvaCanvas(r)._canvas}toDataURL(r){r=r||{};var t=r.mimeType||null,s=r.quality||null,n=this._toKonvaCanvas(r).toDataURL(t,s);return r.callback&&r.callback(n),n}toImage(r){return new Promise((t,s)=>{try{const n=r==null?void 0:r.callback;n&&delete r.callback,mi.Util._urlToImage(this.toDataURL(r),function(a){t(a),n==null||n(a)})}catch(n){s(n)}})}toBlob(r){return new Promise((t,s)=>{try{const n=r==null?void 0:r.callback;n&&delete r.callback,this.toCanvas(r).toBlob(a=>{t(a),n==null||n(a)},r==null?void 0:r.mimeType,r==null?void 0:r.quality)}catch(n){s(n)}})}setSize(r){return this.width(r.width),this.height(r.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Ts.Konva.dragDistance}_off(r,t,s){var n=this.eventListeners[r],a,o,c;for(a=0;a<n.length;a++)if(o=n[a].name,c=n[a].handler,(o!=="konva"||t==="konva")&&(!t||o===t)&&(!s||s===c)){if(n.splice(a,1),n.length===0){delete this.eventListeners[r];break}a--}}_fireChangeEvent(r,t,s){this._fire(r+Ay,{oldVal:t,newVal:s})}addName(r){if(!this.hasName(r)){var t=this.name(),s=t?t+" "+r:r;this.name(s)}return this}hasName(r){if(!r)return!1;const t=this.name();if(!t)return!1;var s=(t||"").split(/\s/g);return s.indexOf(r)!==-1}removeName(r){var t=(this.name()||"").split(/\s/g),s=t.indexOf(r);return s!==-1&&(t.splice(s,1),this.name(t.join(" "))),this}setAttr(r,t){var s=this[fp+mi.Util._capitalize(r)];return mi.Util._isFunction(s)?s.call(this,t):this._setAttr(r,t),this}_requestDraw(){if(Ts.Konva.autoDrawEnabled){const r=this.getLayer()||this.getStage();r==null||r.batchDraw()}}_setAttr(r,t){var s=this.attrs[r];s===t&&!mi.Util.isObject(t)||(t==null?delete this.attrs[r]:this.attrs[r]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(r,s,t),this._requestDraw())}_setComponentAttr(r,t,s){var n;s!==void 0&&(n=this.attrs[r],n||(this.attrs[r]=this.getAttr(r)),this.attrs[r][t]=s,this._fireChangeEvent(r,n,s))}_fireAndBubble(r,t,s){t&&this.nodeType===pp&&(t.target=this);var n=(r===dp||r===up)&&(s&&(this===s||this.isAncestorOf&&this.isAncestorOf(s))||this.nodeType==="Stage"&&!s);if(!n){this._fire(r,t);var a=(r===dp||r===up)&&s&&s.isAncestorOf&&s.isAncestorOf(this)&&!s.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!a&&(s&&s.parent?this._fireAndBubble.call(this.parent,r,t,s):this._fireAndBubble.call(this.parent,r,t))}}_getProtoListeners(r){var t,s,n;const a=(t=this._cache.get(vl))!==null&&t!==void 0?t:{};let o=a==null?void 0:a[r];if(o===void 0){o=[];let c=Object.getPrototypeOf(this);for(;c;){const u=(n=(s=c.eventListeners)===null||s===void 0?void 0:s[r])!==null&&n!==void 0?n:[];o.push(...u),c=Object.getPrototypeOf(c)}a[r]=o,this._cache.set(vl,a)}return o}_fire(r,t){t=t||{},t.currentTarget=this,t.type=r;const s=this._getProtoListeners(r);if(s)for(var n=0;n<s.length;n++)s[n].handler.call(this,t);const a=this.eventListeners[r];if(a)for(var n=0;n<a.length;n++)a[n].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(r){var t=r?r.pointerId:void 0,s=this.getStage(),n=this.getAbsolutePosition();if(s){var a=s._getPointerById(t)||s._changedPointerPositions[0]||n;fn.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-n.x,y:a.y-n.y},dragStatus:"ready",pointerId:t})}}startDrag(r,t=!0){fn.DD._dragElements.has(this._id)||this._createDragElement(r);const s=fn.DD._dragElements.get(this._id);s.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:r&&r.evt},t)}_setDragPosition(r,t){const s=this.getStage()._getPointerById(t.pointerId);if(s){var n={x:s.x-t.offset.x,y:s.y-t.offset.y},a=this.dragBoundFunc();if(a!==void 0){const o=a.call(this,n,r);o?n=o:mi.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==n.x||this._lastPos.y!==n.y)&&(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}}stopDrag(r){const t=fn.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),fn.DD._endDragBefore(r),fn.DD._endDragAfter(r)}setDraggable(r){this._setAttr("draggable",r),this._dragChange()}isDragging(){const r=fn.DD._dragElements.get(this._id);return r?r.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(r){var t=r.evt.button!==void 0,s=!t||Ts.Konva.dragButtons.indexOf(r.evt.button)>=0;if(s&&!this.isDragging()){var n=!1;fn.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(n=!0)}),n||this._createDragElement(r)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var r=this.getStage();if(!r)return;const t=fn.DD._dragElements.get(this._id),s=t&&t.dragStatus==="dragging",n=t&&t.dragStatus==="ready";s?this.stopDrag():n&&fn.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(r={x:0,y:0}){const t=this.getStage();if(!t)return!1;const s={x:-r.x,y:-r.y,width:t.width()+2*r.x,height:t.height()+2*r.y};return mi.Util.haveIntersection(s,this.getClientRect())}static create(r,t){return mi.Util._isString(r)&&(r=JSON.parse(r)),this._createNode(r,t)}static _createNode(r,t){var s=Xe.prototype.getClassName.call(r),n=r.children,a,o,c;t&&(r.attrs.container=t),Ts.Konva[s]||(mi.Util.warn('Can not find a node with class name "'+s+'". Fallback to "Shape".'),s="Shape");const u=Ts.Konva[s];if(a=new u(r.attrs),n)for(o=n.length,c=0;c<o;c++)a.add(Xe._createNode(n[c]));return a}};Wi.Node=Xe,Xe.prototype.nodeType="Node",Xe.prototype._attrsAffectingSize=[],Xe.prototype.eventListeners={},Xe.prototype.on.call(Xe.prototype,ky,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ps),this._clearSelfAndDescendantCache(os)}),Xe.prototype.on.call(Xe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Dc)}),Xe.prototype.on.call(Xe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Lc)}),Xe.prototype.on.call(Xe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(ml)});const Li=po.Factory.addGetterSetter;Li(Xe,"zIndex"),Li(Xe,"absolutePosition"),Li(Xe,"position"),Li(Xe,"x",0,(0,sr.getNumberValidator)()),Li(Xe,"y",0,(0,sr.getNumberValidator)()),Li(Xe,"globalCompositeOperation","source-over",(0,sr.getStringValidator)()),Li(Xe,"opacity",1,(0,sr.getNumberValidator)()),Li(Xe,"name","",(0,sr.getStringValidator)()),Li(Xe,"id","",(0,sr.getStringValidator)()),Li(Xe,"rotation",0,(0,sr.getNumberValidator)()),po.Factory.addComponentsGetterSetter(Xe,"scale",["x","y"]),Li(Xe,"scaleX",1,(0,sr.getNumberValidator)()),Li(Xe,"scaleY",1,(0,sr.getNumberValidator)()),po.Factory.addComponentsGetterSetter(Xe,"skew",["x","y"]),Li(Xe,"skewX",0,(0,sr.getNumberValidator)()),Li(Xe,"skewY",0,(0,sr.getNumberValidator)()),po.Factory.addComponentsGetterSetter(Xe,"offset",["x","y"]),Li(Xe,"offsetX",0,(0,sr.getNumberValidator)()),Li(Xe,"offsetY",0,(0,sr.getNumberValidator)()),Li(Xe,"dragDistance",null,(0,sr.getNumberValidator)()),Li(Xe,"width",0,(0,sr.getNumberValidator)()),Li(Xe,"height",0,(0,sr.getNumberValidator)()),Li(Xe,"listening",!0,(0,sr.getBooleanValidator)()),Li(Xe,"preventDefault",!0,(0,sr.getBooleanValidator)()),Li(Xe,"filters",null,function(r){return this._filterUpToDate=!1,r}),Li(Xe,"visible",!0,(0,sr.getBooleanValidator)()),Li(Xe,"transformsEnabled","all",(0,sr.getStringValidator)()),Li(Xe,"size"),Li(Xe,"dragBoundFunc"),Li(Xe,"draggable",!1,(0,sr.getBooleanValidator)()),po.Factory.backCompat(Xe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Js={};Object.defineProperty(Js,"__esModule",{value:!0}),Js.Container=void 0;const Ta=ai,Nc=Wi,bl=De;class ta extends Nc.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const s=this.children||[];var n=[];return s.forEach(function(a){t(a)&&n.push(a)}),n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(var s=0;s<t.length;s++)this.add(t[s]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var s=this._generalFind(t,!0);return s.length>0?s[0]:void 0}_generalFind(t,s){var n=[];return this._descendants(a=>{const o=a._isMatch(t);return o&&n.push(a),!!(o&&s)}),n}_descendants(t){let s=!1;const n=this.getChildren();for(const a of n)if(s=t(a),s||a.hasChildren()&&(s=a._descendants(t),s))return!0;return!1}toObject(){var t=Nc.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(s=>{t.children.push(s.toObject())}),t}isAncestorOf(t){for(var s=t.getParent();s;){if(s._id===this._id)return!0;s=s.getParent()}return!1}clone(t){var s=Nc.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){s.add(n.clone())}),s}getAllIntersections(t){var s=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&s.push(n)}),s}_clearSelfAndDescendantCache(t){var s;super._clearSelfAndDescendantCache(t),!this.isCached()&&((s=this.children)===null||s===void 0||s.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(s,n){s.index=n}),this._requestDraw()}drawScene(t,s,n){var a=this.getLayer(),o=t||a&&a.getCanvas(),c=o&&o.getContext(),u=this._getCanvasCache(),d=u&&u.scene,f=o&&o.isCache;if(!this.isVisible()&&!f)return this;if(d){c.save();var m=this.getAbsoluteTransform(s).getMatrix();c.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",o,s,n);return this}drawHit(t,s){if(!this.shouldDrawHit(s))return this;var n=this.getLayer(),a=t||n&&n.hitCanvas,o=a&&a.getContext(),c=this._getCanvasCache(),u=c&&c.hit;if(u){o.save();var d=this.getAbsoluteTransform(s).getMatrix();o.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",a,s);return this}_drawChildren(t,s,n,a){var o,c=s&&s.getContext(),u=this.clipWidth(),d=this.clipHeight(),f=this.clipFunc(),m=typeof u=="number"&&typeof d=="number"||f;const S=n===this;if(m){c.save();var _=this.getAbsoluteTransform(n),v=_.getMatrix();c.transform(v[0],v[1],v[2],v[3],v[4],v[5]),c.beginPath();let F;if(f)F=f.call(this,c,this);else{var b=this.clipX(),x=this.clipY();c.rect(b||0,x||0,u,d)}c.clip.apply(c,F),v=_.copy().invert().getMatrix(),c.transform(v[0],v[1],v[2],v[3],v[4],v[5])}var A=!S&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";A&&(c.save(),c._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(F){F[t](s,n,a)}),A&&c.restore(),m&&c.restore()}getClientRect(t={}){var s,n=t.skipTransform,a=t.relativeTo,o,c,u,d,f={x:1/0,y:1/0,width:0,height:0},m=this;(s=this.children)===null||s===void 0||s.forEach(function(x){if(x.visible()){var A=x.getClientRect({relativeTo:m,skipShadow:t.skipShadow,skipStroke:t.skipStroke});A.width===0&&A.height===0||(o===void 0?(o=A.x,c=A.y,u=A.x+A.width,d=A.y+A.height):(o=Math.min(o,A.x),c=Math.min(c,A.y),u=Math.max(u,A.x+A.width),d=Math.max(d,A.y+A.height)))}});for(var S=this.find("Shape"),_=!1,v=0;v<S.length;v++){var b=S[v];if(b._isVisible(this)){_=!0;break}}return _&&o!==void 0?f={x:o,y:c,width:u-o,height:d-c}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,a)}}Js.Container=ta,Ta.Factory.addComponentsGetterSetter(ta,"clip",["x","y","width","height"]),Ta.Factory.addGetterSetter(ta,"clipX",void 0,(0,bl.getNumberValidator)()),Ta.Factory.addGetterSetter(ta,"clipY",void 0,(0,bl.getNumberValidator)()),Ta.Factory.addGetterSetter(ta,"clipWidth",void 0,(0,bl.getNumberValidator)()),Ta.Factory.addGetterSetter(ta,"clipHeight",void 0,(0,bl.getNumberValidator)()),Ta.Factory.addGetterSetter(ta,"clipFunc");var mp={},an={};Object.defineProperty(an,"__esModule",{value:!0}),an.releaseCapture=an.setPointerCapture=an.hasPointerCapture=an.createEvent=an.getCapturedShape=void 0;const Py=si,mo=new Map,vp=Py.Konva._global.PointerEvent!==void 0;function My(r){return mo.get(r)}an.getCapturedShape=My;function Oc(r){return{evt:r,pointerId:r.pointerId}}an.createEvent=Oc;function Ry(r,t){return mo.get(r)===t}an.hasPointerCapture=Ry;function Fy(r,t){yp(r),t.getStage()&&(mo.set(r,t),vp&&t._fire("gotpointercapture",Oc(new PointerEvent("gotpointercapture"))))}an.setPointerCapture=Fy;function yp(r,t){const s=mo.get(r);if(!s)return;const n=s.getStage();n&&n.content,mo.delete(r),vp&&s._fire("lostpointercapture",Oc(new PointerEvent("lostpointercapture")))}an.releaseCapture=yp,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Stage=r.stages=void 0;const t=Qi,s=ai,n=Js,a=si,o=En,c=gl,u=si,d=an;var f="Stage",m="string",S="px",_="mouseout",v="mouseleave",b="mouseover",x="mouseenter",A="mousemove",F="mousedown",M="mouseup",g="pointermove",w="pointerdown",E="pointerup",C="pointercancel",B="lostpointercapture",I="pointerout",rt="pointerleave",tt="pointerover",st="pointerenter",wt="contextmenu",dt="touchstart",Tt="touchend",Lt="touchmove",Qt="touchcancel",ct="wheel",Dt=5,ee=[[x,"_pointerenter"],[F,"_pointerdown"],[A,"_pointermove"],[M,"_pointerup"],[v,"_pointerleave"],[dt,"_pointerdown"],[Lt,"_pointermove"],[Tt,"_pointerup"],[Qt,"_pointercancel"],[b,"_pointerover"],[ct,"_wheel"],[wt,"_contextmenu"],[w,"_pointerdown"],[g,"_pointermove"],[E,"_pointerup"],[C,"_pointercancel"],[B,"_lostpointercapture"]];const zt={mouse:{[I]:_,[rt]:v,[tt]:b,[st]:x,[g]:A,[w]:F,[E]:M,[C]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[I]:"touchout",[rt]:"touchleave",[tt]:"touchover",[st]:"touchenter",[g]:Lt,[w]:dt,[E]:Tt,[C]:Qt,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[I]:I,[rt]:rt,[tt]:tt,[st]:st,[g]:g,[w]:w,[E]:E,[C]:C,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Jt=Gt=>Gt.indexOf("pointer")>=0?"pointer":Gt.indexOf("touch")>=0?"touch":"mouse",oe=Gt=>{const lt=Jt(Gt);if(lt==="pointer")return a.Konva.pointerEventsEnabled&&zt.pointer;if(lt==="touch")return zt.touch;if(lt==="mouse")return zt.mouse};function ge(Gt={}){return(Gt.clipFunc||Gt.clipWidth||Gt.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Gt}const Ae="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";r.stages=[];class Ve extends n.Container{constructor(lt){super(ge(lt)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),r.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ge(this.attrs)}),this._checkVisibility()}_validateAdd(lt){const Ft=lt.getType()==="Layer",Wt=lt.getType()==="FastLayer";Ft||Wt||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const lt=this.visible()?"":"none";this.content.style.display=lt}setContainer(lt){if(typeof lt===m){if(lt.charAt(0)==="."){var Ft=lt.slice(1);lt=document.getElementsByClassName(Ft)[0]}else{var Wt;lt.charAt(0)!=="#"?Wt=lt:Wt=lt.slice(1),lt=document.getElementById(Wt)}if(!lt)throw"Can not find container in document with id "+Wt}return this._setAttr("container",lt),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),lt.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var lt=this.children,Ft=lt.length,Wt;for(Wt=0;Wt<Ft;Wt++)lt[Wt].clear();return this}clone(lt){return lt||(lt={}),lt.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,lt)}destroy(){super.destroy();var lt=this.content;lt&&t.Util._isInDocument(lt)&&this.container().removeChild(lt);var Ft=r.stages.indexOf(this);return Ft>-1&&r.stages.splice(Ft,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const lt=this._pointerPositions[0]||this._changedPointerPositions[0];return lt?{x:lt.x,y:lt.y}:(t.Util.warn(Ae),null)}_getPointerById(lt){return this._pointerPositions.find(Ft=>Ft.id===lt)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(lt){lt=lt||{},lt.x=lt.x||0,lt.y=lt.y||0,lt.width=lt.width||this.width(),lt.height=lt.height||this.height();var Ft=new o.SceneCanvas({width:lt.width,height:lt.height,pixelRatio:lt.pixelRatio||1}),Wt=Ft.getContext()._context,ve=this.children;return(lt.x||lt.y)&&Wt.translate(-1*lt.x,-1*lt.y),ve.forEach(function(ie){if(ie.isVisible()){var xe=ie._toKonvaCanvas(lt);Wt.drawImage(xe._canvas,lt.x,lt.y,xe.getWidth()/xe.getPixelRatio(),xe.getHeight()/xe.getPixelRatio())}}),Ft}getIntersection(lt){if(!lt)return null;var Ft=this.children,Wt=Ft.length,ve=Wt-1,ie;for(ie=ve;ie>=0;ie--){const xe=Ft[ie].getIntersection(lt);if(xe)return xe}return null}_resizeDOM(){var lt=this.width(),Ft=this.height();this.content&&(this.content.style.width=lt+S,this.content.style.height=Ft+S),this.bufferCanvas.setSize(lt,Ft),this.bufferHitCanvas.setSize(lt,Ft),this.children.forEach(Wt=>{Wt.setSize({width:lt,height:Ft}),Wt.draw()})}add(lt,...Ft){if(arguments.length>1){for(var Wt=0;Wt<arguments.length;Wt++)this.add(arguments[Wt]);return this}super.add(lt);var ve=this.children.length;return ve>Dt&&t.Util.warn("The stage has "+ve+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),lt.setSize({width:this.width(),height:this.height()}),lt.draw(),a.Konva.isBrowser&&this.content.appendChild(lt.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(lt){return d.hasPointerCapture(lt,this)}setPointerCapture(lt){d.setPointerCapture(lt,this)}releaseCapture(lt){d.releaseCapture(lt,this)}getLayers(){return this.children}_bindContentEvents(){!a.Konva.isBrowser||ee.forEach(([lt,Ft])=>{this.content.addEventListener(lt,Wt=>{this[Ft](Wt)},{passive:!1})})}_pointerenter(lt){this.setPointersPositions(lt);const Ft=oe(lt.type);Ft&&this._fire(Ft.pointerenter,{evt:lt,target:this,currentTarget:this})}_pointerover(lt){this.setPointersPositions(lt);const Ft=oe(lt.type);Ft&&this._fire(Ft.pointerover,{evt:lt,target:this,currentTarget:this})}_getTargetShape(lt){let Ft=this[lt+"targetShape"];return Ft&&!Ft.getStage()&&(Ft=null),Ft}_pointerleave(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(Ft){this.setPointersPositions(lt);var ve=this._getTargetShape(Wt),ie=!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled;ve&&ie?(ve._fireAndBubble(Ft.pointerout,{evt:lt}),ve._fireAndBubble(Ft.pointerleave,{evt:lt}),this._fire(Ft.pointerleave,{evt:lt,target:this,currentTarget:this}),this[Wt+"targetShape"]=null):ie&&(this._fire(Ft.pointerleave,{evt:lt,target:this,currentTarget:this}),this._fire(Ft.pointerout,{evt:lt,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(Ft){this.setPointersPositions(lt);var ve=!1;this._changedPointerPositions.forEach(ie=>{var xe=this.getIntersection(ie);if(c.DD.justDragged=!1,a.Konva["_"+Wt+"ListenClick"]=!0,!xe||!xe.isListening())return;a.Konva.capturePointerEventsEnabled&&xe.setPointerCapture(ie.id),this[Wt+"ClickStartShape"]=xe,xe._fireAndBubble(Ft.pointerdown,{evt:lt,pointerId:ie.id}),ve=!0;const _e=lt.type.indexOf("touch")>=0;xe.preventDefault()&&lt.cancelable&&_e&&lt.preventDefault()}),ve||this._fire(Ft.pointerdown,{evt:lt,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(!Ft)return;a.Konva.isDragging()&&c.DD.node.preventDefault()&&lt.cancelable&&lt.preventDefault(),this.setPointersPositions(lt);var ve=!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled;if(!ve)return;var ie={};let xe=!1;var _e=this._getTargetShape(Wt);this._changedPointerPositions.forEach(ut=>{const T=d.getCapturedShape(ut.id)||this.getIntersection(ut),R=ut.id,D={evt:lt,pointerId:R};var H=_e!==T;if(H&&_e&&(_e._fireAndBubble(Ft.pointerout,{...D},T),_e._fireAndBubble(Ft.pointerleave,{...D},T)),T){if(ie[T._id])return;ie[T._id]=!0}T&&T.isListening()?(xe=!0,H&&(T._fireAndBubble(Ft.pointerover,{...D},_e),T._fireAndBubble(Ft.pointerenter,{...D},_e),this[Wt+"targetShape"]=T),T._fireAndBubble(Ft.pointermove,{...D})):_e&&(this._fire(Ft.pointerover,{evt:lt,target:this,currentTarget:this,pointerId:R}),this[Wt+"targetShape"]=null)}),xe||this._fire(Ft.pointermove,{evt:lt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(!Ft)return;this.setPointersPositions(lt);const ve=this[Wt+"ClickStartShape"],ie=this[Wt+"ClickEndShape"];var xe={};let _e=!1;this._changedPointerPositions.forEach(ut=>{const T=d.getCapturedShape(ut.id)||this.getIntersection(ut);if(T){if(T.releaseCapture(ut.id),xe[T._id])return;xe[T._id]=!0}const R=ut.id,D={evt:lt,pointerId:R};let H=!1;a.Konva["_"+Wt+"InDblClickWindow"]?(H=!0,clearTimeout(this[Wt+"DblTimeout"])):c.DD.justDragged||(a.Konva["_"+Wt+"InDblClickWindow"]=!0,clearTimeout(this[Wt+"DblTimeout"])),this[Wt+"DblTimeout"]=setTimeout(function(){a.Konva["_"+Wt+"InDblClickWindow"]=!1},a.Konva.dblClickWindow),T&&T.isListening()?(_e=!0,this[Wt+"ClickEndShape"]=T,T._fireAndBubble(Ft.pointerup,{...D}),a.Konva["_"+Wt+"ListenClick"]&&ve&&ve===T&&(T._fireAndBubble(Ft.pointerclick,{...D}),H&&ie&&ie===T&&T._fireAndBubble(Ft.pointerdblclick,{...D}))):(this[Wt+"ClickEndShape"]=null,a.Konva["_"+Wt+"ListenClick"]&&this._fire(Ft.pointerclick,{evt:lt,target:this,currentTarget:this,pointerId:R}),H&&this._fire(Ft.pointerdblclick,{evt:lt,target:this,currentTarget:this,pointerId:R}))}),_e||this._fire(Ft.pointerup,{evt:lt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a.Konva["_"+Wt+"ListenClick"]=!1,lt.cancelable&&Wt!=="touch"&&lt.preventDefault()}_contextmenu(lt){this.setPointersPositions(lt);var Ft=this.getIntersection(this.getPointerPosition());Ft&&Ft.isListening()?Ft._fireAndBubble(wt,{evt:lt}):this._fire(wt,{evt:lt,target:this,currentTarget:this})}_wheel(lt){this.setPointersPositions(lt);var Ft=this.getIntersection(this.getPointerPosition());Ft&&Ft.isListening()?Ft._fireAndBubble(ct,{evt:lt}):this._fire(ct,{evt:lt,target:this,currentTarget:this})}_pointercancel(lt){this.setPointersPositions(lt);const Ft=d.getCapturedShape(lt.pointerId)||this.getIntersection(this.getPointerPosition());Ft&&Ft._fireAndBubble(E,d.createEvent(lt)),d.releaseCapture(lt.pointerId)}_lostpointercapture(lt){d.releaseCapture(lt.pointerId)}setPointersPositions(lt){var Ft=this._getContentPosition(),Wt=null,ve=null;lt=lt||window.event,lt.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(lt.touches,ie=>{this._pointerPositions.push({id:ie.identifier,x:(ie.clientX-Ft.left)/Ft.scaleX,y:(ie.clientY-Ft.top)/Ft.scaleY})}),Array.prototype.forEach.call(lt.changedTouches||lt.touches,ie=>{this._changedPointerPositions.push({id:ie.identifier,x:(ie.clientX-Ft.left)/Ft.scaleX,y:(ie.clientY-Ft.top)/Ft.scaleY})})):(Wt=(lt.clientX-Ft.left)/Ft.scaleX,ve=(lt.clientY-Ft.top)/Ft.scaleY,this.pointerPos={x:Wt,y:ve},this._pointerPositions=[{x:Wt,y:ve,id:t.Util._getFirstPointerId(lt)}],this._changedPointerPositions=[{x:Wt,y:ve,id:t.Util._getFirstPointerId(lt)}])}_setPointerPosition(lt){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(lt)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var lt=this.content.getBoundingClientRect();return{top:lt.top,left:lt.left,scaleX:lt.width/this.content.clientWidth||1,scaleY:lt.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!a.Konva.isBrowser){var lt=this.container();if(!lt)throw"Stage has no container. A container is required.";lt.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),lt.appendChild(this.content),this._resizeDOM()}}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(lt){lt.batchDraw()}),this}}r.Stage=Ve,Ve.prototype.nodeType=f,(0,u._registerNode)(Ve),s.Factory.addGetterSetter(Ve,"container")}(mp);var vo={},pr={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Shape=r.shapes=void 0;const t=si,s=Qi,n=ai,a=Wi,o=De,c=si,u=an;var d="hasShadow",f="shadowRGBA",m="patternImage",S="linearGradient",_="radialGradient";let v;function b(){return v||(v=s.Util.createCanvasElement().getContext("2d"),v)}r.shapes={};function x(rt){const tt=this.attrs.fillRule;tt?rt.fill(tt):rt.fill()}function A(rt){rt.stroke()}function F(rt){rt.fill()}function M(rt){rt.stroke()}function g(){this._clearCache(d)}function w(){this._clearCache(f)}function E(){this._clearCache(m)}function C(){this._clearCache(S)}function B(){this._clearCache(_)}class I extends a.Node{constructor(tt){super(tt);let st;for(;st=s.Util.getRandomColor(),!(st&&!(st in r.shapes)););this.colorKey=st,r.shapes[st]=this}getContext(){return s.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return s.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(d,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(m,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var tt=b();const st=tt.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(st&&st.setTransform){const wt=new s.Transform;wt.translate(this.fillPatternX(),this.fillPatternY()),wt.rotate(t.Konva.getAngle(this.fillPatternRotation())),wt.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),wt.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const dt=wt.getMatrix(),Tt=typeof DOMMatrix>"u"?{a:dt[0],b:dt[1],c:dt[2],d:dt[3],e:dt[4],f:dt[5]}:new DOMMatrix(dt);st.setTransform(Tt)}return st}}_getLinearGradient(){return this._getCache(S,this.__getLinearGradient)}__getLinearGradient(){var tt=this.fillLinearGradientColorStops();if(tt){for(var st=b(),wt=this.fillLinearGradientStartPoint(),dt=this.fillLinearGradientEndPoint(),Tt=st.createLinearGradient(wt.x,wt.y,dt.x,dt.y),Lt=0;Lt<tt.length;Lt+=2)Tt.addColorStop(tt[Lt],tt[Lt+1]);return Tt}}_getRadialGradient(){return this._getCache(_,this.__getRadialGradient)}__getRadialGradient(){var tt=this.fillRadialGradientColorStops();if(tt){for(var st=b(),wt=this.fillRadialGradientStartPoint(),dt=this.fillRadialGradientEndPoint(),Tt=st.createRadialGradient(wt.x,wt.y,this.fillRadialGradientStartRadius(),dt.x,dt.y,this.fillRadialGradientEndRadius()),Lt=0;Lt<tt.length;Lt+=2)Tt.addColorStop(tt[Lt],tt[Lt+1]);return Tt}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var tt=s.Util.colorToRGBA(this.shadowColor());if(tt)return"rgba("+tt.r+","+tt.g+","+tt.b+","+tt.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const tt=this.hitStrokeWidth();return tt==="auto"?this.hasStroke():this.strokeEnabled()&&!!tt}intersects(tt){var st=this.getStage();if(!st)return!1;const wt=st.bufferHitCanvas;return wt.getContext().clear(),this.drawHit(wt,void 0,!0),wt.context.getImageData(Math.round(tt.x),Math.round(tt.y),1,1).data[3]>0}destroy(){return a.Node.prototype.destroy.call(this),delete r.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(tt){var st;if(!(!((st=this.attrs.perfectDrawEnabled)!==null&&st!==void 0)||st))return!1;const wt=tt||this.hasFill(),dt=this.hasStroke(),Tt=this.getAbsoluteOpacity()!==1;if(wt&&dt&&Tt)return!0;const Lt=this.hasShadow(),Qt=this.shadowForStrokeEnabled();return!!(wt&&dt&&Lt&&Qt)}setStrokeHitEnabled(tt){s.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),tt?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var tt=this.size();return{x:this._centroid?-tt.width/2:0,y:this._centroid?-tt.height/2:0,width:tt.width,height:tt.height}}getClientRect(tt={}){const st=tt.skipTransform,wt=tt.relativeTo,dt=this.getSelfRect(),Tt=!tt.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Lt=dt.width+Tt,Qt=dt.height+Tt,ct=!tt.skipShadow&&this.hasShadow(),Dt=ct?this.shadowOffsetX():0,ee=ct?this.shadowOffsetY():0,zt=Lt+Math.abs(Dt),Jt=Qt+Math.abs(ee),oe=ct&&this.shadowBlur()||0,ge=zt+oe*2,Ae=Jt+oe*2,Ve={width:ge,height:Ae,x:-(Tt/2+oe)+Math.min(Dt,0)+dt.x,y:-(Tt/2+oe)+Math.min(ee,0)+dt.y};return st?Ve:this._transformedRect(Ve,wt)}drawScene(tt,st,wt){var dt=this.getLayer(),Tt=tt||dt.getCanvas(),Lt=Tt.getContext(),Qt=this._getCanvasCache(),ct=this.getSceneFunc(),Dt=this.hasShadow(),ee,zt,Jt=Tt.isCache,oe=st===this;if(!this.isVisible()&&!oe)return this;if(Qt){Lt.save();var ge=this.getAbsoluteTransform(st).getMatrix();return Lt.transform(ge[0],ge[1],ge[2],ge[3],ge[4],ge[5]),this._drawCachedSceneCanvas(Lt),Lt.restore(),this}if(!ct)return this;if(Lt.save(),this._useBufferCanvas()&&!Jt){ee=this.getStage();const Gt=wt||ee.bufferCanvas;zt=Gt.getContext(),zt.clear(),zt.save(),zt._applyLineJoin(this);var Ae=this.getAbsoluteTransform(st).getMatrix();zt.transform(Ae[0],Ae[1],Ae[2],Ae[3],Ae[4],Ae[5]),ct.call(this,zt,this),zt.restore();var Ve=Gt.pixelRatio;Dt&&Lt._applyShadow(this),Lt._applyOpacity(this),Lt._applyGlobalCompositeOperation(this),Lt.drawImage(Gt._canvas,0,0,Gt.width/Ve,Gt.height/Ve)}else{if(Lt._applyLineJoin(this),!oe){var Ae=this.getAbsoluteTransform(st).getMatrix();Lt.transform(Ae[0],Ae[1],Ae[2],Ae[3],Ae[4],Ae[5]),Lt._applyOpacity(this),Lt._applyGlobalCompositeOperation(this)}Dt&&Lt._applyShadow(this),ct.call(this,Lt,this)}return Lt.restore(),this}drawHit(tt,st,wt=!1){if(!this.shouldDrawHit(st,wt))return this;var dt=this.getLayer(),Tt=tt||dt.hitCanvas,Lt=Tt&&Tt.getContext(),Qt=this.hitFunc()||this.sceneFunc(),ct=this._getCanvasCache(),Dt=ct&&ct.hit;if(this.colorKey||s.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Dt){Lt.save();var ee=this.getAbsoluteTransform(st).getMatrix();return Lt.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),this._drawCachedHitCanvas(Lt),Lt.restore(),this}if(!Qt)return this;if(Lt.save(),Lt._applyLineJoin(this),this!==st){var zt=this.getAbsoluteTransform(st).getMatrix();Lt.transform(zt[0],zt[1],zt[2],zt[3],zt[4],zt[5])}return Qt.call(this,Lt,this),Lt.restore(),this}drawHitFromCache(tt=0){var st=this._getCanvasCache(),wt=this._getCachedSceneCanvas(),dt=st.hit,Tt=dt.getContext(),Lt=dt.getWidth(),Qt=dt.getHeight(),ct,Dt,ee,zt,Jt,oe;Tt.clear(),Tt.drawImage(wt._canvas,0,0,Lt,Qt);try{for(ct=Tt.getImageData(0,0,Lt,Qt),Dt=ct.data,ee=Dt.length,zt=s.Util._hexToRgb(this.colorKey),Jt=0;Jt<ee;Jt+=4)oe=Dt[Jt+3],oe>tt?(Dt[Jt]=zt.r,Dt[Jt+1]=zt.g,Dt[Jt+2]=zt.b,Dt[Jt+3]=255):Dt[Jt+3]=0;Tt.putImageData(ct,0,0)}catch(ge){s.Util.error("Unable to draw hit graph from cached scene canvas. "+ge.message)}return this}hasPointerCapture(tt){return u.hasPointerCapture(tt,this)}setPointerCapture(tt){u.setPointerCapture(tt,this)}releaseCapture(tt){u.releaseCapture(tt,this)}}r.Shape=I,I.prototype._fillFunc=x,I.prototype._strokeFunc=A,I.prototype._fillFuncHit=F,I.prototype._strokeFuncHit=M,I.prototype._centroid=!1,I.prototype.nodeType="Shape",(0,c._registerNode)(I),I.prototype.eventListeners={},I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",g),I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",C),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",B),n.Factory.addGetterSetter(I,"stroke",void 0,(0,o.getStringOrGradientValidator)()),n.Factory.addGetterSetter(I,"strokeWidth",2,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(I,"hitStrokeWidth","auto",(0,o.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(I,"strokeHitEnabled",!0,(0,o.getBooleanValidator)()),n.Factory.addGetterSetter(I,"perfectDrawEnabled",!0,(0,o.getBooleanValidator)()),n.Factory.addGetterSetter(I,"shadowForStrokeEnabled",!0,(0,o.getBooleanValidator)()),n.Factory.addGetterSetter(I,"lineJoin"),n.Factory.addGetterSetter(I,"lineCap"),n.Factory.addGetterSetter(I,"sceneFunc"),n.Factory.addGetterSetter(I,"hitFunc"),n.Factory.addGetterSetter(I,"dash"),n.Factory.addGetterSetter(I,"dashOffset",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"shadowColor",void 0,(0,o.getStringValidator)()),n.Factory.addGetterSetter(I,"shadowBlur",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"shadowOpacity",1,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(I,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(I,"shadowOffsetX",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"shadowOffsetY",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternImage"),n.Factory.addGetterSetter(I,"fill",void 0,(0,o.getStringOrGradientValidator)()),n.Factory.addGetterSetter(I,"fillPatternX",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternY",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(I,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(I,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(I,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(I,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(I,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(I,"fillEnabled",!0),n.Factory.addGetterSetter(I,"strokeEnabled",!0),n.Factory.addGetterSetter(I,"shadowEnabled",!0),n.Factory.addGetterSetter(I,"dashEnabled",!0),n.Factory.addGetterSetter(I,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(I,"fillPriority","color"),n.Factory.addComponentsGetterSetter(I,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(I,"fillPatternOffsetX",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternOffsetY",0,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(I,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(I,"fillPatternScaleX",1,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternScaleY",1,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(I,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(I,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(I,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(I,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(I,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(I,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(I,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(I,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(I,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(I,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(I,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(I,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(I,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(I,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(I,"fillPatternRotation",0),n.Factory.addGetterSetter(I,"fillRule",void 0,(0,o.getStringValidator)()),n.Factory.backCompat(I,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(pr),Object.defineProperty(vo,"__esModule",{value:!0}),vo.Layer=void 0;const ls=Qi,zc=Js,Pa=Wi,Hc=ai,bp=En,Iy=De,Ly=pr,Dy=si;var Ny="#",Oy="beforeDraw",zy="draw",_p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Hy=_p.length;let Ma=class extends zc.Container{constructor(r){super(r),this.canvas=new bp.SceneCanvas,this.hitCanvas=new bp.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(r){return this.getContext().clear(r),this.getHitCanvas().getContext().clear(r),this}setZIndex(r){super.setZIndex(r);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),r<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[r+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Pa.Node.prototype.moveToTop.call(this);var r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),r.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var r=Pa.Node.prototype.moveUp.call(this);if(!r)return!1;var t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Pa.Node.prototype.moveDown.call(this)){var r=this.getStage();if(r){var t=r.children;r.content&&(r.content.removeChild(this.getNativeCanvasElement()),r.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Pa.Node.prototype.moveToBottom.call(this)){var r=this.getStage();if(r){var t=r.children;r.content&&(r.content.removeChild(this.getNativeCanvasElement()),r.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var r=this.getNativeCanvasElement();return Pa.Node.prototype.remove.call(this),r&&r.parentNode&&ls.Util._isInDocument(r)&&r.parentNode.removeChild(r),this}getStage(){return this.parent}setSize({width:r,height:t}){return this.canvas.setSize(r,t),this.hitCanvas.setSize(r,t),this._setSmoothEnabled(),this}_validateAdd(r){var t=r.getType();t!=="Group"&&t!=="Shape"&&ls.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(r){return r=r||{},r.width=r.width||this.getWidth(),r.height=r.height||this.getHeight(),r.x=r.x!==void 0?r.x:this.x(),r.y=r.y!==void 0?r.y:this.y(),Pa.Node.prototype._toKonvaCanvas.call(this,r)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){ls.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){ls.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,ls.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(r){if(!this.isListening()||!this.isVisible())return null;for(var t=1,s=!1;;){for(let n=0;n<Hy;n++){const a=_p[n],o=this._getIntersection({x:r.x+a.x*t,y:r.y+a.y*t}),c=o.shape;if(c)return c;if(s=!!o.antialiased,!o.antialiased)break}if(s)t+=1;else return null}}_getIntersection(r){const t=this.hitCanvas.pixelRatio,s=this.hitCanvas.context.getImageData(Math.round(r.x*t),Math.round(r.y*t),1,1).data,n=s[3];if(n===255){const a=ls.Util._rgbToHex(s[0],s[1],s[2]),o=Ly.shapes[Ny+a];return o?{shape:o}:{antialiased:!0}}else if(n>0)return{antialiased:!0};return{}}drawScene(r,t){var s=this.getLayer(),n=r||s&&s.getCanvas();return this._fire(Oy,{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),zc.Container.prototype.drawScene.call(this,n,t),this._fire(zy,{node:this}),this}drawHit(r,t){var s=this.getLayer(),n=r||s&&s.hitCanvas;return s&&s.clearBeforeDraw()&&s.getHitCanvas().getContext().clear(),zc.Container.prototype.drawHit.call(this,n,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(r){ls.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(r)}getHitGraphEnabled(r){return ls.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var r=this.parent,t=!!this.hitCanvas._canvas.parentNode;t?r.content.removeChild(this.hitCanvas._canvas):r.content.appendChild(this.hitCanvas._canvas)}}destroy(){return ls.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};vo.Layer=Ma,Ma.prototype.nodeType="Layer",(0,Dy._registerNode)(Ma),Hc.Factory.addGetterSetter(Ma,"imageSmoothingEnabled",!0),Hc.Factory.addGetterSetter(Ma,"clearBeforeDraw",!0),Hc.Factory.addGetterSetter(Ma,"hitGraphEnabled",!0,(0,Iy.getBooleanValidator)());var _l={};Object.defineProperty(_l,"__esModule",{value:!0}),_l.FastLayer=void 0;const By=Qi,Uy=vo,Gy=si;class Bc extends Uy.Layer{constructor(t){super(t),this.listening(!1),By.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}_l.FastLayer=Bc,Bc.prototype.nodeType="FastLayer",(0,Gy._registerNode)(Bc);var Ra={};Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.Group=void 0;const jy=Qi,Vy=Js,Wy=si;class Uc extends Vy.Container{_validateAdd(t){var s=t.getType();s!=="Group"&&s!=="Shape"&&jy.Util.throw("You may only add groups and shapes to groups.")}}Ra.Group=Uc,Uc.prototype.nodeType="Group",(0,Wy._registerNode)(Uc);var Fa={};Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.Animation=void 0;const Gc=si,xp=Qi,jc=function(){return Gc.glob.performance&&Gc.glob.performance.now?function(){return Gc.glob.performance.now()}:function(){return new Date().getTime()}}();class jn{constructor(t,s){this.id=jn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:jc(),frameRate:0},this.func=t,this.setLayers(s)}setLayers(t){let s=[];return t&&(s=Array.isArray(t)?t:[t]),this.layers=s,this}getLayers(){return this.layers}addLayer(t){const s=this.layers,n=s.length;for(let a=0;a<n;a++)if(s[a]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const t=jn.animations,s=t.length;for(let n=0;n<s;n++)if(t[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=jc(),jn._addAnimation(this),this}stop(){return jn._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const s=t.id,n=this.animations,a=n.length;for(let o=0;o<a;o++)if(n[o].id===s){this.animations.splice(o,1);break}}static _runFrames(){const t={},s=this.animations;for(let n=0;n<s.length;n++){const a=s[n],o=a.layers,c=a.func;a._updateFrameObject(jc());const u=o.length;let d;if(c?d=c.call(a,a.frame)!==!1:d=!0,!!d)for(let f=0;f<u;f++){const m=o[f];m._id!==void 0&&(t[m._id]=m)}}for(let n in t)!t.hasOwnProperty(n)||t[n].batchDraw()}static _animationLoop(){const t=jn;t.animations.length?(t._runFrames(),xp.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,xp.Util.requestAnimFrame(this._animationLoop))}}Fa.Animation=jn,jn.animations=[],jn.animIdCounter=0,jn.animRunning=!1;var wp={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Easings=r.Tween=void 0;const t=Qi,s=Fa,n=Wi,a=si;var o={node:1,duration:1,easing:1,onFinish:1,yoyo:1},c=1,u=2,d=3,f=0,m=["fill","stroke","shadowColor"];class S{constructor(b,x,A,F,M,g,w){this.prop=b,this.propFunc=x,this.begin=F,this._pos=F,this.duration=g,this._change=0,this.prevPos=0,this.yoyo=w,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=A,this._change=M-this.begin,this.pause()}fire(b){var x=this[b];x&&x()}setTime(b){b>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():b<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=b,this.update())}getTime(){return this._time}setPosition(b){this.prevPos=this._pos,this.propFunc(b),this._pos=b}getPosition(b){return b===void 0&&(b=this._time),this.func(b,this.begin,this._change,this.duration)}play(){this.state=u,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=d,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(b){this.pause(),this._time=b,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var b=this.getTimer()-this._startTime;this.state===u?this.setTime(b):this.state===d&&this.setTime(this.duration-b)}pause(){this.state=c,this.fire("onPause")}getTimer(){return new Date().getTime()}}class _{constructor(b){var x=this,A=b.node,F=A._id,M,g=b.easing||r.Easings.Linear,w=!!b.yoyo,E;typeof b.duration>"u"?M=.3:b.duration===0?M=.001:M=b.duration,this.node=A,this._id=f++;var C=A.getLayer()||(A instanceof a.Konva.Stage?A.getLayers():null);C||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new s.Animation(function(){x.tween.onEnterFrame()},C),this.tween=new S(E,function(B){x._tweenFunc(B)},g,0,1,M*1e3,w),this._addListeners(),_.attrs[F]||(_.attrs[F]={}),_.attrs[F][this._id]||(_.attrs[F][this._id]={}),_.tweens[F]||(_.tweens[F]={});for(E in b)o[E]===void 0&&this._addAttr(E,b[E]);this.reset(),this.onFinish=b.onFinish,this.onReset=b.onReset,this.onUpdate=b.onUpdate}_addAttr(b,x){var A=this.node,F=A._id,M,g,w,E,C,B,I,rt;if(w=_.tweens[F][b],w&&delete _.attrs[F][w][b],M=A.getAttr(b),t.Util._isArray(x))if(g=[],C=Math.max(x.length,M.length),b==="points"&&x.length!==M.length&&(x.length>M.length?(I=M,M=t.Util._prepareArrayForTween(M,x,A.closed())):(B=x,x=t.Util._prepareArrayForTween(x,M,A.closed()))),b.indexOf("fill")===0)for(E=0;E<C;E++)if(E%2===0)g.push(x[E]-M[E]);else{var tt=t.Util.colorToRGBA(M[E]);rt=t.Util.colorToRGBA(x[E]),M[E]=tt,g.push({r:rt.r-tt.r,g:rt.g-tt.g,b:rt.b-tt.b,a:rt.a-tt.a})}else for(E=0;E<C;E++)g.push(x[E]-M[E]);else m.indexOf(b)!==-1?(M=t.Util.colorToRGBA(M),rt=t.Util.colorToRGBA(x),g={r:rt.r-M.r,g:rt.g-M.g,b:rt.b-M.b,a:rt.a-M.a}):g=x-M;_.attrs[F][this._id][b]={start:M,diff:g,end:x,trueEnd:B,trueStart:I},_.tweens[F][b]=this._id}_tweenFunc(b){var x=this.node,A=_.attrs[x._id][this._id],F,M,g,w,E,C,B,I;for(F in A){if(M=A[F],g=M.start,w=M.diff,I=M.end,t.Util._isArray(g))if(E=[],B=Math.max(g.length,I.length),F.indexOf("fill")===0)for(C=0;C<B;C++)C%2===0?E.push((g[C]||0)+w[C]*b):E.push("rgba("+Math.round(g[C].r+w[C].r*b)+","+Math.round(g[C].g+w[C].g*b)+","+Math.round(g[C].b+w[C].b*b)+","+(g[C].a+w[C].a*b)+")");else for(C=0;C<B;C++)E.push((g[C]||0)+w[C]*b);else m.indexOf(F)!==-1?E="rgba("+Math.round(g.r+w.r*b)+","+Math.round(g.g+w.g*b)+","+Math.round(g.b+w.b*b)+","+(g.a+w.a*b)+")":E=g+w*b;x.setAttr(F,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var b=this.node,x=_.attrs[b._id][this._id];x.points&&x.points.trueEnd&&b.setAttr("points",x.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var b=this.node,x=_.attrs[b._id][this._id];x.points&&x.points.trueStart&&b.points(x.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(b){return this.tween.seek(b*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var b=this.node._id,x=this._id,A=_.tweens[b],F;this.pause();for(F in A)delete _.tweens[b][F];delete _.attrs[b][x]}}r.Tween=_,_.attrs={},_.tweens={},n.Node.prototype.to=function(v){var b=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),b&&b()};var x=new _(v);x.play()},r.Easings={BackEaseIn(v,b,x,A){var F=1.70158;return x*(v/=A)*v*((F+1)*v-F)+b},BackEaseOut(v,b,x,A){var F=1.70158;return x*((v=v/A-1)*v*((F+1)*v+F)+1)+b},BackEaseInOut(v,b,x,A){var F=1.70158;return(v/=A/2)<1?x/2*(v*v*(((F*=1.525)+1)*v-F))+b:x/2*((v-=2)*v*(((F*=1.525)+1)*v+F)+2)+b},ElasticEaseIn(v,b,x,A,F,M){var g=0;return v===0?b:(v/=A)===1?b+x:(M||(M=A*.3),!F||F<Math.abs(x)?(F=x,g=M/4):g=M/(2*Math.PI)*Math.asin(x/F),-(F*Math.pow(2,10*(v-=1))*Math.sin((v*A-g)*(2*Math.PI)/M))+b)},ElasticEaseOut(v,b,x,A,F,M){var g=0;return v===0?b:(v/=A)===1?b+x:(M||(M=A*.3),!F||F<Math.abs(x)?(F=x,g=M/4):g=M/(2*Math.PI)*Math.asin(x/F),F*Math.pow(2,-10*v)*Math.sin((v*A-g)*(2*Math.PI)/M)+x+b)},ElasticEaseInOut(v,b,x,A,F,M){var g=0;return v===0?b:(v/=A/2)===2?b+x:(M||(M=A*(.3*1.5)),!F||F<Math.abs(x)?(F=x,g=M/4):g=M/(2*Math.PI)*Math.asin(x/F),v<1?-.5*(F*Math.pow(2,10*(v-=1))*Math.sin((v*A-g)*(2*Math.PI)/M))+b:F*Math.pow(2,-10*(v-=1))*Math.sin((v*A-g)*(2*Math.PI)/M)*.5+x+b)},BounceEaseOut(v,b,x,A){return(v/=A)<1/2.75?x*(7.5625*v*v)+b:v<2/2.75?x*(7.5625*(v-=1.5/2.75)*v+.75)+b:v<2.5/2.75?x*(7.5625*(v-=2.25/2.75)*v+.9375)+b:x*(7.5625*(v-=2.625/2.75)*v+.984375)+b},BounceEaseIn(v,b,x,A){return x-r.Easings.BounceEaseOut(A-v,0,x,A)+b},BounceEaseInOut(v,b,x,A){return v<A/2?r.Easings.BounceEaseIn(v*2,0,x,A)*.5+b:r.Easings.BounceEaseOut(v*2-A,0,x,A)*.5+x*.5+b},EaseIn(v,b,x,A){return x*(v/=A)*v+b},EaseOut(v,b,x,A){return-x*(v/=A)*(v-2)+b},EaseInOut(v,b,x,A){return(v/=A/2)<1?x/2*v*v+b:-x/2*(--v*(v-2)-1)+b},StrongEaseIn(v,b,x,A){return x*(v/=A)*v*v*v*v+b},StrongEaseOut(v,b,x,A){return x*((v=v/A-1)*v*v*v*v+1)+b},StrongEaseInOut(v,b,x,A){return(v/=A/2)<1?x/2*v*v*v*v*v+b:x/2*((v-=2)*v*v*v*v+2)+b},Linear(v,b,x,A){return x*v/A+b}}})(wp),function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Konva=void 0;const t=si,s=Qi,n=Wi,a=Js,o=mp,c=vo,u=_l,d=Ra,f=gl,m=pr,S=Fa,_=wp,v=as,b=En;r.Konva=s.Util._assign(t.Konva,{Util:s.Util,Transform:s.Transform,Node:n.Node,Container:a.Container,Stage:o.Stage,stages:o.stages,Layer:c.Layer,FastLayer:u.FastLayer,Group:d.Group,DD:f.DD,Shape:m.Shape,shapes:m.shapes,Animation:S.Animation,Tween:_.Tween,Easings:_.Easings,Context:v.Context,Canvas:b.Canvas}),r.default=r.Konva}(cl);var xl={};Object.defineProperty(xl,"__esModule",{value:!0}),xl.Arc=void 0;const wl=ai,$y=pr,Ap=si,Al=De,Ky=si;class hs extends $y.Shape{_sceneFunc(t){var s=Ap.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,s,n),t.arc(0,0,this.innerRadius(),s,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),s=this.outerRadius(),n=this.clockwise(),a=Ap.Konva.getAngle(n?360-this.angle():this.angle()),o=Math.cos(Math.min(a,Math.PI)),c=1,u=Math.sin(Math.min(Math.max(Math.PI,a),3*Math.PI/2)),d=Math.sin(Math.min(a,Math.PI/2)),f=o*(o>0?t:s),m=c*s,S=u*(u>0?t:s),_=d*(d>0?s:t);return{x:f,y:n?-1*_:S,width:m-f,height:_-S}}}xl.Arc=hs,hs.prototype._centroid=!0,hs.prototype.className="Arc",hs.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,Ky._registerNode)(hs),wl.Factory.addGetterSetter(hs,"innerRadius",0,(0,Al.getNumberValidator)()),wl.Factory.addGetterSetter(hs,"outerRadius",0,(0,Al.getNumberValidator)()),wl.Factory.addGetterSetter(hs,"angle",0,(0,Al.getNumberValidator)()),wl.Factory.addGetterSetter(hs,"clockwise",!1,(0,Al.getBooleanValidator)());var Sl={},yo={};Object.defineProperty(yo,"__esModule",{value:!0}),yo.Line=void 0;const El=ai,Xy=pr,Sp=De,Yy=si;function Vc(r,t,s,n,a,o,c){var u=Math.sqrt(Math.pow(s-r,2)+Math.pow(n-t,2)),d=Math.sqrt(Math.pow(a-s,2)+Math.pow(o-n,2)),f=c*u/(u+d),m=c*d/(u+d),S=s-f*(a-r),_=n-f*(o-t),v=s+m*(a-r),b=n+m*(o-t);return[S,_,v,b]}function Ep(r,t){var s=r.length,n=[],a,o;for(a=2;a<s-2;a+=2)o=Vc(r[a-2],r[a-1],r[a],r[a+1],r[a+2],r[a+3],t),!isNaN(o[0])&&(n.push(o[0]),n.push(o[1]),n.push(r[a]),n.push(r[a+1]),n.push(o[2]),n.push(o[3]));return n}class Ms extends Xy.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){var s=this.points(),n=s.length,a=this.tension(),o=this.closed(),c=this.bezier(),u,d,f;if(n){if(t.beginPath(),t.moveTo(s[0],s[1]),a!==0&&n>4){for(u=this.getTensionPoints(),d=u.length,f=o?0:4,o||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);f<d-2;)t.bezierCurveTo(u[f++],u[f++],u[f++],u[f++],u[f++],u[f++]);o||t.quadraticCurveTo(u[d-2],u[d-1],s[n-2],s[n-1])}else if(c)for(f=2;f<n;)t.bezierCurveTo(s[f++],s[f++],s[f++],s[f++],s[f++],s[f++]);else for(f=2;f<n;f+=2)t.lineTo(s[f],s[f+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Ep(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),s=t.length,n=this.tension(),a=Vc(t[s-2],t[s-1],t[0],t[1],t[2],t[3],n),o=Vc(t[s-4],t[s-3],t[s-2],t[s-1],t[0],t[1],n),c=Ep(t,n),u=[a[2],a[3]].concat(c).concat([o[0],o[1],t[s-2],t[s-1],o[2],o[3],a[0],a[1],t[0],t[1]]);return u}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();for(var s=t[0],n=t[0],a=t[1],o=t[1],c,u,d=0;d<t.length/2;d++)c=t[d*2],u=t[d*2+1],s=Math.min(s,c),n=Math.max(n,c),a=Math.min(a,u),o=Math.max(o,u);return{x:s,y:a,width:n-s,height:o-a}}}yo.Line=Ms,Ms.prototype.className="Line",Ms.prototype._attrsAffectingSize=["points","bezier","tension"],(0,Yy._registerNode)(Ms),El.Factory.addGetterSetter(Ms,"closed",!1),El.Factory.addGetterSetter(Ms,"bezier",!1),El.Factory.addGetterSetter(Ms,"tension",0,(0,Sp.getNumberValidator)()),El.Factory.addGetterSetter(Ms,"points",[],(0,Sp.getNumberArrayValidator)());var Ia={},Cp={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.t2length=r.getQuadraticArcLength=r.getCubicArcLength=r.binomialCoefficients=r.cValues=r.tValues=void 0,r.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427584,.9491079123427584],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975364,.9602898564975364],[0,-.8360311073266358,.8360311073266358,-.968160239507626,.968160239507626,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171716,.9739065285171716],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704748,.9041172563704748,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.917598399222978,.917598399222978,-.984183054718588,.984183054718588],[-.10805494870734368,.10805494870734368,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635736,.9284348836635736,-.9862838086968124,.9862838086968124],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.98940093499165,.98940093499165],[0,-.17848418149584783,.17848418149584783,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713976,.9558239495713976,-.9915651684209308,.9915651684209308],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.903155903614818,.903155903614818,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.3737060887154195,.3737060887154195,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850948,.9931285991850948],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663064,.9672268385663064,-.9937521706203896,.9937521706203896],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354288,.9700604978354288,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.932971086826016,.932971086826016,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713096,.9747285559713096,-.9951872199970212,.9951872199970212]],r.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773423,.18629021092773423,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531844,.10693932599531844,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772844,.09212149983772844,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793785,.18553839747793785,.15720316715819355,.15720316715819355,.1215185706879032,.1215185706879032,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.1984314853271116,.1984314853271116,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.1826034150449236,.1826034150449236,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.0951585116824928,.0951585116824928,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340395,.11188384719340395,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065063,.14064291467065063,.12255520671147846,.12255520671147846,.10094204410628715,.10094204410628715,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.1287539625393362,.1287539625393362,.111566645547334,.111566645547334,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.01946178822972648,.01946178822972648],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.1181945319615184,.1181945319615184,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.1460811336496904,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372852,.12183141605372852,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.1336545721861062,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672952,.12304908430672952,.11499664022241136,.11499664022241136,.1048920914645414,.1048920914645414,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.1216704729278034,.1216704729278034,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(c,u,d)=>{let f,m,S;f=d/2,m=0;for(let _=0;_<20;_++)S=f*r.tValues[20][_]+f,m+=r.cValues[20][_]*n(c,u,S);return f*m};r.getCubicArcLength=t;const s=(c,u,d)=>{d===void 0&&(d=1);const f=c[0]-2*c[1]+c[2],m=u[0]-2*u[1]+u[2],S=2*c[1]-2*c[0],_=2*u[1]-2*u[0],v=4*(f*f+m*m),b=4*(f*S+m*_),x=S*S+_*_;if(v===0)return d*Math.sqrt(Math.pow(c[2]-c[0],2)+Math.pow(u[2]-u[0],2));const A=b/(2*v),F=x/v,M=d+A,g=F-A*A,w=M*M+g>0?Math.sqrt(M*M+g):0,E=A*A+g>0?Math.sqrt(A*A+g):0,C=A+Math.sqrt(A*A+g)!==0?g*Math.log(Math.abs((M+w)/(A+E))):0;return Math.sqrt(v)/2*(M*w-A*E+C)};r.getQuadraticArcLength=s;function n(c,u,d){const f=a(1,d,c),m=a(1,d,u),S=f*f+m*m;return Math.sqrt(S)}const a=(c,u,d)=>{const f=d.length-1;let m,S;if(f===0)return 0;if(c===0){S=0;for(let _=0;_<=f;_++)S+=r.binomialCoefficients[f][_]*Math.pow(1-u,f-_)*Math.pow(u,_)*d[_];return S}else{m=new Array(f);for(let _=0;_<f;_++)m[_]=f*(d[_+1]-d[_]);return a(c-1,u,m)}},o=(c,u,d)=>{let f=1,m=c/u,S=(c-d(m))/u,_=0;for(;f>.001;){const v=d(m+S),b=Math.abs(c-v)/u;if(b<f)f=b,m+=S;else{const x=d(m-S),A=Math.abs(c-x)/u;A<f?(f=A,m-=S):S/=2}if(_++,_>500)break}return m};r.t2length=o})(Cp),Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.Path=void 0;const qy=ai,Qy=pr,Zy=si,La=Cp;class gr extends Qy.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=gr.parsePathData(this.data()),this.pathLength=gr.getPathLength(this.dataArray)}_sceneFunc(t){var s=this.dataArray;t.beginPath();for(var n=!1,a=0;a<s.length;a++){var o=s[a].command,c=s[a].points;switch(o){case"L":t.lineTo(c[0],c[1]);break;case"M":t.moveTo(c[0],c[1]);break;case"C":t.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":t.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":var u=c[0],d=c[1],f=c[2],m=c[3],S=c[4],_=c[5],v=c[6],b=c[7],x=f>m?f:m,A=f>m?1:f/m,F=f>m?m/f:1;t.translate(u,d),t.rotate(v),t.scale(A,F),t.arc(0,0,x,S,S+_,1-b),t.scale(1/A,1/F),t.rotate(-v),t.translate(-u,-d);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach(function(f){if(f.command==="A"){var m=f.points[4],S=f.points[5],_=f.points[4]+S,v=Math.PI/180;if(Math.abs(m-_)<v&&(v=Math.abs(m-_)),S<0)for(let b=m-v;b>_;b-=v){const x=gr.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],b,0);t.push(x.x,x.y)}else for(let b=m+v;b<_;b+=v){const x=gr.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],b,0);t.push(x.x,x.y)}}else if(f.command==="C")for(let b=0;b<=1;b+=.01){const x=gr.getPointOnCubicBezier(b,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3],f.points[4],f.points[5]);t.push(x.x,x.y)}else t=t.concat(f.points)});for(var s=t[0],n=t[0],a=t[1],o=t[1],c,u,d=0;d<t.length/2;d++)c=t[d*2],u=t[d*2+1],isNaN(c)||(s=Math.min(s,c),n=Math.max(n,c)),isNaN(u)||(a=Math.min(a,u),o=Math.max(o,u));return{x:s,y:a,width:n-s,height:o-a}}getLength(){return this.pathLength}getPointAtLength(t){return gr.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,s,n,a){return Math.sqrt((n-t)*(n-t)+(a-s)*(a-s))}static getPathLength(t){let s=0;for(var n=0;n<t.length;++n)s+=t[n].pathLength;return s}static getPointAtLengthOfDataArray(t,s){var n,a=0,o=s.length;if(!o)return null;for(;a<o&&t>s[a].pathLength;)t-=s[a].pathLength,++a;if(a===o)return n=s[a-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return n=s[a].points.slice(0,2),{x:n[0],y:n[1]};var c=s[a],u=c.points;switch(c.command){case"L":return gr.getPointOnLine(t,c.start.x,c.start.y,u[0],u[1]);case"C":return gr.getPointOnCubicBezier((0,La.t2length)(t,gr.getPathLength(s),x=>(0,La.getCubicArcLength)([c.start.x,u[0],u[2],u[4]],[c.start.y,u[1],u[3],u[5]],x)),c.start.x,c.start.y,u[0],u[1],u[2],u[3],u[4],u[5]);case"Q":return gr.getPointOnQuadraticBezier((0,La.t2length)(t,gr.getPathLength(s),x=>(0,La.getQuadraticArcLength)([c.start.x,u[0],u[2]],[c.start.y,u[1],u[3]],x)),c.start.x,c.start.y,u[0],u[1],u[2],u[3]);case"A":var d=u[0],f=u[1],m=u[2],S=u[3],_=u[4],v=u[5],b=u[6];return _+=v*t/c.pathLength,gr.getPointOnEllipticalArc(d,f,m,S,_,b)}return null}static getPointOnLine(t,s,n,a,o,c,u){c===void 0&&(c=s),u===void 0&&(u=n);var d=(o-n)/(a-s+1e-8),f=Math.sqrt(t*t/(1+d*d));a<s&&(f*=-1);var m=d*f,S;if(a===s)S={x:c,y:u+m};else if((u-n)/(c-s+1e-8)===d)S={x:c+f,y:u+m};else{var _,v,b=this.getLineLength(s,n,a,o),x=(c-s)*(a-s)+(u-n)*(o-n);x=x/(b*b),_=s+x*(a-s),v=n+x*(o-n);var A=this.getLineLength(c,u,_,v),F=Math.sqrt(t*t-A*A);f=Math.sqrt(F*F/(1+d*d)),a<s&&(f*=-1),m=d*f,S={x:_+f,y:v+m}}return S}static getPointOnCubicBezier(t,s,n,a,o,c,u,d,f){function m(A){return A*A*A}function S(A){return 3*A*A*(1-A)}function _(A){return 3*A*(1-A)*(1-A)}function v(A){return(1-A)*(1-A)*(1-A)}var b=d*m(t)+c*S(t)+a*_(t)+s*v(t),x=f*m(t)+u*S(t)+o*_(t)+n*v(t);return{x:b,y:x}}static getPointOnQuadraticBezier(t,s,n,a,o,c,u){function d(v){return v*v}function f(v){return 2*v*(1-v)}function m(v){return(1-v)*(1-v)}var S=c*d(t)+a*f(t)+s*m(t),_=u*d(t)+o*f(t)+n*m(t);return{x:S,y:_}}static getPointOnEllipticalArc(t,s,n,a,o,c){var u=Math.cos(c),d=Math.sin(c),f={x:n*Math.cos(o),y:a*Math.sin(o)};return{x:t+(f.x*u-f.y*d),y:s+(f.x*d+f.y*u)}}static parsePathData(t){if(!t)return[];var s=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];s=s.replace(new RegExp(" ","g"),",");for(var a=0;a<n.length;a++)s=s.replace(new RegExp(n[a],"g"),"|"+n[a]);var o=s.split("|"),c=[],u=[],d=0,f=0,m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,S;for(a=1;a<o.length;a++){var _=o[a],v=_.charAt(0);for(_=_.slice(1),u.length=0;S=m.exec(_);)u.push(S[0]);for(var b=[],x=0,A=u.length;x<A;x++){if(u[x]==="00"){b.push(0,0);continue}var F=parseFloat(u[x]);isNaN(F)?b.push(0):b.push(F)}for(;b.length>0&&!isNaN(b[0]);){var M="",g=[],w=d,E=f,C,B,I,rt,tt,st,wt,dt,Tt,Lt;switch(v){case"l":d+=b.shift(),f+=b.shift(),M="L",g.push(d,f);break;case"L":d=b.shift(),f=b.shift(),g.push(d,f);break;case"m":var Qt=b.shift(),ct=b.shift();if(d+=Qt,f+=ct,M="M",c.length>2&&c[c.length-1].command==="z"){for(var Dt=c.length-2;Dt>=0;Dt--)if(c[Dt].command==="M"){d=c[Dt].points[0]+Qt,f=c[Dt].points[1]+ct;break}}g.push(d,f),v="l";break;case"M":d=b.shift(),f=b.shift(),M="M",g.push(d,f),v="L";break;case"h":d+=b.shift(),M="L",g.push(d,f);break;case"H":d=b.shift(),M="L",g.push(d,f);break;case"v":f+=b.shift(),M="L",g.push(d,f);break;case"V":f=b.shift(),M="L",g.push(d,f);break;case"C":g.push(b.shift(),b.shift(),b.shift(),b.shift()),d=b.shift(),f=b.shift(),g.push(d,f);break;case"c":g.push(d+b.shift(),f+b.shift(),d+b.shift(),f+b.shift()),d+=b.shift(),f+=b.shift(),M="C",g.push(d,f);break;case"S":B=d,I=f,C=c[c.length-1],C.command==="C"&&(B=d+(d-C.points[2]),I=f+(f-C.points[3])),g.push(B,I,b.shift(),b.shift()),d=b.shift(),f=b.shift(),M="C",g.push(d,f);break;case"s":B=d,I=f,C=c[c.length-1],C.command==="C"&&(B=d+(d-C.points[2]),I=f+(f-C.points[3])),g.push(B,I,d+b.shift(),f+b.shift()),d+=b.shift(),f+=b.shift(),M="C",g.push(d,f);break;case"Q":g.push(b.shift(),b.shift()),d=b.shift(),f=b.shift(),g.push(d,f);break;case"q":g.push(d+b.shift(),f+b.shift()),d+=b.shift(),f+=b.shift(),M="Q",g.push(d,f);break;case"T":B=d,I=f,C=c[c.length-1],C.command==="Q"&&(B=d+(d-C.points[0]),I=f+(f-C.points[1])),d=b.shift(),f=b.shift(),M="Q",g.push(B,I,d,f);break;case"t":B=d,I=f,C=c[c.length-1],C.command==="Q"&&(B=d+(d-C.points[0]),I=f+(f-C.points[1])),d+=b.shift(),f+=b.shift(),M="Q",g.push(B,I,d,f);break;case"A":rt=b.shift(),tt=b.shift(),st=b.shift(),wt=b.shift(),dt=b.shift(),Tt=d,Lt=f,d=b.shift(),f=b.shift(),M="A",g=this.convertEndpointToCenterParameterization(Tt,Lt,d,f,wt,dt,rt,tt,st);break;case"a":rt=b.shift(),tt=b.shift(),st=b.shift(),wt=b.shift(),dt=b.shift(),Tt=d,Lt=f,d+=b.shift(),f+=b.shift(),M="A",g=this.convertEndpointToCenterParameterization(Tt,Lt,d,f,wt,dt,rt,tt,st);break}c.push({command:M||v,points:g,start:{x:w,y:E},pathLength:this.calcLength(w,E,M||v,g)})}(v==="z"||v==="Z")&&c.push({command:"z",points:[],start:void 0,pathLength:0})}return c}static calcLength(t,s,n,a){var o,c,u,d,f=gr;switch(n){case"L":return f.getLineLength(t,s,a[0],a[1]);case"C":return(0,La.getCubicArcLength)([t,a[0],a[2],a[4]],[s,a[1],a[3],a[5]],1);case"Q":return(0,La.getQuadraticArcLength)([t,a[0],a[2]],[s,a[1],a[3]],1);case"A":o=0;var m=a[4],S=a[5],_=a[4]+S,v=Math.PI/180;if(Math.abs(m-_)<v&&(v=Math.abs(m-_)),c=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],m,0),S<0)for(d=m-v;d>_;d-=v)u=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],d,0),o+=f.getLineLength(c.x,c.y,u.x,u.y),c=u;else for(d=m+v;d<_;d+=v)u=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],d,0),o+=f.getLineLength(c.x,c.y,u.x,u.y),c=u;return u=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],_,0),o+=f.getLineLength(c.x,c.y,u.x,u.y),o}return 0}static convertEndpointToCenterParameterization(t,s,n,a,o,c,u,d,f){var m=f*(Math.PI/180),S=Math.cos(m)*(t-n)/2+Math.sin(m)*(s-a)/2,_=-1*Math.sin(m)*(t-n)/2+Math.cos(m)*(s-a)/2,v=S*S/(u*u)+_*_/(d*d);v>1&&(u*=Math.sqrt(v),d*=Math.sqrt(v));var b=Math.sqrt((u*u*(d*d)-u*u*(_*_)-d*d*(S*S))/(u*u*(_*_)+d*d*(S*S)));o===c&&(b*=-1),isNaN(b)&&(b=0);var x=b*u*_/d,A=b*-d*S/u,F=(t+n)/2+Math.cos(m)*x-Math.sin(m)*A,M=(s+a)/2+Math.sin(m)*x+Math.cos(m)*A,g=function(tt){return Math.sqrt(tt[0]*tt[0]+tt[1]*tt[1])},w=function(tt,st){return(tt[0]*st[0]+tt[1]*st[1])/(g(tt)*g(st))},E=function(tt,st){return(tt[0]*st[1]<tt[1]*st[0]?-1:1)*Math.acos(w(tt,st))},C=E([1,0],[(S-x)/u,(_-A)/d]),B=[(S-x)/u,(_-A)/d],I=[(-1*S-x)/u,(-1*_-A)/d],rt=E(B,I);return w(B,I)<=-1&&(rt=Math.PI),w(B,I)>=1&&(rt=0),c===0&&rt>0&&(rt=rt-2*Math.PI),c===1&&rt<0&&(rt=rt+2*Math.PI),[F,M,u,d,C,rt,m,c]}}Ia.Path=gr,gr.prototype.className="Path",gr.prototype._attrsAffectingSize=["data"],(0,Zy._registerNode)(gr),qy.Factory.addGetterSetter(gr,"data"),Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.Arrow=void 0;const Cl=ai,Jy=yo,kp=De,tb=si,Tp=Ia;class ea extends Jy.Line{_sceneFunc(t){super._sceneFunc(t);var s=Math.PI*2,n=this.points(),a=n,o=this.tension()!==0&&n.length>4;o&&(a=this.getTensionPoints());var c=this.pointerLength(),u=n.length,d,f;if(o){const _=[a[a.length-4],a[a.length-3],a[a.length-2],a[a.length-1],n[u-2],n[u-1]],v=Tp.Path.calcLength(a[a.length-4],a[a.length-3],"C",_),b=Tp.Path.getPointOnQuadraticBezier(Math.min(1,1-c/v),_[0],_[1],_[2],_[3],_[4],_[5]);d=n[u-2]-b.x,f=n[u-1]-b.y}else d=n[u-2]-n[u-4],f=n[u-1]-n[u-3];var m=(Math.atan2(f,d)+s)%s,S=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[u-2],n[u-1]),t.rotate(m),t.moveTo(0,0),t.lineTo(-c,S/2),t.lineTo(-c,-S/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),o?(d=(a[0]+a[2])/2-n[0],f=(a[1]+a[3])/2-n[1]):(d=n[2]-n[0],f=n[3]-n[1]),t.rotate((Math.atan2(-f,-d)+s)%s),t.moveTo(0,0),t.lineTo(-c,S/2),t.lineTo(-c,-S/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var s=this.dashEnabled();s&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),s&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),s=this.pointerWidth()/2;return{x:t.x-s,y:t.y-s,width:t.width+s*2,height:t.height+s*2}}}Sl.Arrow=ea,ea.prototype.className="Arrow",(0,tb._registerNode)(ea),Cl.Factory.addGetterSetter(ea,"pointerLength",10,(0,kp.getNumberValidator)()),Cl.Factory.addGetterSetter(ea,"pointerWidth",10,(0,kp.getNumberValidator)()),Cl.Factory.addGetterSetter(ea,"pointerAtBeginning",!1),Cl.Factory.addGetterSetter(ea,"pointerAtEnding",!0);var kl={};Object.defineProperty(kl,"__esModule",{value:!0}),kl.Circle=void 0;const eb=ai,ib=pr,rb=De,nb=si;class Da extends ib.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}kl.Circle=Da,Da.prototype._centroid=!0,Da.prototype.className="Circle",Da.prototype._attrsAffectingSize=["radius"],(0,nb._registerNode)(Da),eb.Factory.addGetterSetter(Da,"radius",0,(0,rb.getNumberValidator)());var Tl={};Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.Ellipse=void 0;const Wc=ai,sb=pr,Pp=De,ab=si;class Rs extends sb.Shape{_sceneFunc(t){var s=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),s!==n&&t.scale(1,n/s),t.arc(0,0,s,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Tl.Ellipse=Rs,Rs.prototype.className="Ellipse",Rs.prototype._centroid=!0,Rs.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,ab._registerNode)(Rs),Wc.Factory.addComponentsGetterSetter(Rs,"radius",["x","y"]),Wc.Factory.addGetterSetter(Rs,"radiusX",0,(0,Pp.getNumberValidator)()),Wc.Factory.addGetterSetter(Rs,"radiusY",0,(0,Pp.getNumberValidator)());var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.Image=void 0;const $c=Qi,ia=ai,ob=pr,lb=si,bo=De;let Cn=class extends ob.Shape{constructor(r){super(r),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const r=this.image();r&&r.complete||r&&r.readyState===4||r&&r.addEventListener&&r.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(r){const t=this.getWidth(),s=this.getHeight(),n=this.cornerRadius(),a=this.attrs.image;let o;if(a){const c=this.attrs.cropWidth,u=this.attrs.cropHeight;c&&u?o=[a,this.cropX(),this.cropY(),c,u,0,0,t,s]:o=[a,0,0,t,s]}(this.hasFill()||this.hasStroke()||n)&&(r.beginPath(),n?$c.Util.drawRoundedRectPath(r,t,s,n):r.rect(0,0,t,s),r.closePath(),r.fillStrokeShape(this)),a&&(n&&r.clip(),r.drawImage.apply(r,o))}_hitFunc(r){var t=this.width(),s=this.height(),n=this.cornerRadius();r.beginPath(),n?$c.Util.drawRoundedRectPath(r,t,s,n):r.rect(0,0,t,s),r.closePath(),r.fillStrokeShape(this)}getWidth(){var r,t;return(r=this.attrs.width)!==null&&r!==void 0?r:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var r,t;return(r=this.attrs.height)!==null&&r!==void 0?r:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(r,t,s=null){var n=$c.Util.createImageElement();n.onload=function(){var a=new Cn({image:n});t(a)},n.onerror=s,n.crossOrigin="Anonymous",n.src=r}};Pl.Image=Cn,Cn.prototype.className="Image",(0,lb._registerNode)(Cn),ia.Factory.addGetterSetter(Cn,"cornerRadius",0,(0,bo.getNumberOrArrayOfNumbersValidator)(4)),ia.Factory.addGetterSetter(Cn,"image"),ia.Factory.addComponentsGetterSetter(Cn,"crop",["x","y","width","height"]),ia.Factory.addGetterSetter(Cn,"cropX",0,(0,bo.getNumberValidator)()),ia.Factory.addGetterSetter(Cn,"cropY",0,(0,bo.getNumberValidator)()),ia.Factory.addGetterSetter(Cn,"cropWidth",0,(0,bo.getNumberValidator)()),ia.Factory.addGetterSetter(Cn,"cropHeight",0,(0,bo.getNumberValidator)());var Na={};Object.defineProperty(Na,"__esModule",{value:!0}),Na.Tag=Na.Label=void 0;const Ml=ai,hb=pr,cb=Ra,Kc=De,Mp=si;var Rp=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],db="Change.konva",ub="none",Xc="up",Yc="right",qc="down",Qc="left",fb=Rp.length;class Zc extends cb.Group{constructor(t){super(t),this.on("add.konva",function(s){this._addListeners(s.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var s=this,n,a=function(){s._sync()};for(n=0;n<fb;n++)t.on(Rp[n]+db,a)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t=this.getText(),s=this.getTag(),n,a,o,c,u,d,f;if(t&&s){switch(n=t.width(),a=t.height(),o=s.pointerDirection(),c=s.pointerWidth(),f=s.pointerHeight(),u=0,d=0,o){case Xc:u=n/2,d=-1*f;break;case Yc:u=n+c,d=a/2;break;case qc:u=n/2,d=a+f;break;case Qc:u=-1*c,d=a/2;break}s.setAttrs({x:-1*u,y:-1*d,width:n,height:a}),t.setAttrs({x:-1*u,y:-1*d})}}}Na.Label=Zc,Zc.prototype.className="Label",(0,Mp._registerNode)(Zc);class ra extends hb.Shape{_sceneFunc(t){var s=this.width(),n=this.height(),a=this.pointerDirection(),o=this.pointerWidth(),c=this.pointerHeight(),u=this.cornerRadius();let d=0,f=0,m=0,S=0;typeof u=="number"?d=f=m=S=Math.min(u,s/2,n/2):(d=Math.min(u[0]||0,s/2,n/2),f=Math.min(u[1]||0,s/2,n/2),S=Math.min(u[2]||0,s/2,n/2),m=Math.min(u[3]||0,s/2,n/2)),t.beginPath(),t.moveTo(d,0),a===Xc&&(t.lineTo((s-o)/2,0),t.lineTo(s/2,-1*c),t.lineTo((s+o)/2,0)),t.lineTo(s-f,0),t.arc(s-f,f,f,Math.PI*3/2,0,!1),a===Yc&&(t.lineTo(s,(n-c)/2),t.lineTo(s+o,n/2),t.lineTo(s,(n+c)/2)),t.lineTo(s,n-S),t.arc(s-S,n-S,S,0,Math.PI/2,!1),a===qc&&(t.lineTo((s+o)/2,n),t.lineTo(s/2,n+c),t.lineTo((s-o)/2,n)),t.lineTo(m,n),t.arc(m,n-m,m,Math.PI/2,Math.PI,!1),a===Qc&&(t.lineTo(0,(n+c)/2),t.lineTo(-1*o,n/2),t.lineTo(0,(n-c)/2)),t.lineTo(0,d),t.arc(d,d,d,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,s=0,n=this.pointerWidth(),a=this.pointerHeight(),o=this.pointerDirection(),c=this.width(),u=this.height();return o===Xc?(s-=a,u+=a):o===qc?u+=a:o===Qc?(t-=n*1.5,c+=n):o===Yc&&(c+=n*1.5),{x:t,y:s,width:c,height:u}}}Na.Tag=ra,ra.prototype.className="Tag",(0,Mp._registerNode)(ra),Ml.Factory.addGetterSetter(ra,"pointerDirection",ub),Ml.Factory.addGetterSetter(ra,"pointerWidth",0,(0,Kc.getNumberValidator)()),Ml.Factory.addGetterSetter(ra,"pointerHeight",0,(0,Kc.getNumberValidator)()),Ml.Factory.addGetterSetter(ra,"cornerRadius",0,(0,Kc.getNumberOrArrayOfNumbersValidator)(4));var _o={};Object.defineProperty(_o,"__esModule",{value:!0}),_o.Rect=void 0;const pb=ai,gb=pr,mb=si,vb=Qi,yb=De;class Rl extends gb.Shape{_sceneFunc(t){var s=this.cornerRadius(),n=this.width(),a=this.height();t.beginPath(),s?vb.Util.drawRoundedRectPath(t,n,a,s):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}}_o.Rect=Rl,Rl.prototype.className="Rect",(0,mb._registerNode)(Rl),pb.Factory.addGetterSetter(Rl,"cornerRadius",0,(0,yb.getNumberOrArrayOfNumbersValidator)(4));var Fl={};Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.RegularPolygon=void 0;const Fp=ai,bb=pr,Ip=De,_b=si;class na extends bb.Shape{_sceneFunc(t){const s=this._getPoints();t.beginPath(),t.moveTo(s[0].x,s[0].y);for(var n=1;n<s.length;n++)t.lineTo(s[n].x,s[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,s=this.attrs.radius||0,n=[];for(var a=0;a<t;a++)n.push({x:s*Math.sin(a*2*Math.PI/t),y:-1*s*Math.cos(a*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();var s=t[0].x,n=t[0].y,a=t[0].x,o=t[0].y;return t.forEach(c=>{s=Math.min(s,c.x),n=Math.max(n,c.x),a=Math.min(a,c.y),o=Math.max(o,c.y)}),{x:s,y:a,width:n-s,height:o-a}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Fl.RegularPolygon=na,na.prototype.className="RegularPolygon",na.prototype._centroid=!0,na.prototype._attrsAffectingSize=["radius"],(0,_b._registerNode)(na),Fp.Factory.addGetterSetter(na,"radius",0,(0,Ip.getNumberValidator)()),Fp.Factory.addGetterSetter(na,"sides",0,(0,Ip.getNumberValidator)());var Il={};Object.defineProperty(Il,"__esModule",{value:!0}),Il.Ring=void 0;const Lp=ai,xb=pr,Dp=De,wb=si;var Np=Math.PI*2;class sa extends xb.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Np,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Np,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Il.Ring=sa,sa.prototype.className="Ring",sa.prototype._centroid=!0,sa.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,wb._registerNode)(sa),Lp.Factory.addGetterSetter(sa,"innerRadius",0,(0,Dp.getNumberValidator)()),Lp.Factory.addGetterSetter(sa,"outerRadius",0,(0,Dp.getNumberValidator)());var Ll={};Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.Sprite=void 0;const aa=ai,Ab=pr,Sb=Fa,Op=De,Eb=si;class Vn extends Ab.Shape{constructor(t){super(t),this._updated=!0,this.anim=new Sb.Animation(()=>{var s=this._updated;return this._updated=!1,s}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){!this.anim.isRunning()||(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){var s=this.animation(),n=this.frameIndex(),a=n*4,o=this.animations()[s],c=this.frameOffsets(),u=o[a+0],d=o[a+1],f=o[a+2],m=o[a+3],S=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,f,m),t.closePath(),t.fillStrokeShape(this)),S)if(c){var _=c[s],v=n*2;t.drawImage(S,u,d,f,m,_[v+0],_[v+1],f,m)}else t.drawImage(S,u,d,f,m,0,0,f,m)}_hitFunc(t){var s=this.animation(),n=this.frameIndex(),a=n*4,o=this.animations()[s],c=this.frameOffsets(),u=o[a+2],d=o[a+3];if(t.beginPath(),c){var f=c[s],m=n*2;t.rect(f[m+0],f[m+1],u,d)}else t.rect(0,0,u,d);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),s=this.animation(),n=this.animations(),a=n[s],o=a.length/4;t<o-1?this.frameIndex(t+1):this.frameIndex(0)}}Ll.Sprite=Vn,Vn.prototype.className="Sprite",(0,Eb._registerNode)(Vn),aa.Factory.addGetterSetter(Vn,"animation"),aa.Factory.addGetterSetter(Vn,"animations"),aa.Factory.addGetterSetter(Vn,"frameOffsets"),aa.Factory.addGetterSetter(Vn,"image"),aa.Factory.addGetterSetter(Vn,"frameIndex",0,(0,Op.getNumberValidator)()),aa.Factory.addGetterSetter(Vn,"frameRate",17,(0,Op.getNumberValidator)()),aa.Factory.backCompat(Vn,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Dl={};Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.Star=void 0;const Jc=ai,Cb=pr,td=De,kb=si;class Fs extends Cb.Shape{_sceneFunc(t){var s=this.innerRadius(),n=this.outerRadius(),a=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(var o=1;o<a*2;o++){var c=o%2===0?n:s,u=c*Math.sin(o*Math.PI/a),d=-1*c*Math.cos(o*Math.PI/a);t.lineTo(u,d)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Dl.Star=Fs,Fs.prototype.className="Star",Fs.prototype._centroid=!0,Fs.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,kb._registerNode)(Fs),Jc.Factory.addGetterSetter(Fs,"numPoints",5,(0,td.getNumberValidator)()),Jc.Factory.addGetterSetter(Fs,"innerRadius",0,(0,td.getNumberValidator)()),Jc.Factory.addGetterSetter(Fs,"outerRadius",0,(0,td.getNumberValidator)());var oa={};Object.defineProperty(oa,"__esModule",{value:!0}),oa.Text=oa.stringToArray=void 0;const ed=Qi,Lr=ai,Tb=pr,Is=De,Pb=si;function zp(r){return Array.from(r)}oa.stringToArray=zp;var Oa="auto",Mb="center",Hp="inherit",xo="justify",Rb="Change.konva",Fb="2d",Bp="-",Up="left",Ib="text",Lb="Text",Db="top",Nb="bottom",Gp="middle",jp="normal",Ob="px ",Nl=" ",zb="right",Vp="rtl",Hb="word",Bb="char",Wp="none",id="\u2026",$p=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Ub=$p.length;function Gb(r){return r.split(",").map(t=>{t=t.trim();const s=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return s&&!n&&(t=`"${t}"`),t}).join(", ")}var rd;function nd(){return rd||(rd=ed.Util.createCanvasElement().getContext(Fb),rd)}function jb(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Vb(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Wb(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}class tr extends Tb.Shape{constructor(t){super(Wb(t)),this._partialTextX=0,this._partialTextY=0;for(var s=0;s<Ub;s++)this.on($p[s]+Rb,this._setTextData);this._setTextData()}_sceneFunc(t){var s=this.textArr,n=s.length;if(this.text()){var a=this.padding(),o=this.fontSize(),c=this.lineHeight()*o,u=this.verticalAlign(),d=this.direction(),f=0,m=this.align(),S=this.getWidth(),_=this.letterSpacing(),v=this.fill(),b=this.textDecoration(),x=b.indexOf("underline")!==-1,A=b.indexOf("line-through")!==-1,F;d=d===Hp?t.direction:d;var M=0,M=c/2,g=0,w=0;for(d===Vp&&t.setAttr("direction",d),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",Gp),t.setAttr("textAlign",Up),u===Gp?f=(this.getHeight()-n*c-a*2)/2:u===Nb&&(f=this.getHeight()-n*c-a*2),t.translate(a,f+a),F=0;F<n;F++){var g=0,w=0,E=s[F],C=E.text,B=E.width,I=E.lastInParagraph,rt,tt,st;if(t.save(),m===zb?g+=S-B-a*2:m===Mb&&(g+=(S-B-a*2)/2),x){t.save(),t.beginPath(),t.moveTo(g,M+w+Math.round(o/2)),rt=C.split(" ").length-1,tt=rt===0,st=m===xo&&!I?S-a*2:B,t.lineTo(g+Math.round(st),M+w+Math.round(o/2)),t.lineWidth=o/15;const ct=this._getLinearGradient();t.strokeStyle=ct||v,t.stroke(),t.restore()}if(A){t.save(),t.beginPath(),t.moveTo(g,M+w),rt=C.split(" ").length-1,tt=rt===0,st=m===xo&&I&&!tt?S-a*2:B,t.lineTo(g+Math.round(st),M+w),t.lineWidth=o/15;const ct=this._getLinearGradient();t.strokeStyle=ct||v,t.stroke(),t.restore()}if(d!==Vp&&(_!==0||m===xo)){rt=C.split(" ").length-1;for(var wt=zp(C),dt=0;dt<wt.length;dt++){var Tt=wt[dt];Tt===" "&&!I&&m===xo&&(g+=(S-a*2-B)/rt),this._partialTextX=g,this._partialTextY=M+w,this._partialText=Tt,t.fillStrokeShape(this),g+=this.measureSize(Tt).width+_}}else _!==0&&t.setAttr("letterSpacing",`${_}px`),this._partialTextX=g,this._partialTextY=M+w,this._partialText=C,t.fillStrokeShape(this);t.restore(),n>1&&(M+=c)}}}_hitFunc(t){var s=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,s,n),t.closePath(),t.fillStrokeShape(this)}setText(t){var s=ed.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(Ib,s),this}getWidth(){var t=this.attrs.width===Oa||this.attrs.width===void 0;return t?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var t=this.attrs.height===Oa||this.attrs.height===void 0;return t?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return ed.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var s=nd(),n=this.fontSize(),a;return s.save(),s.font=this._getContextFont(),a=s.measureText(t),s.restore(),{width:a.width,height:n}}_getContextFont(){return this.fontStyle()+Nl+this.fontVariant()+Nl+(this.fontSize()+Ob)+Gb(this.fontFamily())}_addTextLine(t){this.align()===xo&&(t=t.trim());var s=this._getTextWidth(t);return this.textArr.push({text:t,width:s,lastInParagraph:!1})}_getTextWidth(t){var s=this.letterSpacing(),n=t.length;return nd().measureText(t).width+(n?s*(n-1):0)}_setTextData(){var t=this.text().split(`
`),s=+this.fontSize(),n=0,a=this.lineHeight()*s,o=this.attrs.width,c=this.attrs.height,u=o!==Oa&&o!==void 0,d=c!==Oa&&c!==void 0,f=this.padding(),m=o-f*2,S=c-f*2,_=0,v=this.wrap(),b=v!==Wp,x=v!==Bb&&b,A=this.ellipsis();this.textArr=[],nd().font=this._getContextFont();for(var F=A?this._getTextWidth(id):0,M=0,g=t.length;M<g;++M){var w=t[M],E=this._getTextWidth(w);if(u&&E>m)for(;w.length>0;){for(var C=0,B=w.length,I="",rt=0;C<B;){var tt=C+B>>>1,st=w.slice(0,tt+1),wt=this._getTextWidth(st)+F;wt<=m?(C=tt+1,I=st,rt=wt):B=tt}if(I){if(x){var dt,Tt=w[I.length],Lt=Tt===Nl||Tt===Bp;Lt&&rt<=m?dt=I.length:dt=Math.max(I.lastIndexOf(Nl),I.lastIndexOf(Bp))+1,dt>0&&(C=dt,I=I.slice(0,C),rt=this._getTextWidth(I))}I=I.trimRight(),this._addTextLine(I),n=Math.max(n,rt),_+=a;var Qt=this._shouldHandleEllipsis(_);if(Qt){this._tryToAddEllipsisToLastLine();break}if(w=w.slice(C),w=w.trimLeft(),w.length>0&&(E=this._getTextWidth(w),E<=m)){this._addTextLine(w),_+=a,n=Math.max(n,E);break}}else break}else this._addTextLine(w),_+=a,n=Math.max(n,E),this._shouldHandleEllipsis(_)&&M<g-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),d&&_+a>S)break}this.textHeight=s,this.textWidth=n}_shouldHandleEllipsis(t){var s=+this.fontSize(),n=this.lineHeight()*s,a=this.attrs.height,o=a!==Oa&&a!==void 0,c=this.padding(),u=a-c*2,d=this.wrap(),f=d!==Wp;return!f||o&&t+n>u}_tryToAddEllipsisToLastLine(){var t=this.attrs.width,s=t!==Oa&&t!==void 0,n=this.padding(),a=t-n*2,o=this.ellipsis(),c=this.textArr[this.textArr.length-1];if(!(!c||!o)){if(s){var u=this._getTextWidth(c.text+id)<a;u||(c.text=c.text.slice(0,c.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+id)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,s=this.hasShadow();return t&&s?!0:super._useBufferCanvas()}}oa.Text=tr,tr.prototype._fillFunc=jb,tr.prototype._strokeFunc=Vb,tr.prototype.className=Lb,tr.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,Pb._registerNode)(tr),Lr.Factory.overWriteSetter(tr,"width",(0,Is.getNumberOrAutoValidator)()),Lr.Factory.overWriteSetter(tr,"height",(0,Is.getNumberOrAutoValidator)()),Lr.Factory.addGetterSetter(tr,"direction",Hp),Lr.Factory.addGetterSetter(tr,"fontFamily","Arial"),Lr.Factory.addGetterSetter(tr,"fontSize",12,(0,Is.getNumberValidator)()),Lr.Factory.addGetterSetter(tr,"fontStyle",jp),Lr.Factory.addGetterSetter(tr,"fontVariant",jp),Lr.Factory.addGetterSetter(tr,"padding",0,(0,Is.getNumberValidator)()),Lr.Factory.addGetterSetter(tr,"align",Up),Lr.Factory.addGetterSetter(tr,"verticalAlign",Db),Lr.Factory.addGetterSetter(tr,"lineHeight",1,(0,Is.getNumberValidator)()),Lr.Factory.addGetterSetter(tr,"wrap",Hb),Lr.Factory.addGetterSetter(tr,"ellipsis",!1,(0,Is.getBooleanValidator)()),Lr.Factory.addGetterSetter(tr,"letterSpacing",0,(0,Is.getNumberValidator)()),Lr.Factory.addGetterSetter(tr,"text","",(0,Is.getStringValidator)()),Lr.Factory.addGetterSetter(tr,"textDecoration","");var Ol={};Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.TextPath=void 0;const sd=Qi,kn=ai,$b=pr,wo=Ia,ad=oa,Kp=De,Kb=si;var Xb="",Xp="normal";function Yp(r){r.fillText(this.partialText,0,0)}function qp(r){r.strokeText(this.partialText,0,0)}class mr extends $b.Shape{constructor(t){super(t),this.dummyCanvas=sd.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return wo.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const s=this.pathLength;return t-1>s?null:wo.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=wo.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var s=this.textDecoration(),n=this.fill(),a=this.fontSize(),o=this.glyphInfo;s==="underline"&&t.beginPath();for(var c=0;c<o.length;c++){t.save();var u=o[c].p0;t.translate(u.x,u.y),t.rotate(o[c].rotation),this.partialText=o[c].text,t.fillStrokeShape(this),s==="underline"&&(c===0&&t.moveTo(0,a/2+1),t.lineTo(a,a/2+1)),t.restore()}s==="underline"&&(t.strokeStyle=n,t.lineWidth=a/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var s=this.glyphInfo;if(s.length>=1){var n=s[0].p0;t.moveTo(n.x,n.y)}for(var a=0;a<s.length;a++){var o=s[a].p1;t.lineTo(o.x,o.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return sd.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return ad.Text.prototype.setText.call(this,t)}_getContextFont(){return ad.Text.prototype._getContextFont.call(this)}_getTextSize(t){var s=this.dummyCanvas,n=s.getContext("2d");n.save(),n.font=this._getContextFont();var a=n.measureText(t);return n.restore(),{width:a.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:s}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=s,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),a=this.align(),o=this.kerningFunc(),c=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let u=0;a==="center"&&(u=Math.max(0,this.pathLength/2-c/2)),a==="right"&&(u=Math.max(0,this.pathLength-c));const d=(0,ad.stringToArray)(this.text());let f=u;for(var m=0;m<d.length;m++){const S=this._getPointAtLength(f);if(!S)return;let _=this._getTextSize(d[m]).width+n;if(d[m]===" "&&a==="justify"){const M=this.text().split(" ").length-1;_+=(this.pathLength-c)/M}const v=this._getPointAtLength(f+_);if(!v)return;const b=wo.Path.getLineLength(S.x,S.y,v.x,v.y);let x=0;if(o)try{x=o(d[m-1],d[m])*this.fontSize()}catch{x=0}S.x+=x,v.x+=x,this.textWidth+=x;const A=wo.Path.getPointOnLine(x+b/2,S.x,S.y,v.x,v.y),F=Math.atan2(v.y-S.y,v.x-S.x);this.glyphInfo.push({transposeX:A.x,transposeY:A.y,text:d[m],rotation:F,p0:S,p1:v}),f+=_}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});for(var s=t[0]||0,n=t[0]||0,a=t[1]||0,o=t[1]||0,c,u,d=0;d<t.length/2;d++)c=t[d*2],u=t[d*2+1],s=Math.min(s,c),n=Math.max(n,c),a=Math.min(a,u),o=Math.max(o,u);var f=this.fontSize();return{x:s-f/2,y:a-f/2,width:n-s+f,height:o-a+f}}destroy(){return sd.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Ol.TextPath=mr,mr.prototype._fillFunc=Yp,mr.prototype._strokeFunc=qp,mr.prototype._fillFuncHit=Yp,mr.prototype._strokeFuncHit=qp,mr.prototype.className="TextPath",mr.prototype._attrsAffectingSize=["text","fontSize","data"],(0,Kb._registerNode)(mr),kn.Factory.addGetterSetter(mr,"data"),kn.Factory.addGetterSetter(mr,"fontFamily","Arial"),kn.Factory.addGetterSetter(mr,"fontSize",12,(0,Kp.getNumberValidator)()),kn.Factory.addGetterSetter(mr,"fontStyle",Xp),kn.Factory.addGetterSetter(mr,"align","left"),kn.Factory.addGetterSetter(mr,"letterSpacing",0,(0,Kp.getNumberValidator)()),kn.Factory.addGetterSetter(mr,"textBaseline","middle"),kn.Factory.addGetterSetter(mr,"fontVariant",Xp),kn.Factory.addGetterSetter(mr,"text",Xb),kn.Factory.addGetterSetter(mr,"textDecoration",null),kn.Factory.addGetterSetter(mr,"kerningFunc",null);var zl={};Object.defineProperty(zl,"__esModule",{value:!0}),zl.Transformer=void 0;const Ri=Qi,Si=ai,Qp=Wi,Yb=pr,qb=_o,Zp=Ra,Tn=si,Ls=De,Qb=si;var Jp="tr-konva",Zb=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${Jp}`).join(" "),tg="nodesRect",Jb=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],t2={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const e2="ontouchstart"in Tn.Konva._global;function i2(r,t,s){if(r==="rotater")return s;t+=Ri.Util.degToRad(t2[r]||0);var n=(Ri.Util.radToDeg(t)%360+360)%360;return Ri.Util._inRange(n,315+22.5,360)||Ri.Util._inRange(n,0,22.5)?"ns-resize":Ri.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Ri.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Ri.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Ri.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Ri.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Ri.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Ri.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Ri.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var Hl=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],eg=1e8;function r2(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function ig(r,t,s){const n=s.x+(r.x-s.x)*Math.cos(t)-(r.y-s.y)*Math.sin(t),a=s.y+(r.x-s.x)*Math.sin(t)+(r.y-s.y)*Math.cos(t);return{...r,rotation:r.rotation+t,x:n,y:a}}function n2(r,t){const s=r2(r);return ig(r,t,s)}function s2(r,t,s){let n=t;for(let a=0;a<r.length;a++){const o=Tn.Konva.getAngle(r[a]),c=Math.abs(o-t)%(Math.PI*2);Math.min(c,Math.PI*2-c)<s&&(n=o)}return n}let od=0;class yi extends Zp.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Zb,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return Ri.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Jp+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const s=t.filter(a=>a.isAncestorOf(this)?(Ri.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=t=s,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(a=>{const o=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},c=a._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");a.on(c,o),a.on(Jb.map(u=>u+`.${this._getEventNamespace()}`).join(" "),o),a.on(`absoluteTransformChange.${this._getEventNamespace()}`,o),this._proxyDrag(a)}),this._resetTransformCache();var n=!!this.findOne(".top-left");return n&&this.update(),this}_proxyDrag(t){let s;t.on(`dragstart.${this._getEventNamespace()}`,n=>{s=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!s)return;const a=t.getAbsolutePosition(),o=a.x-s.x,c=a.y-s.y;this.nodes().forEach(u=>{if(u===t||u.isDragging())return;const d=u.getAbsolutePosition();u.setAbsolutePosition({x:d.x+o,y:d.y+c}),u.startDrag(n)}),s=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(tg),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(tg,this.__getNodeRect)}__getNodeShape(t,s=this.rotation(),n){var a=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=t.getAbsoluteScale(n),c=t.getAbsolutePosition(n),u=a.x*o.x-t.offsetX()*o.x,d=a.y*o.y-t.offsetY()*o.y;const f=(Tn.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),m={x:c.x+u*Math.cos(f)+d*Math.sin(-f),y:c.y+d*Math.cos(f)+u*Math.sin(f),width:a.width*o.x,height:a.height*o.y,rotation:f};return ig(m,-Tn.Konva.getAngle(s),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-eg,y:-eg,width:0,height:0,rotation:0};const s=[];this.nodes().map(f=>{const m=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var S=[{x:m.x,y:m.y},{x:m.x+m.width,y:m.y},{x:m.x+m.width,y:m.y+m.height},{x:m.x,y:m.y+m.height}],_=f.getAbsoluteTransform();S.forEach(function(v){var b=_.point(v);s.push(b)})});const n=new Ri.Transform;n.rotate(-Tn.Konva.getAngle(this.rotation()));var a=1/0,o=1/0,c=-1/0,u=-1/0;s.forEach(function(f){var m=n.point(f);a===void 0&&(a=c=m.x,o=u=m.y),a=Math.min(a,m.x),o=Math.min(o,m.y),c=Math.max(c,m.x),u=Math.max(u,m.y)}),n.invert();const d=n.point({x:a,y:o});return{x:d.x,y:d.y,width:c-a,height:u-o,rotation:Tn.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Hl.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){var s=new qb.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:e2?10:"auto"}),n=this;s.on("mousedown touchstart",function(a){n._handleMouseDown(a)}),s.on("dragstart",a=>{s.stopDrag(),a.cancelBubble=!0}),s.on("dragend",a=>{a.cancelBubble=!0}),s.on("mouseenter",()=>{var a=Tn.Konva.getAngle(this.rotation()),o=this.rotateAnchorCursor(),c=i2(t,a,o);s.getStage().content&&(s.getStage().content.style.cursor=c),this._cursorChange=!0}),s.on("mouseout",()=>{s.getStage().content&&(s.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(s)}_createBack(){var t=new Yb.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(s,n){var a=n.getParent(),o=a.padding();s.beginPath(),s.rect(-o,-o,n.width()+o*2,n.height()+o*2),s.moveTo(n.width()/2,-o),a.rotateEnabled()&&a.rotateLineVisible()&&s.lineTo(n.width()/2,-a.rotateAnchorOffset()*Ri.Util._sign(n.height())-o),s.fillStrokeShape(n)},hitFunc:(s,n)=>{if(this.shouldOverdrawWholeArea()){var a=this.padding();s.beginPath(),s.rect(-a,-a,n.width()+a*2,n.height()+a*2),s.fillStrokeShape(n)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",s=>{s.cancelBubble=!0}),t.on("dragmove",s=>{s.cancelBubble=!0}),t.on("dragend",s=>{s.cancelBubble=!0}),this.on("dragmove",s=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var s=this._getNodeRect(),n=s.width,a=s.height,o=Math.sqrt(Math.pow(n,2)+Math.pow(a,2));this.sin=Math.abs(a/o),this.cos=Math.abs(n/o),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var c=t.target.getAbsolutePosition(),u=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-c.x,y:u.y-c.y},od++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(d=>{d._fire("transformstart",{evt:t.evt,target:d})})}_handleMouseMove(t){var s,n,a,o=this.findOne("."+this._movingAnchorName),c=o.getStage();c.setPointersPositions(t);const u=c.getPointerPosition();let d={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y};const f=o.getAbsolutePosition();this.anchorDragBoundFunc()&&(d=this.anchorDragBoundFunc()(f,d,t)),o.setAbsolutePosition(d);const m=o.getAbsolutePosition();if(!(f.x===m.x&&f.y===m.y)){if(this._movingAnchorName==="rotater"){var S=this._getNodeRect();s=o.x()-S.width/2,n=-o.y()+S.height/2;let dt=Math.atan2(-n,s)+Math.PI/2;S.height<0&&(dt-=Math.PI);var _=Tn.Konva.getAngle(this.rotation());const Tt=_+dt,Lt=Tn.Konva.getAngle(this.rotationSnapTolerance()),Qt=s2(this.rotationSnaps(),Tt,Lt)-S.rotation,ct=n2(S,Qt);this._fitNodesInto(ct,t);return}var v=this.shiftBehavior(),b;v==="inverted"?b=this.keepRatio()&&!t.shiftKey:v==="none"?b=this.keepRatio():b=this.keepRatio()||t.shiftKey;var g=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(b){var x=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};a=Math.sqrt(Math.pow(x.x-o.x(),2)+Math.pow(x.y-o.y(),2));var A=this.findOne(".top-left").x()>x.x?-1:1,F=this.findOne(".top-left").y()>x.y?-1:1;s=a*this.cos*A,n=a*this.sin*F,this.findOne(".top-left").x(x.x-s),this.findOne(".top-left").y(x.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(b){var x=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};a=Math.sqrt(Math.pow(o.x()-x.x,2)+Math.pow(x.y-o.y(),2));var A=this.findOne(".top-right").x()<x.x?-1:1,F=this.findOne(".top-right").y()>x.y?-1:1;s=a*this.cos*A,n=a*this.sin*F,this.findOne(".top-right").x(x.x+s),this.findOne(".top-right").y(x.y-n)}var M=o.position();this.findOne(".top-left").y(M.y),this.findOne(".bottom-right").x(M.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(b){var x=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};a=Math.sqrt(Math.pow(x.x-o.x(),2)+Math.pow(o.y()-x.y,2));var A=x.x<o.x()?-1:1,F=o.y()<x.y?-1:1;s=a*this.cos*A,n=a*this.sin*F,o.x(x.x-s),o.y(x.y+n)}M=o.position(),this.findOne(".top-left").x(M.x),this.findOne(".bottom-right").y(M.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(b){var x=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};a=Math.sqrt(Math.pow(o.x()-x.x,2)+Math.pow(o.y()-x.y,2));var A=this.findOne(".bottom-right").x()<x.x?-1:1,F=this.findOne(".bottom-right").y()<x.y?-1:1;s=a*this.cos*A,n=a*this.sin*F,this.findOne(".bottom-right").x(x.x+s),this.findOne(".bottom-right").y(x.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var g=this.centeredScaling()||t.altKey;if(g){var w=this.findOne(".top-left"),E=this.findOne(".bottom-right"),C=w.x(),B=w.y(),I=this.getWidth()-E.x(),rt=this.getHeight()-E.y();E.move({x:-C,y:-B}),w.move({x:I,y:rt})}var tt=this.findOne(".top-left").getAbsolutePosition();s=tt.x,n=tt.y;var st=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),wt=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:s,y:n,width:st,height:wt,rotation:Tn.Konva.getAngle(this.rotation())},t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var s;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var n=this.getNode();od--,this._fire("transformend",{evt:t,target:n}),(s=this.getLayer())===null||s===void 0||s.batchDraw(),n&&this._nodes.forEach(a=>{var o;a._fire("transformend",{evt:t,target:a}),(o=a.getLayer())===null||o===void 0||o.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,s){var n=this._getNodeRect();const a=1;if(Ri.Util._inRange(t.width,-this.padding()*2-a,a)){this.update();return}if(Ri.Util._inRange(t.height,-this.padding()*2-a,a)){this.update();return}var o=new Ri.Transform;if(o.rotate(Tn.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const _=o.point({x:-this.padding()*2,y:0});t.x+=_.x,t.y+=_.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const _=o.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const _=o.point({x:0,y:-this.padding()*2});t.x+=_.x,t.y+=_.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const _=o.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const _=this.boundBoxFunc()(n,t);_?t=_:Ri.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,u=new Ri.Transform;u.translate(n.x,n.y),u.rotate(n.rotation),u.scale(n.width/c,n.height/c);const d=new Ri.Transform,f=t.width/c,m=t.height/c;this.flipEnabled()===!1?(d.translate(t.x,t.y),d.rotate(t.rotation),d.translate(t.width<0?t.width:0,t.height<0?t.height:0),d.scale(Math.abs(f),Math.abs(m))):(d.translate(t.x,t.y),d.rotate(t.rotation),d.scale(f,m));const S=d.multiply(u.invert());this._nodes.forEach(_=>{var v;const b=_.getParent().getAbsoluteTransform(),x=_.getTransform().copy();x.translate(_.offsetX(),_.offsetY());const A=new Ri.Transform;A.multiply(b.copy().invert()).multiply(S).multiply(b).multiply(x);const F=A.decompose();_.setAttrs(F),(v=_.getLayer())===null||v===void 0||v.batchDraw()}),this.rotation(Ri.Util._getRotation(t.rotation)),this._nodes.forEach(_=>{this._fire("transform",{evt:s,target:_}),_._fire("transform",{evt:s,target:_})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,s){this.findOne(t).setAttrs(s)}update(){var t,s=this._getNodeRect();this.rotation(Ri.Util._getRotation(s.rotation));var n=s.width,a=s.height,o=this.enabledAnchors(),c=this.resizeEnabled(),u=this.padding(),d=this.anchorSize();const f=this.find("._anchor");f.forEach(S=>{S.setAttrs({width:d,height:d,offsetX:d/2,offsetY:d/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:d/2+u,offsetY:d/2+u,visible:c&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:d/2+u,visible:c&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:d/2-u,offsetY:d/2+u,visible:c&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:a/2,offsetX:d/2+u,visible:c&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:a/2,offsetX:d/2-u,visible:c&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:a,offsetX:d/2+u,offsetY:d/2-u,visible:c&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:a,offsetY:d/2-u,visible:c&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:a,offsetX:d/2-u,offsetY:d/2-u,visible:c&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Ri.Util._sign(a)-u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:a,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const m=this.anchorStyleFunc();m&&f.forEach(S=>{m(S)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Zp.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Qp.Node.prototype.toObject.call(this)}clone(t){var s=Qp.Node.prototype.clone.call(this,t);return s}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}zl.Transformer=yi,yi.isTransforming=()=>od>0;function a2(r){return r instanceof Array||Ri.Util.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(t){Hl.indexOf(t)===-1&&Ri.Util.warn("Unknown anchor name: "+t+". Available names are: "+Hl.join(", "))}),r||[]}yi.prototype.className="Transformer",(0,Qb._registerNode)(yi),Si.Factory.addGetterSetter(yi,"enabledAnchors",Hl,a2),Si.Factory.addGetterSetter(yi,"flipEnabled",!0,(0,Ls.getBooleanValidator)()),Si.Factory.addGetterSetter(yi,"resizeEnabled",!0),Si.Factory.addGetterSetter(yi,"anchorSize",10,(0,Ls.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"rotateEnabled",!0),Si.Factory.addGetterSetter(yi,"rotateLineVisible",!0),Si.Factory.addGetterSetter(yi,"rotationSnaps",[]),Si.Factory.addGetterSetter(yi,"rotateAnchorOffset",50,(0,Ls.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"rotateAnchorCursor","crosshair"),Si.Factory.addGetterSetter(yi,"rotationSnapTolerance",5,(0,Ls.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"borderEnabled",!0),Si.Factory.addGetterSetter(yi,"anchorStroke","rgb(0, 161, 255)"),Si.Factory.addGetterSetter(yi,"anchorStrokeWidth",1,(0,Ls.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"anchorFill","white"),Si.Factory.addGetterSetter(yi,"anchorCornerRadius",0,(0,Ls.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"borderStroke","rgb(0, 161, 255)"),Si.Factory.addGetterSetter(yi,"borderStrokeWidth",1,(0,Ls.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"borderDash"),Si.Factory.addGetterSetter(yi,"keepRatio",!0),Si.Factory.addGetterSetter(yi,"shiftBehavior","default"),Si.Factory.addGetterSetter(yi,"centeredScaling",!1),Si.Factory.addGetterSetter(yi,"ignoreStroke",!1),Si.Factory.addGetterSetter(yi,"padding",0,(0,Ls.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"node"),Si.Factory.addGetterSetter(yi,"nodes"),Si.Factory.addGetterSetter(yi,"boundBoxFunc"),Si.Factory.addGetterSetter(yi,"anchorDragBoundFunc"),Si.Factory.addGetterSetter(yi,"anchorStyleFunc"),Si.Factory.addGetterSetter(yi,"shouldOverdrawWholeArea",!1),Si.Factory.addGetterSetter(yi,"useSingleNodeRotation",!0),Si.Factory.backCompat(yi,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Bl={};Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.Wedge=void 0;const Ul=ai,o2=pr,l2=si,rg=De,h2=si;class cs extends o2.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,l2.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Bl.Wedge=cs,cs.prototype.className="Wedge",cs.prototype._centroid=!0,cs.prototype._attrsAffectingSize=["radius"],(0,h2._registerNode)(cs),Ul.Factory.addGetterSetter(cs,"radius",0,(0,rg.getNumberValidator)()),Ul.Factory.addGetterSetter(cs,"angle",0,(0,rg.getNumberValidator)()),Ul.Factory.addGetterSetter(cs,"clockwise",!1),Ul.Factory.backCompat(cs,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Gl={};Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.Blur=void 0;const ng=ai,c2=Wi,d2=De;function sg(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var u2=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],f2=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function p2(r,t){var s=r.data,n=r.width,a=r.height,o,c,u,d,f,m,S,_,v,b,x,A,F,M,g,w,E,C,B,I,rt,tt,st,wt,dt=t+t+1,Tt=n-1,Lt=a-1,Qt=t+1,ct=Qt*(Qt+1)/2,Dt=new sg,ee=null,zt=Dt,Jt=null,oe=null,ge=u2[t],Ae=f2[t];for(u=1;u<dt;u++)zt=zt.next=new sg,u===Qt&&(ee=zt);for(zt.next=Dt,S=m=0,c=0;c<a;c++){for(w=E=C=B=_=v=b=x=0,A=Qt*(I=s[m]),F=Qt*(rt=s[m+1]),M=Qt*(tt=s[m+2]),g=Qt*(st=s[m+3]),_+=ct*I,v+=ct*rt,b+=ct*tt,x+=ct*st,zt=Dt,u=0;u<Qt;u++)zt.r=I,zt.g=rt,zt.b=tt,zt.a=st,zt=zt.next;for(u=1;u<Qt;u++)d=m+((Tt<u?Tt:u)<<2),_+=(zt.r=I=s[d])*(wt=Qt-u),v+=(zt.g=rt=s[d+1])*wt,b+=(zt.b=tt=s[d+2])*wt,x+=(zt.a=st=s[d+3])*wt,w+=I,E+=rt,C+=tt,B+=st,zt=zt.next;for(Jt=Dt,oe=ee,o=0;o<n;o++)s[m+3]=st=x*ge>>Ae,st!==0?(st=255/st,s[m]=(_*ge>>Ae)*st,s[m+1]=(v*ge>>Ae)*st,s[m+2]=(b*ge>>Ae)*st):s[m]=s[m+1]=s[m+2]=0,_-=A,v-=F,b-=M,x-=g,A-=Jt.r,F-=Jt.g,M-=Jt.b,g-=Jt.a,d=S+((d=o+t+1)<Tt?d:Tt)<<2,w+=Jt.r=s[d],E+=Jt.g=s[d+1],C+=Jt.b=s[d+2],B+=Jt.a=s[d+3],_+=w,v+=E,b+=C,x+=B,Jt=Jt.next,A+=I=oe.r,F+=rt=oe.g,M+=tt=oe.b,g+=st=oe.a,w-=I,E-=rt,C-=tt,B-=st,oe=oe.next,m+=4;S+=n}for(o=0;o<n;o++){for(E=C=B=w=v=b=x=_=0,m=o<<2,A=Qt*(I=s[m]),F=Qt*(rt=s[m+1]),M=Qt*(tt=s[m+2]),g=Qt*(st=s[m+3]),_+=ct*I,v+=ct*rt,b+=ct*tt,x+=ct*st,zt=Dt,u=0;u<Qt;u++)zt.r=I,zt.g=rt,zt.b=tt,zt.a=st,zt=zt.next;for(f=n,u=1;u<=t;u++)m=f+o<<2,_+=(zt.r=I=s[m])*(wt=Qt-u),v+=(zt.g=rt=s[m+1])*wt,b+=(zt.b=tt=s[m+2])*wt,x+=(zt.a=st=s[m+3])*wt,w+=I,E+=rt,C+=tt,B+=st,zt=zt.next,u<Lt&&(f+=n);for(m=o,Jt=Dt,oe=ee,c=0;c<a;c++)d=m<<2,s[d+3]=st=x*ge>>Ae,st>0?(st=255/st,s[d]=(_*ge>>Ae)*st,s[d+1]=(v*ge>>Ae)*st,s[d+2]=(b*ge>>Ae)*st):s[d]=s[d+1]=s[d+2]=0,_-=A,v-=F,b-=M,x-=g,A-=Jt.r,F-=Jt.g,M-=Jt.b,g-=Jt.a,d=o+((d=c+Qt)<Lt?d:Lt)*n<<2,_+=w+=Jt.r=s[d],v+=E+=Jt.g=s[d+1],b+=C+=Jt.b=s[d+2],x+=B+=Jt.a=s[d+3],Jt=Jt.next,A+=I=oe.r,F+=rt=oe.g,M+=tt=oe.b,g+=st=oe.a,w-=I,E-=rt,C-=tt,B-=st,oe=oe.next,m+=n}}const g2=function(r){var t=Math.round(this.blurRadius());t>0&&p2(r,t)};Gl.Blur=g2,ng.Factory.addGetterSetter(c2.Node,"blurRadius",0,(0,d2.getNumberValidator)(),ng.Factory.afterSetFilter);var jl={};Object.defineProperty(jl,"__esModule",{value:!0}),jl.Brighten=void 0;const ag=ai,m2=Wi,v2=De,y2=function(r){var t=this.brightness()*255,s=r.data,n=s.length,a;for(a=0;a<n;a+=4)s[a]+=t,s[a+1]+=t,s[a+2]+=t};jl.Brighten=y2,ag.Factory.addGetterSetter(m2.Node,"brightness",0,(0,v2.getNumberValidator)(),ag.Factory.afterSetFilter);var Vl={};Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.Contrast=void 0;const og=ai,b2=Wi,_2=De,x2=function(r){var t=Math.pow((this.contrast()+100)/100,2),s=r.data,n=s.length,a=150,o=150,c=150,u;for(u=0;u<n;u+=4)a=s[u],o=s[u+1],c=s[u+2],a/=255,a-=.5,a*=t,a+=.5,a*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,c/=255,c-=.5,c*=t,c+=.5,c*=255,a=a<0?0:a>255?255:a,o=o<0?0:o>255?255:o,c=c<0?0:c>255?255:c,s[u]=a,s[u+1]=o,s[u+2]=c};Vl.Contrast=x2,og.Factory.addGetterSetter(b2.Node,"contrast",0,(0,_2.getNumberValidator)(),og.Factory.afterSetFilter);var Wl={};Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.Emboss=void 0;const Ds=ai,$l=Wi,w2=Qi,lg=De,A2=function(r){var t=this.embossStrength()*10,s=this.embossWhiteLevel()*255,n=this.embossDirection(),a=this.embossBlend(),o=0,c=0,u=r.data,d=r.width,f=r.height,m=d*4,S=f;switch(n){case"top-left":o=-1,c=-1;break;case"top":o=-1,c=0;break;case"top-right":o=-1,c=1;break;case"right":o=0,c=1;break;case"bottom-right":o=1,c=1;break;case"bottom":o=1,c=0;break;case"bottom-left":o=1,c=-1;break;case"left":o=0,c=-1;break;default:w2.Util.error("Unknown emboss direction: "+n)}do{var _=(S-1)*m,v=o;S+v<1&&(v=0),S+v>f&&(v=0);var b=(S-1+v)*d*4,x=d;do{var A=_+(x-1)*4,F=c;x+F<1&&(F=0),x+F>d&&(F=0);var M=b+(x-1+F)*4,g=u[A]-u[M],w=u[A+1]-u[M+1],E=u[A+2]-u[M+2],C=g,B=C>0?C:-C,I=w>0?w:-w,rt=E>0?E:-E;if(I>B&&(C=w),rt>B&&(C=E),C*=t,a){var tt=u[A]+C,st=u[A+1]+C,wt=u[A+2]+C;u[A]=tt>255?255:tt<0?0:tt,u[A+1]=st>255?255:st<0?0:st,u[A+2]=wt>255?255:wt<0?0:wt}else{var dt=s-C;dt<0?dt=0:dt>255&&(dt=255),u[A]=u[A+1]=u[A+2]=dt}}while(--x)}while(--S)};Wl.Emboss=A2,Ds.Factory.addGetterSetter($l.Node,"embossStrength",.5,(0,lg.getNumberValidator)(),Ds.Factory.afterSetFilter),Ds.Factory.addGetterSetter($l.Node,"embossWhiteLevel",.5,(0,lg.getNumberValidator)(),Ds.Factory.afterSetFilter),Ds.Factory.addGetterSetter($l.Node,"embossDirection","top-left",null,Ds.Factory.afterSetFilter),Ds.Factory.addGetterSetter($l.Node,"embossBlend",!1,null,Ds.Factory.afterSetFilter);var Kl={};Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.Enhance=void 0;const hg=ai,S2=Wi,E2=De;function ld(r,t,s,n,a){var o=s-t,c=a-n,u;return o===0?n+c/2:c===0?n:(u=(r-t)/o,u=c*u+n,u)}const C2=function(r){var t=r.data,s=t.length,n=t[0],a=n,o,c=t[1],u=c,d,f=t[2],m=f,S,_,v=this.enhance();if(v!==0){for(_=0;_<s;_+=4)o=t[_+0],o<n?n=o:o>a&&(a=o),d=t[_+1],d<c?c=d:d>u&&(u=d),S=t[_+2],S<f?f=S:S>m&&(m=S);a===n&&(a=255,n=0),u===c&&(u=255,c=0),m===f&&(m=255,f=0);var b,x,A,F,M,g,w,E,C;for(v>0?(x=a+v*(255-a),A=n-v*(n-0),M=u+v*(255-u),g=c-v*(c-0),E=m+v*(255-m),C=f-v*(f-0)):(b=(a+n)*.5,x=a+v*(a-b),A=n+v*(n-b),F=(u+c)*.5,M=u+v*(u-F),g=c+v*(c-F),w=(m+f)*.5,E=m+v*(m-w),C=f+v*(f-w)),_=0;_<s;_+=4)t[_+0]=ld(t[_+0],n,a,A,x),t[_+1]=ld(t[_+1],c,u,g,M),t[_+2]=ld(t[_+2],f,m,C,E)}};Kl.Enhance=C2,hg.Factory.addGetterSetter(S2.Node,"enhance",0,(0,E2.getNumberValidator)(),hg.Factory.afterSetFilter);var Xl={};Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.Grayscale=void 0;const k2=function(r){var t=r.data,s=t.length,n,a;for(n=0;n<s;n+=4)a=.34*t[n]+.5*t[n+1]+.16*t[n+2],t[n]=a,t[n+1]=a,t[n+2]=a};Xl.Grayscale=k2;var Yl={};Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.HSL=void 0;const za=ai,hd=Wi,cd=De;za.Factory.addGetterSetter(hd.Node,"hue",0,(0,cd.getNumberValidator)(),za.Factory.afterSetFilter),za.Factory.addGetterSetter(hd.Node,"saturation",0,(0,cd.getNumberValidator)(),za.Factory.afterSetFilter),za.Factory.addGetterSetter(hd.Node,"luminance",0,(0,cd.getNumberValidator)(),za.Factory.afterSetFilter);const T2=function(r){var t=r.data,s=t.length,n=1,a=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,c=this.luminance()*127,u,d=n*a*Math.cos(o*Math.PI/180),f=n*a*Math.sin(o*Math.PI/180),m=.299*n+.701*d+.167*f,S=.587*n-.587*d+.33*f,_=.114*n-.114*d-.497*f,v=.299*n-.299*d-.328*f,b=.587*n+.413*d+.035*f,x=.114*n-.114*d+.293*f,A=.299*n-.3*d+1.25*f,F=.587*n-.586*d-1.05*f,M=.114*n+.886*d-.2*f,g,w,E,C;for(u=0;u<s;u+=4)g=t[u+0],w=t[u+1],E=t[u+2],C=t[u+3],t[u+0]=m*g+S*w+_*E+c,t[u+1]=v*g+b*w+x*E+c,t[u+2]=A*g+F*w+M*E+c,t[u+3]=C};Yl.HSL=T2;var ql={};Object.defineProperty(ql,"__esModule",{value:!0}),ql.HSV=void 0;const Ha=ai,dd=Wi,ud=De,P2=function(r){var t=r.data,s=t.length,n=Math.pow(2,this.value()),a=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,c,u=n*a*Math.cos(o*Math.PI/180),d=n*a*Math.sin(o*Math.PI/180),f=.299*n+.701*u+.167*d,m=.587*n-.587*u+.33*d,S=.114*n-.114*u-.497*d,_=.299*n-.299*u-.328*d,v=.587*n+.413*u+.035*d,b=.114*n-.114*u+.293*d,x=.299*n-.3*u+1.25*d,A=.587*n-.586*u-1.05*d,F=.114*n+.886*u-.2*d,M,g,w,E;for(c=0;c<s;c+=4)M=t[c+0],g=t[c+1],w=t[c+2],E=t[c+3],t[c+0]=f*M+m*g+S*w,t[c+1]=_*M+v*g+b*w,t[c+2]=x*M+A*g+F*w,t[c+3]=E};ql.HSV=P2,Ha.Factory.addGetterSetter(dd.Node,"hue",0,(0,ud.getNumberValidator)(),Ha.Factory.afterSetFilter),Ha.Factory.addGetterSetter(dd.Node,"saturation",0,(0,ud.getNumberValidator)(),Ha.Factory.afterSetFilter),Ha.Factory.addGetterSetter(dd.Node,"value",0,(0,ud.getNumberValidator)(),Ha.Factory.afterSetFilter);var Ql={};Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.Invert=void 0;const M2=function(r){var t=r.data,s=t.length,n;for(n=0;n<s;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};Ql.Invert=M2;var Zl={};Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.Kaleidoscope=void 0;const Jl=ai,cg=Wi,dg=Qi,ug=De;var R2=function(r,t,s){var n=r.data,a=t.data,o=r.width,c=r.height,u=s.polarCenterX||o/2,d=s.polarCenterY||c/2,f,m,S,_=0,v=0,b=0,x=0,A,F=Math.sqrt(u*u+d*d);m=o-u,S=c-d,A=Math.sqrt(m*m+S*S),F=A>F?A:F;var M=c,g=o,w,E,C=360/g*Math.PI/180,B,I;for(E=0;E<g;E+=1)for(B=Math.sin(E*C),I=Math.cos(E*C),w=0;w<M;w+=1)m=Math.floor(u+F*w/M*I),S=Math.floor(d+F*w/M*B),f=(S*o+m)*4,_=n[f+0],v=n[f+1],b=n[f+2],x=n[f+3],f=(E+w*o)*4,a[f+0]=_,a[f+1]=v,a[f+2]=b,a[f+3]=x},F2=function(r,t,s){var n=r.data,a=t.data,o=r.width,c=r.height,u=s.polarCenterX||o/2,d=s.polarCenterY||c/2,f,m,S,_,v,b=0,x=0,A=0,F=0,M,g=Math.sqrt(u*u+d*d);m=o-u,S=c-d,M=Math.sqrt(m*m+S*S),g=M>g?M:g;var w=c,E=o,C,B,I=s.polarRotation||0,rt,tt;for(m=0;m<o;m+=1)for(S=0;S<c;S+=1)_=m-u,v=S-d,C=Math.sqrt(_*_+v*v)*w/g,B=(Math.atan2(v,_)*180/Math.PI+360+I)%360,B=B*E/360,rt=Math.floor(B),tt=Math.floor(C),f=(tt*o+rt)*4,b=n[f+0],x=n[f+1],A=n[f+2],F=n[f+3],f=(S*o+m)*4,a[f+0]=b,a[f+1]=x,a[f+2]=A,a[f+3]=F};const I2=function(r){var t=r.width,s=r.height,n,a,o,c,u,d,f,m,S,_,v=Math.round(this.kaleidoscopePower()),b=Math.round(this.kaleidoscopeAngle()),x=Math.floor(t*(b%360)/360);if(!(v<1)){var A=dg.Util.createCanvasElement();A.width=t,A.height=s;var F=A.getContext("2d").getImageData(0,0,t,s);dg.Util.releaseCanvas(A),R2(r,F,{polarCenterX:t/2,polarCenterY:s/2});for(var M=t/Math.pow(2,v);M<=8;)M=M*2,v-=1;M=Math.ceil(M);var g=M,w=0,E=g,C=1;for(x+M>t&&(w=g,E=0,C=-1),a=0;a<s;a+=1)for(n=w;n!==E;n+=C)o=Math.round(n+x)%t,S=(t*a+o)*4,u=F.data[S+0],d=F.data[S+1],f=F.data[S+2],m=F.data[S+3],_=(t*a+n)*4,F.data[_+0]=u,F.data[_+1]=d,F.data[_+2]=f,F.data[_+3]=m;for(a=0;a<s;a+=1)for(g=Math.floor(M),c=0;c<v;c+=1){for(n=0;n<g+1;n+=1)S=(t*a+n)*4,u=F.data[S+0],d=F.data[S+1],f=F.data[S+2],m=F.data[S+3],_=(t*a+g*2-n-1)*4,F.data[_+0]=u,F.data[_+1]=d,F.data[_+2]=f,F.data[_+3]=m;g*=2}F2(F,r,{polarRotation:0})}};Zl.Kaleidoscope=I2,Jl.Factory.addGetterSetter(cg.Node,"kaleidoscopePower",2,(0,ug.getNumberValidator)(),Jl.Factory.afterSetFilter),Jl.Factory.addGetterSetter(cg.Node,"kaleidoscopeAngle",0,(0,ug.getNumberValidator)(),Jl.Factory.afterSetFilter);var th={};Object.defineProperty(th,"__esModule",{value:!0}),th.Mask=void 0;const fg=ai,L2=Wi,D2=De;function eh(r,t,s){var n=(s*r.width+t)*4,a=[];return a.push(r.data[n++],r.data[n++],r.data[n++],r.data[n++]),a}function Ao(r,t){return Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2)+Math.pow(r[2]-t[2],2))}function N2(r){for(var t=[0,0,0],s=0;s<r.length;s++)t[0]+=r[s][0],t[1]+=r[s][1],t[2]+=r[s][2];return t[0]/=r.length,t[1]/=r.length,t[2]/=r.length,t}function O2(r,t){var s=eh(r,0,0),n=eh(r,r.width-1,0),a=eh(r,0,r.height-1),o=eh(r,r.width-1,r.height-1),c=t||10;if(Ao(s,n)<c&&Ao(n,o)<c&&Ao(o,a)<c&&Ao(a,s)<c){for(var u=N2([n,s,o,a]),d=[],f=0;f<r.width*r.height;f++){var m=Ao(u,[r.data[f*4],r.data[f*4+1],r.data[f*4+2]]);d[f]=m<c?0:255}return d}}function z2(r,t){for(var s=0;s<r.width*r.height;s++)r.data[4*s+3]=t[s]}function H2(r,t,s){for(var n=[1,1,1,1,0,1,1,1,1],a=Math.round(Math.sqrt(n.length)),o=Math.floor(a/2),c=[],u=0;u<s;u++)for(var d=0;d<t;d++){for(var f=u*t+d,m=0,S=0;S<a;S++)for(var _=0;_<a;_++){var v=u+S-o,b=d+_-o;if(v>=0&&v<s&&b>=0&&b<t){var x=v*t+b,A=n[S*a+_];m+=r[x]*A}}c[f]=m===255*8?255:0}return c}function B2(r,t,s){for(var n=[1,1,1,1,1,1,1,1,1],a=Math.round(Math.sqrt(n.length)),o=Math.floor(a/2),c=[],u=0;u<s;u++)for(var d=0;d<t;d++){for(var f=u*t+d,m=0,S=0;S<a;S++)for(var _=0;_<a;_++){var v=u+S-o,b=d+_-o;if(v>=0&&v<s&&b>=0&&b<t){var x=v*t+b,A=n[S*a+_];m+=r[x]*A}}c[f]=m>=255*4?255:0}return c}function U2(r,t,s){for(var n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],a=Math.round(Math.sqrt(n.length)),o=Math.floor(a/2),c=[],u=0;u<s;u++)for(var d=0;d<t;d++){for(var f=u*t+d,m=0,S=0;S<a;S++)for(var _=0;_<a;_++){var v=u+S-o,b=d+_-o;if(v>=0&&v<s&&b>=0&&b<t){var x=v*t+b,A=n[S*a+_];m+=r[x]*A}}c[f]=m}return c}const G2=function(r){var t=this.threshold(),s=O2(r,t);return s&&(s=H2(s,r.width,r.height),s=B2(s,r.width,r.height),s=U2(s,r.width,r.height),z2(r,s)),r};th.Mask=G2,fg.Factory.addGetterSetter(L2.Node,"threshold",0,(0,D2.getNumberValidator)(),fg.Factory.afterSetFilter);var ih={};Object.defineProperty(ih,"__esModule",{value:!0}),ih.Noise=void 0;const pg=ai,j2=Wi,V2=De,W2=function(r){var t=this.noise()*255,s=r.data,n=s.length,a=t/2,o;for(o=0;o<n;o+=4)s[o+0]+=a-2*a*Math.random(),s[o+1]+=a-2*a*Math.random(),s[o+2]+=a-2*a*Math.random()};ih.Noise=W2,pg.Factory.addGetterSetter(j2.Node,"noise",.2,(0,V2.getNumberValidator)(),pg.Factory.afterSetFilter);var rh={};Object.defineProperty(rh,"__esModule",{value:!0}),rh.Pixelate=void 0;const gg=ai,$2=Qi,K2=Wi,X2=De,Y2=function(r){var t=Math.ceil(this.pixelSize()),s=r.width,n=r.height,a,o,c,u,d,f,m,S=Math.ceil(s/t),_=Math.ceil(n/t),v,b,x,A,F,M,g,w=r.data;if(t<=0){$2.Util.error("pixelSize value can not be <= 0");return}for(F=0;F<S;F+=1)for(M=0;M<_;M+=1){for(u=0,d=0,f=0,m=0,v=F*t,b=v+t,x=M*t,A=x+t,g=0,a=v;a<b;a+=1)if(!(a>=s))for(o=x;o<A;o+=1)o>=n||(c=(s*o+a)*4,u+=w[c+0],d+=w[c+1],f+=w[c+2],m+=w[c+3],g+=1);for(u=u/g,d=d/g,f=f/g,m=m/g,a=v;a<b;a+=1)if(!(a>=s))for(o=x;o<A;o+=1)o>=n||(c=(s*o+a)*4,w[c+0]=u,w[c+1]=d,w[c+2]=f,w[c+3]=m)}};rh.Pixelate=Y2,gg.Factory.addGetterSetter(K2.Node,"pixelSize",8,(0,X2.getNumberValidator)(),gg.Factory.afterSetFilter);var nh={};Object.defineProperty(nh,"__esModule",{value:!0}),nh.Posterize=void 0;const mg=ai,q2=Wi,Q2=De,Z2=function(r){var t=Math.round(this.levels()*254)+1,s=r.data,n=s.length,a=255/t,o;for(o=0;o<n;o+=1)s[o]=Math.floor(s[o]/a)*a};nh.Posterize=Z2,mg.Factory.addGetterSetter(q2.Node,"levels",.5,(0,Q2.getNumberValidator)(),mg.Factory.afterSetFilter);var sh={};Object.defineProperty(sh,"__esModule",{value:!0}),sh.RGB=void 0;const ah=ai,fd=Wi,J2=De,t_=function(r){var t=r.data,s=t.length,n=this.red(),a=this.green(),o=this.blue(),c,u;for(c=0;c<s;c+=4)u=(.34*t[c]+.5*t[c+1]+.16*t[c+2])/255,t[c]=u*n,t[c+1]=u*a,t[c+2]=u*o,t[c+3]=t[c+3]};sh.RGB=t_,ah.Factory.addGetterSetter(fd.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),ah.Factory.addGetterSetter(fd.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),ah.Factory.addGetterSetter(fd.Node,"blue",0,J2.RGBComponent,ah.Factory.afterSetFilter);var oh={};Object.defineProperty(oh,"__esModule",{value:!0}),oh.RGBA=void 0;const So=ai,lh=Wi,e_=De,i_=function(r){var t=r.data,s=t.length,n=this.red(),a=this.green(),o=this.blue(),c=this.alpha(),u,d;for(u=0;u<s;u+=4)d=1-c,t[u]=n*c+t[u]*d,t[u+1]=a*c+t[u+1]*d,t[u+2]=o*c+t[u+2]*d};oh.RGBA=i_,So.Factory.addGetterSetter(lh.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),So.Factory.addGetterSetter(lh.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),So.Factory.addGetterSetter(lh.Node,"blue",0,e_.RGBComponent,So.Factory.afterSetFilter),So.Factory.addGetterSetter(lh.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});var hh={};Object.defineProperty(hh,"__esModule",{value:!0}),hh.Sepia=void 0;const r_=function(r){var t=r.data,s=t.length,n,a,o,c;for(n=0;n<s;n+=4)a=t[n+0],o=t[n+1],c=t[n+2],t[n+0]=Math.min(255,a*.393+o*.769+c*.189),t[n+1]=Math.min(255,a*.349+o*.686+c*.168),t[n+2]=Math.min(255,a*.272+o*.534+c*.131)};hh.Sepia=r_;var ch={};Object.defineProperty(ch,"__esModule",{value:!0}),ch.Solarize=void 0;const n_=function(r){var t=r.data,s=r.width,n=r.height,a=s*4,o=n;do{var c=(o-1)*a,u=s;do{var d=c+(u-1)*4,f=t[d],m=t[d+1],S=t[d+2];f>127&&(f=255-f),m>127&&(m=255-m),S>127&&(S=255-S),t[d]=f,t[d+1]=m,t[d+2]=S}while(--u)}while(--o)};ch.Solarize=n_;var dh={};Object.defineProperty(dh,"__esModule",{value:!0}),dh.Threshold=void 0;const vg=ai,s_=Wi,a_=De,o_=function(r){var t=this.threshold()*255,s=r.data,n=s.length,a;for(a=0;a<n;a+=1)s[a]=s[a]<t?0:255};dh.Threshold=o_,vg.Factory.addGetterSetter(s_.Node,"threshold",.5,(0,a_.getNumberValidator)(),vg.Factory.afterSetFilter),Object.defineProperty(hl,"__esModule",{value:!0}),hl.Konva=void 0;const yg=cl,l_=xl,h_=Sl,c_=kl,d_=Tl,u_=Pl,bg=Na,f_=yo,p_=Ia,g_=_o,m_=Fl,v_=Il,y_=Ll,b_=Dl,__=oa,x_=Ol,w_=zl,A_=Bl,S_=Gl,E_=jl,C_=Vl,k_=Wl,T_=Kl,P_=Xl,M_=Yl,R_=ql,F_=Ql,I_=Zl,L_=th,D_=ih,N_=rh,O_=nh,z_=sh,H_=oh,B_=hh,U_=ch,G_=dh;hl.Konva=yg.Konva.Util._assign(yg.Konva,{Arc:l_.Arc,Arrow:h_.Arrow,Circle:c_.Circle,Ellipse:d_.Ellipse,Image:u_.Image,Label:bg.Label,Tag:bg.Tag,Line:f_.Line,Path:p_.Path,Rect:g_.Rect,RegularPolygon:m_.RegularPolygon,Ring:v_.Ring,Sprite:y_.Sprite,Star:b_.Star,Text:__.Text,TextPath:x_.TextPath,Transformer:w_.Transformer,Wedge:A_.Wedge,Filters:{Blur:S_.Blur,Brighten:E_.Brighten,Contrast:C_.Contrast,Emboss:k_.Emboss,Enhance:T_.Enhance,Grayscale:P_.Grayscale,HSL:M_.HSL,HSV:R_.HSV,Invert:F_.Invert,Kaleidoscope:I_.Kaleidoscope,Mask:L_.Mask,Noise:D_.Noise,Pixelate:N_.Pixelate,Posterize:O_.Posterize,RGB:z_.RGB,RGBA:H_.RGBA,Sepia:B_.Sepia,Solarize:U_.Solarize,Threshold:G_.Threshold}}),Object.defineProperty(np.exports,"__esModule",{value:!0});const j_=hl;np.exports=j_.Konva;var pd={exports:{}};(function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var s=cl;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return s.Konva}});const n=cl;r.exports=n.Konva})(pd,pd.exports);const Eo=o0(pd.exports);var _g={exports:{}},V_=function(r){var t={},s=Ni.exports,n=Wh.exports,a=Object.assign;function o(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,h=1;h<arguments.length;h++)i+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),d=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),v=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),w=Symbol.iterator;function E(e){return e===null||typeof e!="object"?null:(e=w&&e[w]||e["@@iterator"],typeof e=="function"?e:null)}function C(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case f:return"Fragment";case d:return"Portal";case S:return"Profiler";case m:return"StrictMode";case x:return"Suspense";case A:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case v:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case b:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case F:return i=e.displayName||null,i!==null?i:C(e.type)||"Memo";case M:i=e._payload,e=e._init;try{return C(e(i))}catch{}}return null}function B(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return C(i);case 8:return i===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function I(e){var i=e,h=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(h=i.return),e=i.return;while(e)}return i.tag===3?h:null}function rt(e){if(I(e)!==e)throw Error(o(188))}function tt(e){var i=e.alternate;if(!i){if(i=I(e),i===null)throw Error(o(188));return i!==e?null:e}for(var h=e,p=i;;){var y=h.return;if(y===null)break;var P=y.alternate;if(P===null){if(p=y.return,p!==null){h=p;continue}break}if(y.child===P.child){for(P=y.child;P;){if(P===h)return rt(y),e;if(P===p)return rt(y),i;P=P.sibling}throw Error(o(188))}if(h.return!==p.return)h=y,p=P;else{for(var it=!1,Ct=y.child;Ct;){if(Ct===h){it=!0,h=y,p=P;break}if(Ct===p){it=!0,p=y,h=P;break}Ct=Ct.sibling}if(!it){for(Ct=P.child;Ct;){if(Ct===h){it=!0,h=P,p=y;break}if(Ct===p){it=!0,p=P,h=y;break}Ct=Ct.sibling}if(!it)throw Error(o(189))}}if(h.alternate!==p)throw Error(o(190))}if(h.tag!==3)throw Error(o(188));return h.stateNode.current===h?e:i}function st(e){return e=tt(e),e!==null?wt(e):null}function wt(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=wt(e);if(i!==null)return i;e=e.sibling}return null}function dt(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){if(e.tag!==4){var i=dt(e);if(i!==null)return i}e=e.sibling}return null}var Tt=Array.isArray,Lt=r.getPublicInstance,Qt=r.getRootHostContext,ct=r.getChildHostContext,Dt=r.prepareForCommit,ee=r.resetAfterCommit,zt=r.createInstance,Jt=r.appendInitialChild,oe=r.finalizeInitialChildren,ge=r.prepareUpdate,Ae=r.shouldSetTextContent,Ve=r.createTextInstance,Gt=r.scheduleTimeout,lt=r.cancelTimeout,Ft=r.noTimeout,Wt=r.isPrimaryRenderer,ve=r.supportsMutation,ie=r.supportsPersistence,xe=r.supportsHydration,_e=r.getInstanceFromNode,ut=r.preparePortalMount,T=r.getCurrentEventPriority,R=r.detachDeletedInstance,D=r.supportsMicrotasks,H=r.scheduleMicrotask,L=r.supportsTestSelectors,V=r.findFiberRoot,j=r.getBoundingRect,G=r.getTextContent,W=r.isHiddenSubtree,U=r.matchAccessibilityRole,O=r.setFocusIfFocusable,z=r.setupIntersectionObserver,et=r.appendChild,nt=r.appendChildToContainer,gt=r.commitTextUpdate,yt=r.commitMount,Nt=r.commitUpdate,Ht=r.insertBefore,Pt=r.insertInContainerBefore,Bt=r.removeChild,Z=r.removeChildFromContainer,at=r.resetTextContent,_t=r.hideInstance,vt=r.hideTextInstance,jt=r.unhideInstance,bt=r.unhideTextInstance,q=r.clearContainer,ot=r.cloneInstance,ft=r.createContainerChildSet,Et=r.appendChildToContainerChildSet,Kt=r.finalizeContainerChildren,te=r.replaceContainerChildren,me=r.cloneHiddenInstance,Pe=r.cloneHiddenTextInstance,Ti=r.canHydrateInstance,je=r.canHydrateTextInstance,hi=r.canHydrateSuspenseInstance,ze=r.isSuspenseInstancePending,vi=r.isSuspenseInstanceFallback,oi=r.getSuspenseInstanceFallbackErrorDetails,er=r.registerSuspenseInstanceRetry,bi=r.getNextHydratableSibling,Me=r.getFirstHydratableChild,Q=r.getFirstHydratableChildWithinContainer,K=r.getFirstHydratableChildWithinSuspenseInstance,ht=r.hydrateInstance,xt=r.hydrateTextInstance,St=r.hydrateSuspenseInstance,It=r.getNextHydratableInstanceAfterSuspenseInstance,Ot=r.commitHydratedContainer,ye=r.commitHydratedSuspenseInstance,le=r.clearSuspenseBoundary,$t=r.clearSuspenseBoundaryFromContainer,ne=r.shouldDeleteUnhydratedTailInstances,ue=r.didNotMatchHydratedContainerTextInstance,he=r.didNotMatchHydratedTextInstance,Le;function we(e){if(Le===void 0)try{throw Error()}catch(h){var i=h.stack.trim().match(/\n( *(at )?)/);Le=i&&i[1]||""}return`
`+Le+e}var He=!1;function Ue(e,i){if(!e||He)return"";He=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(pe){var p=pe}Reflect.construct(e,[],i)}else{try{i.call()}catch(pe){p=pe}e.call(i.prototype)}else{try{throw Error()}catch(pe){p=pe}e()}}catch(pe){if(pe&&p&&typeof pe.stack=="string"){for(var y=pe.stack.split(`
`),P=p.stack.split(`
`),it=y.length-1,Ct=P.length-1;1<=it&&0<=Ct&&y[it]!==P[Ct];)Ct--;for(;1<=it&&0<=Ct;it--,Ct--)if(y[it]!==P[Ct]){if(it!==1||Ct!==1)do if(it--,Ct--,0>Ct||y[it]!==P[Ct]){var Vt=`
`+y[it].replace(" at new "," at ");return e.displayName&&Vt.includes("<anonymous>")&&(Vt=Vt.replace("<anonymous>",e.displayName)),Vt}while(1<=it&&0<=Ct);break}}}finally{He=!1,Error.prepareStackTrace=h}return(e=e?e.displayName||e.name:"")?we(e):""}var zi=Object.prototype.hasOwnProperty,ei=[],lr=-1;function Hi(e){return{current:e}}function qe(e){0>lr||(e.current=ei[lr],ei[lr]=null,lr--)}function $(e,i){lr++,ei[lr]=e.current,e.current=i}var At={},Zt=Hi(At),ae=Hi(!1),de=At;function Ce(e,i){var h=e.type.contextTypes;if(!h)return At;var p=e.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===i)return p.__reactInternalMemoizedMaskedChildContext;var y={},P;for(P in h)y[P]=i[P];return p&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=y),y}function Se(e){return e=e.childContextTypes,e!=null}function ri(){qe(ae),qe(Zt)}function ci(e,i,h){if(Zt.current!==At)throw Error(o(168));$(Zt,i),$(ae,h)}function vr(e,i,h){var p=e.stateNode;if(i=i.childContextTypes,typeof p.getChildContext!="function")return h;p=p.getChildContext();for(var y in p)if(!(y in i))throw Error(o(108,B(e)||"Unknown",y));return a({},h,p)}function Bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||At,de=Zt.current,$(Zt,e),$(ae,ae.current),!0}function qr(e,i,h){var p=e.stateNode;if(!p)throw Error(o(169));h?(e=vr(e,i,de),p.__reactInternalMemoizedMergedChildContext=e,qe(ae),qe(Zt),$(Zt,e)):qe(ae),$(ae,h)}var Ar=Math.clz32?Math.clz32:Xx,fh=Math.log,ds=Math.LN2;function Xx(e){return e>>>=0,e===0?32:31-(fh(e)/ds|0)|0}var us=64,ph=4194304;function jr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function gh(e,i){var h=e.pendingLanes;if(h===0)return 0;var p=0,y=e.suspendedLanes,P=e.pingedLanes,it=h&268435455;if(it!==0){var Ct=it&~y;Ct!==0?p=jr(Ct):(P&=it,P!==0&&(p=jr(P)))}else it=h&~y,it!==0?p=jr(it):P!==0&&(p=jr(P));if(p===0)return 0;if(i!==0&&i!==p&&!(i&y)&&(y=p&-p,P=i&-i,y>=P||y===16&&(P&4194240)!==0))return i;if(p&4&&(p|=h&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=p;0<i;)h=31-Ar(i),y=1<<h,p|=e[h],i&=~y;return p}function ha(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yx(e,i){for(var h=e.suspendedLanes,p=e.pingedLanes,y=e.expirationTimes,P=e.pendingLanes;0<P;){var it=31-Ar(P),Ct=1<<it,Vt=y[it];Vt===-1?(!(Ct&h)||Ct&p)&&(y[it]=ha(Ct,i)):Vt<=i&&(e.expiredLanes|=Ct),P&=~Ct}}function Wn(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Hg(){var e=us;return us<<=1,!(us&4194240)&&(us=64),e}function $n(e){for(var i=[],h=0;31>h;h++)i.push(e);return i}function ko(e,i,h){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-Ar(i),e[i]=h}function Kn(e,i){var h=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var p=e.eventTimes;for(e=e.expirationTimes;0<h;){var y=31-Ar(h),P=1<<y;i[y]=0,p[y]=-1,e[y]=-1,h&=~P}}function wd(e,i){var h=e.entangledLanes|=i;for(e=e.entanglements;h;){var p=31-Ar(h),y=1<<p;y&i|e[p]&i&&(e[p]|=i),h&=~y}}var di=0;function Bg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Xn=n.unstable_scheduleCallback,Ug=n.unstable_cancelCallback,Ba=n.unstable_shouldYield,qx=n.unstable_requestPaint,$i=n.unstable_now,Ad=n.unstable_ImmediatePriority,Ua=n.unstable_UserBlockingPriority,Sd=n.unstable_NormalPriority,Ga=n.unstable_IdlePriority,mh=null,Dr=null;function Qx(e){if(Dr&&typeof Dr.onCommitFiberRoot=="function")try{Dr.onCommitFiberRoot(mh,e,void 0,(e.current.flags&128)===128)}catch{}}function Os(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var Pn=typeof Object.is=="function"?Object.is:Os,Tr=null,vh=!1,ar=!1;function hr(e){Tr===null?Tr=[e]:Tr.push(e)}function yr(e){vh=!0,hr(e)}function br(){if(!ar&&Tr!==null){ar=!0;var e=0,i=di;try{var h=Tr;for(di=1;e<h.length;e++){var p=h[e];do p=p(!0);while(p!==null)}Tr=null,vh=!1}catch(y){throw Tr!==null&&(Tr=Tr.slice(e+1)),Xn(Ad,br),y}finally{di=i,ar=!1}}return null}var Nr=[],Vr=0,Mn=null,Wr=0,cr=[],Zi=0,_r=null,$r=1,Pr="";function ca(e,i){Nr[Vr++]=Wr,Nr[Vr++]=Mn,Mn=e,Wr=i}function Yn(e,i,h){cr[Zi++]=$r,cr[Zi++]=Pr,cr[Zi++]=_r,_r=e;var p=$r;e=Pr;var y=32-Ar(p)-1;p&=~(1<<y),h+=1;var P=32-Ar(i)+y;if(30<P){var it=y-y%5;P=(p&(1<<it)-1).toString(32),p>>=it,y-=it,$r=1<<32-Ar(i)+y|h<<y|p,Pr=P+e}else $r=1<<P|h<<y|p,Pr=e}function Ed(e){e.return!==null&&(ca(e,1),Yn(e,1,0))}function qn(e){for(;e===Mn;)Mn=Nr[--Vr],Nr[Vr]=null,Wr=Nr[--Vr],Nr[Vr]=null;for(;e===_r;)_r=cr[--Zi],cr[Zi]=null,Pr=cr[--Zi],cr[Zi]=null,$r=cr[--Zi],cr[Zi]=null}var on=null,Sr=null,Ki=!1,Qn=!1,Rn=null;function da(e,i){var h=xn(5,null,null,0);h.elementType="DELETED",h.stateNode=i,h.return=e,i=e.deletions,i===null?(e.deletions=[h],e.flags|=16):i.push(h)}function Gg(e,i){switch(e.tag){case 5:return i=Ti(i,e.type,e.pendingProps),i!==null?(e.stateNode=i,on=e,Sr=Me(i),!0):!1;case 6:return i=je(i,e.pendingProps),i!==null?(e.stateNode=i,on=e,Sr=null,!0):!1;case 13:if(i=hi(i),i!==null){var h=_r!==null?{id:$r,overflow:Pr}:null;return e.memoizedState={dehydrated:i,treeContext:h,retryLane:1073741824},h=xn(18,null,null,0),h.stateNode=i,h.return=e,e.child=h,on=e,Sr=null,!0}return!1;default:return!1}}function fs(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Cd(e){if(Ki){var i=Sr;if(i){var h=i;if(!Gg(e,i)){if(fs(e))throw Error(o(418));i=bi(h);var p=on;i&&Gg(e,i)?da(p,h):(e.flags=e.flags&-4097|2,Ki=!1,on=e)}}else{if(fs(e))throw Error(o(418));e.flags=e.flags&-4097|2,Ki=!1,on=e}}}function ps(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;on=e}function yh(e){if(!xe||e!==on)return!1;if(!Ki)return ps(e),Ki=!0,!1;if(e.tag!==3&&(e.tag!==5||ne(e.type)&&!Ae(e.type,e.memoizedProps))){var i=Sr;if(i){if(fs(e))throw ua(),Error(o(418));for(;i;)da(e,i),i=bi(i)}}if(ps(e),e.tag===13){if(!xe)throw Error(o(316));if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Sr=It(e)}else Sr=on?bi(e.stateNode):null;return!0}function ua(){for(var e=Sr;e;)e=bi(e)}function ja(){xe&&(Sr=on=null,Qn=Ki=!1)}function fa(e){Rn===null?Rn=[e]:Rn.push(e)}var gs=c.ReactCurrentBatchConfig;function Fn(e,i){if(Pn(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var h=Object.keys(e),p=Object.keys(i);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var y=h[p];if(!zi.call(i,y)||!Pn(e[y],i[y]))return!1}return!0}function gn(e){switch(e.tag){case 5:return we(e.type);case 16:return we("Lazy");case 13:return we("Suspense");case 19:return we("SuspenseList");case 0:case 2:case 15:return e=Ue(e.type,!1),e;case 11:return e=Ue(e.type.render,!1),e;case 1:return e=Ue(e.type,!0),e;default:return""}}function ln(e,i,h){if(e=h.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(o(309));var p=h.stateNode}if(!p)throw Error(o(147,e));var y=p,P=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===P?i.ref:(i=function(it){var Ct=y.refs;it===null?delete Ct[P]:Ct[P]=it},i._stringRef=P,i)}if(typeof e!="string")throw Error(o(284));if(!h._owner)throw Error(o(290,e))}return e}function Qr(e,i){throw e=Object.prototype.toString.call(i),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function mn(e){var i=e._init;return i(e._payload)}function vn(e){function i(Ut,Mt){if(e){var Yt=Ut.deletions;Yt===null?(Ut.deletions=[Mt],Ut.flags|=16):Yt.push(Mt)}}function h(Ut,Mt){if(!e)return null;for(;Mt!==null;)i(Ut,Mt),Mt=Mt.sibling;return null}function p(Ut,Mt){for(Ut=new Map;Mt!==null;)Mt.key!==null?Ut.set(Mt.key,Mt):Ut.set(Mt.index,Mt),Mt=Mt.sibling;return Ut}function y(Ut,Mt){return Ut=Vs(Ut,Mt),Ut.index=0,Ut.sibling=null,Ut}function P(Ut,Mt,Yt){return Ut.index=Yt,e?(Yt=Ut.alternate,Yt!==null?(Yt=Yt.index,Yt<Mt?(Ut.flags|=2,Mt):Yt):(Ut.flags|=2,Mt)):(Ut.flags|=1048576,Mt)}function it(Ut){return e&&Ut.alternate===null&&(Ut.flags|=2),Ut}function Ct(Ut,Mt,Yt,Te){return Mt===null||Mt.tag!==6?(Mt=hu(Yt,Ut.mode,Te),Mt.return=Ut,Mt):(Mt=y(Mt,Yt),Mt.return=Ut,Mt)}function Vt(Ut,Mt,Yt,Te){var Ge=Yt.type;return Ge===f?Ie(Ut,Mt,Yt.props.children,Te,Yt.key):Mt!==null&&(Mt.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===M&&mn(Ge)===Mt.type)?(Te=y(Mt,Yt.props),Te.ref=ln(Ut,Mt,Yt),Te.return=Ut,Te):(Te=Gh(Yt.type,Yt.key,Yt.props,null,Ut.mode,Te),Te.ref=ln(Ut,Mt,Yt),Te.return=Ut,Te)}function pe(Ut,Mt,Yt,Te){return Mt===null||Mt.tag!==4||Mt.stateNode.containerInfo!==Yt.containerInfo||Mt.stateNode.implementation!==Yt.implementation?(Mt=cu(Yt,Ut.mode,Te),Mt.return=Ut,Mt):(Mt=y(Mt,Yt.children||[]),Mt.return=Ut,Mt)}function Ie(Ut,Mt,Yt,Te,Ge){return Mt===null||Mt.tag!==7?(Mt=_a(Yt,Ut.mode,Te,Ge),Mt.return=Ut,Mt):(Mt=y(Mt,Yt),Mt.return=Ut,Mt)}function Ze(Ut,Mt,Yt){if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number")return Mt=hu(""+Mt,Ut.mode,Yt),Mt.return=Ut,Mt;if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case u:return Yt=Gh(Mt.type,Mt.key,Mt.props,null,Ut.mode,Yt),Yt.ref=ln(Ut,null,Mt),Yt.return=Ut,Yt;case d:return Mt=cu(Mt,Ut.mode,Yt),Mt.return=Ut,Mt;case M:var Te=Mt._init;return Ze(Ut,Te(Mt._payload),Yt)}if(Tt(Mt)||E(Mt))return Mt=_a(Mt,Ut.mode,Yt,null),Mt.return=Ut,Mt;Qr(Ut,Mt)}return null}function ke(Ut,Mt,Yt,Te){var Ge=Mt!==null?Mt.key:null;if(typeof Yt=="string"&&Yt!==""||typeof Yt=="number")return Ge!==null?null:Ct(Ut,Mt,""+Yt,Te);if(typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case u:return Yt.key===Ge?Vt(Ut,Mt,Yt,Te):null;case d:return Yt.key===Ge?pe(Ut,Mt,Yt,Te):null;case M:return Ge=Yt._init,ke(Ut,Mt,Ge(Yt._payload),Te)}if(Tt(Yt)||E(Yt))return Ge!==null?null:Ie(Ut,Mt,Yt,Te,null);Qr(Ut,Yt)}return null}function Gi(Ut,Mt,Yt,Te,Ge){if(typeof Te=="string"&&Te!==""||typeof Te=="number")return Ut=Ut.get(Yt)||null,Ct(Mt,Ut,""+Te,Ge);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case u:return Ut=Ut.get(Te.key===null?Yt:Te.key)||null,Vt(Mt,Ut,Te,Ge);case d:return Ut=Ut.get(Te.key===null?Yt:Te.key)||null,pe(Mt,Ut,Te,Ge);case M:var ni=Te._init;return Gi(Ut,Mt,Yt,ni(Te._payload),Ge)}if(Tt(Te)||E(Te))return Ut=Ut.get(Yt)||null,Ie(Mt,Ut,Te,Ge,null);Qr(Mt,Te)}return null}function Di(Ut,Mt,Yt,Te){for(var Ge=null,ni=null,Je=Mt,wi=Mt=0,kr=null;Je!==null&&wi<Yt.length;wi++){Je.index>wi?(kr=Je,Je=null):kr=Je.sibling;var Ai=ke(Ut,Je,Yt[wi],Te);if(Ai===null){Je===null&&(Je=kr);break}e&&Je&&Ai.alternate===null&&i(Ut,Je),Mt=P(Ai,Mt,wi),ni===null?Ge=Ai:ni.sibling=Ai,ni=Ai,Je=kr}if(wi===Yt.length)return h(Ut,Je),Ki&&ca(Ut,wi),Ge;if(Je===null){for(;wi<Yt.length;wi++)Je=Ze(Ut,Yt[wi],Te),Je!==null&&(Mt=P(Je,Mt,wi),ni===null?Ge=Je:ni.sibling=Je,ni=Je);return Ki&&ca(Ut,wi),Ge}for(Je=p(Ut,Je);wi<Yt.length;wi++)kr=Gi(Je,Ut,wi,Yt[wi],Te),kr!==null&&(e&&kr.alternate!==null&&Je.delete(kr.key===null?wi:kr.key),Mt=P(kr,Mt,wi),ni===null?Ge=kr:ni.sibling=kr,ni=kr);return e&&Je.forEach(function(Ws){return i(Ut,Ws)}),Ki&&ca(Ut,wi),Ge}function en(Ut,Mt,Yt,Te){var Ge=E(Yt);if(typeof Ge!="function")throw Error(o(150));if(Yt=Ge.call(Yt),Yt==null)throw Error(o(151));for(var ni=Ge=null,Je=Mt,wi=Mt=0,kr=null,Ai=Yt.next();Je!==null&&!Ai.done;wi++,Ai=Yt.next()){Je.index>wi?(kr=Je,Je=null):kr=Je.sibling;var Ws=ke(Ut,Je,Ai.value,Te);if(Ws===null){Je===null&&(Je=kr);break}e&&Je&&Ws.alternate===null&&i(Ut,Je),Mt=P(Ws,Mt,wi),ni===null?Ge=Ws:ni.sibling=Ws,ni=Ws,Je=kr}if(Ai.done)return h(Ut,Je),Ki&&ca(Ut,wi),Ge;if(Je===null){for(;!Ai.done;wi++,Ai=Yt.next())Ai=Ze(Ut,Ai.value,Te),Ai!==null&&(Mt=P(Ai,Mt,wi),ni===null?Ge=Ai:ni.sibling=Ai,ni=Ai);return Ki&&ca(Ut,wi),Ge}for(Je=p(Ut,Je);!Ai.done;wi++,Ai=Yt.next())Ai=Gi(Je,Ut,wi,Ai.value,Te),Ai!==null&&(e&&Ai.alternate!==null&&Je.delete(Ai.key===null?wi:Ai.key),Mt=P(Ai,Mt,wi),ni===null?Ge=Ai:ni.sibling=Ai,ni=Ai);return e&&Je.forEach(function(Cw){return i(Ut,Cw)}),Ki&&ca(Ut,wi),Ge}function xs(Ut,Mt,Yt,Te){if(typeof Yt=="object"&&Yt!==null&&Yt.type===f&&Yt.key===null&&(Yt=Yt.props.children),typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case u:t:{for(var Ge=Yt.key,ni=Mt;ni!==null;){if(ni.key===Ge){if(Ge=Yt.type,Ge===f){if(ni.tag===7){h(Ut,ni.sibling),Mt=y(ni,Yt.props.children),Mt.return=Ut,Ut=Mt;break t}}else if(ni.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===M&&mn(Ge)===ni.type){h(Ut,ni.sibling),Mt=y(ni,Yt.props),Mt.ref=ln(Ut,ni,Yt),Mt.return=Ut,Ut=Mt;break t}h(Ut,ni);break}else i(Ut,ni);ni=ni.sibling}Yt.type===f?(Mt=_a(Yt.props.children,Ut.mode,Te,Yt.key),Mt.return=Ut,Ut=Mt):(Te=Gh(Yt.type,Yt.key,Yt.props,null,Ut.mode,Te),Te.ref=ln(Ut,Mt,Yt),Te.return=Ut,Ut=Te)}return it(Ut);case d:t:{for(ni=Yt.key;Mt!==null;){if(Mt.key===ni)if(Mt.tag===4&&Mt.stateNode.containerInfo===Yt.containerInfo&&Mt.stateNode.implementation===Yt.implementation){h(Ut,Mt.sibling),Mt=y(Mt,Yt.children||[]),Mt.return=Ut,Ut=Mt;break t}else{h(Ut,Mt);break}else i(Ut,Mt);Mt=Mt.sibling}Mt=cu(Yt,Ut.mode,Te),Mt.return=Ut,Ut=Mt}return it(Ut);case M:return ni=Yt._init,xs(Ut,Mt,ni(Yt._payload),Te)}if(Tt(Yt))return Di(Ut,Mt,Yt,Te);if(E(Yt))return en(Ut,Mt,Yt,Te);Qr(Ut,Yt)}return typeof Yt=="string"&&Yt!==""||typeof Yt=="number"?(Yt=""+Yt,Mt!==null&&Mt.tag===6?(h(Ut,Mt.sibling),Mt=y(Mt,Yt),Mt.return=Ut,Ut=Mt):(h(Ut,Mt),Mt=hu(Yt,Ut.mode,Te),Mt.return=Ut,Ut=Mt),it(Ut)):h(Ut,Mt)}return xs}var dr=vn(!0),In=vn(!1),Ln=Hi(null),Dn=null,ir=null,Oe=null;function yn(){Oe=ir=Dn=null}function pa(e,i,h){Wt?($(Ln,i._currentValue),i._currentValue=h):($(Ln,i._currentValue2),i._currentValue2=h)}function kd(e){var i=Ln.current;qe(Ln),Wt?e._currentValue=i:e._currentValue2=i}function ms(e,i,h){for(;e!==null;){var p=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,p!==null&&(p.childLanes|=i)):p!==null&&(p.childLanes&i)!==i&&(p.childLanes|=i),e===h)break;e=e.return}}function Va(e,i){Dn=e,Oe=ir=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(Zr=!0),e.firstContext=null)}function Er(e){var i=Wt?e._currentValue:e._currentValue2;if(Oe!==e)if(e={context:e,memoizedValue:i,next:null},ir===null){if(Dn===null)throw Error(o(308));ir=e,Dn.dependencies={lanes:0,firstContext:e}}else ir=ir.next=e;return i}var ga=null;function vs(e){ga===null?ga=[e]:ga.push(e)}function jg(e,i,h,p){var y=i.interleaved;return y===null?(h.next=h,vs(i)):(h.next=y.next,y.next=h),i.interleaved=h,Mr(e,p)}function Mr(e,i){e.lanes|=i;var h=e.alternate;for(h!==null&&(h.lanes|=i),h=e,e=e.return;e!==null;)e.childLanes|=i,h=e.alternate,h!==null&&(h.childLanes|=i),h=e,e=e.return;return h.tag===3?h.stateNode:null}var zs=!1;function hn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vg(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kt(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function k(e,i,h){var p=e.updateQueue;if(p===null)return null;if(p=p.shared,fi&2){var y=p.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),p.pending=i,Mr(e,h)}return y=p.interleaved,y===null?(i.next=i,vs(p)):(i.next=y.next,y.next=i),p.interleaved=i,Mr(e,h)}function X(e,i,h){if(i=i.updateQueue,i!==null&&(i=i.shared,(h&4194240)!==0)){var p=i.lanes;p&=e.pendingLanes,h|=p,i.lanes=h,wd(e,h)}}function pt(e,i){var h=e.updateQueue,p=e.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var y=null,P=null;if(h=h.firstBaseUpdate,h!==null){do{var it={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};P===null?y=P=it:P=P.next=it,h=h.next}while(h!==null);P===null?y=P=i:P=P.next=i}else y=P=i;h={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:P,shared:p.shared,effects:p.effects},e.updateQueue=h;return}e=h.lastBaseUpdate,e===null?h.firstBaseUpdate=i:e.next=i,h.lastBaseUpdate=i}function mt(e,i,h,p){var y=e.updateQueue;zs=!1;var P=y.firstBaseUpdate,it=y.lastBaseUpdate,Ct=y.shared.pending;if(Ct!==null){y.shared.pending=null;var Vt=Ct,pe=Vt.next;Vt.next=null,it===null?P=pe:it.next=pe,it=Vt;var Ie=e.alternate;Ie!==null&&(Ie=Ie.updateQueue,Ct=Ie.lastBaseUpdate,Ct!==it&&(Ct===null?Ie.firstBaseUpdate=pe:Ct.next=pe,Ie.lastBaseUpdate=Vt))}if(P!==null){var Ze=y.baseState;it=0,Ie=pe=Vt=null,Ct=P;do{var ke=Ct.lane,Gi=Ct.eventTime;if((p&ke)===ke){Ie!==null&&(Ie=Ie.next={eventTime:Gi,lane:0,tag:Ct.tag,payload:Ct.payload,callback:Ct.callback,next:null});t:{var Di=e,en=Ct;switch(ke=i,Gi=h,en.tag){case 1:if(Di=en.payload,typeof Di=="function"){Ze=Di.call(Gi,Ze,ke);break t}Ze=Di;break t;case 3:Di.flags=Di.flags&-65537|128;case 0:if(Di=en.payload,ke=typeof Di=="function"?Di.call(Gi,Ze,ke):Di,ke==null)break t;Ze=a({},Ze,ke);break t;case 2:zs=!0}}Ct.callback!==null&&Ct.lane!==0&&(e.flags|=64,ke=y.effects,ke===null?y.effects=[Ct]:ke.push(Ct))}else Gi={eventTime:Gi,lane:ke,tag:Ct.tag,payload:Ct.payload,callback:Ct.callback,next:null},Ie===null?(pe=Ie=Gi,Vt=Ze):Ie=Ie.next=Gi,it|=ke;if(Ct=Ct.next,Ct===null){if(Ct=y.shared.pending,Ct===null)break;ke=Ct,Ct=ke.next,ke.next=null,y.lastBaseUpdate=ke,y.shared.pending=null}}while(1);if(Ie===null&&(Vt=Ze),y.baseState=Vt,y.firstBaseUpdate=pe,y.lastBaseUpdate=Ie,i=y.shared.interleaved,i!==null){y=i;do it|=y.lane,y=y.next;while(y!==i)}else P===null&&(y.shared.lanes=0);ma|=it,e.lanes=it,e.memoizedState=Ze}}function Rt(e,i,h){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var p=e[i],y=p.callback;if(y!==null){if(p.callback=null,p=h,typeof y!="function")throw Error(o(191,y));y.call(p)}}}var qt={},re=Hi(qt),Xt=Hi(qt),be=Hi(qt);function fe(e){if(e===qt)throw Error(o(174));return e}function Ye(e,i){$(be,i),$(Xt,e),$(re,qt),e=Qt(i),qe(re),$(re,e)}function We(){qe(re),qe(Xt),qe(be)}function ui(e){var i=fe(be.current),h=fe(re.current);i=ct(h,e.type,i),h!==i&&($(Xt,e),$(re,i))}function pi(e){Xt.current===e&&(qe(re),qe(Xt))}var Qe=Hi(0);function xi(e){for(var i=e;i!==null;){if(i.tag===13){var h=i.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||ze(h)||vi(h)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Xi=[];function Ui(){for(var e=0;e<Xi.length;e++){var i=Xi[e];Wt?i._workInProgressVersionPrimary=null:i._workInProgressVersionSecondary=null}Xi.length=0}var Kr=c.ReactCurrentDispatcher,ys=c.ReactCurrentBatchConfig,cn=0,Fi=null,Ei=null,rr=null,Hs=!1,Zn=!1,Jn=0,Wa=0;function nr(){throw Error(o(321))}function $a(e,i){if(i===null)return!1;for(var h=0;h<i.length&&h<e.length;h++)if(!Pn(e[h],i[h]))return!1;return!0}function Td(e,i,h,p,y,P){if(cn=P,Fi=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Kr.current=e===null||e.memoizedState===null?ew:iw,e=h(p,y),Zn){P=0;do{if(Zn=!1,Jn=0,25<=P)throw Error(o(301));P+=1,rr=Ei=null,i.updateQueue=null,Kr.current=rw,e=h(p,y)}while(Zn)}if(Kr.current=xh,i=Ei!==null&&Ei.next!==null,cn=0,rr=Ei=Fi=null,Hs=!1,i)throw Error(o(300));return e}function Pd(){var e=Jn!==0;return Jn=0,e}function ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rr===null?Fi.memoizedState=rr=e:rr=rr.next=e,rr}function bn(){if(Ei===null){var e=Fi.alternate;e=e!==null?e.memoizedState:null}else e=Ei.next;var i=rr===null?Fi.memoizedState:rr.next;if(i!==null)rr=i,Ei=e;else{if(e===null)throw Error(o(310));Ei=e,e={memoizedState:Ei.memoizedState,baseState:Ei.baseState,baseQueue:Ei.baseQueue,queue:Ei.queue,next:null},rr===null?Fi.memoizedState=rr=e:rr=rr.next=e}return rr}function To(e,i){return typeof i=="function"?i(e):i}function Md(e){var i=bn(),h=i.queue;if(h===null)throw Error(o(311));h.lastRenderedReducer=e;var p=Ei,y=p.baseQueue,P=h.pending;if(P!==null){if(y!==null){var it=y.next;y.next=P.next,P.next=it}p.baseQueue=y=P,h.pending=null}if(y!==null){P=y.next,p=p.baseState;var Ct=it=null,Vt=null,pe=P;do{var Ie=pe.lane;if((cn&Ie)===Ie)Vt!==null&&(Vt=Vt.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),p=pe.hasEagerState?pe.eagerState:e(p,pe.action);else{var Ze={lane:Ie,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};Vt===null?(Ct=Vt=Ze,it=p):Vt=Vt.next=Ze,Fi.lanes|=Ie,ma|=Ie}pe=pe.next}while(pe!==null&&pe!==P);Vt===null?it=p:Vt.next=Ct,Pn(p,i.memoizedState)||(Zr=!0),i.memoizedState=p,i.baseState=it,i.baseQueue=Vt,h.lastRenderedState=p}if(e=h.interleaved,e!==null){y=e;do P=y.lane,Fi.lanes|=P,ma|=P,y=y.next;while(y!==e)}else y===null&&(h.lanes=0);return[i.memoizedState,h.dispatch]}function Rd(e){var i=bn(),h=i.queue;if(h===null)throw Error(o(311));h.lastRenderedReducer=e;var p=h.dispatch,y=h.pending,P=i.memoizedState;if(y!==null){h.pending=null;var it=y=y.next;do P=e(P,it.action),it=it.next;while(it!==y);Pn(P,i.memoizedState)||(Zr=!0),i.memoizedState=P,i.baseQueue===null&&(i.baseState=P),h.lastRenderedState=P}return[P,p]}function Wg(){}function $g(e,i){var h=Fi,p=bn(),y=i(),P=!Pn(p.memoizedState,y);if(P&&(p.memoizedState=y,Zr=!0),p=p.queue,Fd(Yg.bind(null,h,p,e),[e]),p.getSnapshot!==i||P||rr!==null&&rr.memoizedState.tag&1){if(h.flags|=2048,Po(9,Xg.bind(null,h,p,y,i),void 0,null),Cr===null)throw Error(o(349));cn&30||Kg(h,i,y)}return y}function Kg(e,i,h){e.flags|=16384,e={getSnapshot:i,value:h},i=Fi.updateQueue,i===null?(i={lastEffect:null,stores:null},Fi.updateQueue=i,i.stores=[e]):(h=i.stores,h===null?i.stores=[e]:h.push(e))}function Xg(e,i,h,p){i.value=h,i.getSnapshot=p,qg(i)&&Qg(e)}function Yg(e,i,h){return h(function(){qg(i)&&Qg(e)})}function qg(e){var i=e.getSnapshot;e=e.value;try{var h=i();return!Pn(e,h)}catch{return!0}}function Qg(e){var i=Mr(e,1);i!==null&&_n(i,e,1,-1)}function Zg(e){var i=ts();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},i.queue=e,e=e.dispatch=tw.bind(null,Fi,e),[i.memoizedState,e]}function Po(e,i,h,p){return e={tag:e,create:i,destroy:h,deps:p,next:null},i=Fi.updateQueue,i===null?(i={lastEffect:null,stores:null},Fi.updateQueue=i,i.lastEffect=e.next=e):(h=i.lastEffect,h===null?i.lastEffect=e.next=e:(p=h.next,h.next=e,e.next=p,i.lastEffect=e)),e}function Jg(){return bn().memoizedState}function bh(e,i,h,p){var y=ts();Fi.flags|=e,y.memoizedState=Po(1|i,h,void 0,p===void 0?null:p)}function _h(e,i,h,p){var y=bn();p=p===void 0?null:p;var P=void 0;if(Ei!==null){var it=Ei.memoizedState;if(P=it.destroy,p!==null&&$a(p,it.deps)){y.memoizedState=Po(i,h,P,p);return}}Fi.flags|=e,y.memoizedState=Po(1|i,h,P,p)}function tm(e,i){return bh(8390656,8,e,i)}function Fd(e,i){return _h(2048,8,e,i)}function em(e,i){return _h(4,2,e,i)}function im(e,i){return _h(4,4,e,i)}function rm(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function nm(e,i,h){return h=h!=null?h.concat([e]):null,_h(4,4,rm.bind(null,i,e),h)}function Id(){}function sm(e,i){var h=bn();i=i===void 0?null:i;var p=h.memoizedState;return p!==null&&i!==null&&$a(i,p[1])?p[0]:(h.memoizedState=[e,i],e)}function am(e,i){var h=bn();i=i===void 0?null:i;var p=h.memoizedState;return p!==null&&i!==null&&$a(i,p[1])?p[0]:(e=e(),h.memoizedState=[e,i],e)}function om(e,i,h){return cn&21?(Pn(h,i)||(h=Hg(),Fi.lanes|=h,ma|=h,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,Zr=!0),e.memoizedState=h)}function Zx(e,i){var h=di;di=h!==0&&4>h?h:4,e(!0);var p=ys.transition;ys.transition={};try{e(!1),i()}finally{di=h,ys.transition=p}}function lm(){return bn().memoizedState}function Jx(e,i,h){var p=Gs(e);if(h={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null},hm(e))cm(i,h);else if(h=jg(e,i,h,p),h!==null){var y=Hr();_n(h,e,p,y),dm(h,i,p)}}function tw(e,i,h){var p=Gs(e),y={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null};if(hm(e))cm(i,y);else{var P=e.alternate;if(e.lanes===0&&(P===null||P.lanes===0)&&(P=i.lastRenderedReducer,P!==null))try{var it=i.lastRenderedState,Ct=P(it,h);if(y.hasEagerState=!0,y.eagerState=Ct,Pn(Ct,it)){var Vt=i.interleaved;Vt===null?(y.next=y,vs(i)):(y.next=Vt.next,Vt.next=y),i.interleaved=y;return}}catch{}finally{}h=jg(e,i,y,p),h!==null&&(y=Hr(),_n(h,e,p,y),dm(h,i,p))}}function hm(e){var i=e.alternate;return e===Fi||i!==null&&i===Fi}function cm(e,i){Zn=Hs=!0;var h=e.pending;h===null?i.next=i:(i.next=h.next,h.next=i),e.pending=i}function dm(e,i,h){if(h&4194240){var p=i.lanes;p&=e.pendingLanes,h|=p,i.lanes=h,wd(e,h)}}var xh={readContext:Er,useCallback:nr,useContext:nr,useEffect:nr,useImperativeHandle:nr,useInsertionEffect:nr,useLayoutEffect:nr,useMemo:nr,useReducer:nr,useRef:nr,useState:nr,useDebugValue:nr,useDeferredValue:nr,useTransition:nr,useMutableSource:nr,useSyncExternalStore:nr,useId:nr,unstable_isNewReconciler:!1},ew={readContext:Er,useCallback:function(e,i){return ts().memoizedState=[e,i===void 0?null:i],e},useContext:Er,useEffect:tm,useImperativeHandle:function(e,i,h){return h=h!=null?h.concat([e]):null,bh(4194308,4,rm.bind(null,i,e),h)},useLayoutEffect:function(e,i){return bh(4194308,4,e,i)},useInsertionEffect:function(e,i){return bh(4,2,e,i)},useMemo:function(e,i){var h=ts();return i=i===void 0?null:i,e=e(),h.memoizedState=[e,i],e},useReducer:function(e,i,h){var p=ts();return i=h!==void 0?h(i):i,p.memoizedState=p.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},p.queue=e,e=e.dispatch=Jx.bind(null,Fi,e),[p.memoizedState,e]},useRef:function(e){var i=ts();return e={current:e},i.memoizedState=e},useState:Zg,useDebugValue:Id,useDeferredValue:function(e){return ts().memoizedState=e},useTransition:function(){var e=Zg(!1),i=e[0];return e=Zx.bind(null,e[1]),ts().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,h){var p=Fi,y=ts();if(Ki){if(h===void 0)throw Error(o(407));h=h()}else{if(h=i(),Cr===null)throw Error(o(349));cn&30||Kg(p,i,h)}y.memoizedState=h;var P={value:h,getSnapshot:i};return y.queue=P,tm(Yg.bind(null,p,P,e),[e]),p.flags|=2048,Po(9,Xg.bind(null,p,P,h,i),void 0,null),h},useId:function(){var e=ts(),i=Cr.identifierPrefix;if(Ki){var h=Pr,p=$r;h=(p&~(1<<32-Ar(p)-1)).toString(32)+h,i=":"+i+"R"+h,h=Jn++,0<h&&(i+="H"+h.toString(32)),i+=":"}else h=Wa++,i=":"+i+"r"+h.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},iw={readContext:Er,useCallback:sm,useContext:Er,useEffect:Fd,useImperativeHandle:nm,useInsertionEffect:em,useLayoutEffect:im,useMemo:am,useReducer:Md,useRef:Jg,useState:function(){return Md(To)},useDebugValue:Id,useDeferredValue:function(e){var i=bn();return om(i,Ei.memoizedState,e)},useTransition:function(){var e=Md(To)[0],i=bn().memoizedState;return[e,i]},useMutableSource:Wg,useSyncExternalStore:$g,useId:lm,unstable_isNewReconciler:!1},rw={readContext:Er,useCallback:sm,useContext:Er,useEffect:Fd,useImperativeHandle:nm,useInsertionEffect:em,useLayoutEffect:im,useMemo:am,useReducer:Rd,useRef:Jg,useState:function(){return Rd(To)},useDebugValue:Id,useDeferredValue:function(e){var i=bn();return Ei===null?i.memoizedState=e:om(i,Ei.memoizedState,e)},useTransition:function(){var e=Rd(To)[0],i=bn().memoizedState;return[e,i]},useMutableSource:Wg,useSyncExternalStore:$g,useId:lm,unstable_isNewReconciler:!1};function Nn(e,i){if(e&&e.defaultProps){i=a({},i),e=e.defaultProps;for(var h in e)i[h]===void 0&&(i[h]=e[h]);return i}return i}function Ld(e,i,h,p){i=e.memoizedState,h=h(p,i),h=h==null?i:a({},i,h),e.memoizedState=h,e.lanes===0&&(e.updateQueue.baseState=h)}var wh={isMounted:function(e){return(e=e._reactInternals)?I(e)===e:!1},enqueueSetState:function(e,i,h){e=e._reactInternals;var p=Hr(),y=Gs(e),P=kt(p,y);P.payload=i,h!=null&&(P.callback=h),i=k(e,P,y),i!==null&&(_n(i,e,y,p),X(i,e,y))},enqueueReplaceState:function(e,i,h){e=e._reactInternals;var p=Hr(),y=Gs(e),P=kt(p,y);P.tag=1,P.payload=i,h!=null&&(P.callback=h),i=k(e,P,y),i!==null&&(_n(i,e,y,p),X(i,e,y))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var h=Hr(),p=Gs(e),y=kt(h,p);y.tag=2,i!=null&&(y.callback=i),i=k(e,y,p),i!==null&&(_n(i,e,p,h),X(i,e,p))}};function um(e,i,h,p,y,P,it){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(p,P,it):i.prototype&&i.prototype.isPureReactComponent?!Fn(h,p)||!Fn(y,P):!0}function fm(e,i,h){var p=!1,y=At,P=i.contextType;return typeof P=="object"&&P!==null?P=Er(P):(y=Se(i)?de:Zt.current,p=i.contextTypes,P=(p=p!=null)?Ce(e,y):At),i=new i(h,P),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=wh,e.stateNode=i,i._reactInternals=e,p&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=y,e.__reactInternalMemoizedMaskedChildContext=P),i}function pm(e,i,h,p){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(h,p),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(h,p),i.state!==e&&wh.enqueueReplaceState(i,i.state,null)}function Dd(e,i,h,p){var y=e.stateNode;y.props=h,y.state=e.memoizedState,y.refs={},hn(e);var P=i.contextType;typeof P=="object"&&P!==null?y.context=Er(P):(P=Se(i)?de:Zt.current,y.context=Ce(e,P)),y.state=e.memoizedState,P=i.getDerivedStateFromProps,typeof P=="function"&&(Ld(e,i,P,h),y.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&wh.enqueueReplaceState(y,y.state,null),mt(e,h,y,p),y.state=e.memoizedState),typeof y.componentDidMount=="function"&&(e.flags|=4194308)}function Ka(e,i){try{var h="",p=i;do h+=gn(p),p=p.return;while(p);var y=h}catch(P){y=`
Error generating stack: `+P.message+`
`+P.stack}return{value:e,source:i,stack:y,digest:null}}function Nd(e,i,h){return{value:e,source:null,stack:h??null,digest:i??null}}function Od(e,i){try{console.error(i.value)}catch(h){setTimeout(function(){throw h})}}var nw=typeof WeakMap=="function"?WeakMap:Map;function gm(e,i,h){h=kt(-1,h),h.tag=3,h.payload={element:null};var p=i.value;return h.callback=function(){Nh||(Nh=!0,iu=p),Od(e,i)},h}function mm(e,i,h){h=kt(-1,h),h.tag=3;var p=e.type.getDerivedStateFromError;if(typeof p=="function"){var y=i.value;h.payload=function(){return p(y)},h.callback=function(){Od(e,i)}}var P=e.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(h.callback=function(){Od(e,i),typeof p!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var it=i.stack;this.componentDidCatch(i.value,{componentStack:it!==null?it:""})}),h}function vm(e,i,h){var p=e.pingCache;if(p===null){p=e.pingCache=new nw;var y=new Set;p.set(i,y)}else y=p.get(i),y===void 0&&(y=new Set,p.set(i,y));y.has(h)||(y.add(h),e=yw.bind(null,e,i,h),i.then(e,e))}function ym(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function bm(e,i,h,p,y){return e.mode&1?(e.flags|=65536,e.lanes=y,e):(e===i?e.flags|=65536:(e.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(i=kt(-1,1),i.tag=2,k(h,i,1))),h.lanes|=1),e)}var sw=c.ReactCurrentOwner,Zr=!1;function Xr(e,i,h,p){i.child=e===null?In(i,null,h,p):dr(i,e.child,h,p)}function _m(e,i,h,p,y){h=h.render;var P=i.ref;return Va(i,y),p=Td(e,i,h,p,P,y),h=Pd(),e!==null&&!Zr?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~y,bs(e,i,y)):(Ki&&h&&Ed(i),i.flags|=1,Xr(e,i,p,y),i.child)}function xm(e,i,h,p,y){if(e===null){var P=h.type;return typeof P=="function"&&!lu(P)&&P.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(i.tag=15,i.type=P,wm(e,i,P,p,y)):(e=Gh(h.type,null,p,i,i.mode,y),e.ref=i.ref,e.return=i,i.child=e)}if(P=e.child,!(e.lanes&y)){var it=P.memoizedProps;if(h=h.compare,h=h!==null?h:Fn,h(it,p)&&e.ref===i.ref)return bs(e,i,y)}return i.flags|=1,e=Vs(P,p),e.ref=i.ref,e.return=i,i.child=e}function wm(e,i,h,p,y){if(e!==null){var P=e.memoizedProps;if(Fn(P,p)&&e.ref===i.ref)if(Zr=!1,i.pendingProps=p=P,(e.lanes&y)!==0)e.flags&131072&&(Zr=!0);else return i.lanes=e.lanes,bs(e,i,y)}return zd(e,i,h,p,y)}function Am(e,i,h){var p=i.pendingProps,y=p.children,P=e!==null?e.memoizedState:null;if(p.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},$(Ya,dn),dn|=h;else{if(!(h&1073741824))return e=P!==null?P.baseLanes|h:h,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,$(Ya,dn),dn|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=P!==null?P.baseLanes:h,$(Ya,dn),dn|=p}else P!==null?(p=P.baseLanes|h,i.memoizedState=null):p=h,$(Ya,dn),dn|=p;return Xr(e,i,y,h),i.child}function Sm(e,i){var h=i.ref;(e===null&&h!==null||e!==null&&e.ref!==h)&&(i.flags|=512,i.flags|=2097152)}function zd(e,i,h,p,y){var P=Se(h)?de:Zt.current;return P=Ce(i,P),Va(i,y),h=Td(e,i,h,p,P,y),p=Pd(),e!==null&&!Zr?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~y,bs(e,i,y)):(Ki&&p&&Ed(i),i.flags|=1,Xr(e,i,h,y),i.child)}function Em(e,i,h,p,y){if(Se(h)){var P=!0;Bi(i)}else P=!1;if(Va(i,y),i.stateNode===null)Sh(e,i),fm(i,h,p),Dd(i,h,p,y),p=!0;else if(e===null){var it=i.stateNode,Ct=i.memoizedProps;it.props=Ct;var Vt=it.context,pe=h.contextType;typeof pe=="object"&&pe!==null?pe=Er(pe):(pe=Se(h)?de:Zt.current,pe=Ce(i,pe));var Ie=h.getDerivedStateFromProps,Ze=typeof Ie=="function"||typeof it.getSnapshotBeforeUpdate=="function";Ze||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(Ct!==p||Vt!==pe)&&pm(i,it,p,pe),zs=!1;var ke=i.memoizedState;it.state=ke,mt(i,p,it,y),Vt=i.memoizedState,Ct!==p||ke!==Vt||ae.current||zs?(typeof Ie=="function"&&(Ld(i,h,Ie,p),Vt=i.memoizedState),(Ct=zs||um(i,h,Ct,p,ke,Vt,pe))?(Ze||typeof it.UNSAFE_componentWillMount!="function"&&typeof it.componentWillMount!="function"||(typeof it.componentWillMount=="function"&&it.componentWillMount(),typeof it.UNSAFE_componentWillMount=="function"&&it.UNSAFE_componentWillMount()),typeof it.componentDidMount=="function"&&(i.flags|=4194308)):(typeof it.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=p,i.memoizedState=Vt),it.props=p,it.state=Vt,it.context=pe,p=Ct):(typeof it.componentDidMount=="function"&&(i.flags|=4194308),p=!1)}else{it=i.stateNode,Vg(e,i),Ct=i.memoizedProps,pe=i.type===i.elementType?Ct:Nn(i.type,Ct),it.props=pe,Ze=i.pendingProps,ke=it.context,Vt=h.contextType,typeof Vt=="object"&&Vt!==null?Vt=Er(Vt):(Vt=Se(h)?de:Zt.current,Vt=Ce(i,Vt));var Gi=h.getDerivedStateFromProps;(Ie=typeof Gi=="function"||typeof it.getSnapshotBeforeUpdate=="function")||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(Ct!==Ze||ke!==Vt)&&pm(i,it,p,Vt),zs=!1,ke=i.memoizedState,it.state=ke,mt(i,p,it,y);var Di=i.memoizedState;Ct!==Ze||ke!==Di||ae.current||zs?(typeof Gi=="function"&&(Ld(i,h,Gi,p),Di=i.memoizedState),(pe=zs||um(i,h,pe,p,ke,Di,Vt)||!1)?(Ie||typeof it.UNSAFE_componentWillUpdate!="function"&&typeof it.componentWillUpdate!="function"||(typeof it.componentWillUpdate=="function"&&it.componentWillUpdate(p,Di,Vt),typeof it.UNSAFE_componentWillUpdate=="function"&&it.UNSAFE_componentWillUpdate(p,Di,Vt)),typeof it.componentDidUpdate=="function"&&(i.flags|=4),typeof it.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof it.componentDidUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=1024),i.memoizedProps=p,i.memoizedState=Di),it.props=p,it.state=Di,it.context=Vt,p=pe):(typeof it.componentDidUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=1024),p=!1)}return Hd(e,i,h,p,P,y)}function Hd(e,i,h,p,y,P){Sm(e,i);var it=(i.flags&128)!==0;if(!p&&!it)return y&&qr(i,h,!1),bs(e,i,P);p=i.stateNode,sw.current=i;var Ct=it&&typeof h.getDerivedStateFromError!="function"?null:p.render();return i.flags|=1,e!==null&&it?(i.child=dr(i,e.child,null,P),i.child=dr(i,null,Ct,P)):Xr(e,i,Ct,P),i.memoizedState=p.state,y&&qr(i,h,!0),i.child}function Cm(e){var i=e.stateNode;i.pendingContext?ci(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ci(e,i.context,!1),Ye(e,i.containerInfo)}function km(e,i,h,p,y){return ja(),fa(y),i.flags|=256,Xr(e,i,h,p),i.child}var Bd={dehydrated:null,treeContext:null,retryLane:0};function Ud(e){return{baseLanes:e,cachePool:null,transitions:null}}function Tm(e,i,h){var p=i.pendingProps,y=Qe.current,P=!1,it=(i.flags&128)!==0,Ct;if((Ct=it)||(Ct=e!==null&&e.memoizedState===null?!1:(y&2)!==0),Ct?(P=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(y|=1),$(Qe,y&1),e===null)return Cd(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?vi(e)?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(it=p.children,e=p.fallback,P?(p=i.mode,P=i.child,it={mode:"hidden",children:it},!(p&1)&&P!==null?(P.childLanes=0,P.pendingProps=it):P=jh(it,p,0,null),e=_a(e,p,h,null),P.return=i,e.return=i,P.sibling=e,i.child=P,i.child.memoizedState=Ud(h),i.memoizedState=Bd,e):Gd(i,it));if(y=e.memoizedState,y!==null&&(Ct=y.dehydrated,Ct!==null))return aw(e,i,it,p,Ct,y,h);if(P){P=p.fallback,it=i.mode,y=e.child,Ct=y.sibling;var Vt={mode:"hidden",children:p.children};return!(it&1)&&i.child!==y?(p=i.child,p.childLanes=0,p.pendingProps=Vt,i.deletions=null):(p=Vs(y,Vt),p.subtreeFlags=y.subtreeFlags&14680064),Ct!==null?P=Vs(Ct,P):(P=_a(P,it,h,null),P.flags|=2),P.return=i,p.return=i,p.sibling=P,i.child=p,p=P,P=i.child,it=e.child.memoizedState,it=it===null?Ud(h):{baseLanes:it.baseLanes|h,cachePool:null,transitions:it.transitions},P.memoizedState=it,P.childLanes=e.childLanes&~h,i.memoizedState=Bd,p}return P=e.child,e=P.sibling,p=Vs(P,{mode:"visible",children:p.children}),!(i.mode&1)&&(p.lanes=h),p.return=i,p.sibling=null,e!==null&&(h=i.deletions,h===null?(i.deletions=[e],i.flags|=16):h.push(e)),i.child=p,i.memoizedState=null,p}function Gd(e,i){return i=jh({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function Ah(e,i,h,p){return p!==null&&fa(p),dr(i,e.child,null,h),e=Gd(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function aw(e,i,h,p,y,P,it){if(h)return i.flags&256?(i.flags&=-257,p=Nd(Error(o(422))),Ah(e,i,it,p)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(P=p.fallback,y=i.mode,p=jh({mode:"visible",children:p.children},y,0,null),P=_a(P,y,it,null),P.flags|=2,p.return=i,P.return=i,p.sibling=P,i.child=p,i.mode&1&&dr(i,e.child,null,it),i.child.memoizedState=Ud(it),i.memoizedState=Bd,P);if(!(i.mode&1))return Ah(e,i,it,null);if(vi(y))return p=oi(y).digest,P=Error(o(419)),p=Nd(P,p,void 0),Ah(e,i,it,p);if(h=(it&e.childLanes)!==0,Zr||h){if(p=Cr,p!==null){switch(it&-it){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(p.suspendedLanes|it)?0:y,y!==0&&y!==P.retryLane&&(P.retryLane=y,Mr(e,y),_n(p,e,y,-1))}return ou(),p=Nd(Error(o(421))),Ah(e,i,it,p)}return ze(y)?(i.flags|=128,i.child=e.child,i=bw.bind(null,e),er(y,i),null):(e=P.treeContext,xe&&(Sr=K(y),on=i,Ki=!0,Rn=null,Qn=!1,e!==null&&(cr[Zi++]=$r,cr[Zi++]=Pr,cr[Zi++]=_r,$r=e.id,Pr=e.overflow,_r=i)),i=Gd(i,p.children),i.flags|=4096,i)}function Pm(e,i,h){e.lanes|=i;var p=e.alternate;p!==null&&(p.lanes|=i),ms(e.return,i,h)}function jd(e,i,h,p,y){var P=e.memoizedState;P===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:y}:(P.isBackwards=i,P.rendering=null,P.renderingStartTime=0,P.last=p,P.tail=h,P.tailMode=y)}function Mm(e,i,h){var p=i.pendingProps,y=p.revealOrder,P=p.tail;if(Xr(e,i,p.children,h),p=Qe.current,p&2)p=p&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pm(e,h,i);else if(e.tag===19)Pm(e,h,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}p&=1}if($(Qe,p),!(i.mode&1))i.memoizedState=null;else switch(y){case"forwards":for(h=i.child,y=null;h!==null;)e=h.alternate,e!==null&&xi(e)===null&&(y=h),h=h.sibling;h=y,h===null?(y=i.child,i.child=null):(y=h.sibling,h.sibling=null),jd(i,!1,y,h,P);break;case"backwards":for(h=null,y=i.child,i.child=null;y!==null;){if(e=y.alternate,e!==null&&xi(e)===null){i.child=y;break}e=y.sibling,y.sibling=h,h=y,y=e}jd(i,!0,h,null,P);break;case"together":jd(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Sh(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function bs(e,i,h){if(e!==null&&(i.dependencies=e.dependencies),ma|=i.lanes,!(h&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(o(153));if(i.child!==null){for(e=i.child,h=Vs(e,e.pendingProps),i.child=h,h.return=i;e.sibling!==null;)e=e.sibling,h=h.sibling=Vs(e,e.pendingProps),h.return=i;h.sibling=null}return i.child}function ow(e,i,h){switch(i.tag){case 3:Cm(i),ja();break;case 5:ui(i);break;case 1:Se(i.type)&&Bi(i);break;case 4:Ye(i,i.stateNode.containerInfo);break;case 10:pa(i,i.type._context,i.memoizedProps.value);break;case 13:var p=i.memoizedState;if(p!==null)return p.dehydrated!==null?($(Qe,Qe.current&1),i.flags|=128,null):h&i.child.childLanes?Tm(e,i,h):($(Qe,Qe.current&1),e=bs(e,i,h),e!==null?e.sibling:null);$(Qe,Qe.current&1);break;case 19:if(p=(h&i.childLanes)!==0,e.flags&128){if(p)return Mm(e,i,h);i.flags|=128}var y=i.memoizedState;if(y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),$(Qe,Qe.current),p)break;return null;case 22:case 23:return i.lanes=0,Am(e,i,h)}return bs(e,i,h)}function es(e){e.flags|=4}function Rm(e,i){if(e!==null&&e.child===i.child)return!0;if(i.flags&16)return!1;for(e=i.child;e!==null;){if(e.flags&12854||e.subtreeFlags&12854)return!1;e=e.sibling}return!0}var Mo,Ro,Eh,Ch;if(ve)Mo=function(e,i){for(var h=i.child;h!==null;){if(h.tag===5||h.tag===6)Jt(e,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===i)break;for(;h.sibling===null;){if(h.return===null||h.return===i)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Ro=function(){},Eh=function(e,i,h,p,y){if(e=e.memoizedProps,e!==p){var P=i.stateNode,it=fe(re.current);h=ge(P,h,e,p,y,it),(i.updateQueue=h)&&es(i)}},Ch=function(e,i,h,p){h!==p&&es(i)};else if(ie){Mo=function(e,i,h,p){for(var y=i.child;y!==null;){if(y.tag===5){var P=y.stateNode;h&&p&&(P=me(P,y.type,y.memoizedProps,y)),Jt(e,P)}else if(y.tag===6)P=y.stateNode,h&&p&&(P=Pe(P,y.memoizedProps,y)),Jt(e,P);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)P=y.child,P!==null&&(P.return=y),Mo(e,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===i)break;for(;y.sibling===null;){if(y.return===null||y.return===i)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};var Fm=function(e,i,h,p){for(var y=i.child;y!==null;){if(y.tag===5){var P=y.stateNode;h&&p&&(P=me(P,y.type,y.memoizedProps,y)),Et(e,P)}else if(y.tag===6)P=y.stateNode,h&&p&&(P=Pe(P,y.memoizedProps,y)),Et(e,P);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)P=y.child,P!==null&&(P.return=y),Fm(e,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===i)break;for(;y.sibling===null;){if(y.return===null||y.return===i)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};Ro=function(e,i){var h=i.stateNode;if(!Rm(e,i)){e=h.containerInfo;var p=ft(e);Fm(p,i,!1,!1),h.pendingChildren=p,es(i),Kt(e,p)}},Eh=function(e,i,h,p,y){var P=e.stateNode,it=e.memoizedProps;if((e=Rm(e,i))&&it===p)i.stateNode=P;else{var Ct=i.stateNode,Vt=fe(re.current),pe=null;it!==p&&(pe=ge(Ct,h,it,p,y,Vt)),e&&pe===null?i.stateNode=P:(P=ot(P,pe,h,it,p,i,e,Ct),oe(P,h,p,y,Vt)&&es(i),i.stateNode=P,e?es(i):Mo(P,i,!1,!1))}},Ch=function(e,i,h,p){h!==p?(e=fe(be.current),h=fe(re.current),i.stateNode=Ve(p,e,h,i),es(i)):i.stateNode=e.stateNode}}else Ro=function(){},Eh=function(){},Ch=function(){};function Fo(e,i){if(!Ki)switch(e.tailMode){case"hidden":i=e.tail;for(var h=null;i!==null;)i.alternate!==null&&(h=i),i=i.sibling;h===null?e.tail=null:h.sibling=null;break;case"collapsed":h=e.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:p.sibling=null}}function Or(e){var i=e.alternate!==null&&e.alternate.child===e.child,h=0,p=0;if(i)for(var y=e.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags&14680064,p|=y.flags&14680064,y.return=e,y=y.sibling;else for(y=e.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=e,y=y.sibling;return e.subtreeFlags|=p,e.childLanes=h,i}function lw(e,i,h){var p=i.pendingProps;switch(qn(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(i),null;case 1:return Se(i.type)&&ri(),Or(i),null;case 3:return h=i.stateNode,We(),qe(ae),qe(Zt),Ui(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(e===null||e.child===null)&&(yh(i)?es(i):e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,Rn!==null&&(su(Rn),Rn=null))),Ro(e,i),Or(i),null;case 5:pi(i),h=fe(be.current);var y=i.type;if(e!==null&&i.stateNode!=null)Eh(e,i,y,p,h),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!p){if(i.stateNode===null)throw Error(o(166));return Or(i),null}if(e=fe(re.current),yh(i)){if(!xe)throw Error(o(175));e=ht(i.stateNode,i.type,i.memoizedProps,h,e,i,!Qn),i.updateQueue=e,e!==null&&es(i)}else{var P=zt(y,p,h,e,i);Mo(P,i,!1,!1),i.stateNode=P,oe(P,y,p,h,e)&&es(i)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Or(i),null;case 6:if(e&&i.stateNode!=null)Ch(e,i,e.memoizedProps,p);else{if(typeof p!="string"&&i.stateNode===null)throw Error(o(166));if(e=fe(be.current),h=fe(re.current),yh(i)){if(!xe)throw Error(o(176));if(e=i.stateNode,h=i.memoizedProps,(p=xt(e,h,i,!Qn))&&(y=on,y!==null))switch(y.tag){case 3:ue(y.stateNode.containerInfo,e,h,(y.mode&1)!==0);break;case 5:he(y.type,y.memoizedProps,y.stateNode,e,h,(y.mode&1)!==0)}p&&es(i)}else i.stateNode=Ve(p,e,h,i)}return Or(i),null;case 13:if(qe(Qe),p=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ki&&Sr!==null&&i.mode&1&&!(i.flags&128))ua(),ja(),i.flags|=98560,y=!1;else if(y=yh(i),p!==null&&p.dehydrated!==null){if(e===null){if(!y)throw Error(o(318));if(!xe)throw Error(o(344));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(o(317));St(y,i)}else ja(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;Or(i),y=!1}else Rn!==null&&(su(Rn),Rn=null),y=!0;if(!y)return i.flags&65536?i:null}return i.flags&128?(i.lanes=h,i):(h=p!==null,h!==(e!==null&&e.memoizedState!==null)&&h&&(i.child.flags|=8192,i.mode&1&&(e===null||Qe.current&1?xr===0&&(xr=3):ou())),i.updateQueue!==null&&(i.flags|=4),Or(i),null);case 4:return We(),Ro(e,i),e===null&&ut(i.stateNode.containerInfo),Or(i),null;case 10:return kd(i.type._context),Or(i),null;case 17:return Se(i.type)&&ri(),Or(i),null;case 19:if(qe(Qe),y=i.memoizedState,y===null)return Or(i),null;if(p=(i.flags&128)!==0,P=y.rendering,P===null)if(p)Fo(y,!1);else{if(xr!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(P=xi(e),P!==null){for(i.flags|=128,Fo(y,!1),e=P.updateQueue,e!==null&&(i.updateQueue=e,i.flags|=4),i.subtreeFlags=0,e=h,h=i.child;h!==null;)p=h,y=e,p.flags&=14680066,P=p.alternate,P===null?(p.childLanes=0,p.lanes=y,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=P.childLanes,p.lanes=P.lanes,p.child=P.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=P.memoizedProps,p.memoizedState=P.memoizedState,p.updateQueue=P.updateQueue,p.type=P.type,y=P.dependencies,p.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),h=h.sibling;return $(Qe,Qe.current&1|2),i.child}e=e.sibling}y.tail!==null&&$i()>eu&&(i.flags|=128,p=!0,Fo(y,!1),i.lanes=4194304)}else{if(!p)if(e=xi(P),e!==null){if(i.flags|=128,p=!0,e=e.updateQueue,e!==null&&(i.updateQueue=e,i.flags|=4),Fo(y,!0),y.tail===null&&y.tailMode==="hidden"&&!P.alternate&&!Ki)return Or(i),null}else 2*$i()-y.renderingStartTime>eu&&h!==1073741824&&(i.flags|=128,p=!0,Fo(y,!1),i.lanes=4194304);y.isBackwards?(P.sibling=i.child,i.child=P):(e=y.last,e!==null?e.sibling=P:i.child=P,y.last=P)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=$i(),i.sibling=null,e=Qe.current,$(Qe,p?e&1|2:e&1),i):(Or(i),null);case 22:case 23:return au(),h=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==h&&(i.flags|=8192),h&&i.mode&1?dn&1073741824&&(Or(i),ve&&i.subtreeFlags&6&&(i.flags|=8192)):Or(i),null;case 24:return null;case 25:return null}throw Error(o(156,i.tag))}function hw(e,i){switch(qn(i),i.tag){case 1:return Se(i.type)&&ri(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return We(),qe(ae),qe(Zt),Ui(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return pi(i),null;case 13:if(qe(Qe),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(o(340));ja()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return qe(Qe),null;case 4:return We(),null;case 10:return kd(i.type._context),null;case 22:case 23:return au(),null;case 24:return null;default:return null}}var kh=!1,zr=!1,cw=typeof WeakSet=="function"?WeakSet:Set,Re=null;function Xa(e,i){var h=e.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(p){Yi(e,i,p)}else h.current=null}function Im(e,i,h){try{h()}catch(p){Yi(e,i,p)}}var Lm=!1;function dw(e,i){for(Dt(e.containerInfo),Re=i;Re!==null;)if(e=Re,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,Re=i;else for(;Re!==null;){e=Re;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var p=h.memoizedProps,y=h.memoizedState,P=e.stateNode,it=P.getSnapshotBeforeUpdate(e.elementType===e.type?p:Nn(e.type,p),y);P.__reactInternalSnapshotBeforeUpdate=it}break;case 3:ve&&q(e.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Ct){Yi(e,e.return,Ct)}if(i=e.sibling,i!==null){i.return=e.return,Re=i;break}Re=e.return}return h=Lm,Lm=!1,h}function Io(e,i,h){var p=i.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var y=p=p.next;do{if((y.tag&e)===e){var P=y.destroy;y.destroy=void 0,P!==void 0&&Im(i,h,P)}y=y.next}while(y!==p)}}function Th(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var h=i=i.next;do{if((h.tag&e)===e){var p=h.create;h.destroy=p()}h=h.next}while(h!==i)}}function Vd(e){var i=e.ref;if(i!==null){var h=e.stateNode;switch(e.tag){case 5:e=Lt(h);break;default:e=h}typeof i=="function"?i(e):i.current=e}}function Dm(e){var i=e.alternate;i!==null&&(e.alternate=null,Dm(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&R(i)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Nm(e){return e.tag===5||e.tag===3||e.tag===4}function Om(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Nm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wd(e,i,h){var p=e.tag;if(p===5||p===6)e=e.stateNode,i?Pt(h,e,i):nt(h,e);else if(p!==4&&(e=e.child,e!==null))for(Wd(e,i,h),e=e.sibling;e!==null;)Wd(e,i,h),e=e.sibling}function $d(e,i,h){var p=e.tag;if(p===5||p===6)e=e.stateNode,i?Ht(h,e,i):et(h,e);else if(p!==4&&(e=e.child,e!==null))for($d(e,i,h),e=e.sibling;e!==null;)$d(e,i,h),e=e.sibling}var Rr=null,On=!1;function is(e,i,h){for(h=h.child;h!==null;)Kd(e,i,h),h=h.sibling}function Kd(e,i,h){if(Dr&&typeof Dr.onCommitFiberUnmount=="function")try{Dr.onCommitFiberUnmount(mh,h)}catch{}switch(h.tag){case 5:zr||Xa(h,i);case 6:if(ve){var p=Rr,y=On;Rr=null,is(e,i,h),Rr=p,On=y,Rr!==null&&(On?Z(Rr,h.stateNode):Bt(Rr,h.stateNode))}else is(e,i,h);break;case 18:ve&&Rr!==null&&(On?$t(Rr,h.stateNode):le(Rr,h.stateNode));break;case 4:ve?(p=Rr,y=On,Rr=h.stateNode.containerInfo,On=!0,is(e,i,h),Rr=p,On=y):(ie&&(p=h.stateNode.containerInfo,y=ft(p),te(p,y)),is(e,i,h));break;case 0:case 11:case 14:case 15:if(!zr&&(p=h.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){y=p=p.next;do{var P=y,it=P.destroy;P=P.tag,it!==void 0&&(P&2||P&4)&&Im(h,i,it),y=y.next}while(y!==p)}is(e,i,h);break;case 1:if(!zr&&(Xa(h,i),p=h.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=h.memoizedProps,p.state=h.memoizedState,p.componentWillUnmount()}catch(Ct){Yi(h,i,Ct)}is(e,i,h);break;case 21:is(e,i,h);break;case 22:h.mode&1?(zr=(p=zr)||h.memoizedState!==null,is(e,i,h),zr=p):is(e,i,h);break;default:is(e,i,h)}}function zm(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var h=e.stateNode;h===null&&(h=e.stateNode=new cw),i.forEach(function(p){var y=_w.bind(null,e,p);h.has(p)||(h.add(p),p.then(y,y))})}}function zn(e,i){var h=i.deletions;if(h!==null)for(var p=0;p<h.length;p++){var y=h[p];try{var P=e,it=i;if(ve){var Ct=it;t:for(;Ct!==null;){switch(Ct.tag){case 5:Rr=Ct.stateNode,On=!1;break t;case 3:Rr=Ct.stateNode.containerInfo,On=!0;break t;case 4:Rr=Ct.stateNode.containerInfo,On=!0;break t}Ct=Ct.return}if(Rr===null)throw Error(o(160));Kd(P,it,y),Rr=null,On=!1}else Kd(P,it,y);var Vt=y.alternate;Vt!==null&&(Vt.return=null),y.return=null}catch(pe){Yi(y,i,pe)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Hm(i,e),i=i.sibling}function Hm(e,i){var h=e.alternate,p=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(zn(i,e),rs(e),p&4){try{Io(3,e,e.return),Th(3,e)}catch(ke){Yi(e,e.return,ke)}try{Io(5,e,e.return)}catch(ke){Yi(e,e.return,ke)}}break;case 1:zn(i,e),rs(e),p&512&&h!==null&&Xa(h,h.return);break;case 5:if(zn(i,e),rs(e),p&512&&h!==null&&Xa(h,h.return),ve){if(e.flags&32){var y=e.stateNode;try{at(y)}catch(ke){Yi(e,e.return,ke)}}if(p&4&&(y=e.stateNode,y!=null)){var P=e.memoizedProps;if(h=h!==null?h.memoizedProps:P,p=e.type,i=e.updateQueue,e.updateQueue=null,i!==null)try{Nt(y,i,p,h,P,e)}catch(ke){Yi(e,e.return,ke)}}}break;case 6:if(zn(i,e),rs(e),p&4&&ve){if(e.stateNode===null)throw Error(o(162));y=e.stateNode,P=e.memoizedProps,h=h!==null?h.memoizedProps:P;try{gt(y,h,P)}catch(ke){Yi(e,e.return,ke)}}break;case 3:if(zn(i,e),rs(e),p&4){if(ve&&xe&&h!==null&&h.memoizedState.isDehydrated)try{Ot(i.containerInfo)}catch(ke){Yi(e,e.return,ke)}if(ie){y=i.containerInfo,P=i.pendingChildren;try{te(y,P)}catch(ke){Yi(e,e.return,ke)}}}break;case 4:if(zn(i,e),rs(e),p&4&&ie){P=e.stateNode,y=P.containerInfo,P=P.pendingChildren;try{te(y,P)}catch(ke){Yi(e,e.return,ke)}}break;case 13:zn(i,e),rs(e),y=e.child,y.flags&8192&&(P=y.memoizedState!==null,y.stateNode.isHidden=P,!P||y.alternate!==null&&y.alternate.memoizedState!==null||(tu=$i())),p&4&&zm(e);break;case 22:var it=h!==null&&h.memoizedState!==null;if(e.mode&1?(zr=(h=zr)||it,zn(i,e),zr=h):zn(i,e),rs(e),p&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!it&&e.mode&1)for(Re=e,p=e.child;p!==null;){for(i=Re=p;Re!==null;){it=Re;var Ct=it.child;switch(it.tag){case 0:case 11:case 14:case 15:Io(4,it,it.return);break;case 1:Xa(it,it.return);var Vt=it.stateNode;if(typeof Vt.componentWillUnmount=="function"){var pe=it,Ie=it.return;try{var Ze=pe;Vt.props=Ze.memoizedProps,Vt.state=Ze.memoizedState,Vt.componentWillUnmount()}catch(ke){Yi(pe,Ie,ke)}}break;case 5:Xa(it,it.return);break;case 22:if(it.memoizedState!==null){Gm(i);continue}}Ct!==null?(Ct.return=it,Re=Ct):Gm(i)}p=p.sibling}if(ve){t:if(p=null,ve)for(i=e;;){if(i.tag===5){if(p===null){p=i;try{y=i.stateNode,h?_t(y):jt(i.stateNode,i.memoizedProps)}catch(ke){Yi(e,e.return,ke)}}}else if(i.tag===6){if(p===null)try{P=i.stateNode,h?vt(P):bt(P,i.memoizedProps)}catch(ke){Yi(e,e.return,ke)}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;p===i&&(p=null),i=i.return}p===i&&(p=null),i.sibling.return=i.return,i=i.sibling}}}break;case 19:zn(i,e),rs(e),p&4&&zm(e);break;case 21:break;default:zn(i,e),rs(e)}}function rs(e){var i=e.flags;if(i&2){try{if(ve){t:{for(var h=e.return;h!==null;){if(Nm(h)){var p=h;break t}h=h.return}throw Error(o(160))}switch(p.tag){case 5:var y=p.stateNode;p.flags&32&&(at(y),p.flags&=-33);var P=Om(e);$d(e,P,y);break;case 3:case 4:var it=p.stateNode.containerInfo,Ct=Om(e);Wd(e,Ct,it);break;default:throw Error(o(161))}}}catch(Vt){Yi(e,e.return,Vt)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function uw(e,i,h){Re=e,Bm(e)}function Bm(e,i,h){for(var p=(e.mode&1)!==0;Re!==null;){var y=Re,P=y.child;if(y.tag===22&&p){var it=y.memoizedState!==null||kh;if(!it){var Ct=y.alternate,Vt=Ct!==null&&Ct.memoizedState!==null||zr;Ct=kh;var pe=zr;if(kh=it,(zr=Vt)&&!pe)for(Re=y;Re!==null;)it=Re,Vt=it.child,it.tag===22&&it.memoizedState!==null?jm(y):Vt!==null?(Vt.return=it,Re=Vt):jm(y);for(;P!==null;)Re=P,Bm(P),P=P.sibling;Re=y,kh=Ct,zr=pe}Um(e)}else y.subtreeFlags&8772&&P!==null?(P.return=y,Re=P):Um(e)}}function Um(e){for(;Re!==null;){var i=Re;if(i.flags&8772){var h=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:zr||Th(5,i);break;case 1:var p=i.stateNode;if(i.flags&4&&!zr)if(h===null)p.componentDidMount();else{var y=i.elementType===i.type?h.memoizedProps:Nn(i.type,h.memoizedProps);p.componentDidUpdate(y,h.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var P=i.updateQueue;P!==null&&Rt(i,P,p);break;case 3:var it=i.updateQueue;if(it!==null){if(h=null,i.child!==null)switch(i.child.tag){case 5:h=Lt(i.child.stateNode);break;case 1:h=i.child.stateNode}Rt(i,it,h)}break;case 5:var Ct=i.stateNode;h===null&&i.flags&4&&yt(Ct,i.type,i.memoizedProps,i);break;case 6:break;case 4:break;case 12:break;case 13:if(xe&&i.memoizedState===null){var Vt=i.alternate;if(Vt!==null){var pe=Vt.memoizedState;if(pe!==null){var Ie=pe.dehydrated;Ie!==null&&ye(Ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}zr||i.flags&512&&Vd(i)}catch(Ze){Yi(i,i.return,Ze)}}if(i===e){Re=null;break}if(h=i.sibling,h!==null){h.return=i.return,Re=h;break}Re=i.return}}function Gm(e){for(;Re!==null;){var i=Re;if(i===e){Re=null;break}var h=i.sibling;if(h!==null){h.return=i.return,Re=h;break}Re=i.return}}function jm(e){for(;Re!==null;){var i=Re;try{switch(i.tag){case 0:case 11:case 15:var h=i.return;try{Th(4,i)}catch(Vt){Yi(i,h,Vt)}break;case 1:var p=i.stateNode;if(typeof p.componentDidMount=="function"){var y=i.return;try{p.componentDidMount()}catch(Vt){Yi(i,y,Vt)}}var P=i.return;try{Vd(i)}catch(Vt){Yi(i,P,Vt)}break;case 5:var it=i.return;try{Vd(i)}catch(Vt){Yi(i,it,Vt)}}}catch(Vt){Yi(i,i.return,Vt)}if(i===e){Re=null;break}var Ct=i.sibling;if(Ct!==null){Ct.return=i.return,Re=Ct;break}Re=i.return}}var Ph=0,Mh=1,Rh=2,Fh=3,Ih=4;if(typeof Symbol=="function"&&Symbol.for){var Lo=Symbol.for;Ph=Lo("selector.component"),Mh=Lo("selector.has_pseudo_class"),Rh=Lo("selector.role"),Fh=Lo("selector.test_id"),Ih=Lo("selector.text")}function Xd(e){var i=_e(e);if(i!=null){if(typeof i.memoizedProps["data-testname"]!="string")throw Error(o(364));return i}if(e=V(e),e===null)throw Error(o(362));return e.stateNode.current}function Yd(e,i){switch(i.$$typeof){case Ph:if(e.type===i.value)return!0;break;case Mh:t:{i=i.value,e=[e,0];for(var h=0;h<e.length;){var p=e[h++],y=e[h++],P=i[y];if(p.tag!==5||!W(p)){for(;P!=null&&Yd(p,P);)y++,P=i[y];if(y===i.length){i=!0;break t}else for(p=p.child;p!==null;)e.push(p,y),p=p.sibling}}i=!1}return i;case Rh:if(e.tag===5&&U(e.stateNode,i.value))return!0;break;case Ih:if((e.tag===5||e.tag===6)&&(e=G(e),e!==null&&0<=e.indexOf(i.value)))return!0;break;case Fh:if(e.tag===5&&(e=e.memoizedProps["data-testname"],typeof e=="string"&&e.toLowerCase()===i.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function qd(e){switch(e.$$typeof){case Ph:return"<"+(C(e.value)||"Unknown")+">";case Mh:return":has("+(qd(e)||"")+")";case Rh:return'[role="'+e.value+'"]';case Ih:return'"'+e.value+'"';case Fh:return'[data-testname="'+e.value+'"]';default:throw Error(o(365))}}function Vm(e,i){var h=[];e=[e,0];for(var p=0;p<e.length;){var y=e[p++],P=e[p++],it=i[P];if(y.tag!==5||!W(y)){for(;it!=null&&Yd(y,it);)P++,it=i[P];if(P===i.length)h.push(y);else for(y=y.child;y!==null;)e.push(y,P),y=y.sibling}}return h}function Qd(e,i){if(!L)throw Error(o(363));e=Xd(e),e=Vm(e,i),i=[],e=Array.from(e);for(var h=0;h<e.length;){var p=e[h++];if(p.tag===5)W(p)||i.push(p.stateNode);else for(p=p.child;p!==null;)e.push(p),p=p.sibling}return i}var fw=Math.ceil,Lh=c.ReactCurrentDispatcher,Zd=c.ReactCurrentOwner,or=c.ReactCurrentBatchConfig,fi=0,Cr=null,ur=null,Fr=0,dn=0,Ya=Hi(0),xr=0,Do=null,ma=0,Dh=0,Jd=0,No=null,Jr=null,tu=0,eu=1/0,_s=null;function qa(){eu=$i()+500}var Nh=!1,iu=null,Bs=null,Oh=!1,Us=null,zh=0,Oo=0,ru=null,Hh=-1,Bh=0;function Hr(){return fi&6?$i():Hh!==-1?Hh:Hh=$i()}function Gs(e){return e.mode&1?fi&2&&Fr!==0?Fr&-Fr:gs.transition!==null?(Bh===0&&(Bh=Hg()),Bh):(e=di,e!==0?e:T()):1}function _n(e,i,h,p){if(50<Oo)throw Oo=0,ru=null,Error(o(185));ko(e,h,p),(!(fi&2)||e!==Cr)&&(e===Cr&&(!(fi&2)&&(Dh|=h),xr===4&&js(e,Fr)),tn(e,p),h===1&&fi===0&&!(i.mode&1)&&(qa(),vh&&br()))}function tn(e,i){var h=e.callbackNode;Yx(e,i);var p=gh(e,e===Cr?Fr:0);if(p===0)h!==null&&Ug(h),e.callbackNode=null,e.callbackPriority=0;else if(i=p&-p,e.callbackPriority!==i){if(h!=null&&Ug(h),i===1)e.tag===0?yr($m.bind(null,e)):hr($m.bind(null,e)),D?H(function(){!(fi&6)&&br()}):Xn(Ad,br),h=null;else{switch(Bg(p)){case 1:h=Ad;break;case 4:h=Ua;break;case 16:h=Sd;break;case 536870912:h=Ga;break;default:h=Sd}h=e0(h,Wm.bind(null,e))}e.callbackPriority=i,e.callbackNode=h}}function Wm(e,i){if(Hh=-1,Bh=0,fi&6)throw Error(o(327));var h=e.callbackNode;if(ba()&&e.callbackNode!==h)return null;var p=gh(e,e===Cr?Fr:0);if(p===0)return null;if(p&30||p&e.expiredLanes||i)i=Uh(e,p);else{i=p;var y=fi;fi|=2;var P=Ym();(Cr!==e||Fr!==i)&&(_s=null,qa(),va(e,i));do try{mw();break}catch(Ct){Xm(e,Ct)}while(1);yn(),Lh.current=P,fi=y,ur!==null?i=0:(Cr=null,Fr=0,i=xr)}if(i!==0){if(i===2&&(y=Wn(e),y!==0&&(p=y,i=nu(e,y))),i===1)throw h=Do,va(e,0),js(e,p),tn(e,$i()),h;if(i===6)js(e,p);else{if(y=e.current.alternate,!(p&30)&&!pw(y)&&(i=Uh(e,p),i===2&&(P=Wn(e),P!==0&&(p=P,i=nu(e,P))),i===1))throw h=Do,va(e,0),js(e,p),tn(e,$i()),h;switch(e.finishedWork=y,e.finishedLanes=p,i){case 0:case 1:throw Error(o(345));case 2:ya(e,Jr,_s);break;case 3:if(js(e,p),(p&130023424)===p&&(i=tu+500-$i(),10<i)){if(gh(e,0)!==0)break;if(y=e.suspendedLanes,(y&p)!==p){Hr(),e.pingedLanes|=e.suspendedLanes&y;break}e.timeoutHandle=Gt(ya.bind(null,e,Jr,_s),i);break}ya(e,Jr,_s);break;case 4:if(js(e,p),(p&4194240)===p)break;for(i=e.eventTimes,y=-1;0<p;){var it=31-Ar(p);P=1<<it,it=i[it],it>y&&(y=it),p&=~P}if(p=y,p=$i()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*fw(p/1960))-p,10<p){e.timeoutHandle=Gt(ya.bind(null,e,Jr,_s),p);break}ya(e,Jr,_s);break;case 5:ya(e,Jr,_s);break;default:throw Error(o(329))}}}return tn(e,$i()),e.callbackNode===h?Wm.bind(null,e):null}function nu(e,i){var h=No;return e.current.memoizedState.isDehydrated&&(va(e,i).flags|=256),e=Uh(e,i),e!==2&&(i=Jr,Jr=h,i!==null&&su(i)),e}function su(e){Jr===null?Jr=e:Jr.push.apply(Jr,e)}function pw(e){for(var i=e;;){if(i.flags&16384){var h=i.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var p=0;p<h.length;p++){var y=h[p],P=y.getSnapshot;y=y.value;try{if(!Pn(P(),y))return!1}catch{return!1}}}if(h=i.child,i.subtreeFlags&16384&&h!==null)h.return=i,i=h;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function js(e,i){for(i&=~Jd,i&=~Dh,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var h=31-Ar(i),p=1<<h;e[h]=-1,i&=~p}}function $m(e){if(fi&6)throw Error(o(327));ba();var i=gh(e,0);if(!(i&1))return tn(e,$i()),null;var h=Uh(e,i);if(e.tag!==0&&h===2){var p=Wn(e);p!==0&&(i=p,h=nu(e,p))}if(h===1)throw h=Do,va(e,0),js(e,i),tn(e,$i()),h;if(h===6)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,ya(e,Jr,_s),tn(e,$i()),null}function Km(e){Us!==null&&Us.tag===0&&!(fi&6)&&ba();var i=fi;fi|=1;var h=or.transition,p=di;try{if(or.transition=null,di=1,e)return e()}finally{di=p,or.transition=h,fi=i,!(fi&6)&&br()}}function au(){dn=Ya.current,qe(Ya)}function va(e,i){e.finishedWork=null,e.finishedLanes=0;var h=e.timeoutHandle;if(h!==Ft&&(e.timeoutHandle=Ft,lt(h)),ur!==null)for(h=ur.return;h!==null;){var p=h;switch(qn(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&ri();break;case 3:We(),qe(ae),qe(Zt),Ui();break;case 5:pi(p);break;case 4:We();break;case 13:qe(Qe);break;case 19:qe(Qe);break;case 10:kd(p.type._context);break;case 22:case 23:au()}h=h.return}if(Cr=e,ur=e=Vs(e.current,null),Fr=dn=i,xr=0,Do=null,Jd=Dh=ma=0,Jr=No=null,ga!==null){for(i=0;i<ga.length;i++)if(h=ga[i],p=h.interleaved,p!==null){h.interleaved=null;var y=p.next,P=h.pending;if(P!==null){var it=P.next;P.next=y,p.next=it}h.pending=p}ga=null}return e}function Xm(e,i){do{var h=ur;try{if(yn(),Kr.current=xh,Hs){for(var p=Fi.memoizedState;p!==null;){var y=p.queue;y!==null&&(y.pending=null),p=p.next}Hs=!1}if(cn=0,rr=Ei=Fi=null,Zn=!1,Jn=0,Zd.current=null,h===null||h.return===null){xr=1,Do=i,ur=null;break}t:{var P=e,it=h.return,Ct=h,Vt=i;if(i=Fr,Ct.flags|=32768,Vt!==null&&typeof Vt=="object"&&typeof Vt.then=="function"){var pe=Vt,Ie=Ct,Ze=Ie.tag;if(!(Ie.mode&1)&&(Ze===0||Ze===11||Ze===15)){var ke=Ie.alternate;ke?(Ie.updateQueue=ke.updateQueue,Ie.memoizedState=ke.memoizedState,Ie.lanes=ke.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var Gi=ym(it);if(Gi!==null){Gi.flags&=-257,bm(Gi,it,Ct,P,i),Gi.mode&1&&vm(P,pe,i),i=Gi,Vt=pe;var Di=i.updateQueue;if(Di===null){var en=new Set;en.add(Vt),i.updateQueue=en}else Di.add(Vt);break t}else{if(!(i&1)){vm(P,pe,i),ou();break t}Vt=Error(o(426))}}else if(Ki&&Ct.mode&1){var xs=ym(it);if(xs!==null){!(xs.flags&65536)&&(xs.flags|=256),bm(xs,it,Ct,P,i),fa(Ka(Vt,Ct));break t}}P=Vt=Ka(Vt,Ct),xr!==4&&(xr=2),No===null?No=[P]:No.push(P),P=it;do{switch(P.tag){case 3:P.flags|=65536,i&=-i,P.lanes|=i;var Ut=gm(P,Vt,i);pt(P,Ut);break t;case 1:Ct=Vt;var Mt=P.type,Yt=P.stateNode;if(!(P.flags&128)&&(typeof Mt.getDerivedStateFromError=="function"||Yt!==null&&typeof Yt.componentDidCatch=="function"&&(Bs===null||!Bs.has(Yt)))){P.flags|=65536,i&=-i,P.lanes|=i;var Te=mm(P,Ct,i);pt(P,Te);break t}}P=P.return}while(P!==null)}Qm(h)}catch(Ge){i=Ge,ur===h&&h!==null&&(ur=h=h.return);continue}break}while(1)}function Ym(){var e=Lh.current;return Lh.current=xh,e===null?xh:e}function ou(){(xr===0||xr===3||xr===2)&&(xr=4),Cr===null||!(ma&268435455)&&!(Dh&268435455)||js(Cr,Fr)}function Uh(e,i){var h=fi;fi|=2;var p=Ym();(Cr!==e||Fr!==i)&&(_s=null,va(e,i));do try{gw();break}catch(y){Xm(e,y)}while(1);if(yn(),fi=h,Lh.current=p,ur!==null)throw Error(o(261));return Cr=null,Fr=0,xr}function gw(){for(;ur!==null;)qm(ur)}function mw(){for(;ur!==null&&!Ba();)qm(ur)}function qm(e){var i=t0(e.alternate,e,dn);e.memoizedProps=e.pendingProps,i===null?Qm(e):ur=i,Zd.current=null}function Qm(e){var i=e;do{var h=i.alternate;if(e=i.return,i.flags&32768){if(h=hw(h,i),h!==null){h.flags&=32767,ur=h;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{xr=6,ur=null;return}}else if(h=lw(h,i,dn),h!==null){ur=h;return}if(i=i.sibling,i!==null){ur=i;return}ur=i=e}while(i!==null);xr===0&&(xr=5)}function ya(e,i,h){var p=di,y=or.transition;try{or.transition=null,di=1,vw(e,i,h,p)}finally{or.transition=y,di=p}return null}function vw(e,i,h,p){do ba();while(Us!==null);if(fi&6)throw Error(o(327));h=e.finishedWork;var y=e.finishedLanes;if(h===null)return null;if(e.finishedWork=null,e.finishedLanes=0,h===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var P=h.lanes|h.childLanes;if(Kn(e,P),e===Cr&&(ur=Cr=null,Fr=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||Oh||(Oh=!0,e0(Sd,function(){return ba(),null})),P=(h.flags&15990)!==0,h.subtreeFlags&15990||P){P=or.transition,or.transition=null;var it=di;di=1;var Ct=fi;fi|=4,Zd.current=null,dw(e,h),Hm(h,e),ee(e.containerInfo),e.current=h,uw(h),qx(),fi=Ct,di=it,or.transition=P}else e.current=h;if(Oh&&(Oh=!1,Us=e,zh=y),P=e.pendingLanes,P===0&&(Bs=null),Qx(h.stateNode),tn(e,$i()),i!==null)for(p=e.onRecoverableError,h=0;h<i.length;h++)y=i[h],p(y.value,{componentStack:y.stack,digest:y.digest});if(Nh)throw Nh=!1,e=iu,iu=null,e;return zh&1&&e.tag!==0&&ba(),P=e.pendingLanes,P&1?e===ru?Oo++:(Oo=0,ru=e):Oo=0,br(),null}function ba(){if(Us!==null){var e=Bg(zh),i=or.transition,h=di;try{if(or.transition=null,di=16>e?16:e,Us===null)var p=!1;else{if(e=Us,Us=null,zh=0,fi&6)throw Error(o(331));var y=fi;for(fi|=4,Re=e.current;Re!==null;){var P=Re,it=P.child;if(Re.flags&16){var Ct=P.deletions;if(Ct!==null){for(var Vt=0;Vt<Ct.length;Vt++){var pe=Ct[Vt];for(Re=pe;Re!==null;){var Ie=Re;switch(Ie.tag){case 0:case 11:case 15:Io(8,Ie,P)}var Ze=Ie.child;if(Ze!==null)Ze.return=Ie,Re=Ze;else for(;Re!==null;){Ie=Re;var ke=Ie.sibling,Gi=Ie.return;if(Dm(Ie),Ie===pe){Re=null;break}if(ke!==null){ke.return=Gi,Re=ke;break}Re=Gi}}}var Di=P.alternate;if(Di!==null){var en=Di.child;if(en!==null){Di.child=null;do{var xs=en.sibling;en.sibling=null,en=xs}while(en!==null)}}Re=P}}if(P.subtreeFlags&2064&&it!==null)it.return=P,Re=it;else t:for(;Re!==null;){if(P=Re,P.flags&2048)switch(P.tag){case 0:case 11:case 15:Io(9,P,P.return)}var Ut=P.sibling;if(Ut!==null){Ut.return=P.return,Re=Ut;break t}Re=P.return}}var Mt=e.current;for(Re=Mt;Re!==null;){it=Re;var Yt=it.child;if(it.subtreeFlags&2064&&Yt!==null)Yt.return=it,Re=Yt;else t:for(it=Mt;Re!==null;){if(Ct=Re,Ct.flags&2048)try{switch(Ct.tag){case 0:case 11:case 15:Th(9,Ct)}}catch(Ge){Yi(Ct,Ct.return,Ge)}if(Ct===it){Re=null;break t}var Te=Ct.sibling;if(Te!==null){Te.return=Ct.return,Re=Te;break t}Re=Ct.return}}if(fi=y,br(),Dr&&typeof Dr.onPostCommitFiberRoot=="function")try{Dr.onPostCommitFiberRoot(mh,e)}catch{}p=!0}return p}finally{di=h,or.transition=i}}return!1}function Zm(e,i,h){i=Ka(h,i),i=gm(e,i,1),e=k(e,i,1),i=Hr(),e!==null&&(ko(e,1,i),tn(e,i))}function Yi(e,i,h){if(e.tag===3)Zm(e,e,h);else for(;i!==null;){if(i.tag===3){Zm(i,e,h);break}else if(i.tag===1){var p=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Bs===null||!Bs.has(p))){e=Ka(h,e),e=mm(i,e,1),i=k(i,e,1),e=Hr(),i!==null&&(ko(i,1,e),tn(i,e));break}}i=i.return}}function yw(e,i,h){var p=e.pingCache;p!==null&&p.delete(i),i=Hr(),e.pingedLanes|=e.suspendedLanes&h,Cr===e&&(Fr&h)===h&&(xr===4||xr===3&&(Fr&130023424)===Fr&&500>$i()-tu?va(e,0):Jd|=h),tn(e,i)}function Jm(e,i){i===0&&(e.mode&1?(i=ph,ph<<=1,!(ph&130023424)&&(ph=4194304)):i=1);var h=Hr();e=Mr(e,i),e!==null&&(ko(e,i,h),tn(e,h))}function bw(e){var i=e.memoizedState,h=0;i!==null&&(h=i.retryLane),Jm(e,h)}function _w(e,i){var h=0;switch(e.tag){case 13:var p=e.stateNode,y=e.memoizedState;y!==null&&(h=y.retryLane);break;case 19:p=e.stateNode;break;default:throw Error(o(314))}p!==null&&p.delete(i),Jm(e,h)}var t0;t0=function(e,i,h){if(e!==null)if(e.memoizedProps!==i.pendingProps||ae.current)Zr=!0;else{if(!(e.lanes&h)&&!(i.flags&128))return Zr=!1,ow(e,i,h);Zr=!!(e.flags&131072)}else Zr=!1,Ki&&i.flags&1048576&&Yn(i,Wr,i.index);switch(i.lanes=0,i.tag){case 2:var p=i.type;Sh(e,i),e=i.pendingProps;var y=Ce(i,Zt.current);Va(i,h),y=Td(null,i,p,e,y,h);var P=Pd();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Se(p)?(P=!0,Bi(i)):P=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,hn(i),y.updater=wh,i.stateNode=y,y._reactInternals=i,Dd(i,p,e,h),i=Hd(null,i,p,!0,P,h)):(i.tag=0,Ki&&P&&Ed(i),Xr(null,i,y,h),i=i.child),i;case 16:p=i.elementType;t:{switch(Sh(e,i),e=i.pendingProps,y=p._init,p=y(p._payload),i.type=p,y=i.tag=ww(p),e=Nn(p,e),y){case 0:i=zd(null,i,p,e,h);break t;case 1:i=Em(null,i,p,e,h);break t;case 11:i=_m(null,i,p,e,h);break t;case 14:i=xm(null,i,p,Nn(p.type,e),h);break t}throw Error(o(306,p,""))}return i;case 0:return p=i.type,y=i.pendingProps,y=i.elementType===p?y:Nn(p,y),zd(e,i,p,y,h);case 1:return p=i.type,y=i.pendingProps,y=i.elementType===p?y:Nn(p,y),Em(e,i,p,y,h);case 3:t:{if(Cm(i),e===null)throw Error(o(387));p=i.pendingProps,P=i.memoizedState,y=P.element,Vg(e,i),mt(i,p,null,h);var it=i.memoizedState;if(p=it.element,xe&&P.isDehydrated)if(P={element:p,isDehydrated:!1,cache:it.cache,pendingSuspenseBoundaries:it.pendingSuspenseBoundaries,transitions:it.transitions},i.updateQueue.baseState=P,i.memoizedState=P,i.flags&256){y=Ka(Error(o(423)),i),i=km(e,i,p,h,y);break t}else if(p!==y){y=Ka(Error(o(424)),i),i=km(e,i,p,h,y);break t}else for(xe&&(Sr=Q(i.stateNode.containerInfo),on=i,Ki=!0,Rn=null,Qn=!1),h=In(i,null,p,h),i.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ja(),p===y){i=bs(e,i,h);break t}Xr(e,i,p,h)}i=i.child}return i;case 5:return ui(i),e===null&&Cd(i),p=i.type,y=i.pendingProps,P=e!==null?e.memoizedProps:null,it=y.children,Ae(p,y)?it=null:P!==null&&Ae(p,P)&&(i.flags|=32),Sm(e,i),Xr(e,i,it,h),i.child;case 6:return e===null&&Cd(i),null;case 13:return Tm(e,i,h);case 4:return Ye(i,i.stateNode.containerInfo),p=i.pendingProps,e===null?i.child=dr(i,null,p,h):Xr(e,i,p,h),i.child;case 11:return p=i.type,y=i.pendingProps,y=i.elementType===p?y:Nn(p,y),_m(e,i,p,y,h);case 7:return Xr(e,i,i.pendingProps,h),i.child;case 8:return Xr(e,i,i.pendingProps.children,h),i.child;case 12:return Xr(e,i,i.pendingProps.children,h),i.child;case 10:t:{if(p=i.type._context,y=i.pendingProps,P=i.memoizedProps,it=y.value,pa(i,p,it),P!==null)if(Pn(P.value,it)){if(P.children===y.children&&!ae.current){i=bs(e,i,h);break t}}else for(P=i.child,P!==null&&(P.return=i);P!==null;){var Ct=P.dependencies;if(Ct!==null){it=P.child;for(var Vt=Ct.firstContext;Vt!==null;){if(Vt.context===p){if(P.tag===1){Vt=kt(-1,h&-h),Vt.tag=2;var pe=P.updateQueue;if(pe!==null){pe=pe.shared;var Ie=pe.pending;Ie===null?Vt.next=Vt:(Vt.next=Ie.next,Ie.next=Vt),pe.pending=Vt}}P.lanes|=h,Vt=P.alternate,Vt!==null&&(Vt.lanes|=h),ms(P.return,h,i),Ct.lanes|=h;break}Vt=Vt.next}}else if(P.tag===10)it=P.type===i.type?null:P.child;else if(P.tag===18){if(it=P.return,it===null)throw Error(o(341));it.lanes|=h,Ct=it.alternate,Ct!==null&&(Ct.lanes|=h),ms(it,h,i),it=P.sibling}else it=P.child;if(it!==null)it.return=P;else for(it=P;it!==null;){if(it===i){it=null;break}if(P=it.sibling,P!==null){P.return=it.return,it=P;break}it=it.return}P=it}Xr(e,i,y.children,h),i=i.child}return i;case 9:return y=i.type,p=i.pendingProps.children,Va(i,h),y=Er(y),p=p(y),i.flags|=1,Xr(e,i,p,h),i.child;case 14:return p=i.type,y=Nn(p,i.pendingProps),y=Nn(p.type,y),xm(e,i,p,y,h);case 15:return wm(e,i,i.type,i.pendingProps,h);case 17:return p=i.type,y=i.pendingProps,y=i.elementType===p?y:Nn(p,y),Sh(e,i),i.tag=1,Se(p)?(e=!0,Bi(i)):e=!1,Va(i,h),fm(i,p,y),Dd(i,p,y,h),Hd(null,i,p,!0,e,h);case 19:return Mm(e,i,h);case 22:return Am(e,i,h)}throw Error(o(156,i.tag))};function e0(e,i){return Xn(e,i)}function xw(e,i,h,p){this.tag=e,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(e,i,h,p){return new xw(e,i,h,p)}function lu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ww(e){if(typeof e=="function")return lu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===b)return 11;if(e===F)return 14}return 2}function Vs(e,i){var h=e.alternate;return h===null?(h=xn(e.tag,i,e.key,e.mode),h.elementType=e.elementType,h.type=e.type,h.stateNode=e.stateNode,h.alternate=e,e.alternate=h):(h.pendingProps=i,h.type=e.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=e.flags&14680064,h.childLanes=e.childLanes,h.lanes=e.lanes,h.child=e.child,h.memoizedProps=e.memoizedProps,h.memoizedState=e.memoizedState,h.updateQueue=e.updateQueue,i=e.dependencies,h.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},h.sibling=e.sibling,h.index=e.index,h.ref=e.ref,h}function Gh(e,i,h,p,y,P){var it=2;if(p=e,typeof e=="function")lu(e)&&(it=1);else if(typeof e=="string")it=5;else t:switch(e){case f:return _a(h.children,y,P,i);case m:it=8,y|=8;break;case S:return e=xn(12,h,i,y|2),e.elementType=S,e.lanes=P,e;case x:return e=xn(13,h,i,y),e.elementType=x,e.lanes=P,e;case A:return e=xn(19,h,i,y),e.elementType=A,e.lanes=P,e;case g:return jh(h,y,P,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _:it=10;break t;case v:it=9;break t;case b:it=11;break t;case F:it=14;break t;case M:it=16,p=null;break t}throw Error(o(130,e==null?e:typeof e,""))}return i=xn(it,h,i,y),i.elementType=e,i.type=p,i.lanes=P,i}function _a(e,i,h,p){return e=xn(7,e,p,i),e.lanes=h,e}function jh(e,i,h,p){return e=xn(22,e,p,i),e.elementType=g,e.lanes=h,e.stateNode={isHidden:!1},e}function hu(e,i,h){return e=xn(6,e,null,i),e.lanes=h,e}function cu(e,i,h){return i=xn(4,e.children!==null?e.children:[],e.key,i),i.lanes=h,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function Aw(e,i,h,p,y){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ft,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$n(0),this.expirationTimes=$n(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$n(0),this.identifierPrefix=p,this.onRecoverableError=y,xe&&(this.mutableSourceEagerHydrationData=null)}function i0(e,i,h,p,y,P,it,Ct,Vt){return e=new Aw(e,i,h,Ct,Vt),i===1?(i=1,P===!0&&(i|=8)):i=0,P=xn(3,null,null,i),e.current=P,P.stateNode=e,P.memoizedState={element:p,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},hn(P),e}function r0(e){if(!e)return At;e=e._reactInternals;t:{if(I(e)!==e||e.tag!==1)throw Error(o(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(Se(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(i!==null);throw Error(o(171))}if(e.tag===1){var h=e.type;if(Se(h))return vr(e,h,i)}return i}function n0(e){var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=st(i),e===null?null:e.stateNode}function s0(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var h=e.retryLane;e.retryLane=h!==0&&h<i?h:i}}function Vh(e,i){s0(e,i),(e=e.alternate)&&s0(e,i)}function Sw(e){return e=st(e),e===null?null:e.stateNode}function Ew(){return null}return t.attemptContinuousHydration=function(e){if(e.tag===13){var i=Mr(e,134217728);if(i!==null){var h=Hr();_n(i,e,134217728,h)}Vh(e,134217728)}},t.attemptDiscreteHydration=function(e){if(e.tag===13){var i=Mr(e,1);if(i!==null){var h=Hr();_n(i,e,1,h)}Vh(e,1)}},t.attemptHydrationAtCurrentPriority=function(e){if(e.tag===13){var i=Gs(e),h=Mr(e,i);if(h!==null){var p=Hr();_n(h,e,i,p)}Vh(e,i)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var h=jr(i.pendingLanes);h!==0&&(wd(i,h|1),tn(i,$i()),!(fi&6)&&(qa(),br()))}break;case 13:Km(function(){var p=Mr(e,1);if(p!==null){var y=Hr();_n(p,e,1,y)}}),Vh(e,1)}},t.batchedUpdates=function(e,i){var h=fi;fi|=1;try{return e(i)}finally{fi=h,fi===0&&(qa(),vh&&br())}},t.createComponentSelector=function(e){return{$$typeof:Ph,value:e}},t.createContainer=function(e,i,h,p,y,P,it){return i0(e,i,!1,null,h,p,y,P,it)},t.createHasPseudoClassSelector=function(e){return{$$typeof:Mh,value:e}},t.createHydrationContainer=function(e,i,h,p,y,P,it,Ct,Vt){return e=i0(h,p,!0,e,y,P,it,Ct,Vt),e.context=r0(null),h=e.current,p=Hr(),y=Gs(h),P=kt(p,y),P.callback=i??null,k(h,P,y),e.current.lanes=y,ko(e,y,p),tn(e,p),e},t.createPortal=function(e,i,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:p==null?null:""+p,children:e,containerInfo:i,implementation:h}},t.createRoleSelector=function(e){return{$$typeof:Rh,value:e}},t.createTestNameSelector=function(e){return{$$typeof:Fh,value:e}},t.createTextSelector=function(e){return{$$typeof:Ih,value:e}},t.deferredUpdates=function(e){var i=di,h=or.transition;try{return or.transition=null,di=16,e()}finally{di=i,or.transition=h}},t.discreteUpdates=function(e,i,h,p,y){var P=di,it=or.transition;try{return or.transition=null,di=1,e(i,h,p,y)}finally{di=P,or.transition=it,fi===0&&qa()}},t.findAllNodes=Qd,t.findBoundingRects=function(e,i){if(!L)throw Error(o(363));i=Qd(e,i),e=[];for(var h=0;h<i.length;h++)e.push(j(i[h]));for(i=e.length-1;0<i;i--){h=e[i];for(var p=h.x,y=p+h.width,P=h.y,it=P+h.height,Ct=i-1;0<=Ct;Ct--)if(i!==Ct){var Vt=e[Ct],pe=Vt.x,Ie=pe+Vt.width,Ze=Vt.y,ke=Ze+Vt.height;if(p>=pe&&P>=Ze&&y<=Ie&&it<=ke){e.splice(i,1);break}else if(p!==pe||h.width!==Vt.width||ke<P||Ze>it){if(!(P!==Ze||h.height!==Vt.height||Ie<p||pe>y)){pe>p&&(Vt.width+=pe-p,Vt.x=p),Ie<y&&(Vt.width=y-pe),e.splice(i,1);break}}else{Ze>P&&(Vt.height+=Ze-P,Vt.y=P),ke<it&&(Vt.height=it-Ze),e.splice(i,1);break}}}return e},t.findHostInstance=n0,t.findHostInstanceWithNoPortals=function(e){return e=tt(e),e=e!==null?dt(e):null,e===null?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return n0(e)},t.flushControlled=function(e){var i=fi;fi|=1;var h=or.transition,p=di;try{or.transition=null,di=1,e()}finally{di=p,or.transition=h,fi=i,fi===0&&(qa(),br())}},t.flushPassiveEffects=ba,t.flushSync=Km,t.focusWithin=function(e,i){if(!L)throw Error(o(363));for(e=Xd(e),i=Vm(e,i),i=Array.from(i),e=0;e<i.length;){var h=i[e++];if(!W(h)){if(h.tag===5&&O(h.stateNode))return!0;for(h=h.child;h!==null;)i.push(h),h=h.sibling}}return!1},t.getCurrentUpdatePriority=function(){return di},t.getFindAllNodesFailureDescription=function(e,i){if(!L)throw Error(o(363));var h=0,p=[];e=[Xd(e),0];for(var y=0;y<e.length;){var P=e[y++],it=e[y++],Ct=i[it];if((P.tag!==5||!W(P))&&(Yd(P,Ct)&&(p.push(qd(Ct)),it++,it>h&&(h=it)),it<i.length))for(P=P.child;P!==null;)e.push(P,it),P=P.sibling}if(h<i.length){for(e=[];h<i.length;h++)e.push(qd(i[h]));return`findAllNodes was able to match part of the selector:
  `+(p.join(" > ")+`

No matching component was found for:
  `)+e.join(" > ")}return null},t.getPublicRootInstance=function(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return Lt(e.child.stateNode);default:return e.child.stateNode}},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:Sw,findFiberByHostInstance:e.findFiberByHostInstance||Ew,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")e=!1;else{var i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(i.isDisabled||!i.supportsFiber)e=!0;else{try{mh=i.inject(e),Dr=i}catch{}e=!!i.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,i,h,p){if(!L)throw Error(o(363));e=Qd(e,i);var y=z(e,h,p).disconnect;return{disconnect:function(){y()}}},t.registerMutableSourceForHydration=function(e,i){var h=i._getVersion;h=h(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,h]:e.mutableSourceEagerHydrationData.push(i,h)},t.runWithPriority=function(e,i){var h=di;try{return di=e,i()}finally{di=h}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,i,h,p){var y=i.current,P=Hr(),it=Gs(y);return h=r0(h),i.context===null?i.context=h:i.pendingContext=h,i=kt(P,it),i.payload={element:e},p=p===void 0?null:p,p!==null&&(i.callback=p),e=k(y,i,it),e!==null&&(_n(e,y,it,P),X(e,y,it)),it},t};(function(r){r.exports=V_})(_g);const W_=o0(_g.exports);var gd={exports:{}},la={};la.ConcurrentRoot=1,la.ContinuousEventPriority=4,la.DefaultEventPriority=16,la.DiscreteEventPriority=1,la.IdleEventPriority=536870912,la.LegacyRoot=0,function(r){r.exports=la}(gd);const xg={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let wg=!1,Ag=!1;const md=".react-konva-event",$_=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,K_=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,X_={};function uh(r,t,s=X_){if(!wg&&"zIndex"in t&&(console.warn(K_),wg=!0),!Ag&&t.draggable){var n=t.x!==void 0||t.y!==void 0,a=t.onDragEnd||t.onDragMove;n&&!a&&(console.warn($_),Ag=!0)}for(var o in s)if(!xg[o]){var c=o.slice(0,2)==="on",u=s[o]!==t[o];if(c&&u){var d=o.substr(2).toLowerCase();d.substr(0,7)==="content"&&(d="content"+d.substr(7,1).toUpperCase()+d.substr(8)),r.off(d,s[o])}var f=!t.hasOwnProperty(o);f&&r.setAttr(o,void 0)}var m=t._useStrictMode,S={},_=!1;const v={};for(var o in t)if(!xg[o]){var c=o.slice(0,2)==="on",b=s[o]!==t[o];if(c&&b){var d=o.substr(2).toLowerCase();d.substr(0,7)==="content"&&(d="content"+d.substr(7,1).toUpperCase()+d.substr(8)),t[o]&&(v[d]=t[o])}!c&&(t[o]!==s[o]||m&&t[o]!==r.getAttr(o))&&(_=!0,S[o]=t[o])}_&&(r.setAttrs(S),Ns(r));for(var d in v)r.on(d+md,v[d])}function Ns(r){if(!si.Konva.autoDrawEnabled){var t=r.getLayer()||r.getStage();t&&t.batchDraw()}}const Sg={},Y_={};Eo.Node.prototype._applyProps=uh;function q_(r,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}r.add(t),Ns(r)}function Q_(r,t,s){let n=Eo[r];n||(console.error(`Konva has no node with the type ${r}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${r}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Eo.Group);const a={},o={};for(var c in t){var u=c.slice(0,2)==="on";u?o[c]=t[c]:a[c]=t[c]}const d=new n(a);return uh(d,o),d}function Z_(r,t,s){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${r}"`)}function J_(r,t,s){return!1}function tx(r){return r}function ex(){return null}function ix(){return null}function rx(r,t,s,n){return Y_}function nx(){}function sx(r){}function ax(r,t){return!1}function ox(){return Sg}function lx(){return Sg}const hx=setTimeout,cx=clearTimeout,dx=-1;function ux(r,t){return!1}const fx=!1,px=!0,gx=!0;function mx(r,t){t.parent===r?t.moveToTop():r.add(t),Ns(r)}function vx(r,t){t.parent===r?t.moveToTop():r.add(t),Ns(r)}function Eg(r,t,s){t._remove(),r.add(t),t.setZIndex(s.getZIndex()),Ns(r)}function yx(r,t,s){Eg(r,t,s)}function bx(r,t){t.destroy(),t.off(md),Ns(r)}function _x(r,t){t.destroy(),t.off(md),Ns(r)}function xx(r,t,s){console.error(`Text components are not yet supported in ReactKonva. You text is: "${s}"`)}function wx(r,t,s){}function Ax(r,t,s,n,a){uh(r,a,n)}function Sx(r){r.hide(),Ns(r)}function Ex(r){}function Cx(r,t){(t.visible==null||t.visible)&&r.show()}function kx(r,t){}function Tx(r){}function Px(){}const Mx=()=>gd.exports.DefaultEventPriority,Rx=Object.freeze(Object.defineProperty({__proto__:null,appendInitialChild:q_,createInstance:Q_,createTextInstance:Z_,finalizeInitialChildren:J_,getPublicInstance:tx,prepareForCommit:ex,preparePortalMount:ix,prepareUpdate:rx,resetAfterCommit:nx,resetTextContent:sx,shouldDeprioritizeSubtree:ax,getRootHostContext:ox,getChildHostContext:lx,scheduleTimeout:hx,cancelTimeout:cx,noTimeout:dx,shouldSetTextContent:ux,isPrimaryRenderer:fx,warnsIfNotActing:px,supportsMutation:gx,appendChild:mx,appendChildToContainer:vx,insertBefore:Eg,insertInContainerBefore:yx,removeChild:bx,removeChildFromContainer:_x,commitTextUpdate:xx,commitMount:wx,commitUpdate:Ax,hideInstance:Sx,hideTextInstance:Ex,unhideInstance:Cx,unhideTextInstance:kx,clearContainer:Tx,detachDeletedInstance:Px,getCurrentEventPriority:Mx,now:Wh.exports.unstable_now,idlePriority:Wh.exports.unstable_IdlePriority,run:Wh.exports.unstable_runWithPriority},Symbol.toStringTag,{value:"Module"}));var Fx=Object.defineProperty,Ix=Object.defineProperties,Lx=Object.getOwnPropertyDescriptors,Cg=Object.getOwnPropertySymbols,Dx=Object.prototype.hasOwnProperty,Nx=Object.prototype.propertyIsEnumerable,kg=(r,t,s)=>t in r?Fx(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Tg=(r,t)=>{for(var s in t||(t={}))Dx.call(t,s)&&kg(r,s,t[s]);if(Cg)for(var s of Cg(t))Nx.call(t,s)&&kg(r,s,t[s]);return r},Ox=(r,t)=>Ix(r,Lx(t)),Pg,Mg;typeof window<"u"&&((Pg=window.document)!=null&&Pg.createElement||((Mg=window.navigator)==null?void 0:Mg.product)==="ReactNative")?Ni.exports.useLayoutEffect:Ni.exports.useEffect;function Rg(r,t,s){if(!r)return;if(s(r)===!0)return r;let n=t?r.return:r.child;for(;n;){const a=Rg(n,t,s);if(a)return a;n=t?null:n.sibling}}function Fg(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const Ig=console.error;console.error=function(){const r=[...arguments].join("");if(r!=null&&r.startsWith("Warning:")&&r.includes("useContext")){console.error=Ig;return}return Ig.apply(this,arguments)};const vd=Fg(Ni.exports.createContext(null));class Lg extends Ni.exports.Component{render(){return Ni.exports.createElement(vd.Provider,{value:this._reactInternals},this.props.children)}}function zx(){const r=Ni.exports.useContext(vd);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=Ni.exports.useId();return Ni.exports.useMemo(()=>{for(const s of[r,r==null?void 0:r.alternate]){if(!s)continue;const n=Rg(s,!1,a=>{let o=a.memoizedState;for(;o;){if(o.memoizedState===t)return!0;o=o.next}});if(n)return n}},[r,t])}function Hx(){const r=zx(),[t]=Ni.exports.useState(()=>new Map);t.clear();let s=r;for(;s;){if(s.type&&typeof s.type=="object"){const n=s.type._context===void 0&&s.type.Provider===s.type?s.type:s.type._context;n&&n!==vd&&!t.has(n)&&t.set(n,Ni.exports.useContext(Fg(n)))}s=s.return}return t}function Bx(){const r=Hx();return Ni.exports.useMemo(()=>Array.from(r.keys()).reduce((t,s)=>n=>Ni.exports.createElement(t,null,Ni.exports.createElement(s.Provider,Ox(Tg({},n),{value:r.get(s)}))),t=>Ni.exports.createElement(Lg,Tg({},t))),[r])}function Ux(r){const t=se.useRef({});return se.useLayoutEffect(()=>{t.current=r}),se.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const Gx=r=>{const t=se.useRef(),s=se.useRef(),n=se.useRef(),a=Ux(r),o=Bx(),c=u=>{const{forwardedRef:d}=r;!d||(typeof d=="function"?d(u):d.current=u)};return se.useLayoutEffect(()=>(s.current=new Eo.Stage({width:r.width,height:r.height,container:t.current}),c(s.current),n.current=Co.createContainer(s.current,gd.exports.LegacyRoot,!1,null),Co.updateContainer(se.createElement(o,{},r.children),n.current),()=>{!Eo.isBrowser||(c(null),Co.updateContainer(null,n.current,null),s.current.destroy())}),[]),se.useLayoutEffect(()=>{c(s.current),uh(s.current,r,a),Co.updateContainer(se.createElement(o,{},r.children),n.current,null)}),se.createElement("div",{ref:t,id:r.id,accessKey:r.accessKey,className:r.className,role:r.role,style:r.style,tabIndex:r.tabIndex,title:r.title})},jx="Layer",Vx="Image",Co=W_(Rx);Co.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:se.version,rendererPackageName:"react-konva"});const Wx=se.forwardRef((r,t)=>se.createElement(Lg,{},se.createElement(Gx,{...r,forwardedRef:t}))),$x=(r,{scale:t=1}={},{refreshDeps:s}={refreshDeps:[]})=>{const[n,a]=Ni.exports.useState([]);return Ni.exports.useEffect(()=>{(async()=>{const o=[],c=await x1({url:r,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.2.67/cmaps/",cMapPacked:!0}).promise;for(let u=0;u<c.numPages;u++){const d=await c.getPage(u+1),f=d.getViewport({scale:t});console.log(f);const m=document.createElement("canvas"),S=m.getContext("2d");m.width=f.width,m.height=f.height,S!=null&&await d.render({canvasContext:S,viewport:f}).promise,d.cleanup(),o.push({width:f.width,height:f.height,pdfImgDataUrl:m.toDataURL()})}return o})().then(o=>{a(o)})},s),n};let pn;typeof window<"u"?pn=window:typeof self<"u"?pn=self:pn=global;let yd=null,bd=null;const Dg=20,_d=pn.clearTimeout,Ng=pn.setTimeout,xd=pn.cancelAnimationFrame||pn.mozCancelAnimationFrame||pn.webkitCancelAnimationFrame,Og=pn.requestAnimationFrame||pn.mozRequestAnimationFrame||pn.webkitRequestAnimationFrame;xd==null||Og==null?(yd=_d,bd=function(r){return Ng(r,Dg)}):(yd=function([r,t]){xd(r),_d(t)},bd=function(r){const t=Og(function(){_d(s),r()}),s=Ng(function(){xd(t),r()},Dg);return[t,s]});function Kx(r){let t,s,n,a,o,c,u;const d=typeof document<"u"&&document.attachEvent;if(!d){c=function(x){const A=x.__resizeTriggers__,F=A.firstElementChild,M=A.lastElementChild,g=F.firstElementChild;M.scrollLeft=M.scrollWidth,M.scrollTop=M.scrollHeight,g.style.width=F.offsetWidth+1+"px",g.style.height=F.offsetHeight+1+"px",F.scrollLeft=F.scrollWidth,F.scrollTop=F.scrollHeight},o=function(x){return x.offsetWidth!==x.__resizeLast__.width||x.offsetHeight!==x.__resizeLast__.height},u=function(x){if(x.target.className&&typeof x.target.className.indexOf=="function"&&x.target.className.indexOf("contract-trigger")<0&&x.target.className.indexOf("expand-trigger")<0)return;const A=this;c(this),this.__resizeRAF__&&yd(this.__resizeRAF__),this.__resizeRAF__=bd(function(){o(A)&&(A.__resizeLast__.width=A.offsetWidth,A.__resizeLast__.height=A.offsetHeight,A.__resizeListeners__.forEach(function(F){F.call(A,x)}))})};let m=!1,S="";n="animationstart";const _="Webkit Moz O ms".split(" ");let v="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),b="";{const x=document.createElement("fakeelement");if(x.style.animationName!==void 0&&(m=!0),m===!1){for(let A=0;A<_.length;A++)if(x.style[_[A]+"AnimationName"]!==void 0){b=_[A],S="-"+b.toLowerCase()+"-",n=v[A],m=!0;break}}}s="resizeanim",t="@"+S+"keyframes "+s+" { from { opacity: 0; } to { opacity: 0; } } ",a=S+"animation: 1ms "+s+"; "}const f=function(m){if(!m.getElementById("detectElementResize")){const S=(t||"")+".resize-triggers { "+(a||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',_=m.head||m.getElementsByTagName("head")[0],v=m.createElement("style");v.id="detectElementResize",v.type="text/css",r!=null&&v.setAttribute("nonce",r),v.styleSheet?v.styleSheet.cssText=S:v.appendChild(m.createTextNode(S)),_.appendChild(v)}};return{addResizeListener:function(m,S){if(d)m.attachEvent("onresize",S);else{if(!m.__resizeTriggers__){const _=m.ownerDocument,v=pn.getComputedStyle(m);v&&v.position==="static"&&(m.style.position="relative"),f(_),m.__resizeLast__={},m.__resizeListeners__=[],(m.__resizeTriggers__=_.createElement("div")).className="resize-triggers";const b=_.createElement("div");b.className="expand-trigger",b.appendChild(_.createElement("div"));const x=_.createElement("div");x.className="contract-trigger",m.__resizeTriggers__.appendChild(b),m.__resizeTriggers__.appendChild(x),m.appendChild(m.__resizeTriggers__),c(m),m.addEventListener("scroll",u,!0),n&&(m.__resizeTriggers__.__animationListener__=function(A){A.animationName===s&&c(m)},m.__resizeTriggers__.addEventListener(n,m.__resizeTriggers__.__animationListener__))}m.__resizeListeners__.push(S)}},removeResizeListener:function(m,S){if(d)m.detachEvent("onresize",S);else if(m.__resizeListeners__.splice(m.__resizeListeners__.indexOf(S),1),!m.__resizeListeners__.length){m.removeEventListener("scroll",u,!0),m.__resizeTriggers__.__animationListener__&&(m.__resizeTriggers__.removeEventListener(n,m.__resizeTriggers__.__animationListener__),m.__resizeTriggers__.__animationListener__=null);try{m.__resizeTriggers__=!m.removeChild(m.__resizeTriggers__)}catch{}}}}}class zg extends Ni.exports.Component{constructor(...t){super(...t),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:s,disableWidth:n,onResize:a}=this.props;if(this._parentNode){const o=window.getComputedStyle(this._parentNode)||{},c=parseFloat(o.paddingLeft||"0"),u=parseFloat(o.paddingRight||"0"),d=parseFloat(o.paddingTop||"0"),f=parseFloat(o.paddingBottom||"0"),m=this._parentNode.getBoundingClientRect(),S=m.height-d-f,_=m.width-c-u,v=this._parentNode.offsetHeight-d-f,b=this._parentNode.offsetWidth-c-u;(!s&&(this.state.height!==v||this.state.scaledHeight!==S)||!n&&(this.state.width!==b||this.state.scaledWidth!==_))&&(this.setState({height:v,width:b,scaledHeight:S,scaledWidth:_}),typeof a=="function"&&a({height:v,scaledHeight:S,scaledWidth:_,width:b}))}},this._setRef=s=>{this._autoSizer=s}}componentDidMount(){const{nonce:t}=this.props,s=this._autoSizer?this._autoSizer.parentNode:null;if(s!=null&&s.ownerDocument&&s.ownerDocument.defaultView&&s instanceof s.ownerDocument.defaultView.HTMLElement){this._parentNode=s;const n=s.ownerDocument.defaultView.ResizeObserver;n!=null?(this._resizeObserver=new n(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(s)):(this._detectElementResize=Kx(t),this._detectElementResize.addResizeListener(s,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:t,defaultHeight:s,defaultWidth:n,disableHeight:a=!1,disableWidth:o=!1,doNotBailOutOnEmptyChildren:c=!1,nonce:u,onResize:d,style:f={},tagName:m="div",...S}=this.props,{height:_,scaledHeight:v,scaledWidth:b,width:x}=this.state,A={overflow:"visible"},F={};let M=!1;return a||(_===0&&(M=!0),A.height=0,F.height=_,F.scaledHeight=v),o||(x===0&&(M=!0),A.width=0,F.width=x,F.scaledWidth=b),c&&(M=!1),Ni.exports.createElement(m,{ref:this._setRef,style:{...A,...f},...S},!M&&t(F))}}pc.workerSrc="pdf.worker.js",l0=function(){const r=Ni.exports.useRef(null),t=Ni.exports.useRef(null),[s,n]=Ni.exports.useState({x:0,y:0}),[a,o]=se.useState(0),[c,u]=se.useState(0),d=Ni.exports.useRef(null),f=$x("./demo.pdf",{scale:1.5},{refreshDeps:[]}),{contentHeight:m,contentWidth:S}=Ni.exports.useMemo(()=>({contentHeight:f.reduce((v,b)=>v+b.height,0),contentWidth:Math.max(...f.map(v=>v.width))}),[f]),_=Ni.exports.useCallback(()=>{if(t.current==null||r.current==null)return;const{scrollLeft:v,scrollTop:b,clientHeight:x}=t.current,A=v,F=b,M=S-A,g=x;r.current.container().style.transform=`translate(${A}px, ${F}px)`,r.current.container().style.width=`${M}px`,r.current.container().style.height=`${g}px`,r.current.position({x:-A,y:-F}),r.current.setSize({width:M,height:g}),n({x:A,y:F})},[S]);return Ni.exports.useEffect(()=>{var x;const v=s.y,b=f.reduce((A,F,M,g)=>{const w=g.slice(0,M+1).reduce((E,C)=>E+C.height,0);return v<=w?A:A+1},0);d.current!=null&&((x=d.current)==null||x.scrollToIndex({index:b}),o(b))},[s,f]),Ni.exports.useEffect(()=>{var b;let v=0;for(let x=0;x<f.length;x++){const A=f[x];if(x===c){(b=t.current)==null||b.scrollTo({top:v+10});break}else v=v+A.height}},[c,f]),Mw("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",position:"relative",overflow:"hidden"},children:[wn("div",{style:{flexBasis:200,flexShrink:0,height:"100%",overflow:"auto"},children:wn(zg,{children:({width:v,height:b})=>wn(Iv,{ref:d,style:{height:b,width:v},totalCount:f.length,overscan:{main:b,reverse:b},itemContent:x=>wn("div",{style:a===x?{border:"1px solid #000"}:{},children:wn("img",{width:"100%",src:f[x].pdfImgDataUrl,onClick:()=>{o(x),u(x)}})})})})}),wn("div",{style:{flexGrow:1,height:"100%",overflow:"hidden"},children:wn(zg,{children:({width:v,height:b})=>wn("div",{ref:t,style:{width:v,height:b,overflow:"auto"},onScroll:_,children:wn("div",{style:{margin:"0 auto",width:Math.max(...f.map(x=>x.width)),height:m},children:wn(Wx,{width:v,height:b,ref:r,x:-s.x,y:-s.y,children:wn(jx,{children:f.map((x,A,F)=>{if(!(Math.abs(A-a)<=2))return null;const M=new window.Image;return M.src=x.pdfImgDataUrl,wn(Vx,{y:F.slice(0,A).reduce((g,w)=>g+((w==null?void 0:w.height)??0),0),x:(S-x.width)/2,image:M},A)})})})})})})})]})}});export{Fw as __tla,l0 as default};
