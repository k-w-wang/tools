var Ew=Object.defineProperty;var Cw=(Ni,Pi,Mi)=>Pi in Ni?Ew(Ni,Pi,{enumerable:!0,configurable:!0,writable:!0,value:Mi}):Ni[Pi]=Mi;var ti=(Ni,Pi,Mi)=>(Cw(Ni,typeof Pi!="symbol"?Pi+"":Pi,Mi),Mi),uu=(Ni,Pi,Mi)=>{if(!Pi.has(Ni))throw TypeError("Cannot "+Mi)};var l=(Ni,Pi,Mi)=>(uu(Ni,Pi,"read from private field"),Mi?Mi.call(Ni):Pi.get(Ni)),N=(Ni,Pi,Mi)=>{if(Pi.has(Ni))throw TypeError("Cannot add the same private member more than once");Pi instanceof WeakSet?Pi.add(Ni):Pi.set(Ni,Mi)},J=(Ni,Pi,Mi,Be)=>(uu(Ni,Pi,"write to private field"),Be?Be.call(Ni,Mi):Pi.set(Ni,Mi),Mi),xs=(Ni,Pi,Mi,Be)=>({set _(Aa){J(Ni,Pi,Aa,Mi)},get _(){return l(Ni,Pi,Be)}}),Y=(Ni,Pi,Mi)=>(uu(Ni,Pi,"access private method"),Mi);import{b2 as Ws,R as se,a8 as kw,b3 as u0,b4 as f0,r as Fr,b5 as $h,__tla as Tw}from"./index-84c40ad6.js";let g0,p0,m0,v0,y0,b0,_0,x0,Pw=Promise.all([(()=>{try{return Tw}catch{}})()]).then(async()=>{var Ni={976:(r,t,s)=>{var Gt,lt,Ft,fu,ie,_a,_e,w0,T,A0,D,H,L,V,j,G,W,U,O,z,et,nt,pt,yt,Nt,Ht,Pt,Bt,S0,at,Kh,vt,gu,bt,pu,ot,ft,Et,Kt,te,me,Pe,mu,je,hi,ze,vi,E0,tr,vu;s.d(t,{AnnotationLayer:()=>Ve,FreeTextAnnotationElement:()=>st,InkAnnotationElement:()=>Dt,StampAnnotationElement:()=>pe});var n=s(292),a=s(419),o=s(792);function c(Me){return Math.floor(Math.max(0,Math.min(1,Me))*255).toString(16).padStart(2,"0")}function u(Me){return Math.max(0,Math.min(255,255*Me))}class d{static CMYK_G([Q,K,ht,xt]){return["G",1-Math.min(1,.3*Q+.59*ht+.11*K+xt)]}static G_CMYK([Q]){return["CMYK",0,0,0,1-Q]}static G_RGB([Q]){return["RGB",Q,Q,Q]}static G_rgb([Q]){return Q=u(Q),[Q,Q,Q]}static G_HTML([Q]){const K=c(Q);return`#${K}${K}${K}`}static RGB_G([Q,K,ht]){return["G",.3*Q+.59*K+.11*ht]}static RGB_rgb(Q){return Q.map(u)}static RGB_HTML(Q){return`#${Q.map(c).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([Q,K,ht,xt]){return["RGB",1-Math.min(1,Q+xt),1-Math.min(1,ht+xt),1-Math.min(1,K+xt)]}static CMYK_rgb([Q,K,ht,xt]){return[u(1-Math.min(1,Q+xt)),u(1-Math.min(1,ht+xt)),u(1-Math.min(1,K+xt))]}static CMYK_HTML(Q){const K=this.CMYK_RGB(Q).slice(1);return this.RGB_HTML(K)}static RGB_CMYK([Q,K,ht]){const xt=1-Q,St=1-K,It=1-ht,Ot=Math.min(xt,St,It);return["CMYK",xt,St,It,Ot]}}var f=s(284);const m=1e3,S=9,_=new WeakSet;function y(Me){return{width:Me[2]-Me[0],height:Me[3]-Me[1]}}class b{static create(Q){switch(Q.data.annotationType){case n.AnnotationType.LINK:return new E(Q);case n.AnnotationType.TEXT:return new I(Q);case n.AnnotationType.WIDGET:switch(Q.data.fieldType){case"Tx":return new p(Q);case"Btn":return Q.data.radioButton?new C(Q):Q.data.checkBox?new A(Q):new B(Q);case"Ch":return new F(Q);case"Sig":return new w(Q)}return new R(Q);case n.AnnotationType.POPUP:return new rt(Q);case n.AnnotationType.FREETEXT:return new st(Q);case n.AnnotationType.LINE:return new wt(Q);case n.AnnotationType.SQUARE:return new dt(Q);case n.AnnotationType.CIRCLE:return new Tt(Q);case n.AnnotationType.POLYLINE:return new Lt(Q);case n.AnnotationType.CARET:return new ct(Q);case n.AnnotationType.INK:return new Dt(Q);case n.AnnotationType.POLYGON:return new Qt(Q);case n.AnnotationType.HIGHLIGHT:return new ee(Q);case n.AnnotationType.UNDERLINE:return new zt(Q);case n.AnnotationType.SQUIGGLY:return new Jt(Q);case n.AnnotationType.STRIKEOUT:return new oe(Q);case n.AnnotationType.STAMP:return new pe(Q);case n.AnnotationType.FILEATTACHMENT:return new Ae(Q);default:return new x(Q)}}}const ve=class{constructor(Q,{isRenderable:K=!1,ignoreBorder:ht=!1,createQuadrilaterals:xt=!1}={}){N(this,Ft);N(this,Gt,null);N(this,lt,!1);this.isRenderable=K,this.data=Q.data,this.layer=Q.layer,this.linkService=Q.linkService,this.downloadManager=Q.downloadManager,this.imageResourcesPath=Q.imageResourcesPath,this.renderForms=Q.renderForms,this.svgFactory=Q.svgFactory,this.annotationStorage=Q.annotationStorage,this.enableScripting=Q.enableScripting,this.hasJSActions=Q.hasJSActions,this._fieldObjects=Q.fieldObjects,this.parent=Q.parent,K&&(this.container=this._createContainer(ht)),xt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Q,contentsObj:K,richText:ht}){return!!(Q!=null&&Q.str||K!=null&&K.str||ht!=null&&ht.str)}get hasPopupData(){return ve._hasPopupData(this.data)}updateEdited(Q){if(!this.container)return;l(this,Gt)||J(this,Gt,{rect:this.data.rect.slice(0)});const{rect:K}=Q;K&&Y(this,Ft,fu).call(this,K)}resetEdited(){!l(this,Gt)||(Y(this,Ft,fu).call(this,l(this,Gt).rect),J(this,Gt,null))}_createContainer(Q){const{data:K,parent:{page:ht,viewport:xt}}=this,St=document.createElement("section");St.setAttribute("data-annotation-id",K.id),this instanceof R||(St.tabIndex=m);const{style:It}=St;if(It.zIndex=this.parent.zIndex++,K.popupRef&&St.setAttribute("aria-haspopup","dialog"),K.alternativeText&&(St.title=K.alternativeText),K.noRotate&&St.classList.add("norotate"),!K.rect||this instanceof rt){const{rotation:we}=K;return!K.hasOwnCanvas&&we!==0&&this.setRotation(we,St),St}const{width:Ot,height:ye}=y(K.rect);if(!Q&&K.borderStyle.width>0){It.borderWidth=`${K.borderStyle.width}px`;const we=K.borderStyle.horizontalCornerRadius,He=K.borderStyle.verticalCornerRadius;if(we>0||He>0){const Oi=`calc(${we}px * var(--scale-factor)) / calc(${He}px * var(--scale-factor))`;It.borderRadius=Oi}else if(this instanceof C){const Oi=`calc(${Ot}px * var(--scale-factor)) / calc(${ye}px * var(--scale-factor))`;It.borderRadius=Oi}switch(K.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:It.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:It.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:It.borderBottomStyle="solid";break}const Ue=K.borderColor||null;Ue?(J(this,lt,!0),It.borderColor=n.Util.makeHexColor(Ue[0]|0,Ue[1]|0,Ue[2]|0)):It.borderWidth=0}const le=n.Util.normalizeRect([K.rect[0],ht.view[3]-K.rect[1]+ht.view[1],K.rect[2],ht.view[3]-K.rect[3]+ht.view[1]]),{pageWidth:$t,pageHeight:ne,pageX:ue,pageY:he}=xt.rawDims;It.left=`${100*(le[0]-ue)/$t}%`,It.top=`${100*(le[1]-he)/ne}%`;const{rotation:Le}=K;return K.hasOwnCanvas||Le===0?(It.width=`${100*Ot/$t}%`,It.height=`${100*ye/ne}%`):this.setRotation(Le,St),St}setRotation(Q,K=this.container){if(!this.data.rect)return;const{pageWidth:ht,pageHeight:xt}=this.parent.viewport.rawDims,{width:St,height:It}=y(this.data.rect);let Ot,ye;Q%180===0?(Ot=100*St/ht,ye=100*It/xt):(Ot=100*It/ht,ye=100*St/xt),K.style.width=`${Ot}%`,K.style.height=`${ye}%`,K.setAttribute("data-main-rotation",(360-Q)%360)}get _commonActions(){const Q=(K,ht,xt)=>{const St=xt.detail[K],It=St[0],Ot=St.slice(1);xt.target.style[ht]=d[`${It}_HTML`](Ot),this.annotationStorage.setValue(this.data.id,{[ht]:d[`${It}_rgb`](Ot)})};return(0,n.shadow)(this,"_commonActions",{display:K=>{const{display:ht}=K.detail,xt=ht%2===1;this.container.style.visibility=xt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:xt,noPrint:ht===1||ht===2})},print:K=>{this.annotationStorage.setValue(this.data.id,{noPrint:!K.detail.print})},hidden:K=>{const{hidden:ht}=K.detail;this.container.style.visibility=ht?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:ht,noView:ht})},focus:K=>{setTimeout(()=>K.target.focus({preventScroll:!1}),0)},userName:K=>{K.target.title=K.detail.userName},readonly:K=>{K.target.disabled=K.detail.readonly},required:K=>{this._setRequired(K.target,K.detail.required)},bgColor:K=>{Q("bgColor","backgroundColor",K)},fillColor:K=>{Q("fillColor","backgroundColor",K)},fgColor:K=>{Q("fgColor","color",K)},textColor:K=>{Q("textColor","color",K)},borderColor:K=>{Q("borderColor","borderColor",K)},strokeColor:K=>{Q("strokeColor","borderColor",K)},rotation:K=>{const ht=K.detail.rotation;this.setRotation(ht),this.annotationStorage.setValue(this.data.id,{rotation:ht})}})}_dispatchEventFromSandbox(Q,K){var xt;const ht=this._commonActions;for(const St of Object.keys(K.detail))(xt=Q[St]||ht[St])==null||xt(K)}_setDefaultPropertiesFromJS(Q){if(!this.enableScripting)return;const K=this.annotationStorage.getRawValue(this.data.id);if(!K)return;const ht=this._commonActions;for(const[xt,St]of Object.entries(K)){const It=ht[xt];if(It){const Ot={detail:{[xt]:St},target:Q};It(Ot),delete K[xt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Q}=this.data;if(!Q)return;const[K,ht,xt,St]=this.data.rect;if(Q.length===1){const[,{x:we,y:He},{x:Ue,y:Oi}]=Q[0];if(xt===we&&St===He&&K===Ue&&ht===Oi)return}const{style:It}=this.container;let Ot;if(l(this,lt)){const{borderColor:we,borderWidth:He}=It;It.borderWidth=0,Ot=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${we}" stroke-width="${He}">`],this.container.classList.add("hasBorder")}const ye=xt-K,le=St-ht,{svgFactory:$t}=this,ne=$t.createElement("svg");ne.classList.add("quadrilateralsContainer"),ne.setAttribute("width",0),ne.setAttribute("height",0);const ue=$t.createElement("defs");ne.append(ue);const he=$t.createElement("clipPath"),Le=`clippath_${this.data.id}`;he.setAttribute("id",Le),he.setAttribute("clipPathUnits","objectBoundingBox"),ue.append(he);for(const[,{x:we,y:He},{x:Ue,y:Oi}]of Q){const ei=$t.createElement("rect"),or=(Ue-K)/ye,zi=(St-He)/le,qe=(we-Ue)/ye,$=(He-Oi)/le;ei.setAttribute("x",or),ei.setAttribute("y",zi),ei.setAttribute("width",qe),ei.setAttribute("height",$),he.append(ei),Ot==null||Ot.push(`<rect vector-effect="non-scaling-stroke" x="${or}" y="${zi}" width="${qe}" height="${$}"/>`)}l(this,lt)&&(Ot.push("</g></svg>')"),It.backgroundImage=Ot.join("")),this.container.append(ne),this.container.style.clipPath=`url(#${Le})`}_createPopup(){const{container:Q,data:K}=this;Q.setAttribute("aria-haspopup","dialog");const ht=new rt({data:{color:K.color,titleObj:K.titleObj,modificationDate:K.modificationDate,contentsObj:K.contentsObj,richText:K.richText,parentRect:K.rect,borderStyle:0,id:`popup_${K.id}`,rotation:K.rotation},parent:this.parent,elements:[this]});this.parent.div.append(ht.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Q,K=null){const ht=[];if(this._fieldObjects){const xt=this._fieldObjects[Q];if(xt)for(const{page:St,id:It,exportValues:Ot}of xt){if(St===-1||It===K)continue;const ye=typeof Ot=="string"?Ot:null,le=document.querySelector(`[data-element-id="${It}"]`);if(le&&!_.has(le)){(0,n.warn)(`_getElementsByName - element not allowed: ${It}`);continue}ht.push({id:It,exportValue:ye,domElement:le})}return ht}for(const xt of document.getElementsByName(Q)){const{exportValue:St}=xt,It=xt.getAttribute("data-element-id");It!==K&&(!_.has(xt)||ht.push({id:It,exportValue:St,domElement:xt}))}return ht}show(){var Q;this.container&&(this.container.hidden=!1),(Q=this.popup)==null||Q.maybeShow()}hide(){var Q;this.container&&(this.container.hidden=!0),(Q=this.popup)==null||Q.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Q=this.getElementsToTriggerPopup();if(Array.isArray(Q))for(const K of Q)K.classList.add("highlightArea");else Q.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:Q,data:{id:K}}=this;this.container.addEventListener("dblclick",()=>{var ht;(ht=this.linkService.eventBus)==null||ht.dispatch("switchannotationeditormode",{source:this,mode:Q,editId:K})})}};let x=ve;Gt=new WeakMap,lt=new WeakMap,Ft=new WeakSet,fu=function(Q){const{container:{style:K},data:{rect:ht,rotation:xt},parent:{viewport:{rawDims:{pageWidth:St,pageHeight:It,pageX:Ot,pageY:ye}}}}=this;ht==null||ht.splice(0,4,...Q);const{width:le,height:$t}=y(Q);K.left=`${100*(Q[0]-Ot)/St}%`,K.top=`${100*(It-Q[3]+ye)/It}%`,xt===0?(K.width=`${100*le/St}%`,K.height=`${100*$t/It}%`):this.setRotation(xt)};class E extends x{constructor(K,ht=null){super(K,{isRenderable:!0,ignoreBorder:!!(ht!=null&&ht.ignoreBorder),createQuadrilaterals:!0});N(this,ie);N(this,_e);N(this,T);this.isTooltipOnly=K.data.isTooltipOnly}render(){const{data:K,linkService:ht}=this,xt=document.createElement("a");xt.setAttribute("data-element-id",K.id);let St=!1;return K.url?(ht.addLinkAttributes(xt,K.url,K.newWindow),St=!0):K.action?(this._bindNamedAction(xt,K.action),St=!0):K.attachment?(Y(this,_e,w0).call(this,xt,K.attachment,K.attachmentDest),St=!0):K.setOCGState?(Y(this,T,A0).call(this,xt,K.setOCGState),St=!0):K.dest?(this._bindLink(xt,K.dest),St=!0):(K.actions&&(K.actions.Action||K.actions["Mouse Up"]||K.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(xt,K),St=!0),K.resetForm?(this._bindResetFormAction(xt,K.resetForm),St=!0):this.isTooltipOnly&&!St&&(this._bindLink(xt,""),St=!0)),this.container.classList.add("linkAnnotation"),St&&this.container.append(xt),this.container}_bindLink(K,ht){K.href=this.linkService.getDestinationHash(ht),K.onclick=()=>(ht&&this.linkService.goToDestination(ht),!1),(ht||ht==="")&&Y(this,ie,_a).call(this)}_bindNamedAction(K,ht){K.href=this.linkService.getAnchorUrl(""),K.onclick=()=>(this.linkService.executeNamedAction(ht),!1),Y(this,ie,_a).call(this)}_bindJSAction(K,ht){K.href=this.linkService.getAnchorUrl("");const xt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const St of Object.keys(ht.actions)){const It=xt.get(St);!It||(K[It]=()=>{var Ot;return(Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ht.id,name:St}}),!1})}K.onclick||(K.onclick=()=>!1),Y(this,ie,_a).call(this)}_bindResetFormAction(K,ht){const xt=K.onclick;if(xt||(K.href=this.linkService.getAnchorUrl("")),Y(this,ie,_a).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),xt||(K.onclick=()=>!1);return}K.onclick=()=>{var ne;xt==null||xt();const{fields:St,refs:It,include:Ot}=ht,ye=[];if(St.length!==0||It.length!==0){const ue=new Set(It);for(const he of St){const Le=this._fieldObjects[he]||[];for(const{id:we}of Le)ue.add(we)}for(const he of Object.values(this._fieldObjects))for(const Le of he)ue.has(Le.id)===Ot&&ye.push(Le)}else for(const ue of Object.values(this._fieldObjects))ye.push(...ue);const le=this.annotationStorage,$t=[];for(const ue of ye){const{id:he}=ue;switch($t.push(he),ue.type){case"text":{const we=ue.defaultValue||"";le.setValue(he,{value:we});break}case"checkbox":case"radiobutton":{const we=ue.defaultValue===ue.exportValues;le.setValue(he,{value:we});break}case"combobox":case"listbox":{const we=ue.defaultValue||"";le.setValue(he,{value:we});break}default:continue}const Le=document.querySelector(`[data-element-id="${he}"]`);if(Le){if(!_.has(Le)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${he}`);continue}}else continue;Le.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:$t,name:"ResetForm"}})),!1}}}ie=new WeakSet,_a=function(){this.container.setAttribute("data-internal-link","")},_e=new WeakSet,w0=function(K,ht,xt=null){K.href=this.linkService.getAnchorUrl(""),K.onclick=()=>{var St;return(St=this.downloadManager)==null||St.openOrDownloadData(ht.content,ht.filename,xt),!1},Y(this,ie,_a).call(this)},T=new WeakSet,A0=function(K,ht){K.href=this.linkService.getAnchorUrl(""),K.onclick=()=>(this.linkService.executeSetOCGState(ht),!1),Y(this,ie,_a).call(this)};class I extends x{constructor(Q){super(Q,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Q=document.createElement("img");return Q.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Q.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),Q.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Q),this.container}}class R extends x{render(){return this.container}showElementAndHideCanvas(Q){var K;this.data.hasOwnCanvas&&(((K=Q.previousSibling)==null?void 0:K.nodeName)==="CANVAS"&&(Q.previousSibling.hidden=!0),Q.hidden=!1)}_getKeyModifier(Q){return n.FeatureTest.platform.isMac?Q.metaKey:Q.ctrlKey}_setEventListener(Q,K,ht,xt,St){ht.includes("mouse")?Q.addEventListener(ht,It=>{var Ot;(Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:xt,value:St(It),shift:It.shiftKey,modifier:this._getKeyModifier(It)}})}):Q.addEventListener(ht,It=>{var Ot;if(ht==="blur"){if(!K.focused||!It.relatedTarget)return;K.focused=!1}else if(ht==="focus"){if(K.focused)return;K.focused=!0}!St||((Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:xt,value:St(It)}}))})}_setEventListeners(Q,K,ht,xt){var St,It,Ot;for(const[ye,le]of ht)(le==="Action"||(St=this.data.actions)!=null&&St[le])&&((le==="Focus"||le==="Blur")&&(K||(K={focused:!1})),this._setEventListener(Q,K,ye,le,xt),le==="Focus"&&!((It=this.data.actions)!=null&&It.Blur)?this._setEventListener(Q,K,"blur","Blur",null):le==="Blur"&&!((Ot=this.data.actions)!=null&&Ot.Focus)&&this._setEventListener(Q,K,"focus","Focus",null))}_setBackgroundColor(Q){const K=this.data.backgroundColor||null;Q.style.backgroundColor=K===null?"transparent":n.Util.makeHexColor(K[0],K[1],K[2])}_setTextStyle(Q){const K=["left","center","right"],{fontColor:ht}=this.data.defaultAppearanceData,xt=this.data.defaultAppearanceData.fontSize||S,St=Q.style;let It;const Ot=2,ye=le=>Math.round(10*le)/10;if(this.data.multiLine){const le=Math.abs(this.data.rect[3]-this.data.rect[1]-Ot),$t=Math.round(le/(n.LINE_FACTOR*xt))||1,ne=le/$t;It=Math.min(xt,ye(ne/n.LINE_FACTOR))}else{const le=Math.abs(this.data.rect[3]-this.data.rect[1]-Ot);It=Math.min(xt,ye(le/n.LINE_FACTOR))}St.fontSize=`calc(${It}px * var(--scale-factor))`,St.color=n.Util.makeHexColor(ht[0],ht[1],ht[2]),this.data.textAlignment!==null&&(St.textAlign=K[this.data.textAlignment])}_setRequired(Q,K){K?Q.setAttribute("required",!0):Q.removeAttribute("required"),Q.setAttribute("aria-required",K)}}class p extends R{constructor(Q){const K=Q.renderForms||Q.data.hasOwnCanvas||!Q.data.hasAppearance&&!!Q.data.fieldValue;super(Q,{isRenderable:K})}setPropertyOnSiblings(Q,K,ht,xt){const St=this.annotationStorage;for(const It of this._getElementsByName(Q.name,Q.id))It.domElement&&(It.domElement[K]=ht),St.setValue(It.id,{[xt]:ht})}render(){var xt,St;const Q=this.annotationStorage,K=this.data.id;this.container.classList.add("textWidgetAnnotation");let ht=null;if(this.renderForms){const It=Q.getValue(K,{value:this.data.fieldValue});let Ot=It.value||"";const ye=Q.getValue(K,{charLimit:this.data.maxLen}).charLimit;ye&&Ot.length>ye&&(Ot=Ot.slice(0,ye));let le=It.formattedValue||((xt=this.data.textContent)==null?void 0:xt.join(`
`))||null;le&&this.data.comb&&(le=le.replaceAll(/\s+/g,""));const $t={userValue:Ot,formattedValue:le,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(ht=document.createElement("textarea"),ht.textContent=le??Ot,this.data.doNotScroll&&(ht.style.overflowY="hidden")):(ht=document.createElement("input"),ht.type="text",ht.setAttribute("value",le??Ot),this.data.doNotScroll&&(ht.style.overflowX="hidden")),this.data.hasOwnCanvas&&(ht.hidden=!0),_.add(ht),ht.setAttribute("data-element-id",K),ht.disabled=this.data.readOnly,ht.name=this.data.fieldName,ht.tabIndex=m,this._setRequired(ht,this.data.required),ye&&(ht.maxLength=ye),ht.addEventListener("input",ue=>{Q.setValue(K,{value:ue.target.value}),this.setPropertyOnSiblings(ht,"value",ue.target.value,"value"),$t.formattedValue=null}),ht.addEventListener("resetform",ue=>{const he=this.data.defaultFieldValue??"";ht.value=$t.userValue=he,$t.formattedValue=null});let ne=ue=>{const{formattedValue:he}=$t;he!=null&&(ue.target.value=he),ue.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){ht.addEventListener("focus",he=>{var we;if($t.focused)return;const{target:Le}=he;$t.userValue&&(Le.value=$t.userValue),$t.lastCommittedValue=Le.value,$t.commitKey=1,(we=this.data.actions)!=null&&we.Focus||($t.focused=!0)}),ht.addEventListener("updatefromsandbox",he=>{this.showElementAndHideCanvas(he.target);const Le={value(we){$t.userValue=we.detail.value??"",Q.setValue(K,{value:$t.userValue.toString()}),we.target.value=$t.userValue},formattedValue(we){const{formattedValue:He}=we.detail;$t.formattedValue=He,He!=null&&we.target!==document.activeElement&&(we.target.value=He),Q.setValue(K,{formattedValue:He})},selRange(we){we.target.setSelectionRange(...we.detail.selRange)},charLimit:we=>{var ei;const{charLimit:He}=we.detail,{target:Ue}=we;if(He===0){Ue.removeAttribute("maxLength");return}Ue.setAttribute("maxLength",He);let Oi=$t.userValue;!Oi||Oi.length<=He||(Oi=Oi.slice(0,He),Ue.value=$t.userValue=Oi,Q.setValue(K,{value:Oi}),(ei=this.linkService.eventBus)==null||ei.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:Oi,willCommit:!0,commitKey:1,selStart:Ue.selectionStart,selEnd:Ue.selectionEnd}}))}};this._dispatchEventFromSandbox(Le,he)}),ht.addEventListener("keydown",he=>{var He;$t.commitKey=1;let Le=-1;if(he.key==="Escape"?Le=0:he.key==="Enter"&&!this.data.multiLine?Le=2:he.key==="Tab"&&($t.commitKey=3),Le===-1)return;const{value:we}=he.target;$t.lastCommittedValue!==we&&($t.lastCommittedValue=we,$t.userValue=we,(He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:we,willCommit:!0,commitKey:Le,selStart:he.target.selectionStart,selEnd:he.target.selectionEnd}}))});const ue=ne;ne=null,ht.addEventListener("blur",he=>{var we,He;if(!$t.focused||!he.relatedTarget)return;(we=this.data.actions)!=null&&we.Blur||($t.focused=!1);const{value:Le}=he.target;$t.userValue=Le,$t.lastCommittedValue!==Le&&((He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:Le,willCommit:!0,commitKey:$t.commitKey,selStart:he.target.selectionStart,selEnd:he.target.selectionEnd}})),ue(he)}),(St=this.data.actions)!=null&&St.Keystroke&&ht.addEventListener("beforeinput",he=>{var zi;$t.lastCommittedValue=null;const{data:Le,target:we}=he,{value:He,selectionStart:Ue,selectionEnd:Oi}=we;let ei=Ue,or=Oi;switch(he.inputType){case"deleteWordBackward":{const qe=He.substring(0,Ue).match(/\w*[^\w]*$/);qe&&(ei-=qe[0].length);break}case"deleteWordForward":{const qe=He.substring(Ue).match(/^[^\w]*\w*/);qe&&(or+=qe[0].length);break}case"deleteContentBackward":Ue===Oi&&(ei-=1);break;case"deleteContentForward":Ue===Oi&&(or+=1);break}he.preventDefault(),(zi=this.linkService.eventBus)==null||zi.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:He,change:Le||"",willCommit:!1,selStart:ei,selEnd:or}})}),this._setEventListeners(ht,$t,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],he=>he.target.value)}if(ne&&ht.addEventListener("blur",ne),this.data.comb){const ue=(this.data.rect[2]-this.data.rect[0])/ye;ht.classList.add("comb"),ht.style.letterSpacing=`calc(${ue}px * var(--scale-factor) - 1ch)`}}else ht=document.createElement("div"),ht.textContent=this.data.fieldValue,ht.style.verticalAlign="middle",ht.style.display="table-cell",this.data.hasOwnCanvas&&(ht.hidden=!0);return this._setTextStyle(ht),this._setBackgroundColor(ht),this._setDefaultPropertiesFromJS(ht),this.container.append(ht),this.container}}class w extends R{constructor(Q){super(Q,{isRenderable:!!Q.data.hasOwnCanvas})}}class A extends R{constructor(Q){super(Q,{isRenderable:Q.renderForms})}render(){const Q=this.annotationStorage,K=this.data,ht=K.id;let xt=Q.getValue(ht,{value:K.exportValue===K.fieldValue}).value;typeof xt=="string"&&(xt=xt!=="Off",Q.setValue(ht,{value:xt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const St=document.createElement("input");return _.add(St),St.setAttribute("data-element-id",ht),St.disabled=K.readOnly,this._setRequired(St,this.data.required),St.type="checkbox",St.name=K.fieldName,xt&&St.setAttribute("checked",!0),St.setAttribute("exportValue",K.exportValue),St.tabIndex=m,St.addEventListener("change",It=>{const{name:Ot,checked:ye}=It.target;for(const le of this._getElementsByName(Ot,ht)){const $t=ye&&le.exportValue===K.exportValue;le.domElement&&(le.domElement.checked=$t),Q.setValue(le.id,{value:$t})}Q.setValue(ht,{value:ye})}),St.addEventListener("resetform",It=>{const Ot=K.defaultFieldValue||"Off";It.target.checked=Ot===K.exportValue}),this.enableScripting&&this.hasJSActions&&(St.addEventListener("updatefromsandbox",It=>{const Ot={value(ye){ye.target.checked=ye.detail.value!=="Off",Q.setValue(ht,{value:ye.target.checked})}};this._dispatchEventFromSandbox(Ot,It)}),this._setEventListeners(St,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],It=>It.target.checked)),this._setBackgroundColor(St),this._setDefaultPropertiesFromJS(St),this.container.append(St),this.container}}class C extends R{constructor(Q){super(Q,{isRenderable:Q.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Q=this.annotationStorage,K=this.data,ht=K.id;let xt=Q.getValue(ht,{value:K.fieldValue===K.buttonValue}).value;if(typeof xt=="string"&&(xt=xt!==K.buttonValue,Q.setValue(ht,{value:xt})),xt)for(const It of this._getElementsByName(K.fieldName,ht))Q.setValue(It.id,{value:!1});const St=document.createElement("input");if(_.add(St),St.setAttribute("data-element-id",ht),St.disabled=K.readOnly,this._setRequired(St,this.data.required),St.type="radio",St.name=K.fieldName,xt&&St.setAttribute("checked",!0),St.tabIndex=m,St.addEventListener("change",It=>{const{name:Ot,checked:ye}=It.target;for(const le of this._getElementsByName(Ot,ht))Q.setValue(le.id,{value:!1});Q.setValue(ht,{value:ye})}),St.addEventListener("resetform",It=>{const Ot=K.defaultFieldValue;It.target.checked=Ot!=null&&Ot===K.buttonValue}),this.enableScripting&&this.hasJSActions){const It=K.buttonValue;St.addEventListener("updatefromsandbox",Ot=>{const ye={value:le=>{const $t=It===le.detail.value;for(const ne of this._getElementsByName(le.target.name)){const ue=$t&&ne.id===ht;ne.domElement&&(ne.domElement.checked=ue),Q.setValue(ne.id,{value:ue})}}};this._dispatchEventFromSandbox(ye,Ot)}),this._setEventListeners(St,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ot=>Ot.target.checked)}return this._setBackgroundColor(St),this._setDefaultPropertiesFromJS(St),this.container.append(St),this.container}}class B extends E{constructor(Q){super(Q,{ignoreBorder:Q.data.hasAppearance})}render(){const Q=super.render();Q.classList.add("buttonWidgetAnnotation","pushButton");const K=Q.lastChild;return this.enableScripting&&this.hasJSActions&&K&&(this._setDefaultPropertiesFromJS(K),K.addEventListener("updatefromsandbox",ht=>{this._dispatchEventFromSandbox({},ht)})),Q}}class F extends R{constructor(Q){super(Q,{isRenderable:Q.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Q=this.annotationStorage,K=this.data.id,ht=Q.getValue(K,{value:this.data.fieldValue}),xt=document.createElement("select");_.add(xt),xt.setAttribute("data-element-id",K),xt.disabled=this.data.readOnly,this._setRequired(xt,this.data.required),xt.name=this.data.fieldName,xt.tabIndex=m;let St=this.data.combo&&this.data.options.length>0;this.data.combo||(xt.size=this.data.options.length,this.data.multiSelect&&(xt.multiple=!0)),xt.addEventListener("resetform",$t=>{const ne=this.data.defaultFieldValue;for(const ue of xt.options)ue.selected=ue.value===ne});for(const $t of this.data.options){const ne=document.createElement("option");ne.textContent=$t.displayValue,ne.value=$t.exportValue,ht.value.includes($t.exportValue)&&(ne.setAttribute("selected",!0),St=!1),xt.append(ne)}let It=null;if(St){const $t=document.createElement("option");$t.value=" ",$t.setAttribute("hidden",!0),$t.setAttribute("selected",!0),xt.prepend($t),It=()=>{$t.remove(),xt.removeEventListener("input",It),It=null},xt.addEventListener("input",It)}const Ot=$t=>{const ne=$t?"value":"textContent",{options:ue,multiple:he}=xt;return he?Array.prototype.filter.call(ue,Le=>Le.selected).map(Le=>Le[ne]):ue.selectedIndex===-1?null:ue[ue.selectedIndex][ne]};let ye=Ot(!1);const le=$t=>{const ne=$t.target.options;return Array.prototype.map.call(ne,ue=>({displayValue:ue.textContent,exportValue:ue.value}))};return this.enableScripting&&this.hasJSActions?(xt.addEventListener("updatefromsandbox",$t=>{const ne={value(ue){It==null||It();const he=ue.detail.value,Le=new Set(Array.isArray(he)?he:[he]);for(const we of xt.options)we.selected=Le.has(we.value);Q.setValue(K,{value:Ot(!0)}),ye=Ot(!1)},multipleSelection(ue){xt.multiple=!0},remove(ue){const he=xt.options,Le=ue.detail.remove;he[Le].selected=!1,xt.remove(Le),he.length>0&&Array.prototype.findIndex.call(he,we=>we.selected)===-1&&(he[0].selected=!0),Q.setValue(K,{value:Ot(!0),items:le(ue)}),ye=Ot(!1)},clear(ue){for(;xt.length!==0;)xt.remove(0);Q.setValue(K,{value:null,items:[]}),ye=Ot(!1)},insert(ue){const{index:he,displayValue:Le,exportValue:we}=ue.detail.insert,He=xt.children[he],Ue=document.createElement("option");Ue.textContent=Le,Ue.value=we,He?He.before(Ue):xt.append(Ue),Q.setValue(K,{value:Ot(!0),items:le(ue)}),ye=Ot(!1)},items(ue){const{items:he}=ue.detail;for(;xt.length!==0;)xt.remove(0);for(const Le of he){const{displayValue:we,exportValue:He}=Le,Ue=document.createElement("option");Ue.textContent=we,Ue.value=He,xt.append(Ue)}xt.options.length>0&&(xt.options[0].selected=!0),Q.setValue(K,{value:Ot(!0),items:le(ue)}),ye=Ot(!1)},indices(ue){const he=new Set(ue.detail.indices);for(const Le of ue.target.options)Le.selected=he.has(Le.index);Q.setValue(K,{value:Ot(!0)}),ye=Ot(!1)},editable(ue){ue.target.disabled=!ue.detail.editable}};this._dispatchEventFromSandbox(ne,$t)}),xt.addEventListener("input",$t=>{var he;const ne=Ot(!0),ue=Ot(!1);Q.setValue(K,{value:ne}),$t.preventDefault(),(he=this.linkService.eventBus)==null||he.dispatch("dispatcheventinsandbox",{source:this,detail:{id:K,name:"Keystroke",value:ye,change:ue,changeEx:ne,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(xt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],$t=>$t.target.value)):xt.addEventListener("input",function($t){Q.setValue(K,{value:Ot(!0)})}),this.data.combo&&this._setTextStyle(xt),this._setBackgroundColor(xt),this._setDefaultPropertiesFromJS(xt),this.container.append(xt),this.container}}class rt extends x{constructor(Q){const{data:K,elements:ht}=Q;super(Q,{isRenderable:x._hasPopupData(K)}),this.elements=ht}render(){this.container.classList.add("popupAnnotation");const Q=new tt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),K=[];for(const ht of this.elements)ht.popup=Q,K.push(ht.data.id),ht.addHighlightArea();return this.container.setAttribute("aria-controls",K.map(ht=>`${n.AnnotationPrefix}${ht}`).join(",")),this.container}}class tt{constructor({container:Q,color:K,elements:ht,titleObj:xt,modificationDate:St,contentsObj:It,richText:Ot,parent:ye,rect:le,parentRect:$t,open:ne}){N(this,Bt);N(this,at);N(this,vt);N(this,bt);N(this,D,Y(this,Bt,S0).bind(this));N(this,H,Y(this,bt,pu).bind(this));N(this,L,Y(this,vt,gu).bind(this));N(this,V,Y(this,at,Kh).bind(this));N(this,j,null);N(this,G,null);N(this,W,null);N(this,U,null);N(this,O,null);N(this,z,null);N(this,et,null);N(this,nt,!1);N(this,pt,null);N(this,yt,null);N(this,Nt,null);N(this,Ht,null);N(this,Pt,!1);var ue;J(this,G,Q),J(this,Ht,xt),J(this,W,It),J(this,Nt,Ot),J(this,z,ye),J(this,j,K),J(this,yt,le),J(this,et,$t),J(this,O,ht),J(this,U,a.PDFDateString.toDateObject(St)),this.trigger=ht.flatMap(he=>he.getElementsToTriggerPopup());for(const he of this.trigger)he.addEventListener("click",l(this,V)),he.addEventListener("mouseenter",l(this,L)),he.addEventListener("mouseleave",l(this,H)),he.classList.add("popupTriggerArea");for(const he of ht)(ue=he.container)==null||ue.addEventListener("keydown",l(this,D));l(this,G).hidden=!0,ne&&Y(this,at,Kh).call(this)}render(){if(l(this,pt))return;const{page:{view:Q},viewport:{rawDims:{pageWidth:K,pageHeight:ht,pageX:xt,pageY:St}}}=l(this,z),It=J(this,pt,document.createElement("div"));if(It.className="popup",l(this,j)){const ei=It.style.outlineColor=n.Util.makeHexColor(...l(this,j));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?It.style.backgroundColor=`color-mix(in srgb, ${ei} 30%, white)`:It.style.backgroundColor=n.Util.makeHexColor(...l(this,j).map(or=>Math.floor(.7*(255-or)+or)))}const Ot=document.createElement("span");Ot.className="header";const ye=document.createElement("h1");if(Ot.append(ye),{dir:ye.dir,str:ye.textContent}=l(this,Ht),It.append(Ot),l(this,U)){const ei=document.createElement("span");ei.classList.add("popupDate"),ei.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),ei.setAttribute("data-l10n-args",JSON.stringify({date:l(this,U).toLocaleDateString(),time:l(this,U).toLocaleTimeString()})),Ot.append(ei)}const le=l(this,W),$t=l(this,Nt);if($t!=null&&$t.str&&(!(le!=null&&le.str)||le.str===$t.str))f.XfaLayer.render({xfaHtml:$t.html,intent:"richText",div:It}),It.lastChild.classList.add("richText","popupContent");else{const ei=this._formatContents(le);It.append(ei)}let ne=!!l(this,et),ue=ne?l(this,et):l(this,yt);for(const ei of l(this,O))if(!ue||n.Util.intersect(ei.data.rect,ue)!==null){ue=ei.data.rect,ne=!0;break}const he=n.Util.normalizeRect([ue[0],Q[3]-ue[1]+Q[1],ue[2],Q[3]-ue[3]+Q[1]]),Le=5,we=ne?ue[2]-ue[0]+Le:0,He=he[0]+we,Ue=he[1],{style:Oi}=l(this,G);Oi.left=`${100*(He-xt)/K}%`,Oi.top=`${100*(Ue-St)/ht}%`,l(this,G).append(It)}_formatContents({str:Q,dir:K}){const ht=document.createElement("p");ht.classList.add("popupContent"),ht.dir=K;const xt=Q.split(/(?:\r\n?|\n)/);for(let St=0,It=xt.length;St<It;++St){const Ot=xt[St];ht.append(document.createTextNode(Ot)),St<It-1&&ht.append(document.createElement("br"))}return ht}forceHide(){J(this,Pt,this.isVisible),l(this,Pt)&&(l(this,G).hidden=!0)}maybeShow(){!l(this,Pt)||(J(this,Pt,!1),l(this,G).hidden=!1)}get isVisible(){return l(this,G).hidden===!1}}D=new WeakMap,H=new WeakMap,L=new WeakMap,V=new WeakMap,j=new WeakMap,G=new WeakMap,W=new WeakMap,U=new WeakMap,O=new WeakMap,z=new WeakMap,et=new WeakMap,nt=new WeakMap,pt=new WeakMap,yt=new WeakMap,Nt=new WeakMap,Ht=new WeakMap,Pt=new WeakMap,Bt=new WeakSet,S0=function(Q){Q.altKey||Q.shiftKey||Q.ctrlKey||Q.metaKey||(Q.key==="Enter"||Q.key==="Escape"&&l(this,nt))&&Y(this,at,Kh).call(this)},at=new WeakSet,Kh=function(){J(this,nt,!l(this,nt)),l(this,nt)?(Y(this,vt,gu).call(this),l(this,G).addEventListener("click",l(this,V)),l(this,G).addEventListener("keydown",l(this,D))):(Y(this,bt,pu).call(this),l(this,G).removeEventListener("click",l(this,V)),l(this,G).removeEventListener("keydown",l(this,D)))},vt=new WeakSet,gu=function(){l(this,pt)||this.render(),this.isVisible?l(this,nt)&&l(this,G).classList.add("focused"):(l(this,G).hidden=!1,l(this,G).style.zIndex=parseInt(l(this,G).style.zIndex)+1e3)},bt=new WeakSet,pu=function(){l(this,G).classList.remove("focused"),!(l(this,nt)||!this.isVisible)&&(l(this,G).hidden=!0,l(this,G).style.zIndex=parseInt(l(this,G).style.zIndex)-1e3)};class st extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Q.data.textContent,this.textPosition=Q.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Q=document.createElement("div");Q.classList.add("annotationTextContent"),Q.setAttribute("role","comment");for(const K of this.textContent){const ht=document.createElement("span");ht.textContent=K,Q.append(ht)}this.container.append(Q)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class wt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,ot,null)}render(){this.container.classList.add("lineAnnotation");const K=this.data,{width:ht,height:xt}=y(K.rect),St=this.svgFactory.create(ht,xt,!0),It=J(this,ot,this.svgFactory.createElement("svg:line"));return It.setAttribute("x1",K.rect[2]-K.lineCoordinates[0]),It.setAttribute("y1",K.rect[3]-K.lineCoordinates[1]),It.setAttribute("x2",K.rect[2]-K.lineCoordinates[2]),It.setAttribute("y2",K.rect[3]-K.lineCoordinates[3]),It.setAttribute("stroke-width",K.borderStyle.width||1),It.setAttribute("stroke","transparent"),It.setAttribute("fill","transparent"),St.append(It),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap;class dt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,ft,null)}render(){this.container.classList.add("squareAnnotation");const K=this.data,{width:ht,height:xt}=y(K.rect),St=this.svgFactory.create(ht,xt,!0),It=K.borderStyle.width,Ot=J(this,ft,this.svgFactory.createElement("svg:rect"));return Ot.setAttribute("x",It/2),Ot.setAttribute("y",It/2),Ot.setAttribute("width",ht-It),Ot.setAttribute("height",xt-It),Ot.setAttribute("stroke-width",It||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),St.append(Ot),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,ft)}addHighlightArea(){this.container.classList.add("highlightArea")}}ft=new WeakMap;class Tt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,Et,null)}render(){this.container.classList.add("circleAnnotation");const K=this.data,{width:ht,height:xt}=y(K.rect),St=this.svgFactory.create(ht,xt,!0),It=K.borderStyle.width,Ot=J(this,Et,this.svgFactory.createElement("svg:ellipse"));return Ot.setAttribute("cx",ht/2),Ot.setAttribute("cy",xt/2),Ot.setAttribute("rx",ht/2-It/2),Ot.setAttribute("ry",xt/2-It/2),Ot.setAttribute("stroke-width",It||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),St.append(Ot),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Et)}addHighlightArea(){this.container.classList.add("highlightArea")}}Et=new WeakMap;class Lt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,Kt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const K=this.data,{width:ht,height:xt}=y(K.rect),St=this.svgFactory.create(ht,xt,!0);let It=[];for(const ye of K.vertices){const le=ye.x-K.rect[0],$t=K.rect[3]-ye.y;It.push(le+","+$t)}It=It.join(" ");const Ot=J(this,Kt,this.svgFactory.createElement(this.svgElementName));return Ot.setAttribute("points",It),Ot.setAttribute("stroke-width",K.borderStyle.width||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),St.append(Ot),this.container.append(St),!K.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Kt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kt=new WeakMap;class Qt extends Lt{constructor(Q){super(Q),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ct extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Dt extends x{constructor(K){super(K,{isRenderable:!0,ignoreBorder:!0});N(this,te,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const K=this.data,{width:ht,height:xt}=y(K.rect),St=this.svgFactory.create(ht,xt,!0);for(const It of K.inkLists){let Ot=[];for(const le of It){const $t=le.x-K.rect[0],ne=K.rect[3]-le.y;Ot.push(`${$t},${ne}`)}Ot=Ot.join(" ");const ye=this.svgFactory.createElement(this.svgElementName);l(this,te).push(ye),ye.setAttribute("points",Ot),ye.setAttribute("stroke-width",K.borderStyle.width||1),ye.setAttribute("stroke","transparent"),ye.setAttribute("fill","transparent"),!K.popupRef&&this.hasPopupData&&this._createPopup(),St.append(ye)}return this.container.append(St),this.container}getElementsToTriggerPopup(){return l(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap;class ee extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class zt extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Jt extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class oe extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class pe extends x{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ae extends x{constructor(K){var St;super(K,{isRenderable:!0});N(this,Pe);N(this,me,null);const{filename:ht,content:xt}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(ht,!0),this.content=xt,(St=this.linkService.eventBus)==null||St.dispatch("fileattachmentannotation",{source:this,filename:ht,content:xt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:K,data:ht}=this;let xt;ht.hasAppearance||ht.fillAlpha===0?xt=document.createElement("div"):(xt=document.createElement("img"),xt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(ht.name)?"paperclip":"pushpin"}.svg`,ht.fillAlpha&&ht.fillAlpha<1&&(xt.style=`filter: opacity(${Math.round(ht.fillAlpha*100)}%);`)),xt.addEventListener("dblclick",Y(this,Pe,mu).bind(this)),J(this,me,xt);const{isMac:St}=n.FeatureTest.platform;return K.addEventListener("keydown",It=>{It.key==="Enter"&&(St?It.metaKey:It.ctrlKey)&&Y(this,Pe,mu).call(this)}),!ht.popupRef&&this.hasPopupData?this._createPopup():xt.classList.add("popupTriggerArea"),K.append(xt),K}getElementsToTriggerPopup(){return l(this,me)}addHighlightArea(){this.container.classList.add("highlightArea")}}me=new WeakMap,Pe=new WeakSet,mu=function(){var K;(K=this.downloadManager)==null||K.openOrDownloadData(this.content,this.filename)};class Ve{constructor({div:Q,accessibilityManager:K,annotationCanvasMap:ht,annotationEditorUIManager:xt,page:St,viewport:It}){N(this,vi);N(this,tr);N(this,je,null);N(this,hi,null);N(this,ze,new Map);this.div=Q,J(this,je,K),J(this,hi,ht),this.page=St,this.viewport=It,this.zIndex=0,this._annotationEditorUIManager=xt}async render(Q){var It;const{annotations:K}=Q,ht=this.div;(0,a.setLayerDimensions)(ht,this.viewport);const xt=new Map,St={data:null,layer:ht,linkService:Q.linkService,downloadManager:Q.downloadManager,imageResourcesPath:Q.imageResourcesPath||"",renderForms:Q.renderForms!==!1,svgFactory:new a.DOMSVGFactory,annotationStorage:Q.annotationStorage||new o.AnnotationStorage,enableScripting:Q.enableScripting===!0,hasJSActions:Q.hasJSActions,fieldObjects:Q.fieldObjects,parent:this,elements:null};for(const Ot of K){if(Ot.noHTML)continue;const ye=Ot.annotationType===n.AnnotationType.POPUP;if(ye){const ne=xt.get(Ot.id);if(!ne)continue;St.elements=ne}else{const{width:ne,height:ue}=y(Ot.rect);if(ne<=0||ue<=0)continue}St.data=Ot;const le=b.create(St);if(!le.isRenderable)continue;if(!ye&&Ot.popupRef){const ne=xt.get(Ot.popupRef);ne?ne.push(le):xt.set(Ot.popupRef,[le])}const $t=le.render();Ot.hidden&&($t.style.visibility="hidden"),Y(this,vi,E0).call(this,$t,Ot.id),le.annotationEditorType>0&&(l(this,ze).set(le.data.id,le),(It=this._annotationEditorUIManager)==null||It.renderAnnotationElement(le))}Y(this,tr,vu).call(this)}update({viewport:Q}){const K=this.div;this.viewport=Q,(0,a.setLayerDimensions)(K,{rotation:Q.rotation}),Y(this,tr,vu).call(this),K.hidden=!1}getEditableAnnotations(){return Array.from(l(this,ze).values())}getEditableAnnotation(Q){return l(this,ze).get(Q)}}je=new WeakMap,hi=new WeakMap,ze=new WeakMap,vi=new WeakSet,E0=function(Q,K){var xt;const ht=Q.firstChild||Q;ht.id=`${n.AnnotationPrefix}${K}`,this.div.append(Q),(xt=l(this,je))==null||xt.moveElementInDOM(this.div,Q,ht,!1)},tr=new WeakSet,vu=function(){if(!l(this,hi))return;const Q=this.div;for(const[K,ht]of l(this,hi)){const xt=Q.querySelector(`[data-annotation-id="${K}"]`);if(!xt)continue;ht.className="annotationContent";const{firstChild:St}=xt;St?St.nodeName==="CANVAS"?St.replaceWith(ht):St.classList.contains("annotationContent")?St.after(ht):St.before(ht):xt.append(ht)}l(this,hi).clear()}},792:(r,t,s)=>{var f,m,S,C0,y;s.d(t,{AnnotationStorage:()=>u,PrintAnnotationStorage:()=>d,SerializableEmpty:()=>c});var n=s(292),a=s(310),o=s(651);const c=Object.freeze({map:null,hash:"",transfer:void 0});class u{constructor(){N(this,S);N(this,f,!1);N(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(x,E){const I=l(this,m).get(x);return I===void 0?E:Object.assign(E,I)}getRawValue(x){return l(this,m).get(x)}remove(x){if(l(this,m).delete(x),l(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const E of l(this,m).values())if(E instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(x,E){const I=l(this,m).get(x);let R=!1;if(I!==void 0)for(const[p,w]of Object.entries(E))I[p]!==w&&(R=!0,I[p]=w);else R=!0,l(this,m).set(x,E);R&&Y(this,S,C0).call(this),E instanceof a.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(E.constructor._type)}has(x){return l(this,m).has(x)}getAll(){return l(this,m).size>0?(0,n.objectFromMap)(l(this,m)):null}setAll(x){for(const[E,I]of Object.entries(x))this.setValue(E,I)}get size(){return l(this,m).size}resetModified(){l(this,f)&&(J(this,f,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new d(this)}get serializable(){if(l(this,m).size===0)return c;const x=new Map,E=new o.MurmurHash3_64,I=[],R=Object.create(null);let p=!1;for(const[w,A]of l(this,m)){const C=A instanceof a.AnnotationEditor?A.serialize(!1,R):A;C&&(x.set(w,C),E.update(`${w}:${JSON.stringify(C)}`),p||(p=!!C.bitmap))}if(p)for(const w of x.values())w.bitmap&&I.push(w.bitmap);return x.size>0?{map:x,hash:E.hexdigest(),transfer:I}:c}get editorStats(){let x=null;const E=new Map;for(const I of l(this,m).values()){if(!(I instanceof a.AnnotationEditor))continue;const R=I.telemetryFinalData;if(!R)continue;const{type:p}=R;E.has(p)||E.set(p,Object.getPrototypeOf(I).constructor),x||(x=Object.create(null));const w=x[p]||(x[p]=new Map);for(const[A,C]of Object.entries(R)){if(A==="type")continue;let B=w.get(A);B||(B=new Map,w.set(A,B));const F=B.get(C)??0;B.set(C,F+1)}}for(const[I,R]of E)x[I]=R.computeTelemetryFinalData(x[I]);return x}}f=new WeakMap,m=new WeakMap,S=new WeakSet,C0=function(){l(this,f)||(J(this,f,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class d extends u{constructor(E){super();N(this,y,void 0);const{map:I,hash:R,transfer:p}=E.serializable,w=structuredClone(I,p?{transfer:p}:null);J(this,y,{map:w,hash:R,transfer:p})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,y)}}y=new WeakMap},831:(r,t,s)=>{s.a(r,async(n,a)=>{var C,B,F,rt,Ja,st,Xh,dt,Tt,Lt,Qt,ct,Yh,ee,zt,Jt,oe,pe,Ae,Ho,Gt,lt,yu,Wt,ve;try{let ie=function(bt){if(typeof bt=="string"||bt instanceof URL?bt={url:bt}:(bt instanceof ArrayBuffer||ArrayBuffer.isView(bt))&&(bt={data:bt}),typeof bt!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!bt.url&&!bt.data&&!bt.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const q=new W,{docId:ot}=q,ft=bt.url?xe(bt.url):null,Et=bt.data?_e(bt.data):null,Kt=bt.httpHeaders||null,te=bt.withCredentials===!0,me=bt.password??null,Pe=bt.range instanceof U?bt.range:null,Ti=Number.isInteger(bt.rangeChunkSize)&&bt.rangeChunkSize>0?bt.rangeChunkSize:T;let je=bt.worker instanceof pt?bt.worker:null;const hi=bt.verbosity,ze=typeof bt.docBaseUrl=="string"&&!(0,u.isDataScheme)(bt.docBaseUrl)?bt.docBaseUrl:null,vi=typeof bt.cMapUrl=="string"?bt.cMapUrl:null,oi=bt.cMapPacked!==!1,tr=bt.CMapReaderFactory||L,bi=typeof bt.standardFontDataUrl=="string"?bt.standardFontDataUrl:null,Me=bt.StandardFontDataFactory||j,Q=bt.stopAtErrors!==!0,K=Number.isInteger(bt.maxImageSize)&&bt.maxImageSize>-1?bt.maxImageSize:-1,ht=bt.isEvalSupported!==!1,xt=typeof bt.isOffscreenCanvasSupported=="boolean"?bt.isOffscreenCanvasSupported:!o.isNodeJS,St=Number.isInteger(bt.canvasMaxAreaInBytes)?bt.canvasMaxAreaInBytes:-1,It=typeof bt.disableFontFace=="boolean"?bt.disableFontFace:o.isNodeJS,Ot=bt.fontExtraProperties===!0,ye=bt.enableXfa===!0,le=bt.ownerDocument||globalThis.document,$t=bt.disableRange===!0,ne=bt.disableStream===!0,ue=bt.disableAutoFetch===!0,he=bt.pdfBug===!0,Le=Pe?Pe.length:bt.length??NaN,we=typeof bt.useSystemFonts=="boolean"?bt.useSystemFonts:!o.isNodeJS&&!It,He=typeof bt.useWorkerFetch=="boolean"?bt.useWorkerFetch:tr===u.DOMCMapReaderFactory&&Me===u.DOMStandardFontDataFactory&&vi&&bi&&(0,u.isValidFetchUrl)(vi,document.baseURI)&&(0,u.isValidFetchUrl)(bi,document.baseURI),Ue=bt.canvasFactory||new H({ownerDocument:le}),Oi=bt.filterFactory||new V({docId:ot,ownerDocument:le}),ei=null;(0,o.setVerbosityLevel)(hi);const or={canvasFactory:Ue,filterFactory:Oi};if(He||(or.cMapReaderFactory=new tr({baseUrl:vi,isCompressed:oi}),or.standardFontDataFactory=new Me({baseUrl:bi})),!je){const $={verbosity:hi,port:_.GlobalWorkerOptions.workerPort};je=$.port?pt.fromPort($):new pt($),q._worker=je}const zi={docId:ot,apiVersion:"4.2.67",data:Et,password:me,disableAutoFetch:ue,rangeChunkSize:Ti,length:Le,docBaseUrl:ze,enableXfa:ye,evaluatorOptions:{maxImageSize:K,disableFontFace:It,ignoreErrors:Q,isEvalSupported:ht,isOffscreenCanvasSupported:xt,canvasMaxAreaInBytes:St,fontExtraProperties:Ot,useSystemFonts:we,cMapUrl:He?vi:null,standardFontDataUrl:He?bi:null}},qe={ignoreErrors:Q,disableFontFace:It,fontExtraProperties:Ot,enableXfa:ye,ownerDocument:le,disableAutoFetch:ue,pdfBug:he,styleElement:ei};return je.promise.then(function(){if(q.destroyed)throw new Error("Loading aborted");const $=G(je,zi),At=new Promise(function(Zt){let ae;Pe?ae=new E.PDFDataTransportStream(Pe,{disableRange:$t,disableStream:ne}):Et||(ae=(de=>o.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,u.isValidFetchUrl)(de.url)?new I.PDFFetchStream(de):new p.PDFNodeStream(de):(0,u.isValidFetchUrl)(de.url)?new I.PDFFetchStream(de):new R.PDFNetworkStream(de))({url:ft,length:Le,httpHeaders:Kt,withCredentials:te,rangeChunkSize:Ti,disableRange:$t,disableStream:ne})),Zt(ae)});return Promise.all([$,At]).then(function([Zt,ae]){if(q.destroyed)throw new Error("Loading aborted");const de=new y.MessageHandler(ot,Zt,je.port),Ce=new yt(de,q,ae,qe,or);q._transport=Ce,de.send("Ready",null)})}).catch(q._capability.reject),q},xe=function(bt){if(bt instanceof URL)return bt.href;try{return new URL(bt,window.location).href}catch{if(o.isNodeJS&&typeof bt=="string")return bt}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},_e=function(bt){if(o.isNodeJS&&typeof Buffer<"u"&&bt instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(bt instanceof Uint8Array&&bt.byteLength===bt.buffer.byteLength)return bt;if(typeof bt=="string")return(0,o.stringToBytes)(bt);if(bt instanceof ArrayBuffer||ArrayBuffer.isView(bt)||typeof bt=="object"&&!isNaN(bt==null?void 0:bt.length))return new Uint8Array(bt);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")},ut=function(bt){return typeof bt=="object"&&Number.isInteger(bt==null?void 0:bt.num)&&bt.num>=0&&Number.isInteger(bt==null?void 0:bt.gen)&&bt.gen>=0};s.d(t,{PDFDataRangeTransport:()=>U,PDFWorker:()=>pt,build:()=>at,getDocument:()=>ie,version:()=>Z});var o=s(292),c=s(792),u=s(419),d=s(10),f=s(573),m=s(923),S=s(814),_=s(164),y=s(178),b=s(62),x=s(626),E=s(585),I=s(94),R=s(457),p=s(786),w=s(50),A=n([f,p]);[f,p]=A.then?(await A)():A;const T=65536,M=100,D=5e3,H=o.isNodeJS?f.NodeCanvasFactory:u.DOMCanvasFactory,L=o.isNodeJS?f.NodeCMapReaderFactory:u.DOMCMapReaderFactory,V=o.isNodeJS?f.NodeFilterFactory:u.DOMFilterFactory,j=o.isNodeJS?f.NodeStandardFontDataFactory:u.DOMStandardFontDataFactory;async function G(bt,q){if(bt.destroyed)throw new Error("Worker was destroyed");const ot=await bt.messageHandler.sendWithPromise("GetDocRequest",q,q.data?[q.data.buffer]:null);if(bt.destroyed)throw new Error("Worker was destroyed");return ot}const _t=class{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${xs(_t,C)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var q,ot,ft;this.destroyed=!0;try{(q=this._worker)!=null&&q.port&&(this._worker._pendingDestroy=!0),await((ot=this._transport)==null?void 0:ot.destroy())}catch(Et){throw(ft=this._worker)!=null&&ft.port&&delete this._worker._pendingDestroy,Et}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let W=_t;C=new WeakMap,N(W,C,0);class U{constructor(q,ot,ft=!1,Et=null){this.length=q,this.initialData=ot,this.progressiveDone=ft,this.contentDispositionFilename=Et,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(q){this._rangeListeners.push(q)}addProgressListener(q){this._progressListeners.push(q)}addProgressiveReadListener(q){this._progressiveReadListeners.push(q)}addProgressiveDoneListener(q){this._progressiveDoneListeners.push(q)}onDataRange(q,ot){for(const ft of this._rangeListeners)ft(q,ot)}onDataProgress(q,ot){this._readyCapability.promise.then(()=>{for(const ft of this._progressListeners)ft(q,ot)})}onDataProgressiveRead(q){this._readyCapability.promise.then(()=>{for(const ot of this._progressiveReadListeners)ot(q)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const q of this._progressiveDoneListeners)q()})}transportReady(){this._readyCapability.resolve()}requestDataRange(q,ot){(0,o.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class O{constructor(q,ot){this._pdfInfo=q,this._transport=ot}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,o.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(q){return this._transport.getPage(q)}getPageIndex(q){return this._transport.getPageIndex(q)}getDestinations(){return this._transport.getDestinations()}getDestination(q){return this._transport.getDestination(q)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:q="display"}={}){const{renderingIntent:ot}=this._transport.getRenderingIntent(q);return this._transport.getOptionalContentConfig(ot)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(q=!1){return this._transport.startCleanup(q||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(q){return this._transport.cachedPageNumber(q)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class z{constructor(q,ot,ft,Et=!1){N(this,rt);N(this,st);N(this,B,null);N(this,F,!1);this._pageIndex=q,this._pageInfo=ot,this._transport=ft,this._stats=Et?new u.StatTimer:null,this._pdfBug=Et,this.commonObjs=ft.commonObjs,this.objs=new Ht,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:q,rotation:ot=this.rotate,offsetX:ft=0,offsetY:Et=0,dontFlip:Kt=!1}={}){return new u.PageViewport({viewBox:this.view,scale:q,rotation:ot,offsetX:ft,offsetY:Et,dontFlip:Kt})}getAnnotations({intent:q="display"}={}){const{renderingIntent:ot}=this._transport.getRenderingIntent(q);return this._transport.getAnnotations(this._pageIndex,ot)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,o.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var q;return((q=this._transport._htmlForXfa)==null?void 0:q.children[this._pageIndex])||null}render({canvasContext:q,viewport:ot,intent:ft="display",annotationMode:Et=o.AnnotationMode.ENABLE,transform:Kt=null,background:te=null,optionalContentConfigPromise:me=null,annotationCanvasMap:Pe=null,pageColors:Ti=null,printAnnotationStorage:je=null}){var K,ht;(K=this._stats)==null||K.time("Overall");const hi=this._transport.getRenderingIntent(ft,Et,je),{renderingIntent:ze,cacheKey:vi}=hi;J(this,F,!1),Y(this,st,Xh).call(this),me||(me=this._transport.getOptionalContentConfig(ze));let oi=this._intentStates.get(vi);oi||(oi=Object.create(null),this._intentStates.set(vi,oi)),oi.streamReaderCancelTimeout&&(clearTimeout(oi.streamReaderCancelTimeout),oi.streamReaderCancelTimeout=null);const tr=!!(ze&o.RenderingIntentFlag.PRINT);oi.displayReadyCapability||(oi.displayReadyCapability=Promise.withResolvers(),oi.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ht=this._stats)==null||ht.time("Page Request"),this._pumpOperatorList(hi));const bi=xt=>{var St,It;oi.renderTasks.delete(Me),(this._maybeCleanupAfterRender||tr)&&J(this,F,!0),Y(this,rt,Ja).call(this,!tr),xt?(Me.capability.reject(xt),this._abortOperatorList({intentState:oi,reason:xt instanceof Error?xt:new Error(xt)})):Me.capability.resolve(),(St=this._stats)==null||St.timeEnd("Rendering"),(It=this._stats)==null||It.timeEnd("Overall")},Me=new Bt({callback:bi,params:{canvasContext:q,viewport:ot,transform:Kt,background:te},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Pe,operatorList:oi.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!tr,pdfBug:this._pdfBug,pageColors:Ti});(oi.renderTasks||(oi.renderTasks=new Set)).add(Me);const Q=Me.task;return Promise.all([oi.displayReadyCapability.promise,me]).then(([xt,St])=>{var It;if(this.destroyed){bi();return}if((It=this._stats)==null||It.time("Rendering"),!(St.renderingIntent&ze))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");Me.initializeGraphics({transparency:xt,optionalContentConfig:St}),Me.operatorListChanged()}).catch(bi),Q}getOperatorList({intent:q="display",annotationMode:ot=o.AnnotationMode.ENABLE,printAnnotationStorage:ft=null}={}){var Pe;function Et(){te.operatorList.lastChunk&&(te.opListReadCapability.resolve(te.operatorList),te.renderTasks.delete(me))}const Kt=this._transport.getRenderingIntent(q,ot,ft,!0);let te=this._intentStates.get(Kt.cacheKey);te||(te=Object.create(null),this._intentStates.set(Kt.cacheKey,te));let me;return te.opListReadCapability||(me=Object.create(null),me.operatorListChanged=Et,te.opListReadCapability=Promise.withResolvers(),(te.renderTasks||(te.renderTasks=new Set)).add(me),te.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Pe=this._stats)==null||Pe.time("Page Request"),this._pumpOperatorList(Kt)),te.opListReadCapability.promise}streamTextContent({includeMarkedContent:q=!1,disableNormalization:ot=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:q===!0,disableNormalization:ot===!0},{highWaterMark:100,size(ft){return ft.items.length}})}getTextContent(q={}){if(this._transport._htmlForXfa)return this.getXfa().then(ft=>w.XfaText.textContent(ft));const ot=this.streamTextContent(q);return new Promise(function(ft,Et){function Kt(){te.read().then(function({value:Pe,done:Ti}){if(Ti){ft(me);return}Object.assign(me.styles,Pe.styles),me.items.push(...Pe.items),Kt()},Et)}const te=ot.getReader(),me={items:[],styles:Object.create(null)};Kt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const q=[];for(const ot of this._intentStates.values())if(this._abortOperatorList({intentState:ot,reason:new Error("Page was destroyed."),force:!0}),!ot.opListReadCapability)for(const ft of ot.renderTasks)q.push(ft.completed),ft.cancel();return this.objs.clear(),J(this,F,!1),Y(this,st,Xh).call(this),Promise.all(q)}cleanup(q=!1){J(this,F,!0);const ot=Y(this,rt,Ja).call(this,!1);return q&&ot&&this._stats&&(this._stats=new u.StatTimer),ot}_startRenderPage(q,ot){var Et,Kt;const ft=this._intentStates.get(ot);!ft||((Et=this._stats)==null||Et.timeEnd("Page Request"),(Kt=ft.displayReadyCapability)==null||Kt.resolve(q))}_renderPageChunk(q,ot){for(let ft=0,Et=q.length;ft<Et;ft++)ot.operatorList.fnArray.push(q.fnArray[ft]),ot.operatorList.argsArray.push(q.argsArray[ft]);ot.operatorList.lastChunk=q.lastChunk,ot.operatorList.separateAnnots=q.separateAnnots;for(const ft of ot.renderTasks)ft.operatorListChanged();q.lastChunk&&Y(this,rt,Ja).call(this,!0)}_pumpOperatorList({renderingIntent:q,cacheKey:ot,annotationStorageSerializable:ft}){const{map:Et,transfer:Kt}=ft,te=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:q,cacheKey:ot,annotationStorage:Et},Kt).getReader(),me=this._intentStates.get(ot);me.streamReader=te;const Pe=()=>{te.read().then(({value:Ti,done:je})=>{if(je){me.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Ti,me),Pe())},Ti=>{if(me.streamReader=null,!this._transport.destroyed){if(me.operatorList){me.operatorList.lastChunk=!0;for(const je of me.renderTasks)je.operatorListChanged();Y(this,rt,Ja).call(this,!0)}if(me.displayReadyCapability)me.displayReadyCapability.reject(Ti);else if(me.opListReadCapability)me.opListReadCapability.reject(Ti);else throw Ti}})};Pe()}_abortOperatorList({intentState:q,reason:ot,force:ft=!1}){if(q.streamReader){if(q.streamReaderCancelTimeout&&(clearTimeout(q.streamReaderCancelTimeout),q.streamReaderCancelTimeout=null),!ft){if(q.renderTasks.size>0)return;if(ot instanceof u.RenderingCancelledException){let Et=M;ot.extraDelay>0&&ot.extraDelay<1e3&&(Et+=ot.extraDelay),q.streamReaderCancelTimeout=setTimeout(()=>{q.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:q,reason:ot,force:!0})},Et);return}}if(q.streamReader.cancel(new o.AbortException(ot.message)).catch(()=>{}),q.streamReader=null,!this._transport.destroyed){for(const[Et,Kt]of this._intentStates)if(Kt===q){this._intentStates.delete(Et);break}this.cleanup()}}}get stats(){return this._stats}}B=new WeakMap,F=new WeakMap,rt=new WeakSet,Ja=function(q=!1){if(Y(this,st,Xh).call(this),!l(this,F)||this.destroyed)return!1;if(q)return J(this,B,setTimeout(()=>{J(this,B,null),Y(this,rt,Ja).call(this,!1)},D)),!1;for(const{renderTasks:ot,operatorList:ft}of this._intentStates.values())if(ot.size>0||!ft.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),J(this,F,!1),!0},st=new WeakSet,Xh=function(){l(this,B)&&(clearTimeout(l(this,B)),J(this,B,null))};class et{constructor(){N(this,dt,new Set);N(this,Tt,Promise.resolve())}postMessage(q,ot){const ft={data:structuredClone(q,ot?{transfer:ot}:null)};l(this,Tt).then(()=>{for(const Et of l(this,dt))Et.call(this,ft)})}addEventListener(q,ot){l(this,dt).add(ot)}removeEventListener(q,ot){l(this,dt).delete(ot)}terminate(){l(this,dt).clear()}}dt=new WeakMap,Tt=new WeakMap;const nt={isWorkerDisabled:!1,fakeWorkerId:0};o.isNodeJS&&(nt.isWorkerDisabled=!0,(Lt=_.GlobalWorkerOptions).workerSrc||(Lt.workerSrc="./pdf.worker.mjs")),nt.isSameOrigin=function(bt,q){let ot;try{if(ot=new URL(bt),!ot.origin||ot.origin==="null")return!1}catch{return!1}const ft=new URL(q,ot);return ot.origin===ft.origin},nt.createCDNWrapper=function(bt){const q=`await import("${bt}");`;return URL.createObjectURL(new Blob([q],{type:"text/javascript"}))};const vt=class{constructor({name:q=null,port:ot=null,verbosity:ft=(0,o.getVerbosityLevel)()}={}){var Et;if(this.name=q,this.destroyed=!1,this.verbosity=ft,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,ot){if((Et=l(vt,Qt))!=null&&Et.has(ot))throw new Error("Cannot use more than one PDFWorker per port.");(l(vt,Qt)||J(vt,Qt,new WeakMap)).set(ot,this),this._initializeFromPort(ot);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(q){this._port=q,this._messageHandler=new y.MessageHandler("main","worker",q),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!nt.isWorkerDisabled&&!l(vt,ct,Yh)){let{workerSrc:q}=vt;try{nt.isSameOrigin(window.location.href,q)||(q=nt.createCDNWrapper(new URL(q,window.location).href));const ot=new Worker(q,{type:"module"}),ft=new y.MessageHandler("main","worker",ot),Et=()=>{ot.removeEventListener("error",Kt),ft.destroy(),ot.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Kt=()=>{this._webWorker||Et()};ot.addEventListener("error",Kt),ft.on("test",me=>{if(ot.removeEventListener("error",Kt),this.destroyed){Et();return}me?(this._messageHandler=ft,this._port=ot,this._webWorker=ot,this._readyCapability.resolve(),ft.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),ft.destroy(),ot.terminate())}),ft.on("ready",me=>{if(ot.removeEventListener("error",Kt),this.destroyed){Et();return}try{te()}catch{this._setupFakeWorker()}});const te=()=>{const me=new Uint8Array;ft.send("test",me,[me.buffer])};te();return}catch{(0,o.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){nt.isWorkerDisabled||((0,o.warn)("Setting up fake worker."),nt.isWorkerDisabled=!0),vt._setupFakeWorkerGlobal.then(q=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const ot=new et;this._port=ot;const ft=`fake${nt.fakeWorkerId++}`,Et=new y.MessageHandler(ft+"_worker",ft,ot);q.setup(Et,ot);const Kt=new y.MessageHandler(ft,ft+"_worker",ot);this._messageHandler=Kt,this._readyCapability.resolve(),Kt.send("configure",{verbosity:this.verbosity})}).catch(q=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${q.message}".`))})}destroy(){var q;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(q=l(vt,Qt))==null||q.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(q){var ft;if(!(q!=null&&q.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const ot=(ft=l(this,Qt))==null?void 0:ft.get(q.port);if(ot){if(ot._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return ot}return new vt(q)}static get workerSrc(){if(_.GlobalWorkerOptions.workerSrc)return _.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const q=async()=>l(this,ct,Yh)?l(this,ct,Yh):(await Ws(()=>import(this.workerSrc).then(async ot=>(await ot.__tla,ot)),[])).WorkerMessageHandler;return(0,o.shadow)(this,"_setupFakeWorkerGlobal",q())}};let pt=vt;Qt=new WeakMap,ct=new WeakSet,Yh=function(){var q;try{return((q=globalThis.pdfjsWorker)==null?void 0:q.WorkerMessageHandler)||null}catch{return null}},N(pt,ct),N(pt,Qt,void 0);class yt{constructor(q,ot,ft,Et,Kt){N(this,Ae);N(this,ee,new Map);N(this,zt,new Map);N(this,Jt,new Map);N(this,oe,new Map);N(this,pe,null);this.messageHandler=q,this.loadingTask=ot,this.commonObjs=new Ht,this.fontLoader=new d.FontLoader({ownerDocument:Et.ownerDocument,styleElement:Et.styleElement}),this._params=Et,this.canvasFactory=Kt.canvasFactory,this.filterFactory=Kt.filterFactory,this.cMapReaderFactory=Kt.cMapReaderFactory,this.standardFontDataFactory=Kt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=ft,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,o.shadow)(this,"annotationStorage",new c.AnnotationStorage)}getRenderingIntent(q,ot=o.AnnotationMode.ENABLE,ft=null,Et=!1){let Kt=o.RenderingIntentFlag.DISPLAY,te=c.SerializableEmpty;switch(q){case"any":Kt=o.RenderingIntentFlag.ANY;break;case"display":break;case"print":Kt=o.RenderingIntentFlag.PRINT;break;default:(0,o.warn)(`getRenderingIntent - invalid intent: ${q}`)}switch(ot){case o.AnnotationMode.DISABLE:Kt+=o.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case o.AnnotationMode.ENABLE:break;case o.AnnotationMode.ENABLE_FORMS:Kt+=o.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case o.AnnotationMode.ENABLE_STORAGE:Kt+=o.RenderingIntentFlag.ANNOTATIONS_STORAGE,te=(Kt&o.RenderingIntentFlag.PRINT&&ft instanceof c.PrintAnnotationStorage?ft:this.annotationStorage).serializable;break;default:(0,o.warn)(`getRenderingIntent - invalid annotationMode: ${ot}`)}return Et&&(Kt+=o.RenderingIntentFlag.OPLIST),{renderingIntent:Kt,cacheKey:`${Kt}_${te.hash}`,annotationStorageSerializable:te}}destroy(){var ft;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(ft=l(this,pe))==null||ft.reject(new Error("Worker was destroyed during onPassword callback"));const q=[];for(const Et of l(this,zt).values())q.push(Et._destroy());l(this,zt).clear(),l(this,Jt).clear(),l(this,oe).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const ot=this.messageHandler.sendWithPromise("Terminate",null);return q.push(ot),Promise.all(q).then(()=>{var Et;this.commonObjs.clear(),this.fontLoader.clear(),l(this,ee).clear(),this.filterFactory.destroy(),(0,S.cleanupTextLayer)(),(Et=this._networkStream)==null||Et.cancelAllRequests(new o.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:q,loadingTask:ot}=this;q.on("GetReader",(ft,Et)=>{(0,o.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Kt=>{this._lastProgress={loaded:Kt.loaded,total:Kt.total}},Et.onPull=()=>{this._fullReader.read().then(function({value:Kt,done:te}){if(te){Et.close();return}(0,o.assert)(Kt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Et.enqueue(new Uint8Array(Kt),1,[Kt])}).catch(Kt=>{Et.error(Kt)})},Et.onCancel=Kt=>{this._fullReader.cancel(Kt),Et.ready.catch(te=>{if(!this.destroyed)throw te})}}),q.on("ReaderHeadersReady",ft=>{const Et=Promise.withResolvers(),Kt=this._fullReader;return Kt.headersReady.then(()=>{var te;(!Kt.isStreamingSupported||!Kt.isRangeSupported)&&(this._lastProgress&&((te=ot.onProgress)==null||te.call(ot,this._lastProgress)),Kt.onProgress=me=>{var Pe;(Pe=ot.onProgress)==null||Pe.call(ot,{loaded:me.loaded,total:me.total})}),Et.resolve({isStreamingSupported:Kt.isStreamingSupported,isRangeSupported:Kt.isRangeSupported,contentLength:Kt.contentLength})},Et.reject),Et.promise}),q.on("GetRangeReader",(ft,Et)=>{(0,o.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Kt=this._networkStream.getRangeReader(ft.begin,ft.end);if(!Kt){Et.close();return}Et.onPull=()=>{Kt.read().then(function({value:te,done:me}){if(me){Et.close();return}(0,o.assert)(te instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Et.enqueue(new Uint8Array(te),1,[te])}).catch(te=>{Et.error(te)})},Et.onCancel=te=>{Kt.cancel(te),Et.ready.catch(me=>{if(!this.destroyed)throw me})}}),q.on("GetDoc",({pdfInfo:ft})=>{this._numPages=ft.numPages,this._htmlForXfa=ft.htmlForXfa,delete ft.htmlForXfa,ot._capability.resolve(new O(ft,this))}),q.on("DocException",function(ft){let Et;switch(ft.name){case"PasswordException":Et=new o.PasswordException(ft.message,ft.code);break;case"InvalidPDFException":Et=new o.InvalidPDFException(ft.message);break;case"MissingPDFException":Et=new o.MissingPDFException(ft.message);break;case"UnexpectedResponseException":Et=new o.UnexpectedResponseException(ft.message,ft.status);break;case"UnknownErrorException":Et=new o.UnknownErrorException(ft.message,ft.details);break;default:(0,o.unreachable)("DocException - expected a valid Error.")}ot._capability.reject(Et)}),q.on("PasswordRequest",ft=>{if(J(this,pe,Promise.withResolvers()),ot.onPassword){const Et=Kt=>{Kt instanceof Error?l(this,pe).reject(Kt):l(this,pe).resolve({password:Kt})};try{ot.onPassword(Et,ft.code)}catch(Kt){l(this,pe).reject(Kt)}}else l(this,pe).reject(new o.PasswordException(ft.message,ft.code));return l(this,pe).promise}),q.on("DataLoaded",ft=>{var Et;(Et=ot.onProgress)==null||Et.call(ot,{loaded:ft.length,total:ft.length}),this.downloadInfoCapability.resolve(ft)}),q.on("StartRenderPage",ft=>{this.destroyed||l(this,zt).get(ft.pageIndex)._startRenderPage(ft.transparency,ft.cacheKey)}),q.on("commonobj",([ft,Et,Kt])=>{var te;if(this.destroyed||this.commonObjs.has(ft))return null;switch(Et){case"Font":const me=this._params;if("error"in Kt){const hi=Kt.error;(0,o.warn)(`Error during font loading: ${hi}`),this.commonObjs.resolve(ft,hi);break}const Pe=me.pdfBug&&((te=globalThis.FontInspector)!=null&&te.enabled)?(hi,ze)=>globalThis.FontInspector.fontAdded(hi,ze):null,Ti=new d.FontFaceObject(Kt,{disableFontFace:me.disableFontFace,ignoreErrors:me.ignoreErrors,inspectFont:Pe});this.fontLoader.bind(Ti).catch(()=>q.sendWithPromise("FontFallback",{id:ft})).finally(()=>{!me.fontExtraProperties&&Ti.data&&(Ti.data=null),this.commonObjs.resolve(ft,Ti)});break;case"CopyLocalImage":const{imageRef:je}=Kt;(0,o.assert)(je,"The imageRef must be defined.");for(const hi of l(this,zt).values())for(const[,ze]of hi.objs)if(ze.ref===je)return ze.dataLen?(this.commonObjs.resolve(ft,structuredClone(ze)),ze.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(ft,Kt);break;default:throw new Error(`Got unknown common object type ${Et}`)}return null}),q.on("obj",([ft,Et,Kt,te])=>{var Pe;if(this.destroyed)return;const me=l(this,zt).get(Et);if(!me.objs.has(ft)){if(me._intentStates.size===0){(Pe=te==null?void 0:te.bitmap)==null||Pe.close();return}switch(Kt){case"Image":me.objs.resolve(ft,te),(te==null?void 0:te.dataLen)>o.MAX_IMAGE_SIZE_TO_CACHE&&(me._maybeCleanupAfterRender=!0);break;case"Pattern":me.objs.resolve(ft,te);break;default:throw new Error(`Got unknown object type ${Kt}`)}}}),q.on("DocProgress",ft=>{var Et;this.destroyed||((Et=ot.onProgress)==null||Et.call(ot,{loaded:ft.loaded,total:ft.total}))}),q.on("FetchBuiltInCMap",ft=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(ft):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),q.on("FetchStandardFontData",ft=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(ft):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var ft;this.annotationStorage.size<=0&&(0,o.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:q,transfer:ot}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:q,filename:((ft=this._fullReader)==null?void 0:ft.filename)??null},ot).finally(()=>{this.annotationStorage.resetModified()})}getPage(q){if(!Number.isInteger(q)||q<=0||q>this._numPages)return Promise.reject(new Error("Invalid page request."));const ot=q-1,ft=l(this,Jt).get(ot);if(ft)return ft;const Et=this.messageHandler.sendWithPromise("GetPage",{pageIndex:ot}).then(Kt=>{if(this.destroyed)throw new Error("Transport destroyed");Kt.refStr&&l(this,oe).set(Kt.refStr,q);const te=new z(ot,Kt,this,this._params.pdfBug);return l(this,zt).set(ot,te),te});return l(this,Jt).set(ot,Et),Et}getPageIndex(q){return ut(q)?this.messageHandler.sendWithPromise("GetPageIndex",{num:q.num,gen:q.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(q,ot){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:q,intent:ot})}getFieldObjects(){return Y(this,Ae,Ho).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,Ae,Ho).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(q){return typeof q!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:q})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,Ae,Ho).call(this,"GetDocJSActions")}getPageJSActions(q){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:q})}getStructTree(q){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:q})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(q){return Y(this,Ae,Ho).call(this,"GetOptionalContentConfig").then(ot=>new x.OptionalContentConfig(ot,q))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const q="GetMetadata",ot=l(this,ee).get(q);if(ot)return ot;const ft=this.messageHandler.sendWithPromise(q,null).then(Et=>{var Kt,te;return{info:Et[0],metadata:Et[1]?new b.Metadata(Et[1]):null,contentDispositionFilename:((Kt=this._fullReader)==null?void 0:Kt.filename)??null,contentLength:((te=this._fullReader)==null?void 0:te.contentLength)??null}});return l(this,ee).set(q,ft),ft}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(q=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const ot of l(this,zt).values())if(!ot.cleanup())throw new Error(`startCleanup: Page ${ot.pageNumber} is currently rendering.`);this.commonObjs.clear(),q||this.fontLoader.clear(),l(this,ee).clear(),this.filterFactory.destroy(!0),(0,S.cleanupTextLayer)()}}cachedPageNumber(q){if(!ut(q))return null;const ot=q.gen===0?`${q.num}R`:`${q.num}R${q.gen}`;return l(this,oe).get(ot)??null}get loadingParams(){const{disableAutoFetch:q,enableXfa:ot}=this._params;return(0,o.shadow)(this,"loadingParams",{disableAutoFetch:q,enableXfa:ot})}}ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,pe=new WeakMap,Ae=new WeakSet,Ho=function(q,ot=null){const ft=l(this,ee).get(q);if(ft)return ft;const Et=this.messageHandler.sendWithPromise(q,ot);return l(this,ee).set(q,Et),Et};const Nt=Symbol("INITIAL_DATA");class Ht{constructor(){N(this,lt);N(this,Gt,Object.create(null))}get(q,ot=null){if(ot){const Et=Y(this,lt,yu).call(this,q);return Et.promise.then(()=>ot(Et.data)),null}const ft=l(this,Gt)[q];if(!ft||ft.data===Nt)throw new Error(`Requesting object that isn't resolved yet ${q}.`);return ft.data}has(q){const ot=l(this,Gt)[q];return!!ot&&ot.data!==Nt}resolve(q,ot=null){const ft=Y(this,lt,yu).call(this,q);ft.data=ot,ft.resolve()}clear(){var q;for(const ot in l(this,Gt)){const{data:ft}=l(this,Gt)[ot];(q=ft==null?void 0:ft.bitmap)==null||q.close()}J(this,Gt,Object.create(null))}*[Symbol.iterator](){for(const q in l(this,Gt)){const{data:ot}=l(this,Gt)[q];ot!==Nt&&(yield[q,ot])}}}Gt=new WeakMap,lt=new WeakSet,yu=function(q){var ot;return(ot=l(this,Gt))[q]||(ot[q]={...Promise.withResolvers(),data:Nt})};class Pt{constructor(q){N(this,Wt,null);J(this,Wt,q),this.onContinue=null}get promise(){return l(this,Wt).capability.promise}cancel(q=0){l(this,Wt).cancel(null,q)}get separateAnnots(){const{separateAnnots:q}=l(this,Wt).operatorList;if(!q)return!1;const{annotationCanvasMap:ot}=l(this,Wt);return q.form||q.canvas&&(ot==null?void 0:ot.size)>0}}Wt=new WeakMap;const jt=class{constructor({callback:q,params:ot,objs:ft,commonObjs:Et,annotationCanvasMap:Kt,operatorList:te,pageIndex:me,canvasFactory:Pe,filterFactory:Ti,useRequestAnimationFrame:je=!1,pdfBug:hi=!1,pageColors:ze=null}){this.callback=q,this.params=ot,this.objs=ft,this.commonObjs=Et,this.annotationCanvasMap=Kt,this.operatorListIdx=null,this.operatorList=te,this._pageIndex=me,this.canvasFactory=Pe,this.filterFactory=Ti,this._pdfBug=hi,this.pageColors=ze,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=je===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Pt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=ot.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:q=!1,optionalContentConfig:ot}){var me,Pe;if(this.cancelled)return;if(this._canvas){if(l(jt,ve).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(jt,ve).add(this._canvas)}this._pdfBug&&((me=globalThis.StepperManager)!=null&&me.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:ft,viewport:Et,transform:Kt,background:te}=this.params;this.gfx=new m.CanvasGraphics(ft,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:ot},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Kt,viewport:Et,transparency:q,background:te}),this.operatorListIdx=0,this.graphicsReady=!0,(Pe=this.graphicsReadyCallback)==null||Pe.call(this)}cancel(q=null,ot=0){var ft;this.running=!1,this.cancelled=!0,(ft=this.gfx)==null||ft.endDrawing(),l(jt,ve).delete(this._canvas),this.callback(q||new u.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,ot))}operatorListChanged(){var q;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(q=this.stepper)==null||q.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(jt,ve).delete(this._canvas),this.callback())))}};let Bt=jt;ve=new WeakMap,N(Bt,ve,new WeakSet);const Z="4.2.67",at="49b388101";a()}catch(ie){a(ie)}})},583:(r,t,s)=>{s.d(t,{BaseCMapReaderFactory:()=>c,BaseCanvasFactory:()=>o,BaseFilterFactory:()=>a,BaseSVGFactory:()=>d,BaseStandardFontDataFactory:()=>u});var n=s(292);class a{constructor(){this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,S){return"none"}addHighlightHCMFilter(m,S,_,y,b){return"none"}destroy(m=!1){}}class o{constructor(){this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,S){if(m<=0||S<=0)throw new Error("Invalid canvas size");const _=this._createCanvas(m,S);return{canvas:_,context:_.getContext("2d")}}reset(m,S,_){if(!m.canvas)throw new Error("Canvas is not specified");if(S<=0||_<=0)throw new Error("Invalid canvas size");m.canvas.width=S,m.canvas.height=_}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,S){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}class c{constructor({baseUrl:m=null,isCompressed:S=!0}){this.constructor===c&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=S}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const S=this.baseUrl+m+(this.isCompressed?".bcmap":""),_=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(S,_).catch(y=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${S}`)})}_fetchData(m,S){(0,n.unreachable)("Abstract method `_fetchData` called.")}}class u{constructor({baseUrl:m=null}){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const S=`${this.baseUrl}${m}`;return this._fetchData(S).catch(_=>{throw new Error(`Unable to load font data at: ${S}`)})}_fetchData(m){(0,n.unreachable)("Abstract method `_fetchData` called.")}}class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,S,_=!1){if(m<=0||S<=0)throw new Error("Invalid SVG dimensions");const y=this._createSVG("svg:svg");return y.setAttribute("version","1.1"),_||(y.setAttribute("width",`${m}px`),y.setAttribute("height",`${S}px`)),y.setAttribute("preserveAspectRatio","none"),y.setAttribute("viewBox",`0 0 ${m} ${S}`),y}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,n.unreachable)("Abstract method `_createSVG` called.")}}},923:(r,t,s)=>{var Wt,bu,ie,_u;s.d(t,{CanvasGraphics:()=>lt});var n=s(292),a=s(419);const o={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function c(ut,T){if(!T)return;const M=T[2]-T[0],D=T[3]-T[1],H=new Path2D;H.rect(T[0],T[1],M,D),ut.clip(H)}class u{constructor(){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class d extends u{constructor(T){super(),this._type=T[1],this._bbox=T[2],this._colorStops=T[3],this._p0=T[4],this._p1=T[5],this._r0=T[6],this._r1=T[7],this.matrix=null}_createGradient(T){let M;this._type==="axial"?M=T.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(M=T.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const D of this._colorStops)M.addColorStop(D[0],D[1]);return M}getPattern(T,M,D,H){let L;if(H===o.STROKE||H===o.FILL){const V=M.current.getClippedPathBoundingBox(H,(0,a.getCurrentTransform)(T))||[0,0,0,0],j=Math.ceil(V[2]-V[0])||1,G=Math.ceil(V[3]-V[1])||1,W=M.cachedCanvases.getCanvas("pattern",j,G,!0),U=W.context;U.clearRect(0,0,U.canvas.width,U.canvas.height),U.beginPath(),U.rect(0,0,U.canvas.width,U.canvas.height),U.translate(-V[0],-V[1]),D=n.Util.transform(D,[1,0,0,1,V[0],V[1]]),U.transform(...M.baseTransform),this.matrix&&U.transform(...this.matrix),c(U,this._bbox),U.fillStyle=this._createGradient(U),U.fill(),L=T.createPattern(W.canvas,"no-repeat");const O=new DOMMatrix(D);L.setTransform(O)}else c(T,this._bbox),L=this._createGradient(T);return L}}function f(ut,T,M,D,H,L,V,j){const G=T.coords,W=T.colors,U=ut.data,O=ut.width*4;let z;G[M+1]>G[D+1]&&(z=M,M=D,D=z,z=L,L=V,V=z),G[D+1]>G[H+1]&&(z=D,D=H,H=z,z=V,V=j,j=z),G[M+1]>G[D+1]&&(z=M,M=D,D=z,z=L,L=V,V=z);const et=(G[M]+T.offsetX)*T.scaleX,nt=(G[M+1]+T.offsetY)*T.scaleY,pt=(G[D]+T.offsetX)*T.scaleX,yt=(G[D+1]+T.offsetY)*T.scaleY,Nt=(G[H]+T.offsetX)*T.scaleX,Ht=(G[H+1]+T.offsetY)*T.scaleY;if(nt>=Ht)return;const Pt=W[L],Bt=W[L+1],Z=W[L+2],at=W[V],_t=W[V+1],vt=W[V+2],jt=W[j],bt=W[j+1],q=W[j+2],ot=Math.round(nt),ft=Math.round(Ht);let Et,Kt,te,me,Pe,Ti,je,hi;for(let ze=ot;ze<=ft;ze++){if(ze<yt){const Me=ze<nt?0:(nt-ze)/(nt-yt);Et=et-(et-pt)*Me,Kt=Pt-(Pt-at)*Me,te=Bt-(Bt-_t)*Me,me=Z-(Z-vt)*Me}else{let Me;ze>Ht?Me=1:yt===Ht?Me=0:Me=(yt-ze)/(yt-Ht),Et=pt-(pt-Nt)*Me,Kt=at-(at-jt)*Me,te=_t-(_t-bt)*Me,me=vt-(vt-q)*Me}let vi;ze<nt?vi=0:ze>Ht?vi=1:vi=(nt-ze)/(nt-Ht),Pe=et-(et-Nt)*vi,Ti=Pt-(Pt-jt)*vi,je=Bt-(Bt-bt)*vi,hi=Z-(Z-q)*vi;const oi=Math.round(Math.min(Et,Pe)),tr=Math.round(Math.max(Et,Pe));let bi=O*ze+oi*4;for(let Me=oi;Me<=tr;Me++)vi=(Et-Me)/(Et-Pe),vi<0?vi=0:vi>1&&(vi=1),U[bi++]=Kt-(Kt-Ti)*vi|0,U[bi++]=te-(te-je)*vi|0,U[bi++]=me-(me-hi)*vi|0,U[bi++]=255}}function m(ut,T,M){const D=T.coords,H=T.colors;let L,V;switch(T.type){case"lattice":const j=T.verticesPerRow,G=Math.floor(D.length/j)-1,W=j-1;for(L=0;L<G;L++){let U=L*j;for(let O=0;O<W;O++,U++)f(ut,M,D[U],D[U+1],D[U+j],H[U],H[U+1],H[U+j]),f(ut,M,D[U+j+1],D[U+1],D[U+j],H[U+j+1],H[U+1],H[U+j])}break;case"triangles":for(L=0,V=D.length;L<V;L+=3)f(ut,M,D[L],D[L+1],D[L+2],H[L],H[L+1],H[L+2]);break;default:throw new Error("illegal figure")}}class S extends u{constructor(T){super(),this._coords=T[2],this._colors=T[3],this._figures=T[4],this._bounds=T[5],this._bbox=T[7],this._background=T[8],this.matrix=null}_createMeshCanvas(T,M,D){const H=Math.floor(this._bounds[0]),L=Math.floor(this._bounds[1]),V=Math.ceil(this._bounds[2])-H,j=Math.ceil(this._bounds[3])-L,G=Math.min(Math.ceil(Math.abs(V*T[0]*1.1)),3e3),W=Math.min(Math.ceil(Math.abs(j*T[1]*1.1)),3e3),U=V/G,O=j/W,z={coords:this._coords,colors:this._colors,offsetX:-H,offsetY:-L,scaleX:1/U,scaleY:1/O},et=G+2*2,nt=W+2*2,pt=D.getCanvas("mesh",et,nt,!1),yt=pt.context,Nt=yt.createImageData(G,W);if(M){const Ht=Nt.data;for(let Pt=0,Bt=Ht.length;Pt<Bt;Pt+=4)Ht[Pt]=M[0],Ht[Pt+1]=M[1],Ht[Pt+2]=M[2],Ht[Pt+3]=255}for(const Ht of this._figures)m(Nt,Ht,z);return yt.putImageData(Nt,2,2),{canvas:pt.canvas,offsetX:H-2*U,offsetY:L-2*O,scaleX:U,scaleY:O}}getPattern(T,M,D,H){c(T,this._bbox);let L;if(H===o.SHADING)L=n.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(T));else if(L=n.Util.singularValueDecompose2dScale(M.baseTransform),this.matrix){const j=n.Util.singularValueDecompose2dScale(this.matrix);L=[L[0]*j[0],L[1]*j[1]]}const V=this._createMeshCanvas(L,H===o.SHADING?null:this._background,M.cachedCanvases);return H!==o.SHADING&&(T.setTransform(...M.baseTransform),this.matrix&&T.transform(...this.matrix)),T.translate(V.offsetX,V.offsetY),T.scale(V.scaleX,V.scaleY),T.createPattern(V.canvas,"no-repeat")}}class _ extends u{getPattern(){return"hotpink"}}function y(ut){switch(ut[0]){case"RadialAxial":return new d(ut);case"Mesh":return new S(ut);case"Dummy":return new _}throw new Error(`Unknown IR type: ${ut[0]}`)}const b={COLORED:1,UNCOLORED:2},Ft=class{constructor(T,M,D,H,L){this.operatorList=T[2],this.matrix=T[3]||[1,0,0,1,0,0],this.bbox=T[4],this.xstep=T[5],this.ystep=T[6],this.paintType=T[7],this.tilingType=T[8],this.color=M,this.ctx=D,this.canvasGraphicsFactory=H,this.baseTransform=L}createPatternCanvas(T){const M=this.operatorList,D=this.bbox,H=this.xstep,L=this.ystep,V=this.paintType,j=this.tilingType,G=this.color,W=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+j);const U=D[0],O=D[1],z=D[2],et=D[3],nt=n.Util.singularValueDecompose2dScale(this.matrix),pt=n.Util.singularValueDecompose2dScale(this.baseTransform),yt=[nt[0]*pt[0],nt[1]*pt[1]],Nt=this.getSizeAndScale(H,this.ctx.canvas.width,yt[0]),Ht=this.getSizeAndScale(L,this.ctx.canvas.height,yt[1]),Pt=T.cachedCanvases.getCanvas("pattern",Nt.size,Ht.size,!0),Bt=Pt.context,Z=W.createCanvasGraphics(Bt);Z.groupLevel=T.groupLevel,this.setFillAndStrokeStyleToContext(Z,V,G);let at=U,_t=O,vt=z,jt=et;return U<0&&(at=0,vt+=Math.abs(U)),O<0&&(_t=0,jt+=Math.abs(O)),Bt.translate(-(Nt.scale*at),-(Ht.scale*_t)),Z.transform(Nt.scale,0,0,Ht.scale,0,0),Bt.save(),this.clipBbox(Z,at,_t,vt,jt),Z.baseTransform=(0,a.getCurrentTransform)(Z.ctx),Z.executeOperatorList(M),Z.endDrawing(),{canvas:Pt.canvas,scaleX:Nt.scale,scaleY:Ht.scale,offsetX:at,offsetY:_t}}getSizeAndScale(T,M,D){T=Math.abs(T);const H=Math.max(Ft.MAX_PATTERN_SIZE,M);let L=Math.ceil(T*D);return L>=H?L=H:D=L/T,{scale:D,size:L}}clipBbox(T,M,D,H,L){const V=H-M,j=L-D;T.ctx.rect(M,D,V,j),T.current.updateRectMinMax((0,a.getCurrentTransform)(T.ctx),[M,D,H,L]),T.clip(),T.endPath()}setFillAndStrokeStyleToContext(T,M,D){const H=T.ctx,L=T.current;switch(M){case b.COLORED:const V=this.ctx;H.fillStyle=V.fillStyle,H.strokeStyle=V.strokeStyle,L.fillColor=V.fillStyle,L.strokeColor=V.strokeStyle;break;case b.UNCOLORED:const j=n.Util.makeHexColor(D[0],D[1],D[2]);H.fillStyle=j,H.strokeStyle=j,L.fillColor=j,L.strokeColor=j;break;default:throw new n.FormatError(`Unsupported paint type: ${M}`)}}getPattern(T,M,D,H){let L=D;H!==o.SHADING&&(L=n.Util.transform(L,M.baseTransform),this.matrix&&(L=n.Util.transform(L,this.matrix)));const V=this.createPatternCanvas(M);let j=new DOMMatrix(L);j=j.translate(V.offsetX,V.offsetY),j=j.scale(1/V.scaleX,1/V.scaleY);const G=T.createPattern(V.canvas,"repeat");return G.setTransform(j),G}};let x=Ft;ti(x,"MAX_PATTERN_SIZE",3e3);function E({src:ut,srcPos:T=0,dest:M,width:D,height:H,nonBlackColor:L=4294967295,inverseDecode:V=!1}){const j=n.FeatureTest.isLittleEndian?4278190080:255,[G,W]=V?[L,j]:[j,L],U=D>>3,O=D&7,z=ut.length;M=new Uint32Array(M.buffer);let et=0;for(let nt=0;nt<H;nt++){for(const yt=T+U;T<yt;T++){const Nt=T<z?ut[T]:255;M[et++]=Nt&128?W:G,M[et++]=Nt&64?W:G,M[et++]=Nt&32?W:G,M[et++]=Nt&16?W:G,M[et++]=Nt&8?W:G,M[et++]=Nt&4?W:G,M[et++]=Nt&2?W:G,M[et++]=Nt&1?W:G}if(O===0)continue;const pt=T<z?ut[T++]:255;for(let yt=0;yt<O;yt++)M[et++]=pt&1<<7-yt?W:G}return{srcPos:T,destPos:et}}const I=16,R=100,p=4096,w=15,A=10,C=1e3,B=16;function F(ut,T){if(ut._removeMirroring)throw new Error("Context is already forwarding operations.");ut.__originalSave=ut.save,ut.__originalRestore=ut.restore,ut.__originalRotate=ut.rotate,ut.__originalScale=ut.scale,ut.__originalTranslate=ut.translate,ut.__originalTransform=ut.transform,ut.__originalSetTransform=ut.setTransform,ut.__originalResetTransform=ut.resetTransform,ut.__originalClip=ut.clip,ut.__originalMoveTo=ut.moveTo,ut.__originalLineTo=ut.lineTo,ut.__originalBezierCurveTo=ut.bezierCurveTo,ut.__originalRect=ut.rect,ut.__originalClosePath=ut.closePath,ut.__originalBeginPath=ut.beginPath,ut._removeMirroring=()=>{ut.save=ut.__originalSave,ut.restore=ut.__originalRestore,ut.rotate=ut.__originalRotate,ut.scale=ut.__originalScale,ut.translate=ut.__originalTranslate,ut.transform=ut.__originalTransform,ut.setTransform=ut.__originalSetTransform,ut.resetTransform=ut.__originalResetTransform,ut.clip=ut.__originalClip,ut.moveTo=ut.__originalMoveTo,ut.lineTo=ut.__originalLineTo,ut.bezierCurveTo=ut.__originalBezierCurveTo,ut.rect=ut.__originalRect,ut.closePath=ut.__originalClosePath,ut.beginPath=ut.__originalBeginPath,delete ut._removeMirroring},ut.save=function(){T.save(),this.__originalSave()},ut.restore=function(){T.restore(),this.__originalRestore()},ut.translate=function(M,D){T.translate(M,D),this.__originalTranslate(M,D)},ut.scale=function(M,D){T.scale(M,D),this.__originalScale(M,D)},ut.transform=function(M,D,H,L,V,j){T.transform(M,D,H,L,V,j),this.__originalTransform(M,D,H,L,V,j)},ut.setTransform=function(M,D,H,L,V,j){T.setTransform(M,D,H,L,V,j),this.__originalSetTransform(M,D,H,L,V,j)},ut.resetTransform=function(){T.resetTransform(),this.__originalResetTransform()},ut.rotate=function(M){T.rotate(M),this.__originalRotate(M)},ut.clip=function(M){T.clip(M),this.__originalClip(M)},ut.moveTo=function(M,D){T.moveTo(M,D),this.__originalMoveTo(M,D)},ut.lineTo=function(M,D){T.lineTo(M,D),this.__originalLineTo(M,D)},ut.bezierCurveTo=function(M,D,H,L,V,j){T.bezierCurveTo(M,D,H,L,V,j),this.__originalBezierCurveTo(M,D,H,L,V,j)},ut.rect=function(M,D,H,L){T.rect(M,D,H,L),this.__originalRect(M,D,H,L)},ut.closePath=function(){T.closePath(),this.__originalClosePath()},ut.beginPath=function(){T.beginPath(),this.__originalBeginPath()}}class rt{constructor(T){this.canvasFactory=T,this.cache=Object.create(null)}getCanvas(T,M,D){let H;return this.cache[T]!==void 0?(H=this.cache[T],this.canvasFactory.reset(H,M,D)):(H=this.canvasFactory.create(M,D),this.cache[T]=H),H}delete(T){delete this.cache[T]}clear(){for(const T in this.cache){const M=this.cache[T];this.canvasFactory.destroy(M),delete this.cache[T]}}}function tt(ut,T,M,D,H,L,V,j,G,W){const[U,O,z,et,nt,pt]=(0,a.getCurrentTransform)(ut);if(O===0&&z===0){const Ht=V*U+nt,Pt=Math.round(Ht),Bt=j*et+pt,Z=Math.round(Bt),at=(V+G)*U+nt,_t=Math.abs(Math.round(at)-Pt)||1,vt=(j+W)*et+pt,jt=Math.abs(Math.round(vt)-Z)||1;return ut.setTransform(Math.sign(U),0,0,Math.sign(et),Pt,Z),ut.drawImage(T,M,D,H,L,0,0,_t,jt),ut.setTransform(U,O,z,et,nt,pt),[_t,jt]}if(U===0&&et===0){const Ht=j*z+nt,Pt=Math.round(Ht),Bt=V*O+pt,Z=Math.round(Bt),at=(j+W)*z+nt,_t=Math.abs(Math.round(at)-Pt)||1,vt=(V+G)*O+pt,jt=Math.abs(Math.round(vt)-Z)||1;return ut.setTransform(0,Math.sign(O),Math.sign(z),0,Pt,Z),ut.drawImage(T,M,D,H,L,0,0,jt,_t),ut.setTransform(U,O,z,et,nt,pt),[jt,_t]}ut.drawImage(T,M,D,H,L,V,j,G,W);const yt=Math.hypot(U,O),Nt=Math.hypot(z,et);return[yt*G,Nt*W]}function st(ut){const{width:T,height:M}=ut;if(T>C||M>C)return null;const D=1e3,H=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),L=T+1;let V=new Uint8Array(L*(M+1)),j,G,W;const U=T+7&-8;let O=new Uint8Array(U*M),z=0;for(const yt of ut.data){let Nt=128;for(;Nt>0;)O[z++]=yt&Nt?0:255,Nt>>=1}let et=0;for(z=0,O[z]!==0&&(V[0]=1,++et),G=1;G<T;G++)O[z]!==O[z+1]&&(V[G]=O[z]?2:1,++et),z++;for(O[z]!==0&&(V[G]=2,++et),j=1;j<M;j++){z=j*U,W=j*L,O[z-U]!==O[z]&&(V[W]=O[z]?1:8,++et);let yt=(O[z]?4:0)+(O[z-U]?8:0);for(G=1;G<T;G++)yt=(yt>>2)+(O[z+1]?4:0)+(O[z-U+1]?8:0),H[yt]&&(V[W+G]=H[yt],++et),z++;if(O[z-U]!==O[z]&&(V[W+G]=O[z]?2:4,++et),et>D)return null}for(z=U*(M-1),W=j*L,O[z]!==0&&(V[W]=8,++et),G=1;G<T;G++)O[z]!==O[z+1]&&(V[W+G]=O[z]?4:8,++et),z++;if(O[z]!==0&&(V[W+G]=4,++et),et>D)return null;const nt=new Int32Array([0,L,-1,0,-L,0,0,0,1]),pt=new Path2D;for(j=0;et&&j<=M;j++){let yt=j*L;const Nt=yt+T;for(;yt<Nt&&!V[yt];)yt++;if(yt===Nt)continue;pt.moveTo(yt%L,j);const Ht=yt;let Pt=V[yt];do{const Bt=nt[Pt];do yt+=Bt;while(!V[yt]);const Z=V[yt];Z!==5&&Z!==10?(Pt=Z,V[yt]=0):(Pt=Z&51*Pt>>4,V[yt]&=Pt>>2|Pt<<2),pt.lineTo(yt%L,yt/L|0),V[yt]||--et}while(Ht!==yt);--j}return O=null,V=null,function(yt){yt.save(),yt.scale(1/T,-1/M),yt.translate(0,-M),yt.fill(pt),yt.beginPath(),yt.restore()}}class wt{constructor(T,M){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,T,M])}clone(){const T=Object.create(this);return T.clipBox=this.clipBox.slice(),T}setCurrentPoint(T,M){this.x=T,this.y=M}updatePathMinMax(T,M,D){[M,D]=n.Util.applyTransform([M,D],T),this.minX=Math.min(this.minX,M),this.minY=Math.min(this.minY,D),this.maxX=Math.max(this.maxX,M),this.maxY=Math.max(this.maxY,D)}updateRectMinMax(T,M){const D=n.Util.applyTransform(M,T),H=n.Util.applyTransform(M.slice(2),T),L=n.Util.applyTransform([M[0],M[3]],T),V=n.Util.applyTransform([M[2],M[1]],T);this.minX=Math.min(this.minX,D[0],H[0],L[0],V[0]),this.minY=Math.min(this.minY,D[1],H[1],L[1],V[1]),this.maxX=Math.max(this.maxX,D[0],H[0],L[0],V[0]),this.maxY=Math.max(this.maxY,D[1],H[1],L[1],V[1])}updateScalingPathMinMax(T,M){n.Util.scaleMinMax(T,M),this.minX=Math.min(this.minX,M[0]),this.minY=Math.min(this.minY,M[1]),this.maxX=Math.max(this.maxX,M[2]),this.maxY=Math.max(this.maxY,M[3])}updateCurvePathMinMax(T,M,D,H,L,V,j,G,W,U){const O=n.Util.bezierBoundingBox(M,D,H,L,V,j,G,W,U);U||this.updateRectMinMax(T,O)}getPathBoundingBox(T=o.FILL,M=null){const D=[this.minX,this.minY,this.maxX,this.maxY];if(T===o.STROKE){M||(0,n.unreachable)("Stroke bounding box must include transform.");const H=n.Util.singularValueDecompose2dScale(M),L=H[0]*this.lineWidth/2,V=H[1]*this.lineWidth/2;D[0]-=L,D[1]-=V,D[2]+=L,D[3]+=V}return D}updateClipFromPath(){const T=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(T||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(T){this.clipBox=T,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(T=o.FILL,M=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(T,M))}}function dt(ut,T){if(typeof ImageData<"u"&&T instanceof ImageData){ut.putImageData(T,0,0);return}const M=T.height,D=T.width,H=M%B,L=(M-H)/B,V=H===0?L:L+1,j=ut.createImageData(D,B);let G=0,W;const U=T.data,O=j.data;let z,et,nt,pt;if(T.kind===n.ImageKind.GRAYSCALE_1BPP){const yt=U.byteLength,Nt=new Uint32Array(O.buffer,0,O.byteLength>>2),Ht=Nt.length,Pt=D+7>>3,Bt=4294967295,Z=n.FeatureTest.isLittleEndian?4278190080:255;for(z=0;z<V;z++){for(nt=z<L?B:H,W=0,et=0;et<nt;et++){const at=yt-G;let _t=0;const vt=at>Pt?D:at*8-7,jt=vt&-8;let bt=0,q=0;for(;_t<jt;_t+=8)q=U[G++],Nt[W++]=q&128?Bt:Z,Nt[W++]=q&64?Bt:Z,Nt[W++]=q&32?Bt:Z,Nt[W++]=q&16?Bt:Z,Nt[W++]=q&8?Bt:Z,Nt[W++]=q&4?Bt:Z,Nt[W++]=q&2?Bt:Z,Nt[W++]=q&1?Bt:Z;for(;_t<vt;_t++)bt===0&&(q=U[G++],bt=128),Nt[W++]=q&bt?Bt:Z,bt>>=1}for(;W<Ht;)Nt[W++]=0;ut.putImageData(j,0,z*B)}}else if(T.kind===n.ImageKind.RGBA_32BPP){for(et=0,pt=D*B*4,z=0;z<L;z++)O.set(U.subarray(G,G+pt)),G+=pt,ut.putImageData(j,0,et),et+=B;z<V&&(pt=D*H*4,O.set(U.subarray(G,G+pt)),ut.putImageData(j,0,et))}else if(T.kind===n.ImageKind.RGB_24BPP)for(nt=B,pt=D*nt,z=0;z<V;z++){for(z>=L&&(nt=H,pt=D*nt),W=0,et=pt;et--;)O[W++]=U[G++],O[W++]=U[G++],O[W++]=U[G++],O[W++]=255;ut.putImageData(j,0,z*B)}else throw new Error(`bad image kind: ${T.kind}`)}function Tt(ut,T){if(T.bitmap){ut.drawImage(T.bitmap,0,0);return}const M=T.height,D=T.width,H=M%B,L=(M-H)/B,V=H===0?L:L+1,j=ut.createImageData(D,B);let G=0;const W=T.data,U=j.data;for(let O=0;O<V;O++){const z=O<L?B:H;({srcPos:G}=E({src:W,srcPos:G,dest:U,width:D,height:z,nonBlackColor:0})),ut.putImageData(j,0,O*B)}}function Lt(ut,T){const M=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const D of M)ut[D]!==void 0&&(T[D]=ut[D]);ut.setLineDash!==void 0&&(T.setLineDash(ut.getLineDash()),T.lineDashOffset=ut.lineDashOffset)}function Qt(ut){if(ut.strokeStyle=ut.fillStyle="#000000",ut.fillRule="nonzero",ut.globalAlpha=1,ut.lineWidth=1,ut.lineCap="butt",ut.lineJoin="miter",ut.miterLimit=10,ut.globalCompositeOperation="source-over",ut.font="10px sans-serif",ut.setLineDash!==void 0&&(ut.setLineDash([]),ut.lineDashOffset=0),!n.isNodeJS){const{filter:T}=ut;T!=="none"&&T!==""&&(ut.filter="none")}}function ct(ut,T,M,D){const H=ut.length;for(let L=3;L<H;L+=4){const V=ut[L];if(V===0)ut[L-3]=T,ut[L-2]=M,ut[L-1]=D;else if(V<255){const j=255-V;ut[L-3]=ut[L-3]*V+T*j>>8,ut[L-2]=ut[L-2]*V+M*j>>8,ut[L-1]=ut[L-1]*V+D*j>>8}}}function Dt(ut,T,M){const D=ut.length,H=1/255;for(let L=3;L<D;L+=4){const V=M?M[ut[L]]:ut[L];T[L]=T[L]*V*H|0}}function ee(ut,T,M){const D=ut.length;for(let H=3;H<D;H+=4){const L=ut[H-3]*77+ut[H-2]*152+ut[H-1]*28;T[H]=M?T[H]*M[L>>8]>>8:T[H]*L>>16}}function zt(ut,T,M,D,H,L,V,j,G,W,U){const O=!!L,z=O?L[0]:0,et=O?L[1]:0,nt=O?L[2]:0,pt=H==="Luminosity"?ee:Dt,yt=Math.min(D,Math.ceil(1048576/M));for(let Nt=0;Nt<D;Nt+=yt){const Ht=Math.min(yt,D-Nt),Pt=ut.getImageData(j-W,Nt+(G-U),M,Ht),Bt=T.getImageData(j,Nt+G,M,Ht);O&&ct(Pt.data,z,et,nt),pt(Pt.data,Bt.data,V),T.putImageData(Bt,j,Nt+G)}}function Jt(ut,T,M,D){const H=D[0],L=D[1],V=D[2]-H,j=D[3]-L;V===0||j===0||(zt(T.context,M,V,j,T.subtype,T.backdrop,T.transferMap,H,L,T.offsetX,T.offsetY),ut.save(),ut.globalAlpha=1,ut.globalCompositeOperation="source-over",ut.setTransform(1,0,0,1,0,0),ut.drawImage(M.canvas,0,0),ut.restore())}function oe(ut,T){if(T)return!0;const M=n.Util.singularValueDecompose2dScale(ut);M[0]=Math.fround(M[0]),M[1]=Math.fround(M[1]);const D=Math.fround((globalThis.devicePixelRatio||1)*a.PixelsPerInch.PDF_TO_CSS_UNITS);return M[0]<=D&&M[1]<=D}const pe=["butt","round","square"],Ae=["miter","round","bevel"],Ve={},Gt={},_e=class{constructor(T,M,D,H,L,{optionalContentConfig:V,markedContentStack:j=null},G,W){N(this,Wt);N(this,ie);this.ctx=T,this.current=new wt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=M,this.objs=D,this.canvasFactory=H,this.filterFactory=L,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=j||[],this.optionalContentConfig=V,this.cachedCanvases=new rt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=G,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=W,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(T,M=null){return typeof T=="string"?T.startsWith("g_")?this.commonObjs.get(T):this.objs.get(T):M}beginDrawing({transform:T,viewport:M,transparency:D=!1,background:H=null}){const L=this.ctx.canvas.width,V=this.ctx.canvas.height,j=this.ctx.fillStyle;if(this.ctx.fillStyle=H||"#ffffff",this.ctx.fillRect(0,0,L,V),this.ctx.fillStyle=j,D){const G=this.cachedCanvases.getCanvas("transparent",L,V);this.compositeCtx=this.ctx,this.transparentCanvas=G.canvas,this.ctx=G.context,this.ctx.save(),this.ctx.transform(...(0,a.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Qt(this.ctx),T&&(this.ctx.transform(...T),this.outputScaleX=T[0],this.outputScaleY=T[0]),this.ctx.transform(...M.transform),this.viewportScale=M.scale,this.baseTransform=(0,a.getCurrentTransform)(this.ctx)}executeOperatorList(T,M,D,H){const L=T.argsArray,V=T.fnArray;let j=M||0;const G=L.length;if(G===j)return j;const W=G-j>A&&typeof D=="function",U=W?Date.now()+w:0;let O=0;const z=this.commonObjs,et=this.objs;let nt;for(;;){if(H!==void 0&&j===H.nextBreakPoint)return H.breakIt(j,D),j;if(nt=V[j],nt!==n.OPS.dependency)this[nt].apply(this,L[j]);else for(const pt of L[j]){const yt=pt.startsWith("g_")?z:et;if(!yt.has(pt))return yt.get(pt,D),j}if(j++,j===G)return j;if(W&&++O>A){if(Date.now()>U)return D(),j;O=0}}}endDrawing(){Y(this,Wt,bu).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const T of this._cachedBitmapsMap.values()){for(const M of T.values())typeof HTMLCanvasElement<"u"&&M instanceof HTMLCanvasElement&&(M.width=M.height=0);T.clear()}this._cachedBitmapsMap.clear(),Y(this,ie,_u).call(this)}_scaleImage(T,M){const D=T.width,H=T.height;let L=Math.max(Math.hypot(M[0],M[1]),1),V=Math.max(Math.hypot(M[2],M[3]),1),j=D,G=H,W="prescale1",U,O;for(;L>2&&j>1||V>2&&G>1;){let z=j,et=G;L>2&&j>1&&(z=j>=16384?Math.floor(j/2)-1||1:Math.ceil(j/2),L/=j/z),V>2&&G>1&&(et=G>=16384?Math.floor(G/2)-1||1:Math.ceil(G)/2,V/=G/et),U=this.cachedCanvases.getCanvas(W,z,et),O=U.context,O.clearRect(0,0,z,et),O.drawImage(T,0,0,j,G,0,0,z,et),T=U.canvas,j=z,G=et,W=W==="prescale1"?"prescale2":"prescale1"}return{img:T,paintWidth:j,paintHeight:G}}_createMaskCanvas(T){const M=this.ctx,{width:D,height:H}=T,L=this.current.fillColor,V=this.current.patternFill,j=(0,a.getCurrentTransform)(M);let G,W,U,O;if((T.bitmap||T.data)&&T.count>1){const vt=T.bitmap||T.data.buffer;W=JSON.stringify(V?j:[j.slice(0,4),L]),G=this._cachedBitmapsMap.get(vt),G||(G=new Map,this._cachedBitmapsMap.set(vt,G));const jt=G.get(W);if(jt&&!V){const bt=Math.round(Math.min(j[0],j[2])+j[4]),q=Math.round(Math.min(j[1],j[3])+j[5]);return{canvas:jt,offsetX:bt,offsetY:q}}U=jt}U||(O=this.cachedCanvases.getCanvas("maskCanvas",D,H),Tt(O.context,T));let z=n.Util.transform(j,[1/D,0,0,-1/H,0,0]);z=n.Util.transform(z,[1,0,0,1,0,-H]);const[et,nt,pt,yt]=n.Util.getAxialAlignedBoundingBox([0,0,D,H],z),Nt=Math.round(pt-et)||1,Ht=Math.round(yt-nt)||1,Pt=this.cachedCanvases.getCanvas("fillCanvas",Nt,Ht),Bt=Pt.context,Z=et,at=nt;Bt.translate(-Z,-at),Bt.transform(...z),U||(U=this._scaleImage(O.canvas,(0,a.getCurrentTransformInverse)(Bt)),U=U.img,G&&V&&G.set(W,U)),Bt.imageSmoothingEnabled=oe((0,a.getCurrentTransform)(Bt),T.interpolate),tt(Bt,U,0,0,U.width,U.height,0,0,D,H),Bt.globalCompositeOperation="source-in";const _t=n.Util.transform((0,a.getCurrentTransformInverse)(Bt),[1,0,0,1,-Z,-at]);return Bt.fillStyle=V?L.getPattern(M,this,_t,o.FILL):L,Bt.fillRect(0,0,D,H),G&&!V&&(this.cachedCanvases.delete("fillCanvas"),G.set(W,Pt.canvas)),{canvas:Pt.canvas,offsetX:Math.round(Z),offsetY:Math.round(at)}}setLineWidth(T){T!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=T,this.ctx.lineWidth=T}setLineCap(T){this.ctx.lineCap=pe[T]}setLineJoin(T){this.ctx.lineJoin=Ae[T]}setMiterLimit(T){this.ctx.miterLimit=T}setDash(T,M){const D=this.ctx;D.setLineDash!==void 0&&(D.setLineDash(T),D.lineDashOffset=M)}setRenderingIntent(T){}setFlatness(T){}setGState(T){for(const[M,D]of T)switch(M){case"LW":this.setLineWidth(D);break;case"LC":this.setLineCap(D);break;case"LJ":this.setLineJoin(D);break;case"ML":this.setMiterLimit(D);break;case"D":this.setDash(D[0],D[1]);break;case"RI":this.setRenderingIntent(D);break;case"FL":this.setFlatness(D);break;case"Font":this.setFont(D[0],D[1]);break;case"CA":this.current.strokeAlpha=D;break;case"ca":this.current.fillAlpha=D,this.ctx.globalAlpha=D;break;case"BM":this.ctx.globalCompositeOperation=D;break;case"SMask":this.current.activeSMask=D?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(D);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const T=this.inSMaskMode;this.current.activeSMask&&!T?this.beginSMaskMode():!this.current.activeSMask&&T&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const T=this.ctx.canvas.width,M=this.ctx.canvas.height,D="smaskGroupAt"+this.groupLevel,H=this.cachedCanvases.getCanvas(D,T,M);this.suspendedCtx=this.ctx,this.ctx=H.context;const L=this.ctx;L.setTransform(...(0,a.getCurrentTransform)(this.suspendedCtx)),Lt(this.suspendedCtx,L),F(L,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Lt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(T){if(!this.current.activeSMask)return;T?(T[0]=Math.floor(T[0]),T[1]=Math.floor(T[1]),T[2]=Math.ceil(T[2]),T[3]=Math.ceil(T[3])):T=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const M=this.current.activeSMask,D=this.suspendedCtx;Jt(D,M,this.ctx,T),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Lt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const T=this.current;this.stateStack.push(T),this.current=T.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Lt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(T,M,D,H,L,V){this.ctx.transform(T,M,D,H,L,V),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(T,M,D){const H=this.ctx,L=this.current;let V=L.x,j=L.y,G,W;const U=(0,a.getCurrentTransform)(H),O=U[0]===0&&U[3]===0||U[1]===0&&U[2]===0,z=O?D.slice(0):null;for(let et=0,nt=0,pt=T.length;et<pt;et++)switch(T[et]|0){case n.OPS.rectangle:V=M[nt++],j=M[nt++];const yt=M[nt++],Nt=M[nt++],Ht=V+yt,Pt=j+Nt;H.moveTo(V,j),yt===0||Nt===0?H.lineTo(Ht,Pt):(H.lineTo(Ht,j),H.lineTo(Ht,Pt),H.lineTo(V,Pt)),O||L.updateRectMinMax(U,[V,j,Ht,Pt]),H.closePath();break;case n.OPS.moveTo:V=M[nt++],j=M[nt++],H.moveTo(V,j),O||L.updatePathMinMax(U,V,j);break;case n.OPS.lineTo:V=M[nt++],j=M[nt++],H.lineTo(V,j),O||L.updatePathMinMax(U,V,j);break;case n.OPS.curveTo:G=V,W=j,V=M[nt+4],j=M[nt+5],H.bezierCurveTo(M[nt],M[nt+1],M[nt+2],M[nt+3],V,j),L.updateCurvePathMinMax(U,G,W,M[nt],M[nt+1],M[nt+2],M[nt+3],V,j,z),nt+=6;break;case n.OPS.curveTo2:G=V,W=j,H.bezierCurveTo(V,j,M[nt],M[nt+1],M[nt+2],M[nt+3]),L.updateCurvePathMinMax(U,G,W,V,j,M[nt],M[nt+1],M[nt+2],M[nt+3],z),V=M[nt+2],j=M[nt+3],nt+=4;break;case n.OPS.curveTo3:G=V,W=j,V=M[nt+2],j=M[nt+3],H.bezierCurveTo(M[nt],M[nt+1],V,j,V,j),L.updateCurvePathMinMax(U,G,W,M[nt],M[nt+1],V,j,V,j,z),nt+=4;break;case n.OPS.closePath:H.closePath();break}O&&L.updateScalingPathMinMax(U,z),L.setCurrentPoint(V,j)}closePath(){this.ctx.closePath()}stroke(T=!0){const M=this.ctx,D=this.current.strokeColor;M.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof D=="object"&&(D!=null&&D.getPattern)?(M.save(),M.strokeStyle=D.getPattern(M,this,(0,a.getCurrentTransformInverse)(M),o.STROKE),this.rescaleAndStroke(!1),M.restore()):this.rescaleAndStroke(!0)),T&&this.consumePath(this.current.getClippedPathBoundingBox()),M.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(T=!0){const M=this.ctx,D=this.current.fillColor,H=this.current.patternFill;let L=!1;H&&(M.save(),M.fillStyle=D.getPattern(M,this,(0,a.getCurrentTransformInverse)(M),o.FILL),L=!0);const V=this.current.getClippedPathBoundingBox();this.contentVisible&&V!==null&&(this.pendingEOFill?(M.fill("evenodd"),this.pendingEOFill=!1):M.fill()),L&&M.restore(),T&&this.consumePath(V)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Ve}eoClip(){this.pendingClip=Gt}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const T=this.pendingTextPaths,M=this.ctx;if(T===void 0){M.beginPath();return}M.save(),M.beginPath();for(const D of T)M.setTransform(...D.transform),M.translate(D.x,D.y),D.addToPath(M,D.fontSize);M.restore(),M.clip(),M.beginPath(),delete this.pendingTextPaths}setCharSpacing(T){this.current.charSpacing=T}setWordSpacing(T){this.current.wordSpacing=T}setHScale(T){this.current.textHScale=T/100}setLeading(T){this.current.leading=-T}setFont(T,M){var U;const D=this.commonObjs.get(T),H=this.current;if(!D)throw new Error(`Can't find font for ${T}`);if(H.fontMatrix=D.fontMatrix||n.FONT_IDENTITY_MATRIX,(H.fontMatrix[0]===0||H.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+T),M<0?(M=-M,H.fontDirection=-1):H.fontDirection=1,this.current.font=D,this.current.fontSize=M,D.isType3Font)return;const L=D.loadedName||"sans-serif",V=((U=D.systemFontInfo)==null?void 0:U.css)||`"${L}", ${D.fallbackName}`;let j="normal";D.black?j="900":D.bold&&(j="bold");const G=D.italic?"italic":"normal";let W=M;M<I?W=I:M>R&&(W=R),this.current.fontSizeScale=M/W,this.ctx.font=`${G} ${j} ${W}px ${V}`}setTextRenderingMode(T){this.current.textRenderingMode=T}setTextRise(T){this.current.textRise=T}moveText(T,M){this.current.x=this.current.lineX+=T,this.current.y=this.current.lineY+=M}setLeadingMoveText(T,M){this.setLeading(-M),this.moveText(T,M)}setTextMatrix(T,M,D,H,L,V){this.current.textMatrix=[T,M,D,H,L,V],this.current.textMatrixScale=Math.hypot(T,M),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(T,M,D,H){const L=this.ctx,V=this.current,j=V.font,G=V.textRenderingMode,W=V.fontSize/V.fontSizeScale,U=G&n.TextRenderingMode.FILL_STROKE_MASK,O=!!(G&n.TextRenderingMode.ADD_TO_PATH_FLAG),z=V.patternFill&&!j.missingFile;let et;(j.disableFontFace||O||z)&&(et=j.getPathGenerator(this.commonObjs,T)),j.disableFontFace||z?(L.save(),L.translate(M,D),L.beginPath(),et(L,W),H&&L.setTransform(...H),(U===n.TextRenderingMode.FILL||U===n.TextRenderingMode.FILL_STROKE)&&L.fill(),(U===n.TextRenderingMode.STROKE||U===n.TextRenderingMode.FILL_STROKE)&&L.stroke(),L.restore()):((U===n.TextRenderingMode.FILL||U===n.TextRenderingMode.FILL_STROKE)&&L.fillText(T,M,D),(U===n.TextRenderingMode.STROKE||U===n.TextRenderingMode.FILL_STROKE)&&L.strokeText(T,M,D)),O&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,a.getCurrentTransform)(L),x:M,y:D,fontSize:W,addToPath:et})}get isFontSubpixelAAEnabled(){const{context:T}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);T.scale(1.5,1),T.fillText("I",0,10);const M=T.getImageData(0,0,10,10).data;let D=!1;for(let H=3;H<M.length;H+=4)if(M[H]>0&&M[H]<255){D=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",D)}showText(T){const M=this.current,D=M.font;if(D.isType3Font)return this.showType3Text(T);const H=M.fontSize;if(H===0)return;const L=this.ctx,V=M.fontSizeScale,j=M.charSpacing,G=M.wordSpacing,W=M.fontDirection,U=M.textHScale*W,O=T.length,z=D.vertical,et=z?1:-1,nt=D.defaultVMetrics,pt=H*M.fontMatrix[0],yt=M.textRenderingMode===n.TextRenderingMode.FILL&&!D.disableFontFace&&!M.patternFill;L.save(),L.transform(...M.textMatrix),L.translate(M.x,M.y+M.textRise),W>0?L.scale(U,-1):L.scale(U,1);let Nt;if(M.patternFill){L.save();const at=M.fillColor.getPattern(L,this,(0,a.getCurrentTransformInverse)(L),o.FILL);Nt=(0,a.getCurrentTransform)(L),L.restore(),L.fillStyle=at}let Ht=M.lineWidth;const Pt=M.textMatrixScale;if(Pt===0||Ht===0){const at=M.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(at===n.TextRenderingMode.STROKE||at===n.TextRenderingMode.FILL_STROKE)&&(Ht=this.getSinglePixelWidth())}else Ht/=Pt;if(V!==1&&(L.scale(V,V),Ht/=V),L.lineWidth=Ht,D.isInvalidPDFjsFont){const at=[];let _t=0;for(const vt of T)at.push(vt.unicode),_t+=vt.width;L.fillText(at.join(""),0,0),M.x+=_t*pt*U,L.restore(),this.compose();return}let Bt=0,Z;for(Z=0;Z<O;++Z){const at=T[Z];if(typeof at=="number"){Bt+=et*at*H/1e3;continue}let _t=!1;const vt=(at.isSpace?G:0)+j,jt=at.fontChar,bt=at.accent;let q,ot,ft=at.width;if(z){const Kt=at.vmetric||nt,te=-(at.vmetric?Kt[1]:ft*.5)*pt,me=Kt[2]*pt;ft=Kt?-Kt[0]:ft,q=te/V,ot=(Bt+me)/V}else q=Bt/V,ot=0;if(D.remeasure&&ft>0){const Kt=L.measureText(jt).width*1e3/H*V;if(ft<Kt&&this.isFontSubpixelAAEnabled){const te=ft/Kt;_t=!0,L.save(),L.scale(te,1),q/=te}else ft!==Kt&&(q+=(ft-Kt)/2e3*H/V)}if(this.contentVisible&&(at.isInFont||D.missingFile)){if(yt&&!bt)L.fillText(jt,q,ot);else if(this.paintChar(jt,q,ot,Nt),bt){const Kt=q+H*bt.offset.x/V,te=ot-H*bt.offset.y/V;this.paintChar(bt.fontChar,Kt,te,Nt)}}const Et=z?ft*pt-vt*W:ft*pt+vt*W;Bt+=Et,_t&&L.restore()}z?M.y-=Bt:M.x+=Bt*U,L.restore(),this.compose()}showType3Text(T){const M=this.ctx,D=this.current,H=D.font,L=D.fontSize,V=D.fontDirection,j=H.vertical?1:-1,G=D.charSpacing,W=D.wordSpacing,U=D.textHScale*V,O=D.fontMatrix||n.FONT_IDENTITY_MATRIX,z=T.length,et=D.textRenderingMode===n.TextRenderingMode.INVISIBLE;let nt,pt,yt,Nt;if(!(et||L===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,M.save(),M.transform(...D.textMatrix),M.translate(D.x,D.y),M.scale(U,V),nt=0;nt<z;++nt){if(pt=T[nt],typeof pt=="number"){Nt=j*pt*L/1e3,this.ctx.translate(Nt,0),D.x+=Nt*U;continue}const Ht=(pt.isSpace?W:0)+G,Pt=H.charProcOperatorList[pt.operatorListId];if(!Pt){(0,n.warn)(`Type3 character "${pt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=pt,this.save(),M.scale(L,L),M.transform(...O),this.executeOperatorList(Pt),this.restore()),yt=n.Util.applyTransform([pt.width,0],O)[0]*L+Ht,M.translate(yt,0),D.x+=yt*U}M.restore(),this.processingType3=null}}setCharWidth(T,M){}setCharWidthAndBounds(T,M,D,H,L,V){this.ctx.rect(D,H,L-D,V-H),this.ctx.clip(),this.endPath()}getColorN_Pattern(T){let M;if(T[0]==="TilingPattern"){const D=T[1],H=this.baseTransform||(0,a.getCurrentTransform)(this.ctx),L={createCanvasGraphics:V=>new _e(V,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};M=new x(T,D,this.ctx,L,H)}else M=this._getPattern(T[1],T[2]);return M}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(T,M,D){const H=n.Util.makeHexColor(T,M,D);this.ctx.strokeStyle=H,this.current.strokeColor=H}setFillRGBColor(T,M,D){const H=n.Util.makeHexColor(T,M,D);this.ctx.fillStyle=H,this.current.fillColor=H,this.current.patternFill=!1}_getPattern(T,M=null){let D;return this.cachedPatterns.has(T)?D=this.cachedPatterns.get(T):(D=y(this.getObject(T)),this.cachedPatterns.set(T,D)),M&&(D.matrix=M),D}shadingFill(T){if(!this.contentVisible)return;const M=this.ctx;this.save();const D=this._getPattern(T);M.fillStyle=D.getPattern(M,this,(0,a.getCurrentTransformInverse)(M),o.SHADING);const H=(0,a.getCurrentTransformInverse)(M);if(H){const{width:L,height:V}=M.canvas,[j,G,W,U]=n.Util.getAxialAlignedBoundingBox([0,0,L,V],H);this.ctx.fillRect(j,G,W-j,U-G)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(T,M){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(T)&&T.length===6&&this.transform(...T),this.baseTransform=(0,a.getCurrentTransform)(this.ctx),M)){const D=M[2]-M[0],H=M[3]-M[1];this.ctx.rect(M[0],M[1],D,H),this.current.updateRectMinMax((0,a.getCurrentTransform)(this.ctx),M),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(T){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const M=this.ctx;T.isolated||(0,n.info)("TODO: Support non-isolated groups."),T.knockout&&(0,n.warn)("Knockout groups not supported.");const D=(0,a.getCurrentTransform)(M);if(T.matrix&&M.transform(...T.matrix),!T.bbox)throw new Error("Bounding box is required.");let H=n.Util.getAxialAlignedBoundingBox(T.bbox,(0,a.getCurrentTransform)(M));const L=[0,0,M.canvas.width,M.canvas.height];H=n.Util.intersect(H,L)||[0,0,0,0];const V=Math.floor(H[0]),j=Math.floor(H[1]);let G=Math.max(Math.ceil(H[2])-V,1),W=Math.max(Math.ceil(H[3])-j,1),U=1,O=1;G>p&&(U=G/p,G=p),W>p&&(O=W/p,W=p),this.current.startNewPathAndClipBox([0,0,G,W]);let z="groupAt"+this.groupLevel;T.smask&&(z+="_smask_"+this.smaskCounter++%2);const et=this.cachedCanvases.getCanvas(z,G,W),nt=et.context;nt.scale(1/U,1/O),nt.translate(-V,-j),nt.transform(...D),T.smask?this.smaskStack.push({canvas:et.canvas,context:nt,offsetX:V,offsetY:j,scaleX:U,scaleY:O,subtype:T.smask.subtype,backdrop:T.smask.backdrop,transferMap:T.smask.transferMap||null,startTransformInverse:null}):(M.setTransform(1,0,0,1,0,0),M.translate(V,j),M.scale(U,O),M.save()),Lt(M,nt),this.ctx=nt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(M),this.groupLevel++}endGroup(T){if(!this.contentVisible)return;this.groupLevel--;const M=this.ctx,D=this.groupStack.pop();if(this.ctx=D,this.ctx.imageSmoothingEnabled=!1,T.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const H=(0,a.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...H);const L=n.Util.getAxialAlignedBoundingBox([0,0,M.canvas.width,M.canvas.height],H);this.ctx.drawImage(M.canvas,0,0),this.ctx.restore(),this.compose(L)}}beginAnnotation(T,M,D,H,L){if(Y(this,Wt,bu).call(this),Qt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(M)&&M.length===4){const V=M[2]-M[0],j=M[3]-M[1];if(L&&this.annotationCanvasMap){D=D.slice(),D[4]-=M[0],D[5]-=M[1],M=M.slice(),M[0]=M[1]=0,M[2]=V,M[3]=j;const[G,W]=n.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(this.ctx)),{viewportScale:U}=this,O=Math.ceil(V*this.outputScaleX*U),z=Math.ceil(j*this.outputScaleY*U);this.annotationCanvas=this.canvasFactory.create(O,z);const{canvas:et,context:nt}=this.annotationCanvas;this.annotationCanvasMap.set(T,et),this.annotationCanvas.savedCtx=this.ctx,this.ctx=nt,this.ctx.save(),this.ctx.setTransform(G,0,0,-W,0,j*W),Qt(this.ctx)}else Qt(this.ctx),this.ctx.rect(M[0],M[1],V,j),this.ctx.clip(),this.endPath()}this.current=new wt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...D),this.transform(...H)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,ie,_u).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(T){if(!this.contentVisible)return;const M=T.count;T=this.getObject(T.data,T),T.count=M;const D=this.ctx,H=this.processingType3;if(H&&(H.compiled===void 0&&(H.compiled=st(T)),H.compiled)){H.compiled(D);return}const L=this._createMaskCanvas(T),V=L.canvas;D.save(),D.setTransform(1,0,0,1,0,0),D.drawImage(V,L.offsetX,L.offsetY),D.restore(),this.compose()}paintImageMaskXObjectRepeat(T,M,D=0,H=0,L,V){if(!this.contentVisible)return;T=this.getObject(T.data,T);const j=this.ctx;j.save();const G=(0,a.getCurrentTransform)(j);j.transform(M,D,H,L,0,0);const W=this._createMaskCanvas(T);j.setTransform(1,0,0,1,W.offsetX-G[4],W.offsetY-G[5]);for(let U=0,O=V.length;U<O;U+=2){const z=n.Util.transform(G,[M,D,H,L,V[U],V[U+1]]),[et,nt]=n.Util.applyTransform([0,0],z);j.drawImage(W.canvas,et,nt)}j.restore(),this.compose()}paintImageMaskXObjectGroup(T){if(!this.contentVisible)return;const M=this.ctx,D=this.current.fillColor,H=this.current.patternFill;for(const L of T){const{data:V,width:j,height:G,transform:W}=L,U=this.cachedCanvases.getCanvas("maskCanvas",j,G),O=U.context;O.save();const z=this.getObject(V,L);Tt(O,z),O.globalCompositeOperation="source-in",O.fillStyle=H?D.getPattern(O,this,(0,a.getCurrentTransformInverse)(M),o.FILL):D,O.fillRect(0,0,j,G),O.restore(),M.save(),M.transform(...W),M.scale(1,-1),tt(M,U.canvas,0,0,j,G,0,-1,1,1),M.restore()}this.compose()}paintImageXObject(T){if(!this.contentVisible)return;const M=this.getObject(T);if(!M){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(M)}paintImageXObjectRepeat(T,M,D,H){if(!this.contentVisible)return;const L=this.getObject(T);if(!L){(0,n.warn)("Dependent image isn't ready yet");return}const V=L.width,j=L.height,G=[];for(let W=0,U=H.length;W<U;W+=2)G.push({transform:[M,0,0,D,H[W],H[W+1]],x:0,y:0,w:V,h:j});this.paintInlineImageXObjectGroup(L,G)}applyTransferMapsToCanvas(T){return this.current.transferMaps!=="none"&&(T.filter=this.current.transferMaps,T.drawImage(T.canvas,0,0),T.filter="none"),T.canvas}applyTransferMapsToBitmap(T){if(this.current.transferMaps==="none")return T.bitmap;const{bitmap:M,width:D,height:H}=T,L=this.cachedCanvases.getCanvas("inlineImage",D,H),V=L.context;return V.filter=this.current.transferMaps,V.drawImage(M,0,0),V.filter="none",L.canvas}paintInlineImageXObject(T){if(!this.contentVisible)return;const M=T.width,D=T.height,H=this.ctx;if(this.save(),!n.isNodeJS){const{filter:j}=H;j!=="none"&&j!==""&&(H.filter="none")}H.scale(1/M,-1/D);let L;if(T.bitmap)L=this.applyTransferMapsToBitmap(T);else if(typeof HTMLElement=="function"&&T instanceof HTMLElement||!T.data)L=T;else{const j=this.cachedCanvases.getCanvas("inlineImage",M,D).context;dt(j,T),L=this.applyTransferMapsToCanvas(j)}const V=this._scaleImage(L,(0,a.getCurrentTransformInverse)(H));H.imageSmoothingEnabled=oe((0,a.getCurrentTransform)(H),T.interpolate),tt(H,V.img,0,0,V.paintWidth,V.paintHeight,0,-D,M,D),this.compose(),this.restore()}paintInlineImageXObjectGroup(T,M){if(!this.contentVisible)return;const D=this.ctx;let H;if(T.bitmap)H=T.bitmap;else{const L=T.width,V=T.height,j=this.cachedCanvases.getCanvas("inlineImage",L,V).context;dt(j,T),H=this.applyTransferMapsToCanvas(j)}for(const L of M)D.save(),D.transform(...L.transform),D.scale(1,-1),tt(D,H,L.x,L.y,L.w,L.h,0,-1,1,1),D.restore();this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(T){}markPointProps(T,M){}beginMarkedContent(T){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(T,M){T==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(M)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(T){const M=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(T);const D=this.ctx;this.pendingClip&&(M||(this.pendingClip===Gt?D.clip("evenodd"):D.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),D.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const T=(0,a.getCurrentTransform)(this.ctx);if(T[1]===0&&T[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(T[0]),Math.abs(T[3]));else{const M=Math.abs(T[0]*T[3]-T[2]*T[1]),D=Math.hypot(T[0],T[2]),H=Math.hypot(T[1],T[3]);this._cachedGetSinglePixelWidth=Math.max(D,H)/M}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:T}=this.current,{a:M,b:D,c:H,d:L}=this.ctx.getTransform();let V,j;if(D===0&&H===0){const G=Math.abs(M),W=Math.abs(L);if(G===W)if(T===0)V=j=1/G;else{const U=G*T;V=j=U<1?1/U:1}else if(T===0)V=1/G,j=1/W;else{const U=G*T,O=W*T;V=U<1?1/U:1,j=O<1?1/O:1}}else{const G=Math.abs(M*L-D*H),W=Math.hypot(M,D),U=Math.hypot(H,L);if(T===0)V=U/G,j=W/G;else{const O=T*G;V=U>O?U/O:1,j=W>O?W/O:1}}this._cachedScaleForStroking[0]=V,this._cachedScaleForStroking[1]=j}return this._cachedScaleForStroking}rescaleAndStroke(T){const{ctx:M}=this,{lineWidth:D}=this.current,[H,L]=this.getScaleForStroking();if(M.lineWidth=D||1,H===1&&L===1){M.stroke();return}const V=M.getLineDash();if(T&&M.save(),M.scale(H,L),V.length>0){const j=Math.max(H,L);M.setLineDash(V.map(G=>G/j)),M.lineDashOffset/=j}M.stroke(),T&&M.restore()}isContentVisible(){for(let T=this.markedContentStack.length-1;T>=0;T--)if(!this.markedContentStack[T].visible)return!1;return!0}};let lt=_e;Wt=new WeakSet,bu=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ie=new WeakSet,_u=function(){if(this.pageColors){const T=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(T!=="none"){const M=this.ctx.filter;this.ctx.filter=T,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=M}}};for(const ut in n.OPS)lt.prototype[ut]!==void 0&&(lt.prototype[n.OPS[ut]]=lt.prototype[ut])},419:(r,t,s)=>{var Lt,Qt,ct,Dt,ee,zt,Jt,to,pe,eo,Ve,io,lt,xu,Wt,qh,ie,Qh,_e,Bo,T,Uo;s.d(t,{DOMCMapReaderFactory:()=>m,DOMCanvasFactory:()=>d,DOMFilterFactory:()=>u,DOMSVGFactory:()=>_,DOMStandardFontDataFactory:()=>S,PDFDateString:()=>B,PageViewport:()=>y,PixelsPerInch:()=>c,RenderingCancelledException:()=>b,StatTimer:()=>p,fetchData:()=>f,getColorValues:()=>tt,getCurrentTransform:()=>st,getCurrentTransformInverse:()=>wt,getFilenameFromUrl:()=>I,getPdfFilenameFromUrl:()=>R,getRGB:()=>rt,getXfaPageViewport:()=>F,isDataScheme:()=>x,isPdfFile:()=>E,isValidFetchUrl:()=>w,noContextMenu:()=>A,setLayerDimensions:()=>dt});var n=s(583),a=s(292);const o="http://www.w3.org/2000/svg",Tt=class{};let c=Tt;ti(c,"CSS",96),ti(c,"PDF",72),ti(c,"PDF_TO_CSS_UNITS",Tt.CSS/Tt.PDF);class u extends n.BaseFilterFactory{constructor({docId:L,ownerDocument:V=globalThis.document}={}){super();N(this,Jt);N(this,pe);N(this,Ve);N(this,lt);N(this,Wt);N(this,ie);N(this,_e);N(this,T);N(this,Lt,void 0);N(this,Qt,void 0);N(this,ct,void 0);N(this,Dt,void 0);N(this,ee,void 0);N(this,zt,0);J(this,ct,L),J(this,Dt,V)}addFilter(L){if(!L)return"none";let V=l(this,Jt,to).get(L);if(V)return V;let j,G,W,U;if(L.length===1){const nt=L[0],pt=new Array(256);for(let yt=0;yt<256;yt++)pt[yt]=nt[yt]/255;U=j=G=W=pt.join(",")}else{const[nt,pt,yt]=L,Nt=new Array(256),Ht=new Array(256),Pt=new Array(256);for(let Bt=0;Bt<256;Bt++)Nt[Bt]=nt[Bt]/255,Ht[Bt]=pt[Bt]/255,Pt[Bt]=yt[Bt]/255;j=Nt.join(","),G=Ht.join(","),W=Pt.join(","),U=`${j}${G}${W}`}if(V=l(this,Jt,to).get(U),V)return l(this,Jt,to).set(L,V),V;const O=`g_${l(this,ct)}_transfer_map_${xs(this,zt)._++}`,z=`url(#${O})`;l(this,Jt,to).set(L,z),l(this,Jt,to).set(U,z);const et=Y(this,Wt,qh).call(this,O);return Y(this,_e,Bo).call(this,j,G,W,et),z}addHCMFilter(L,V){var Nt;const j=`${L}-${V}`,G="base";let W=l(this,pe,eo).get(G);if((W==null?void 0:W.key)===j||(W?((Nt=W.filter)==null||Nt.remove(),W.key=j,W.url="none",W.filter=null):(W={key:j,url:"none",filter:null},l(this,pe,eo).set(G,W)),!L||!V))return W.url;const U=Y(this,T,Uo).call(this,L);L=a.Util.makeHexColor(...U);const O=Y(this,T,Uo).call(this,V);if(V=a.Util.makeHexColor(...O),l(this,Ve,io).style.color="",L==="#000000"&&V==="#ffffff"||L===V)return W.url;const z=new Array(256);for(let Ht=0;Ht<=255;Ht++){const Pt=Ht/255;z[Ht]=Pt<=.03928?Pt/12.92:((Pt+.055)/1.055)**2.4}const et=z.join(","),nt=`g_${l(this,ct)}_hcm_filter`,pt=W.filter=Y(this,Wt,qh).call(this,nt);Y(this,_e,Bo).call(this,et,et,et,pt),Y(this,lt,xu).call(this,pt);const yt=(Ht,Pt)=>{const Bt=U[Ht]/255,Z=O[Ht]/255,at=new Array(Pt+1);for(let _t=0;_t<=Pt;_t++)at[_t]=Bt+_t/Pt*(Z-Bt);return at.join(",")};return Y(this,_e,Bo).call(this,yt(0,5),yt(1,5),yt(2,5),pt),W.url=`url(#${nt})`,W.url}addHighlightHCMFilter(L,V,j,G,W){var Z;const U=`${V}-${j}-${G}-${W}`;let O=l(this,pe,eo).get(L);if((O==null?void 0:O.key)===U||(O?((Z=O.filter)==null||Z.remove(),O.key=U,O.url="none",O.filter=null):(O={key:U,url:"none",filter:null},l(this,pe,eo).set(L,O)),!V||!j))return O.url;const[z,et]=[V,j].map(Y(this,T,Uo).bind(this));let nt=Math.round(.2126*z[0]+.7152*z[1]+.0722*z[2]),pt=Math.round(.2126*et[0]+.7152*et[1]+.0722*et[2]),[yt,Nt]=[G,W].map(Y(this,T,Uo).bind(this));pt<nt&&([nt,pt,yt,Nt]=[pt,nt,Nt,yt]),l(this,Ve,io).style.color="";const Ht=(at,_t,vt)=>{const jt=new Array(256),bt=(pt-nt)/vt,q=at/255,ot=(_t-at)/(255*vt);let ft=0;for(let Et=0;Et<=vt;Et++){const Kt=Math.round(nt+Et*bt),te=q+Et*ot;for(let me=ft;me<=Kt;me++)jt[me]=te;ft=Kt+1}for(let Et=ft;Et<256;Et++)jt[Et]=jt[ft-1];return jt.join(",")},Pt=`g_${l(this,ct)}_hcm_${L}_filter`,Bt=O.filter=Y(this,Wt,qh).call(this,Pt);return Y(this,lt,xu).call(this,Bt),Y(this,_e,Bo).call(this,Ht(yt[0],Nt[0],5),Ht(yt[1],Nt[1],5),Ht(yt[2],Nt[2],5),Bt),O.url=`url(#${Pt})`,O.url}destroy(L=!1){L&&l(this,pe,eo).size!==0||(l(this,Qt)&&(l(this,Qt).parentNode.parentNode.remove(),J(this,Qt,null)),l(this,Lt)&&(l(this,Lt).clear(),J(this,Lt,null)),J(this,zt,0))}}Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakSet,to=function(){return l(this,Lt)||J(this,Lt,new Map)},pe=new WeakSet,eo=function(){return l(this,ee)||J(this,ee,new Map)},Ve=new WeakSet,io=function(){if(!l(this,Qt)){const L=l(this,Dt).createElement("div"),{style:V}=L;V.visibility="hidden",V.contain="strict",V.width=V.height=0,V.position="absolute",V.top=V.left=0,V.zIndex=-1;const j=l(this,Dt).createElementNS(o,"svg");j.setAttribute("width",0),j.setAttribute("height",0),J(this,Qt,l(this,Dt).createElementNS(o,"defs")),L.append(j),j.append(l(this,Qt)),l(this,Dt).body.append(L)}return l(this,Qt)},lt=new WeakSet,xu=function(L){const V=l(this,Dt).createElementNS(o,"feColorMatrix");V.setAttribute("type","matrix"),V.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),L.append(V)},Wt=new WeakSet,qh=function(L){const V=l(this,Dt).createElementNS(o,"filter");return V.setAttribute("color-interpolation-filters","sRGB"),V.setAttribute("id",L),l(this,Ve,io).append(V),V},ie=new WeakSet,Qh=function(L,V,j){const G=l(this,Dt).createElementNS(o,V);G.setAttribute("type","discrete"),G.setAttribute("tableValues",j),L.append(G)},_e=new WeakSet,Bo=function(L,V,j,G){const W=l(this,Dt).createElementNS(o,"feComponentTransfer");G.append(W),Y(this,ie,Qh).call(this,W,"feFuncR",L),Y(this,ie,Qh).call(this,W,"feFuncG",V),Y(this,ie,Qh).call(this,W,"feFuncB",j)},T=new WeakSet,Uo=function(L){return l(this,Ve,io).style.color=L,rt(getComputedStyle(l(this,Ve,io)).getPropertyValue("color"))};class d extends n.BaseCanvasFactory{constructor({ownerDocument:H=globalThis.document}={}){super(),this._document=H}_createCanvas(H,L){const V=this._document.createElement("canvas");return V.width=H,V.height=L,V}}async function f(D,H="text"){if(w(D,document.baseURI)){const L=await fetch(D);if(!L.ok)throw new Error(L.statusText);switch(H){case"arraybuffer":return L.arrayBuffer();case"blob":return L.blob();case"json":return L.json()}return L.text()}return new Promise((L,V)=>{const j=new XMLHttpRequest;j.open("GET",D,!0),j.responseType=H,j.onreadystatechange=()=>{if(j.readyState===XMLHttpRequest.DONE){if(j.status===200||j.status===0){switch(H){case"arraybuffer":case"blob":case"json":L(j.response);return}L(j.responseText);return}V(new Error(j.statusText))}},j.send(null)})}class m extends n.BaseCMapReaderFactory{_fetchData(H,L){return f(H,this.isCompressed?"arraybuffer":"text").then(V=>({cMapData:V instanceof ArrayBuffer?new Uint8Array(V):(0,a.stringToBytes)(V),compressionType:L}))}}class S extends n.BaseStandardFontDataFactory{_fetchData(H){return f(H,"arraybuffer").then(L=>new Uint8Array(L))}}class _ extends n.BaseSVGFactory{_createSVG(H){return document.createElementNS(o,H)}}class y{constructor({viewBox:H,scale:L,rotation:V,offsetX:j=0,offsetY:G=0,dontFlip:W=!1}){this.viewBox=H,this.scale=L,this.rotation=V,this.offsetX=j,this.offsetY=G;const U=(H[2]+H[0])/2,O=(H[3]+H[1])/2;let z,et,nt,pt;switch(V%=360,V<0&&(V+=360),V){case 180:z=-1,et=0,nt=0,pt=1;break;case 90:z=0,et=1,nt=1,pt=0;break;case 270:z=0,et=-1,nt=-1,pt=0;break;case 0:z=1,et=0,nt=0,pt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}W&&(nt=-nt,pt=-pt);let yt,Nt,Ht,Pt;z===0?(yt=Math.abs(O-H[1])*L+j,Nt=Math.abs(U-H[0])*L+G,Ht=(H[3]-H[1])*L,Pt=(H[2]-H[0])*L):(yt=Math.abs(U-H[0])*L+j,Nt=Math.abs(O-H[1])*L+G,Ht=(H[2]-H[0])*L,Pt=(H[3]-H[1])*L),this.transform=[z*L,et*L,nt*L,pt*L,yt-z*L*U-nt*L*O,Nt-et*L*U-pt*L*O],this.width=Ht,this.height=Pt}get rawDims(){const{viewBox:H}=this;return(0,a.shadow)(this,"rawDims",{pageWidth:H[2]-H[0],pageHeight:H[3]-H[1],pageX:H[0],pageY:H[1]})}clone({scale:H=this.scale,rotation:L=this.rotation,offsetX:V=this.offsetX,offsetY:j=this.offsetY,dontFlip:G=!1}={}){return new y({viewBox:this.viewBox.slice(),scale:H,rotation:L,offsetX:V,offsetY:j,dontFlip:G})}convertToViewportPoint(H,L){return a.Util.applyTransform([H,L],this.transform)}convertToViewportRectangle(H){const L=a.Util.applyTransform([H[0],H[1]],this.transform),V=a.Util.applyTransform([H[2],H[3]],this.transform);return[L[0],L[1],V[0],V[1]]}convertToPdfPoint(H,L){return a.Util.applyInverseTransform([H,L],this.transform)}}class b extends a.BaseException{constructor(H,L=0){super(H,"RenderingCancelledException"),this.extraDelay=L}}function x(D){const H=D.length;let L=0;for(;L<H&&D[L].trim()==="";)L++;return D.substring(L,L+5).toLowerCase()==="data:"}function E(D){return typeof D=="string"&&/\.pdf$/i.test(D)}function I(D,H=!1){return H||([D]=D.split(/[#?]/,1)),D.substring(D.lastIndexOf("/")+1)}function R(D,H="document.pdf"){if(typeof D!="string")return H;if(x(D))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),H;const L=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,V=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,j=L.exec(D);let G=V.exec(j[1])||V.exec(j[2])||V.exec(j[3]);if(G&&(G=G[0],G.includes("%")))try{G=V.exec(decodeURIComponent(G))[0]}catch{}return G||H}class p{constructor(){ti(this,"started",Object.create(null));ti(this,"times",[])}time(H){H in this.started&&(0,a.warn)(`Timer is already running for ${H}`),this.started[H]=Date.now()}timeEnd(H){H in this.started||(0,a.warn)(`Timer has not been started for ${H}`),this.times.push({name:H,start:this.started[H],end:Date.now()}),delete this.started[H]}toString(){const H=[];let L=0;for(const{name:V}of this.times)L=Math.max(V.length,L);for(const{name:V,start:j,end:G}of this.times)H.push(`${V.padEnd(L)} ${G-j}ms
`);return H.join("")}}function w(D,H){try{const{protocol:L}=H?new URL(D,H):new URL(D);return L==="http:"||L==="https:"}catch{return!1}}function A(D){D.preventDefault()}let C;class B{static toDateObject(H){if(!H||typeof H!="string")return null;C||(C=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const L=C.exec(H);if(!L)return null;const V=parseInt(L[1],10);let j=parseInt(L[2],10);j=j>=1&&j<=12?j-1:0;let G=parseInt(L[3],10);G=G>=1&&G<=31?G:1;let W=parseInt(L[4],10);W=W>=0&&W<=23?W:0;let U=parseInt(L[5],10);U=U>=0&&U<=59?U:0;let O=parseInt(L[6],10);O=O>=0&&O<=59?O:0;const z=L[7]||"Z";let et=parseInt(L[8],10);et=et>=0&&et<=23?et:0;let nt=parseInt(L[9],10)||0;return nt=nt>=0&&nt<=59?nt:0,z==="-"?(W+=et,U+=nt):z==="+"&&(W-=et,U-=nt),new Date(Date.UTC(V,j,G,W,U,O))}}function F(D,{scale:H=1,rotation:L=0}){const{width:V,height:j}=D.attributes.style,G=[0,0,parseInt(V),parseInt(j)];return new y({viewBox:G,scale:H,rotation:L})}function rt(D){if(D.startsWith("#")){const H=parseInt(D.slice(1),16);return[(H&16711680)>>16,(H&65280)>>8,H&255]}return D.startsWith("rgb(")?D.slice(4,-1).split(",").map(H=>parseInt(H)):D.startsWith("rgba(")?D.slice(5,-1).split(",").map(H=>parseInt(H)).slice(0,3):((0,a.warn)(`Not a valid color format: "${D}"`),[0,0,0])}function tt(D){const H=document.createElement("span");H.style.visibility="hidden",document.body.append(H);for(const L of D.keys()){H.style.color=L;const V=window.getComputedStyle(H).color;D.set(L,rt(V))}H.remove()}function st(D){const{a:H,b:L,c:V,d:j,e:G,f:W}=D.getTransform();return[H,L,V,j,G,W]}function wt(D){const{a:H,b:L,c:V,d:j,e:G,f:W}=D.getTransform().invertSelf();return[H,L,V,j,G,W]}function dt(D,H,L=!1,V=!0){if(H instanceof y){const{pageWidth:j,pageHeight:G}=H.rawDims,{style:W}=D,U=a.FeatureTest.isCSSRoundSupported,O=`var(--scale-factor) * ${j}px`,z=`var(--scale-factor) * ${G}px`,et=U?`round(${O}, 1px)`:`calc(${O})`,nt=U?`round(${z}, 1px)`:`calc(${z})`;!L||H.rotation%180===0?(W.width=et,W.height=nt):(W.width=nt,W.height=et)}V&&D.setAttribute("data-main-rotation",H.rotation)}},47:(r,t,s)=>{var c,u,d,f,m,wu,_,Au,b,k0;s.d(t,{DrawLayer:()=>o});var n=s(419),a=s(292);const E=class{constructor({pageIndex:R}){N(this,_);N(this,b);N(this,c,null);N(this,u,0);N(this,d,new Map);N(this,f,new Map);this.pageIndex=R}setParent(R){if(!l(this,c)){J(this,c,R);return}if(l(this,c)!==R){if(l(this,d).size>0)for(const p of l(this,d).values())p.remove(),R.append(p);J(this,c,R)}}static get _svgFactory(){return(0,a.shadow)(this,"_svgFactory",new n.DOMSVGFactory)}highlight(R,p,w,A=!1){const C=xs(this,u)._++,B=Y(this,_,Au).call(this,R.box);B.classList.add("highlight"),R.free&&B.classList.add("free");const F=E._svgFactory.createElement("defs");B.append(F);const rt=E._svgFactory.createElement("path");F.append(rt);const tt=`path_p${this.pageIndex}_${C}`;rt.setAttribute("id",tt),rt.setAttribute("d",R.toSVGPath()),A&&l(this,f).set(C,rt);const st=Y(this,b,k0).call(this,F,tt),wt=E._svgFactory.createElement("use");return B.append(wt),B.setAttribute("fill",p),B.setAttribute("fill-opacity",w),wt.setAttribute("href",`#${tt}`),l(this,d).set(C,B),{id:C,clipPathId:`url(#${st})`}}highlightOutline(R){const p=xs(this,u)._++,w=Y(this,_,Au).call(this,R.box);w.classList.add("highlightOutline");const A=E._svgFactory.createElement("defs");w.append(A);const C=E._svgFactory.createElement("path");A.append(C);const B=`path_p${this.pageIndex}_${p}`;C.setAttribute("id",B),C.setAttribute("d",R.toSVGPath()),C.setAttribute("vector-effect","non-scaling-stroke");let F;if(R.free){w.classList.add("free");const st=E._svgFactory.createElement("mask");A.append(st),F=`mask_p${this.pageIndex}_${p}`,st.setAttribute("id",F),st.setAttribute("maskUnits","objectBoundingBox");const wt=E._svgFactory.createElement("rect");st.append(wt),wt.setAttribute("width","1"),wt.setAttribute("height","1"),wt.setAttribute("fill","white");const dt=E._svgFactory.createElement("use");st.append(dt),dt.setAttribute("href",`#${B}`),dt.setAttribute("stroke","none"),dt.setAttribute("fill","black"),dt.setAttribute("fill-rule","nonzero"),dt.classList.add("mask")}const rt=E._svgFactory.createElement("use");w.append(rt),rt.setAttribute("href",`#${B}`),F&&rt.setAttribute("mask",`url(#${F})`);const tt=rt.cloneNode();return w.append(tt),rt.classList.add("mainOutline"),tt.classList.add("secondaryOutline"),l(this,d).set(p,w),p}finalizeLine(R,p){const w=l(this,f).get(R);l(this,f).delete(R),this.updateBox(R,p.box),w.setAttribute("d",p.toSVGPath())}updateLine(R,p){l(this,d).get(R).firstChild.firstChild.setAttribute("d",p.toSVGPath())}removeFreeHighlight(R){this.remove(R),l(this,f).delete(R)}updatePath(R,p){l(this,f).get(R).setAttribute("d",p.toSVGPath())}updateBox(R,p){var w;Y(w=E,m,wu).call(w,l(this,d).get(R),p)}show(R,p){l(this,d).get(R).classList.toggle("hidden",!p)}rotate(R,p){l(this,d).get(R).setAttribute("data-main-rotation",p)}changeColor(R,p){l(this,d).get(R).setAttribute("fill",p)}changeOpacity(R,p){l(this,d).get(R).setAttribute("fill-opacity",p)}addClass(R,p){l(this,d).get(R).classList.add(p)}removeClass(R,p){l(this,d).get(R).classList.remove(p)}remove(R){l(this,c)!==null&&(l(this,d).get(R).remove(),l(this,d).delete(R))}destroy(){J(this,c,null);for(const R of l(this,d).values())R.remove();l(this,d).clear()}};let o=E;c=new WeakMap,u=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakSet,wu=function(R,{x:p=0,y:w=0,width:A=1,height:C=1}={}){const{style:B}=R;B.top=`${100*w}%`,B.left=`${100*p}%`,B.width=`${100*A}%`,B.height=`${100*C}%`},_=new WeakSet,Au=function(R){var w;const p=E._svgFactory.create(1,1,!0);return l(this,c).append(p),p.setAttribute("aria-hidden",!0),Y(w=E,m,wu).call(w,p,R),p},b=new WeakSet,k0=function(R,p){const w=E._svgFactory.createElement("clipPath");R.append(w);const A=`clip_${p}`;w.setAttribute("id",A),w.setAttribute("clipPathUnits","objectBoundingBox");const C=E._svgFactory.createElement("use");return w.append(C),C.setAttribute("href",`#${p}`),C.classList.add("clip"),A},N(o,m)},731:(r,t,s)=>{var E,I,R,p,w,A,C,B,F,rt,tt,T0,wt,P0,Tt,M0,Qt,Zh,Dt,Jh,zt,tc,oe,R0,Ae,Su,Gt,F0,Wt,ve,ie,xe,_e,ut,T,M,D,H,L,V,j,G,W,U,O,z,et,nt,Eu,yt,Cu,Ht,I0,Bt,L0,at,D0,vt,ku,bt,Go,ot,ro,Et,N0,te,ec,Pe,jo,je,O0,ze,z0,oi,H0,bi,B0,K,ht,xt,St,It,Ot,ye,le,$t,ne,ue,he,Le,we,He,Ue,U0,ei,G0,zi,j0,$,V0,Zt,Tu,de,W0,Se,Pu,ci,$0,Hi,K0,wr,X0,cs,Y0,ds,q0,jr,xa,la,Mu,Vn,ic,Wn,rc,$n,no,di,Ru,Kn,nc,Ga,Q0,Wi,Fu,ja,Z0,Va,J0,Dr,Iu,Ns,sc,kr,Vo,lr,vr,yr,Nr,Vr,Pn,Wr,hr,Qi,br,$r,Tr,Wo,Xn,$o,Yn,ac,Ar,Lu,qn,t1,ca,e1,us,Du,fs,oc,da,i1,gs,Rn,pn,hn,Qr,mn,vn,cr,Fn,In,Ln,er,Oe,yn,fa,r1,ps,Nu,Sr,Ou,ms,zu,Pr,lc;s.d(t,{AnnotationEditorLayer:()=>x});var n=s(292),a=s(310),o=s(830),c=s(976);const u=/\r\n?|\n/g,Ft=class extends a.AnnotationEditor{constructor(k){super({...k,name:"freeTextEditor"});N(this,tt);N(this,wt);N(this,Tt);N(this,Qt);N(this,zt);N(this,oe);N(this,Gt);N(this,E,this.editorDivBlur.bind(this));N(this,I,this.editorDivFocus.bind(this));N(this,R,this.editorDivInput.bind(this));N(this,p,this.editorDivKeydown.bind(this));N(this,w,this.editorDivPaste.bind(this));N(this,A,void 0);N(this,C,"");N(this,B,`${this.id}-editor`);N(this,F,void 0);N(this,rt,null);J(this,A,k.color||Ft._defaultColor||a.AnnotationEditor._defaultLineColor),J(this,F,k.fontSize||Ft._defaultFontSize)}static get _keyboardManager(){const k=Ft.prototype,X=Rt=>Rt.isEmpty(),gt=o.AnnotationEditorUIManager.TRANSLATE_SMALL,mt=o.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new o.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],k.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],k.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],k._translateEmpty,{args:[-gt,0],checker:X}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],k._translateEmpty,{args:[-mt,0],checker:X}],[["ArrowRight","mac+ArrowRight"],k._translateEmpty,{args:[gt,0],checker:X}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],k._translateEmpty,{args:[mt,0],checker:X}],[["ArrowUp","mac+ArrowUp"],k._translateEmpty,{args:[0,-gt],checker:X}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],k._translateEmpty,{args:[0,-mt],checker:X}],[["ArrowDown","mac+ArrowDown"],k._translateEmpty,{args:[0,gt],checker:X}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],k._translateEmpty,{args:[0,mt],checker:X}]]))}static initialize(k,X){a.AnnotationEditor.initialize(k,X,{strings:["pdfjs-free-text-default-content"]});const gt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(gt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(k,X){switch(k){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Ft._defaultFontSize=X;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Ft._defaultColor=X;break}}updateParams(k,X){switch(k){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,tt,T0).call(this,X);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,wt,P0).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,Ft._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,Ft._defaultColor||a.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,l(this,F)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,l(this,A)]]}_translateEmpty(k,X){this._uiManager.translateSelectedEditors(k,X,!0)}getInitialTranslation(){const k=this.parentScale;return[-Ft._internalPadding*k,-(Ft._internalPadding+l(this,F))*k]}rebuild(){!this.parent||(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",l(this,p)),this.editorDiv.addEventListener("focus",l(this,I)),this.editorDiv.addEventListener("blur",l(this,E)),this.editorDiv.addEventListener("input",l(this,R)),this.editorDiv.addEventListener("paste",l(this,w)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,B)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",l(this,p)),this.editorDiv.removeEventListener("focus",l(this,I)),this.editorDiv.removeEventListener("blur",l(this,E)),this.editorDiv.removeEventListener("input",l(this,R)),this.editorDiv.removeEventListener("paste",l(this,w)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(k){!this._focusEventsAllowed||(super.focusin(k),k.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var k;this.width||(this.enableEditMode(),this.editorDiv.focus(),(k=this._initialOptions)!=null&&k.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const k=l(this,C),X=J(this,C,Y(this,Tt,M0).call(this).trimEnd());if(k===X)return;const gt=mt=>{if(J(this,C,mt),!mt){this.remove();return}Y(this,zt,tc).call(this),this._uiManager.rebuild(this),Y(this,Qt,Zh).call(this)};this.addCommands({cmd:()=>{gt(X)},undo:()=>{gt(k)},mustExec:!1}),Y(this,Qt,Zh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(k){this.enterInEditMode()}keydown(k){k.target===this.div&&k.key==="Enter"&&(this.enterInEditMode(),k.preventDefault())}editorDivKeydown(k){Ft._keyboardManager.exec(this,k)}editorDivFocus(k){this.isEditing=!0}editorDivBlur(k){this.isEditing=!1}editorDivInput(k){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let k,X;this.width&&(k=this.x,X=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,B)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),a.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(mt=>{var Rt;return(Rt=this.editorDiv)==null?void 0:Rt.setAttribute("default-content",mt)}),this.editorDiv.contentEditable=!0;const{style:gt}=this.editorDiv;if(gt.fontSize=`calc(${l(this,F)}px * var(--scale-factor))`,gt.color=l(this,A),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,o.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[mt,Rt]=this.parentDimensions;if(this.annotationElementId){const{position:qt}=l(this,rt);let[re,Xt]=this.getInitialTranslation();[re,Xt]=this.pageTranslationToScreen(re,Xt);const[be,fe]=this.pageDimensions,[Ye,We]=this.pageTranslation;let ui,pi;switch(this.rotation){case 0:ui=k+(qt[0]-Ye)/be,pi=X+this.height-(qt[1]-We)/fe;break;case 90:ui=k+(qt[0]-Ye)/be,pi=X-(qt[1]-We)/fe,[re,Xt]=[Xt,-re];break;case 180:ui=k-this.width+(qt[0]-Ye)/be,pi=X-(qt[1]-We)/fe,[re,Xt]=[-re,-Xt];break;case 270:ui=k+(qt[0]-Ye-this.height*fe)/be,pi=X+(qt[1]-We-this.width*be)/fe,[re,Xt]=[-Xt,re];break}this.setAt(ui*mt,pi*Rt,re,Xt)}else this.setAt(k*mt,X*Rt,this.width*mt,this.height*Rt);Y(this,zt,tc).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(k){var ui,pi,Qe;const X=k.clipboardData||window.clipboardData,{types:gt}=X;if(gt.length===1&&gt[0]==="text/plain")return;k.preventDefault();const mt=Y(ui=Ft,Ae,Su).call(ui,X.getData("text")||"").replaceAll(u,`
`);if(!mt)return;const Rt=window.getSelection();if(!Rt.rangeCount)return;this.editorDiv.normalize(),Rt.deleteFromDocument();const qt=Rt.getRangeAt(0);if(!mt.includes(`
`)){qt.insertNode(document.createTextNode(mt)),this.editorDiv.normalize(),Rt.collapseToStart();return}const{startContainer:re,startOffset:Xt}=qt,be=[],fe=[];if(re.nodeType===Node.TEXT_NODE){const xi=re.parentElement;if(fe.push(re.nodeValue.slice(Xt).replaceAll(u,"")),xi!==this.editorDiv){let Ki=be;for(const Bi of this.editorDiv.childNodes){if(Bi===xi){Ki=fe;continue}Ki.push(Y(pi=Ft,Dt,Jh).call(pi,Bi))}}be.push(re.nodeValue.slice(0,Xt).replaceAll(u,""))}else if(re===this.editorDiv){let xi=be,Ki=0;for(const Bi of this.editorDiv.childNodes)Ki++===Xt&&(xi=fe),xi.push(Y(Qe=Ft,Dt,Jh).call(Qe,Bi))}J(this,C,`${be.join(`
`)}${mt}${fe.join(`
`)}`),Y(this,zt,tc).call(this);const Ye=new Range;let We=be.reduce((xi,Ki)=>xi+Ki.length,0);for(const{firstChild:xi}of this.editorDiv.childNodes)if(xi.nodeType===Node.TEXT_NODE){const Ki=xi.nodeValue.length;if(We<=Ki){Ye.setStart(xi,We),Ye.setEnd(xi,We);break}We-=Ki}Rt.removeAllRanges(),Rt.addRange(Ye)}get contentDiv(){return this.editorDiv}static deserialize(k,X,gt){var qt;let mt=null;if(k instanceof c.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:re,fontColor:Xt},rect:be,rotation:fe,id:Ye},textContent:We,textPosition:ui,parent:{page:{pageNumber:pi}}}=k;if(!We||We.length===0)return null;mt=k={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(Xt),fontSize:re,value:We.join(`
`),position:ui,pageIndex:pi-1,rect:be.slice(0),rotation:fe,id:Ye,deleted:!1}}const Rt=super.deserialize(k,X,gt);return J(Rt,F,k.fontSize),J(Rt,A,n.Util.makeHexColor(...k.color)),J(Rt,C,Y(qt=Ft,Ae,Su).call(qt,k.value)),Rt.annotationElementId=k.id||null,J(Rt,rt,mt),Rt}serialize(k=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const X=Ft._internalPadding*this.parentScale,gt=this.getRect(X,X),mt=a.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,A)),Rt={annotationType:n.AnnotationEditorType.FREETEXT,color:mt,fontSize:l(this,F),value:Y(this,oe,R0).call(this),pageIndex:this.pageIndex,rect:gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return k?Rt:this.annotationElementId&&!Y(this,Gt,F0).call(this,Rt)?null:(Rt.id=this.annotationElementId,Rt)}renderAnnotationElement(k){const X=super.renderAnnotationElement(k);if(this.deleted)return X;const{style:gt}=X;gt.fontSize=`calc(${l(this,F)}px * var(--scale-factor))`,gt.color=l(this,A),X.replaceChildren();for(const Rt of l(this,C).split(`
`)){const qt=document.createElement("div");qt.append(Rt?document.createTextNode(Rt):document.createElement("br")),X.append(qt)}const mt=Ft._internalPadding*this.parentScale;return k.updateEdited({rect:this.getRect(mt,mt)}),X}resetAnnotationElement(k){super.resetAnnotationElement(k),k.resetEdited()}};let d=Ft;E=new WeakMap,I=new WeakMap,R=new WeakMap,p=new WeakMap,w=new WeakMap,A=new WeakMap,C=new WeakMap,B=new WeakMap,F=new WeakMap,rt=new WeakMap,tt=new WeakSet,T0=function(k){const X=mt=>{this.editorDiv.style.fontSize=`calc(${mt}px * var(--scale-factor))`,this.translate(0,-(mt-l(this,F))*this.parentScale),J(this,F,mt),Y(this,Qt,Zh).call(this)},gt=l(this,F);this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,gt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},wt=new WeakSet,P0=function(k){const X=mt=>{J(this,A,this.editorDiv.style.color=mt)},gt=l(this,A);this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,gt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Tt=new WeakSet,M0=function(){var X;const k=[];this.editorDiv.normalize();for(const gt of this.editorDiv.childNodes)k.push(Y(X=Ft,Dt,Jh).call(X,gt));return k.join(`
`)},Qt=new WeakSet,Zh=function(){const[k,X]=this.parentDimensions;let gt;if(this.isAttachedToDOM)gt=this.div.getBoundingClientRect();else{const{currentLayer:mt,div:Rt}=this,qt=Rt.style.display,re=Rt.classList.contains("hidden");Rt.classList.remove("hidden"),Rt.style.display="hidden",mt.div.append(this.div),gt=Rt.getBoundingClientRect(),Rt.remove(),Rt.style.display=qt,Rt.classList.toggle("hidden",re)}this.rotation%180===this.parentRotation%180?(this.width=gt.width/k,this.height=gt.height/X):(this.width=gt.height/k,this.height=gt.width/X),this.fixAndSetPosition()},Dt=new WeakSet,Jh=function(k){return(k.nodeType===Node.TEXT_NODE?k.nodeValue:k.innerText).replaceAll(u,"")},zt=new WeakSet,tc=function(){if(this.editorDiv.replaceChildren(),!!l(this,C))for(const k of l(this,C).split(`
`)){const X=document.createElement("div");X.append(k?document.createTextNode(k):document.createElement("br")),this.editorDiv.append(X)}},oe=new WeakSet,R0=function(){return l(this,C).replaceAll("\xA0"," ")},Ae=new WeakSet,Su=function(k){return k.replaceAll(" ","\xA0")},Gt=new WeakSet,F0=function(k){const{value:X,fontSize:gt,color:mt,pageIndex:Rt}=l(this,rt);return this._hasBeenMoved||k.value!==X||k.fontSize!==gt||k.color.some((qt,re)=>qt!==mt[re])||k.pageIndex!==Rt},N(d,Dt),N(d,Ae),ti(d,"_freeTextDefaultContent",""),ti(d,"_internalPadding",0),ti(d,"_defaultColor",null),ti(d,"_defaultFontSize",10),ti(d,"_type","freetext"),ti(d,"_editorType",n.AnnotationEditorType.FREETEXT);var f=s(61),m=s(259),S=s(419);const Q=class extends a.AnnotationEditor{constructor(k){super({...k,name:"highlightEditor"});N(this,nt);N(this,yt);N(this,Ht);N(this,Bt);N(this,at);N(this,vt);N(this,bt);N(this,Et);N(this,te);N(this,Pe);N(this,je);N(this,ze);N(this,Wt,null);N(this,ve,0);N(this,ie,void 0);N(this,xe,null);N(this,_e,null);N(this,ut,null);N(this,T,null);N(this,M,0);N(this,D,null);N(this,H,null);N(this,L,null);N(this,V,!1);N(this,j,Y(this,Et,N0).bind(this));N(this,G,null);N(this,W,void 0);N(this,U,null);N(this,O,"");N(this,z,void 0);N(this,et,"");this.color=k.color||Q._defaultColor,J(this,z,k.thickness||Q._defaultThickness),J(this,W,k.opacity||Q._defaultOpacity),J(this,ie,k.boxes||null),J(this,et,k.methodOfCreation||""),J(this,O,k.text||""),this._isDraggable=!1,k.highlightId>-1?(J(this,V,!0),Y(this,yt,Cu).call(this,k),Y(this,bt,Go).call(this)):(J(this,Wt,k.anchorNode),J(this,ve,k.anchorOffset),J(this,T,k.focusNode),J(this,M,k.focusOffset),Y(this,nt,Eu).call(this),Y(this,bt,Go).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const k=Q.prototype;return(0,n.shadow)(this,"_keyboardManager",new o.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],k._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],k._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],k._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],k._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,V)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,z),methodOfCreation:l(this,et)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(k){return{numberOfColors:k.get("color").size}}static initialize(k,X){var gt;a.AnnotationEditor.initialize(k,X),Q._defaultColor||(Q._defaultColor=((gt=X.highlightColors)==null?void 0:gt.values().next().value)||"#fff066")}static updateDefaultParams(k,X){switch(k){case n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:Q._defaultColor=X;break;case n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:Q._defaultThickness=X;break}}translateInPage(k,X){}get toolbarPosition(){return l(this,G)}updateParams(k,X){switch(k){case n.AnnotationEditorParamsType.HIGHLIGHT_COLOR:Y(this,Ht,I0).call(this,X);break;case n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:Y(this,Bt,L0).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,Q._defaultColor],[n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,Q._defaultThickness]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||Q._defaultColor],[n.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,l(this,z)||Q._defaultThickness],[n.AnnotationEditorParamsType.HIGHLIGHT_FREE,l(this,V)]]}async addEditToolbar(){const k=await super.addEditToolbar();return k?(this._uiManager.highlightColors&&(J(this,_e,new m.ColorPicker({editor:this})),k.addColorPicker(l(this,_e))),k):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(Y(this,Pe,jo).call(this))}getBaseTranslation(){return[0,0]}getRect(k,X){return super.getRect(k,X,Y(this,Pe,jo).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){Y(this,vt,ku).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){!this.parent||(super.rebuild(),this.div!==null&&(Y(this,bt,Go).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(k){var gt;let X=!1;this.parent&&!k?Y(this,vt,ku).call(this):k&&(Y(this,bt,Go).call(this,k),X=!this.parent&&((gt=this.div)==null?void 0:gt.classList.contains("selectedEditor"))),super.setParent(k),this.show(this._isVisible),X&&this.select()}rotate(k){var mt,Rt,qt;const{drawLayer:X}=this.parent;let gt;l(this,V)?(k=(k-this.rotation+360)%360,gt=Y(mt=Q,ot,ro).call(mt,l(this,H).box,k)):gt=Y(Rt=Q,ot,ro).call(Rt,this,k),X.rotate(l(this,L),k),X.rotate(l(this,U),k),X.updateBox(l(this,L),gt),X.updateBox(l(this,U),Y(qt=Q,ot,ro).call(qt,l(this,ut).box,k))}render(){if(this.div)return this.div;const k=super.render();l(this,O)&&(k.setAttribute("aria-label",l(this,O)),k.setAttribute("role","mark")),l(this,V)?k.classList.add("free"):this.div.addEventListener("keydown",l(this,j));const X=J(this,D,document.createElement("div"));k.append(X),X.setAttribute("aria-hidden","true"),X.className="internal",X.style.clipPath=l(this,xe);const[gt,mt]=this.parentDimensions;return this.setDims(this.width*gt,this.height*mt),(0,o.bindEvents)(this,l(this,D),["pointerover","pointerleave"]),this.enableEditing(),k}pointerover(){this.parent.drawLayer.addClass(l(this,U),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(l(this,U),"hovered")}_moveCaret(k){switch(this.parent.unselect(this),k){case 0:case 2:Y(this,te,ec).call(this,!0);break;case 1:case 3:Y(this,te,ec).call(this,!1);break}}select(){var k,X;super.select(),l(this,U)&&((k=this.parent)==null||k.drawLayer.removeClass(l(this,U),"hovered"),(X=this.parent)==null||X.drawLayer.addClass(l(this,U),"selected"))}unselect(){var k;super.unselect(),l(this,U)&&((k=this.parent)==null||k.drawLayer.removeClass(l(this,U),"selected"),l(this,V)||Y(this,te,ec).call(this,!1))}get _mustFixPosition(){return!l(this,V)}show(k=this._isVisible){super.show(k),this.parent&&(this.parent.drawLayer.show(l(this,L),k),this.parent.drawLayer.show(l(this,U),k))}static startHighlighting(k,X,{target:gt,x:mt,y:Rt}){const{x:qt,y:re,width:Xt,height:be}=gt.getBoundingClientRect(),fe=pi=>{Y(this,oi,H0).call(this,k,pi)},Ye={capture:!0,passive:!1},We=pi=>{pi.preventDefault(),pi.stopPropagation()},ui=pi=>{gt.removeEventListener("pointermove",fe),window.removeEventListener("blur",ui),window.removeEventListener("pointerup",ui),window.removeEventListener("pointerdown",We,Ye),window.removeEventListener("contextmenu",S.noContextMenu),Y(this,bi,B0).call(this,k,pi)};window.addEventListener("blur",ui),window.addEventListener("pointerup",ui),window.addEventListener("pointerdown",We,Ye),window.addEventListener("contextmenu",S.noContextMenu),gt.addEventListener("pointermove",fe),this._freeHighlight=new f.FreeOutliner({x:mt,y:Rt},[qt,re,Xt,be],k.scale,this._defaultThickness/2,X,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=k.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(k,X,gt){var pi;const mt=super.deserialize(k,X,gt),{rect:[Rt,qt,re,Xt],color:be,quadPoints:fe}=k;mt.color=n.Util.makeHexColor(...be),J(mt,W,k.opacity);const[Ye,We]=mt.pageDimensions;mt.width=(re-Rt)/Ye,mt.height=(Xt-qt)/We;const ui=J(mt,ie,[]);for(let Qe=0;Qe<fe.length;Qe+=8)ui.push({x:(fe[4]-re)/Ye,y:(Xt-(1-fe[Qe+5]))/We,width:(fe[Qe+2]-fe[Qe])/Ye,height:(fe[Qe+5]-fe[Qe+1])/We});return Y(pi=mt,nt,Eu).call(pi),mt}serialize(k=!1){if(this.isEmpty()||k)return null;const X=this.getRect(0,0),gt=a.AnnotationEditor._colorManager.convert(this.color);return{annotationType:n.AnnotationEditorType.HIGHLIGHT,color:gt,opacity:l(this,W),thickness:l(this,z),quadPoints:Y(this,je,O0).call(this),outlines:Y(this,ze,z0).call(this,X),pageIndex:this.pageIndex,rect:X,rotation:Y(this,Pe,jo).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};let _=Q;Wt=new WeakMap,ve=new WeakMap,ie=new WeakMap,xe=new WeakMap,_e=new WeakMap,ut=new WeakMap,T=new WeakMap,M=new WeakMap,D=new WeakMap,H=new WeakMap,L=new WeakMap,V=new WeakMap,j=new WeakMap,G=new WeakMap,W=new WeakMap,U=new WeakMap,O=new WeakMap,z=new WeakMap,et=new WeakMap,nt=new WeakSet,Eu=function(){const k=new f.Outliner(l(this,ie),.001);J(this,H,k.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=l(this,H).box;const X=new f.Outliner(l(this,ie),.0025,.001,this._uiManager.direction==="ltr");J(this,ut,X.getOutlines());const{lastPoint:gt}=l(this,ut).box;J(this,G,[(gt[0]-this.x)/this.width,(gt[1]-this.y)/this.height])},yt=new WeakSet,Cu=function({highlightOutlines:k,highlightId:X,clipPathId:gt}){var fe,Ye;J(this,H,k);const mt=1.5;if(J(this,ut,k.getNewOutline(l(this,z)/2+mt,.0025)),X>=0)J(this,L,X),J(this,xe,gt),this.parent.drawLayer.finalizeLine(X,k),J(this,U,this.parent.drawLayer.highlightOutline(l(this,ut)));else if(this.parent){const We=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(l(this,L),k),this.parent.drawLayer.updateBox(l(this,L),Y(fe=Q,ot,ro).call(fe,l(this,H).box,(We-this.rotation+360)%360)),this.parent.drawLayer.updateLine(l(this,U),l(this,ut)),this.parent.drawLayer.updateBox(l(this,U),Y(Ye=Q,ot,ro).call(Ye,l(this,ut).box,We))}const{x:Rt,y:qt,width:re,height:Xt}=k.box;switch(this.rotation){case 0:this.x=Rt,this.y=qt,this.width=re,this.height=Xt;break;case 90:{const[We,ui]=this.parentDimensions;this.x=qt,this.y=1-Rt,this.width=re*ui/We,this.height=Xt*We/ui;break}case 180:this.x=1-Rt,this.y=1-qt,this.width=re,this.height=Xt;break;case 270:{const[We,ui]=this.parentDimensions;this.x=1-qt,this.y=Rt,this.width=re*ui/We,this.height=Xt*We/ui;break}}const{lastPoint:be}=l(this,ut).box;J(this,G,[(be[0]-Rt)/re,(be[1]-qt)/Xt])},Ht=new WeakSet,I0=function(k){const X=mt=>{var Rt,qt;this.color=mt,(Rt=this.parent)==null||Rt.drawLayer.changeColor(l(this,L),mt),(qt=l(this,_e))==null||qt.updateColor(mt)},gt=this.color;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,gt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(k)},!0)},Bt=new WeakSet,L0=function(k){const X=l(this,z),gt=mt=>{J(this,z,mt),Y(this,at,D0).call(this,mt)};this.addCommands({cmd:gt.bind(this,k),undo:gt.bind(this,X),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:k},!0)},at=new WeakSet,D0=function(k){if(!l(this,V))return;Y(this,yt,Cu).call(this,{highlightOutlines:l(this,H).getNewOutline(k/2)}),this.fixAndSetPosition();const[X,gt]=this.parentDimensions;this.setDims(this.width*X,this.height*gt)},vt=new WeakSet,ku=function(){l(this,L)===null||!this.parent||(this.parent.drawLayer.remove(l(this,L)),J(this,L,null),this.parent.drawLayer.remove(l(this,U)),J(this,U,null))},bt=new WeakSet,Go=function(k=this.parent){l(this,L)===null&&({id:xs(this,L)._,clipPathId:xs(this,xe)._}=k.drawLayer.highlight(l(this,H),this.color,l(this,W)),J(this,U,k.drawLayer.highlightOutline(l(this,ut))),l(this,D)&&(l(this,D).style.clipPath=l(this,xe)))},ot=new WeakSet,ro=function({x:k,y:X,width:gt,height:mt},Rt){switch(Rt){case 90:return{x:1-X-mt,y:k,width:mt,height:gt};case 180:return{x:1-k-gt,y:1-X-mt,width:gt,height:mt};case 270:return{x:X,y:1-k-gt,width:mt,height:gt}}return{x:k,y:X,width:gt,height:mt}},Et=new WeakSet,N0=function(k){Q._keyboardManager.exec(this,k)},te=new WeakSet,ec=function(k){if(!l(this,Wt))return;const X=window.getSelection();k?X.setPosition(l(this,Wt),l(this,ve)):X.setPosition(l(this,T),l(this,M))},Pe=new WeakSet,jo=function(){return l(this,V)?this.rotation:0},je=new WeakSet,O0=function(){if(l(this,V))return null;const[k,X]=this.pageDimensions,gt=l(this,ie),mt=new Array(gt.length*8);let Rt=0;for(const{x:qt,y:re,width:Xt,height:be}of gt){const fe=qt*k,Ye=(1-re-be)*X;mt[Rt]=mt[Rt+4]=fe,mt[Rt+1]=mt[Rt+3]=Ye,mt[Rt+2]=mt[Rt+6]=fe+Xt*k,mt[Rt+5]=mt[Rt+7]=Ye+be*X,Rt+=8}return mt},ze=new WeakSet,z0=function(k){return l(this,H).serialize(k,Y(this,Pe,jo).call(this))},oi=new WeakSet,H0=function(k,X){this._freeHighlight.add(X)&&k.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},bi=new WeakSet,B0=function(k,X){this._freeHighlight.isEmpty()?k.drawLayer.removeFreeHighlight(this._freeHighlightId):k.createAndAddNewEditor(X,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},N(_,ot),N(_,oi),N(_,bi),ti(_,"_defaultColor",null),ti(_,"_defaultOpacity",1),ti(_,"_defaultThickness",12),ti(_,"_l10nPromise"),ti(_,"_type","highlight"),ti(_,"_editorType",n.AnnotationEditorType.HIGHLIGHT),ti(_,"_freeHighlightId",-1),ti(_,"_freeHighlight",null),ti(_,"_freeHighlightClipId","");const sr=class extends a.AnnotationEditor{constructor(k){super({...k,name:"inkEditor"});N(this,Ue);N(this,ei);N(this,zi);N(this,$);N(this,Zt);N(this,de);N(this,Se);N(this,ci);N(this,Hi);N(this,wr);N(this,cs);N(this,ds);N(this,jr);N(this,la);N(this,Vn);N(this,Wn);N(this,$n);N(this,di);N(this,Kn);N(this,Va);N(this,Dr);N(this,Ns);N(this,kr);N(this,K,0);N(this,ht,0);N(this,xt,this.canvasPointermove.bind(this));N(this,St,this.canvasPointerleave.bind(this));N(this,It,this.canvasPointerup.bind(this));N(this,Ot,this.canvasPointerdown.bind(this));N(this,ye,null);N(this,le,new Path2D);N(this,$t,!1);N(this,ne,!1);N(this,ue,!1);N(this,he,null);N(this,Le,0);N(this,we,0);N(this,He,null);this.color=k.color||null,this.thickness=k.thickness||null,this.opacity=k.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(k,X){a.AnnotationEditor.initialize(k,X)}static updateDefaultParams(k,X){switch(k){case n.AnnotationEditorParamsType.INK_THICKNESS:sr._defaultThickness=X;break;case n.AnnotationEditorParamsType.INK_COLOR:sr._defaultColor=X;break;case n.AnnotationEditorParamsType.INK_OPACITY:sr._defaultOpacity=X/100;break}}updateParams(k,X){switch(k){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,Ue,U0).call(this,X);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,ei,G0).call(this,X);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,zi,j0).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,sr._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,sr._defaultColor||a.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(sr._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||sr._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||sr._defaultColor||a.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??sr._defaultOpacity))]]}rebuild(){!this.parent||(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,Vn,ic).call(this),Y(this,Wn,rc).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,$n,no).call(this)),Y(this,kr,Vo).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,l(this,ye)&&(clearTimeout(l(this,ye)),J(this,ye,null)),l(this,he).disconnect(),J(this,he,null),super.remove())}setParent(k){!this.parent&&k?this._uiManager.removeShouldRescale(this):this.parent&&k===null&&this._uiManager.addShouldRescale(this),super.setParent(k)}onScaleChanging(){const[k,X]=this.parentDimensions,gt=this.width*k,mt=this.height*X;this.setDimensions(gt,mt)}enableEditMode(){l(this,$t)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",l(this,Ot)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",l(this,Ot)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){l(this,$t)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),J(this,$t,!0),this.div.classList.add("disabled"),Y(this,kr,Vo).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(k){!this._focusEventsAllowed||(super.focusin(k),this.enableEditMode())}canvasPointerdown(k){k.button!==0||!this.isInEditMode()||l(this,$t)||(this.setInForeground(),k.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),Y(this,de,W0).call(this,k.offsetX,k.offsetY))}canvasPointermove(k){k.preventDefault(),Y(this,Se,Pu).call(this,k.offsetX,k.offsetY)}canvasPointerup(k){k.preventDefault(),Y(this,la,Mu).call(this,k)}canvasPointerleave(k){Y(this,la,Mu).call(this,k)}get isResizable(){return!this.isEmpty()&&l(this,$t)}render(){if(this.div)return this.div;let k,X;this.width&&(k=this.x,X=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[gt,mt,Rt,qt]=Y(this,$,V0).call(this);if(this.setAt(gt,mt,0,0),this.setDims(Rt,qt),Y(this,Vn,ic).call(this),this.width){const[re,Xt]=this.parentDimensions;this.setAspectRatio(this.width*re,this.height*Xt),this.setAt(k*re,X*Xt,this.width*re,this.height*Xt),J(this,ue,!0),Y(this,$n,no).call(this),this.setDims(this.width*re,this.height*Xt),Y(this,jr,xa).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,Wn,rc).call(this),this.div}setDimensions(k,X){const gt=Math.round(k),mt=Math.round(X);if(l(this,Le)===gt&&l(this,we)===mt)return;J(this,Le,gt),J(this,we,mt),this.canvas.style.visibility="hidden";const[Rt,qt]=this.parentDimensions;this.width=k/Rt,this.height=X/qt,this.fixAndSetPosition(),l(this,$t)&&Y(this,di,Ru).call(this,k,X),Y(this,$n,no).call(this),Y(this,jr,xa).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(k,X,gt){var Qe,xi,Ki;if(k instanceof c.InkAnnotationElement)return null;const mt=super.deserialize(k,X,gt);mt.thickness=k.thickness,mt.color=n.Util.makeHexColor(...k.color),mt.opacity=k.opacity;const[Rt,qt]=mt.pageDimensions,re=mt.width*Rt,Xt=mt.height*qt,be=mt.parentScale,fe=k.thickness/2;J(mt,$t,!0),J(mt,Le,Math.round(re)),J(mt,we,Math.round(Xt));const{paths:Ye,rect:We,rotation:ui}=k;for(let{bezier:Bi}of Ye){Bi=Y(Qe=sr,ja,Z0).call(Qe,Bi,We,ui);const Kr=[];mt.paths.push(Kr);let vs=be*(Bi[0]-fe),dn=be*(Bi[1]-fe);for(let Ei=2,ir=Bi.length;Ei<ir;Ei+=6){const zs=be*(Bi[Ei]-fe),Qn=be*(Bi[Ei+1]-fe),Zn=be*(Bi[Ei+2]-fe),Ka=be*(Bi[Ei+3]-fe),rr=be*(Bi[Ei+4]-fe),Xa=be*(Bi[Ei+5]-fe);Kr.push([[vs,dn],[zs,Qn],[Zn,Ka],[rr,Xa]]),vs=rr,dn=Xa}const Fi=Y(this,Ga,Q0).call(this,Kr);mt.bezierPath2D.push(Fi)}const pi=Y(xi=mt,Dr,Iu).call(xi);return J(mt,ht,Math.max(a.AnnotationEditor.MIN_SIZE,pi[2]-pi[0])),J(mt,K,Math.max(a.AnnotationEditor.MIN_SIZE,pi[3]-pi[1])),Y(Ki=mt,di,Ru).call(Ki,re,Xt),mt}serialize(){if(this.isEmpty())return null;const k=this.getRect(0,0),X=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:X,thickness:this.thickness,opacity:this.opacity,paths:Y(this,Va,J0).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,k),pageIndex:this.pageIndex,rect:k,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};let y=sr;K=new WeakMap,ht=new WeakMap,xt=new WeakMap,St=new WeakMap,It=new WeakMap,Ot=new WeakMap,ye=new WeakMap,le=new WeakMap,$t=new WeakMap,ne=new WeakMap,ue=new WeakMap,he=new WeakMap,Le=new WeakMap,we=new WeakMap,He=new WeakMap,Ue=new WeakSet,U0=function(k){const X=mt=>{this.thickness=mt,Y(this,kr,Vo).call(this)},gt=this.thickness;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,gt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},ei=new WeakSet,G0=function(k){const X=mt=>{this.color=mt,Y(this,jr,xa).call(this)},gt=this.color;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,gt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},zi=new WeakSet,j0=function(k){const X=mt=>{this.opacity=mt,Y(this,jr,xa).call(this)};k/=100;const gt=this.opacity;this.addCommands({cmd:X.bind(this,k),undo:X.bind(this,gt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},$=new WeakSet,V0=function(){const{parentRotation:k,parentDimensions:[X,gt]}=this;switch(k){case 90:return[0,gt,gt,X];case 180:return[X,gt,X,gt];case 270:return[X,0,gt,X];default:return[0,0,X,gt]}},Zt=new WeakSet,Tu=function(){const{ctx:k,color:X,opacity:gt,thickness:mt,parentScale:Rt,scaleFactor:qt}=this;k.lineWidth=mt*Rt/qt,k.lineCap="round",k.lineJoin="round",k.miterLimit=10,k.strokeStyle=`${X}${(0,o.opacityToHex)(gt)}`},de=new WeakSet,W0=function(k,X){this.canvas.addEventListener("contextmenu",S.noContextMenu),this.canvas.addEventListener("pointerleave",l(this,St)),this.canvas.addEventListener("pointermove",l(this,xt)),this.canvas.addEventListener("pointerup",l(this,It)),this.canvas.removeEventListener("pointerdown",l(this,Ot)),this.isEditing=!0,l(this,ue)||(J(this,ue,!0),Y(this,$n,no).call(this),this.thickness||(this.thickness=sr._defaultThickness),this.color||(this.color=sr._defaultColor||a.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=sr._defaultOpacity)),this.currentPath.push([k,X]),J(this,ne,!1),Y(this,Zt,Tu).call(this),J(this,He,()=>{Y(this,wr,X0).call(this),l(this,He)&&window.requestAnimationFrame(l(this,He))}),window.requestAnimationFrame(l(this,He))},Se=new WeakSet,Pu=function(k,X){const[gt,mt]=this.currentPath.at(-1);if(this.currentPath.length>1&&k===gt&&X===mt)return;const Rt=this.currentPath;let qt=l(this,le);if(Rt.push([k,X]),J(this,ne,!0),Rt.length<=2){qt.moveTo(...Rt[0]),qt.lineTo(k,X);return}Rt.length===3&&(J(this,le,qt=new Path2D),qt.moveTo(...Rt[0])),Y(this,cs,Y0).call(this,qt,...Rt.at(-3),...Rt.at(-2),k,X)},ci=new WeakSet,$0=function(){if(this.currentPath.length===0)return;const k=this.currentPath.at(-1);l(this,le).lineTo(...k)},Hi=new WeakSet,K0=function(k,X){J(this,He,null),k=Math.min(Math.max(k,0),this.canvas.width),X=Math.min(Math.max(X,0),this.canvas.height),Y(this,Se,Pu).call(this,k,X),Y(this,ci,$0).call(this);let gt;if(this.currentPath.length!==1)gt=Y(this,ds,q0).call(this);else{const Xt=[k,X];gt=[[Xt,Xt.slice(),Xt.slice(),Xt]]}const mt=l(this,le),Rt=this.currentPath;this.currentPath=[],J(this,le,new Path2D);const qt=()=>{this.allRawPaths.push(Rt),this.paths.push(gt),this.bezierPath2D.push(mt),this._uiManager.rebuild(this)},re=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,Vn,ic).call(this),Y(this,Wn,rc).call(this)),Y(this,kr,Vo).call(this))};this.addCommands({cmd:qt,undo:re,mustExec:!0})},wr=new WeakSet,X0=function(){if(!l(this,ne))return;J(this,ne,!1);const k=Math.ceil(this.thickness*this.parentScale),X=this.currentPath.slice(-3),gt=X.map(qt=>qt[0]),mt=X.map(qt=>qt[1]);Math.min(...gt)-k,Math.max(...gt)+k,Math.min(...mt)-k,Math.max(...mt)+k;const{ctx:Rt}=this;Rt.save(),Rt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const qt of this.bezierPath2D)Rt.stroke(qt);Rt.stroke(l(this,le)),Rt.restore()},cs=new WeakSet,Y0=function(k,X,gt,mt,Rt,qt,re){const Xt=(X+mt)/2,be=(gt+Rt)/2,fe=(mt+qt)/2,Ye=(Rt+re)/2;k.bezierCurveTo(Xt+2*(mt-Xt)/3,be+2*(Rt-be)/3,fe+2*(mt-fe)/3,Ye+2*(Rt-Ye)/3,fe,Ye)},ds=new WeakSet,q0=function(){const k=this.currentPath;if(k.length<=2)return[[k[0],k[0],k.at(-1),k.at(-1)]];const X=[];let gt,[mt,Rt]=k[0];for(gt=1;gt<k.length-2;gt++){const[We,ui]=k[gt],[pi,Qe]=k[gt+1],xi=(We+pi)/2,Ki=(ui+Qe)/2,Bi=[mt+2*(We-mt)/3,Rt+2*(ui-Rt)/3],Kr=[xi+2*(We-xi)/3,Ki+2*(ui-Ki)/3];X.push([[mt,Rt],Bi,Kr,[xi,Ki]]),[mt,Rt]=[xi,Ki]}const[qt,re]=k[gt],[Xt,be]=k[gt+1],fe=[mt+2*(qt-mt)/3,Rt+2*(re-Rt)/3],Ye=[Xt+2*(qt-Xt)/3,be+2*(re-be)/3];return X.push([[mt,Rt],fe,Ye,[Xt,be]]),X},jr=new WeakSet,xa=function(){if(this.isEmpty()){Y(this,Kn,nc).call(this);return}Y(this,Zt,Tu).call(this);const{canvas:k,ctx:X}=this;X.setTransform(1,0,0,1,0,0),X.clearRect(0,0,k.width,k.height),Y(this,Kn,nc).call(this);for(const gt of this.bezierPath2D)X.stroke(gt)},la=new WeakSet,Mu=function(k){this.canvas.removeEventListener("pointerleave",l(this,St)),this.canvas.removeEventListener("pointermove",l(this,xt)),this.canvas.removeEventListener("pointerup",l(this,It)),this.canvas.addEventListener("pointerdown",l(this,Ot)),l(this,ye)&&clearTimeout(l(this,ye)),J(this,ye,setTimeout(()=>{J(this,ye,null),this.canvas.removeEventListener("contextmenu",S.noContextMenu)},10)),Y(this,Hi,K0).call(this,k.offsetX,k.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Vn=new WeakSet,ic=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Wn=new WeakSet,rc=function(){J(this,he,new ResizeObserver(k=>{const X=k[0].contentRect;X.width&&X.height&&this.setDimensions(X.width,X.height)})),l(this,he).observe(this.div)},$n=new WeakSet,no=function(){if(!l(this,ue))return;const[k,X]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*k),this.canvas.height=Math.ceil(this.height*X),Y(this,Kn,nc).call(this)},di=new WeakSet,Ru=function(k,X){const gt=Y(this,Ns,sc).call(this),mt=(k-gt)/l(this,ht),Rt=(X-gt)/l(this,K);this.scaleFactor=Math.min(mt,Rt)},Kn=new WeakSet,nc=function(){const k=Y(this,Ns,sc).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+k,this.translationY*this.scaleFactor+k)},Ga=new WeakSet,Q0=function(k){const X=new Path2D;for(let gt=0,mt=k.length;gt<mt;gt++){const[Rt,qt,re,Xt]=k[gt];gt===0&&X.moveTo(...Rt),X.bezierCurveTo(qt[0],qt[1],re[0],re[1],Xt[0],Xt[1])}return X},Wi=new WeakSet,Fu=function(k,X,gt){const[mt,Rt,qt,re]=X;switch(gt){case 0:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]+=mt,k[Xt+1]=re-k[Xt+1];break;case 90:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=k[Xt+1]+mt,k[Xt+1]=fe+Rt}break;case 180:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]=qt-k[Xt],k[Xt+1]+=Rt;break;case 270:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=qt-k[Xt+1],k[Xt+1]=re-fe}break;default:throw new Error("Invalid rotation")}return k},ja=new WeakSet,Z0=function(k,X,gt){const[mt,Rt,qt,re]=X;switch(gt){case 0:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]-=mt,k[Xt+1]=re-k[Xt+1];break;case 90:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=k[Xt+1]-Rt,k[Xt+1]=fe-mt}break;case 180:for(let Xt=0,be=k.length;Xt<be;Xt+=2)k[Xt]=qt-k[Xt],k[Xt+1]-=Rt;break;case 270:for(let Xt=0,be=k.length;Xt<be;Xt+=2){const fe=k[Xt];k[Xt]=re-k[Xt+1],k[Xt+1]=qt-fe}break;default:throw new Error("Invalid rotation")}return k},Va=new WeakSet,J0=function(k,X,gt,mt){var be,fe;const Rt=[],qt=this.thickness/2,re=k*X+qt,Xt=k*gt+qt;for(const Ye of this.paths){const We=[],ui=[];for(let pi=0,Qe=Ye.length;pi<Qe;pi++){const[xi,Ki,Bi,Kr]=Ye[pi];if(xi[0]===Kr[0]&&xi[1]===Kr[1]&&Qe===1){const Ka=k*xi[0]+re,rr=k*xi[1]+Xt;We.push(Ka,rr),ui.push(Ka,rr);break}const vs=k*xi[0]+re,dn=k*xi[1]+Xt,Fi=k*Ki[0]+re,Ei=k*Ki[1]+Xt,ir=k*Bi[0]+re,zs=k*Bi[1]+Xt,Qn=k*Kr[0]+re,Zn=k*Kr[1]+Xt;pi===0&&(We.push(vs,dn),ui.push(vs,dn)),We.push(Fi,Ei,ir,zs,Qn,Zn),ui.push(Fi,Ei),pi===Qe-1&&ui.push(Qn,Zn)}Rt.push({bezier:Y(be=sr,Wi,Fu).call(be,We,mt,this.rotation),points:Y(fe=sr,Wi,Fu).call(fe,ui,mt,this.rotation)})}return Rt},Dr=new WeakSet,Iu=function(){let k=1/0,X=-1/0,gt=1/0,mt=-1/0;for(const Rt of this.paths)for(const[qt,re,Xt,be]of Rt){const fe=n.Util.bezierBoundingBox(...qt,...re,...Xt,...be);k=Math.min(k,fe[0]),gt=Math.min(gt,fe[1]),X=Math.max(X,fe[2]),mt=Math.max(mt,fe[3])}return[k,gt,X,mt]},Ns=new WeakSet,sc=function(){return l(this,$t)?Math.ceil(this.thickness*this.parentScale):0},kr=new WeakSet,Vo=function(k=!1){if(this.isEmpty())return;if(!l(this,$t)){Y(this,jr,xa).call(this);return}const X=Y(this,Dr,Iu).call(this),gt=Y(this,Ns,sc).call(this);J(this,ht,Math.max(a.AnnotationEditor.MIN_SIZE,X[2]-X[0])),J(this,K,Math.max(a.AnnotationEditor.MIN_SIZE,X[3]-X[1]));const mt=Math.ceil(gt+l(this,ht)*this.scaleFactor),Rt=Math.ceil(gt+l(this,K)*this.scaleFactor),[qt,re]=this.parentDimensions;this.width=mt/qt,this.height=Rt/re,this.setAspectRatio(mt,Rt);const Xt=this.translationX,be=this.translationY;this.translationX=-X[0],this.translationY=-X[1],Y(this,$n,no).call(this),Y(this,jr,xa).call(this),J(this,Le,mt),J(this,we,Rt),this.setDims(mt,Rt);const fe=k?gt/this.scaleFactor/2:0;this.translate(Xt-this.translationX-fe,be-this.translationY-fe)},N(y,Ga),N(y,Wi),N(y,ja),ti(y,"_defaultColor",null),ti(y,"_defaultOpacity",1),ti(y,"_defaultThickness",1),ti(y,"_type","ink"),ti(y,"_editorType",n.AnnotationEditorType.INK);const ua=class extends a.AnnotationEditor{constructor(k){super({...k,name:"stampEditor"});N(this,Tr);N(this,Xn);N(this,Yn);N(this,Ar);N(this,qn);N(this,ca);N(this,us);N(this,fs);N(this,da);N(this,lr,null);N(this,vr,null);N(this,yr,null);N(this,Nr,null);N(this,Vr,null);N(this,Pn,"");N(this,Wr,null);N(this,hr,null);N(this,Qi,null);N(this,br,!1);N(this,$r,!1);J(this,Nr,k.bitmapUrl),J(this,Vr,k.bitmapFile)}static initialize(k,X){a.AnnotationEditor.initialize(k,X)}static get supportedTypes(){const k=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",k.map(X=>`image/${X}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(k){return this.supportedTypes.includes(k)}static paste(k,X){X.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:k.getAsFile()})}remove(){var k,X;l(this,vr)&&(J(this,lr,null),this._uiManager.imageManager.deleteId(l(this,vr)),(k=l(this,Wr))==null||k.remove(),J(this,Wr,null),(X=l(this,hr))==null||X.disconnect(),J(this,hr,null),l(this,Qi)&&(clearTimeout(l(this,Qi)),J(this,Qi,null))),super.remove()}rebuild(){if(!this.parent){l(this,vr)&&Y(this,Yn,ac).call(this);return}super.rebuild(),this.div!==null&&(l(this,vr)&&l(this,Wr)===null&&Y(this,Yn,ac).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(l(this,yr)||l(this,lr)||l(this,Nr)||l(this,Vr)||l(this,vr))}get isResizable(){return!0}render(){if(this.div)return this.div;let k,X;if(this.width&&(k=this.x,X=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),l(this,lr)?Y(this,Ar,Lu).call(this):Y(this,Yn,ac).call(this),this.width){const[gt,mt]=this.parentDimensions;this.setAt(k*gt,X*mt,this.width*gt,this.height*mt)}return this.div}getImageForAltText(){return l(this,Wr)}static deserialize(k,X,gt){if(k instanceof c.StampAnnotationElement)return null;const mt=super.deserialize(k,X,gt),{rect:Rt,bitmapUrl:qt,bitmapId:re,isSvg:Xt,accessibilityData:be}=k;re&&gt.imageManager.isValidId(re)?J(mt,vr,re):J(mt,Nr,qt),J(mt,br,Xt);const[fe,Ye]=mt.pageDimensions;return mt.width=(Rt[2]-Rt[0])/fe,mt.height=(Rt[3]-Rt[1])/Ye,be&&(mt.altTextData=be),mt}serialize(k=!1,X=null){if(this.isEmpty())return null;const gt={annotationType:n.AnnotationEditorType.STAMP,bitmapId:l(this,vr),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,br),structTreeParentId:this._structTreeParentId};if(k)return gt.bitmapUrl=Y(this,fs,oc).call(this,!0),gt.accessibilityData=this.altTextData,gt;const{decorative:mt,altText:Rt}=this.altTextData;if(!mt&&Rt&&(gt.accessibilityData={type:"Figure",alt:Rt}),X===null)return gt;X.stamps||(X.stamps=new Map);const qt=l(this,br)?(gt.rect[2]-gt.rect[0])*(gt.rect[3]-gt.rect[1]):null;if(!X.stamps.has(l(this,vr)))X.stamps.set(l(this,vr),{area:qt,serialized:gt}),gt.bitmap=Y(this,fs,oc).call(this,!1);else if(l(this,br)){const re=X.stamps.get(l(this,vr));qt>re.area&&(re.area=qt,re.serialized.bitmap.close(),re.serialized.bitmap=Y(this,fs,oc).call(this,!1))}return gt}};let b=ua;lr=new WeakMap,vr=new WeakMap,yr=new WeakMap,Nr=new WeakMap,Vr=new WeakMap,Pn=new WeakMap,Wr=new WeakMap,hr=new WeakMap,Qi=new WeakMap,br=new WeakMap,$r=new WeakMap,Tr=new WeakSet,Wo=function(k,X=!1){if(!k){this.remove();return}J(this,lr,k.bitmap),X||(J(this,vr,k.id),J(this,br,k.isSvg)),k.file&&J(this,Pn,k.file.name),Y(this,Ar,Lu).call(this)},Xn=new WeakSet,$o=function(){J(this,yr,null),this._uiManager.enableWaiting(!1),l(this,Wr)&&this.div.focus()},Yn=new WeakSet,ac=function(){if(l(this,vr)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,vr)).then(X=>Y(this,Tr,Wo).call(this,X,!0)).finally(()=>Y(this,Xn,$o).call(this));return}if(l(this,Nr)){const X=l(this,Nr);J(this,Nr,null),this._uiManager.enableWaiting(!0),J(this,yr,this._uiManager.imageManager.getFromUrl(X).then(gt=>Y(this,Tr,Wo).call(this,gt)).finally(()=>Y(this,Xn,$o).call(this)));return}if(l(this,Vr)){const X=l(this,Vr);J(this,Vr,null),this._uiManager.enableWaiting(!0),J(this,yr,this._uiManager.imageManager.getFromFile(X).then(gt=>Y(this,Tr,Wo).call(this,gt)).finally(()=>Y(this,Xn,$o).call(this)));return}const k=document.createElement("input");k.type="file",k.accept=ua.supportedTypesStr,J(this,yr,new Promise(X=>{k.addEventListener("change",async()=>{if(!k.files||k.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const gt=await this._uiManager.imageManager.getFromFile(k.files[0]);Y(this,Tr,Wo).call(this,gt)}X()}),k.addEventListener("cancel",()=>{this.remove(),X()})}).finally(()=>Y(this,Xn,$o).call(this))),k.click()},Ar=new WeakSet,Lu=function(){const{div:k}=this;let{width:X,height:gt}=l(this,lr);const[mt,Rt]=this.pageDimensions,qt=.75;if(this.width)X=this.width*mt,gt=this.height*Rt;else if(X>qt*mt||gt>qt*Rt){const fe=Math.min(qt*mt/X,qt*Rt/gt);X*=fe,gt*=fe}const[re,Xt]=this.parentDimensions;this.setDims(X*re/mt,gt*Xt/Rt),this._uiManager.enableWaiting(!1);const be=J(this,Wr,document.createElement("canvas"));k.append(be),k.hidden=!1,Y(this,us,Du).call(this,X,gt),Y(this,da,i1).call(this),l(this,$r)||(this.parent.addUndoableEditor(this),J(this,$r,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,Pn)&&be.setAttribute("aria-label",l(this,Pn))},qn=new WeakSet,t1=function(k,X){var qt;const[gt,mt]=this.parentDimensions;this.width=k/gt,this.height=X/mt,this.setDims(k,X),(qt=this._initialOptions)!=null&&qt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,l(this,Qi)!==null&&clearTimeout(l(this,Qi)),J(this,Qi,setTimeout(()=>{J(this,Qi,null),Y(this,us,Du).call(this,k,X)},200))},ca=new WeakSet,e1=function(k,X){const{width:gt,height:mt}=l(this,lr);let Rt=gt,qt=mt,re=l(this,lr);for(;Rt>2*k||qt>2*X;){const Xt=Rt,be=qt;Rt>2*k&&(Rt=Rt>=16384?Math.floor(Rt/2)-1:Math.ceil(Rt/2)),qt>2*X&&(qt=qt>=16384?Math.floor(qt/2)-1:Math.ceil(qt/2));const fe=new OffscreenCanvas(Rt,qt);fe.getContext("2d").drawImage(re,0,0,Xt,be,0,0,Rt,qt),re=fe.transferToImageBitmap()}return re},us=new WeakSet,Du=function(k,X){k=Math.ceil(k),X=Math.ceil(X);const gt=l(this,Wr);if(!gt||gt.width===k&&gt.height===X)return;gt.width=k,gt.height=X;const mt=l(this,br)?l(this,lr):Y(this,ca,e1).call(this,k,X);if(this._uiManager.hasMLManager&&!this.hasAltText()){const qt=new OffscreenCanvas(k,X);qt.getContext("2d").drawImage(mt,0,0,mt.width,mt.height,0,0,k,X),qt.convertToBlob().then(re=>{const Xt=new FileReader;Xt.onload=()=>{const be=Xt.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:be}}).then(fe=>{const Ye=(fe==null?void 0:fe.output)||"";this.parent&&Ye&&!this.hasAltText()&&(this.altTextData={altText:Ye,decorative:!1})})},Xt.readAsDataURL(re)})}const Rt=gt.getContext("2d");Rt.filter=this._uiManager.hcmFilter,Rt.drawImage(mt,0,0,mt.width,mt.height,0,0,k,X)},fs=new WeakSet,oc=function(k){if(k){if(l(this,br)){const gt=this._uiManager.imageManager.getSvgUrl(l(this,vr));if(gt)return gt}const X=document.createElement("canvas");return{width:X.width,height:X.height}=l(this,lr),X.getContext("2d").drawImage(l(this,lr),0,0),X.toDataURL()}if(l(this,br)){const[X,gt]=this.pageDimensions,mt=Math.round(this.width*X*S.PixelsPerInch.PDF_TO_CSS_UNITS),Rt=Math.round(this.height*gt*S.PixelsPerInch.PDF_TO_CSS_UNITS),qt=new OffscreenCanvas(mt,Rt);return qt.getContext("2d").drawImage(l(this,lr),0,0,l(this,lr).width,l(this,lr).height,0,0,mt,Rt),qt.transferToImageBitmap()}return structuredClone(l(this,lr))},da=new WeakSet,i1=function(){J(this,hr,new ResizeObserver(k=>{const X=k[0].contentRect;X.width&&X.height&&Y(this,qn,t1).call(this,X.width,X.height)})),l(this,hr).observe(this.div)},ti(b,"_type","stamp"),ti(b,"_editorType",n.AnnotationEditorType.STAMP);const cn=class{constructor({uiManager:kt,pageIndex:k,div:X,accessibilityManager:gt,annotationLayer:mt,drawLayer:Rt,textLayer:qt,viewport:re,l10n:Xt}){N(this,fa);N(this,ps);N(this,Sr);N(this,ms);N(this,Pr);N(this,gs,void 0);N(this,Rn,!1);N(this,pn,null);N(this,hn,null);N(this,Qr,null);N(this,mn,null);N(this,vn,null);N(this,cr,new Map);N(this,Fn,!1);N(this,In,!1);N(this,Ln,!1);N(this,er,null);N(this,Oe,void 0);const be=[...l(cn,yn).values()];if(!cn._initialized){cn._initialized=!0;for(const fe of be)fe.initialize(Xt,kt)}kt.registerEditorTypes(be),J(this,Oe,kt),this.pageIndex=k,this.div=X,J(this,gs,gt),J(this,pn,mt),this.viewport=re,J(this,er,qt),this.drawLayer=Rt,l(this,Oe).addLayer(this)}get isEmpty(){return l(this,cr).size===0}get isInvisible(){return this.isEmpty&&l(this,Oe).getMode()===n.AnnotationEditorType.NONE}updateToolbar(kt){l(this,Oe).updateToolbar(kt)}updateMode(kt=l(this,Oe).getMode()){switch(Y(this,Pr,lc).call(this),kt){case n.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case n.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case n.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:k}=this.div;for(const X of l(cn,yn).values())k.toggle(`${X._type}Editing`,kt===X._editorType);this.div.hidden=!1}hasTextLayer(kt){var k;return kt===((k=l(this,er))==null?void 0:k.div)}addInkEditorIfNeeded(kt){if(l(this,Oe).getMode()===n.AnnotationEditorType.INK){if(!kt){for(const k of l(this,cr).values())if(k.isEmpty()){k.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(kt){l(this,Oe).setEditingState(kt)}addCommands(kt){l(this,Oe).addCommands(kt)}togglePointerEvents(kt=!1){this.div.classList.toggle("disabled",!kt)}toggleAnnotationLayerPointerEvents(kt=!1){var k;(k=l(this,pn))==null||k.div.classList.toggle("disabled",!kt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const kt=new Set;for(const X of l(this,cr).values())X.enableEditing(),X.show(!0),X.annotationElementId&&(l(this,Oe).removeChangedExistingAnnotation(X),kt.add(X.annotationElementId));if(!l(this,pn))return;const k=l(this,pn).getEditableAnnotations();for(const X of k){if(X.hide(),l(this,Oe).isDeletedAnnotationElement(X.data.id)||kt.has(X.data.id))continue;const gt=this.deserialize(X);!gt||(this.addOrRebuild(gt),gt.enableEditing())}}disable(){var gt;J(this,Ln,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const kt=new Map,k=new Map;for(const mt of l(this,cr).values())if(mt.disableEditing(),!!mt.annotationElementId){if(mt.serialize()!==null){kt.set(mt.annotationElementId,mt);continue}else k.set(mt.annotationElementId,mt);(gt=this.getEditableAnnotation(mt.annotationElementId))==null||gt.show(),mt.remove()}if(l(this,pn)){const mt=l(this,pn).getEditableAnnotations();for(const Rt of mt){const{id:qt}=Rt.data;if(l(this,Oe).isDeletedAnnotationElement(qt))continue;let re=k.get(qt);if(re){re.resetAnnotationElement(Rt),re.show(!1),Rt.show();continue}re=kt.get(qt),re&&(l(this,Oe).addChangedExistingAnnotation(re),re.renderAnnotationElement(Rt),re.show(!1)),Rt.show()}}Y(this,Pr,lc).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:X}=this.div;for(const mt of l(cn,yn).values())X.remove(`${mt._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),J(this,Ln,!1)}getEditableAnnotation(kt){var k;return((k=l(this,pn))==null?void 0:k.getEditableAnnotation(kt))||null}setActiveEditor(kt){l(this,Oe).getActive()!==kt&&l(this,Oe).setActiveEditor(kt)}enableTextSelection(){var kt;this.div.tabIndex=-1,(kt=l(this,er))!=null&&kt.div&&!l(this,mn)&&(J(this,mn,Y(this,fa,r1).bind(this)),l(this,er).div.addEventListener("pointerdown",l(this,mn)),l(this,er).div.classList.add("highlighting"))}disableTextSelection(){var kt;this.div.tabIndex=0,(kt=l(this,er))!=null&&kt.div&&l(this,mn)&&(l(this,er).div.removeEventListener("pointerdown",l(this,mn)),J(this,mn,null),l(this,er).div.classList.remove("highlighting"))}enableClick(){l(this,Qr)||(J(this,Qr,this.pointerdown.bind(this)),J(this,hn,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",l(this,Qr)),this.div.addEventListener("pointerup",l(this,hn)))}disableClick(){!l(this,Qr)||(this.div.removeEventListener("pointerdown",l(this,Qr)),this.div.removeEventListener("pointerup",l(this,hn)),J(this,Qr,null),J(this,hn,null))}attach(kt){l(this,cr).set(kt.id,kt);const{annotationElementId:k}=kt;k&&l(this,Oe).isDeletedAnnotationElement(k)&&l(this,Oe).removeDeletedAnnotationElement(kt)}detach(kt){var k;l(this,cr).delete(kt.id),(k=l(this,gs))==null||k.removePointerInTextLayer(kt.contentDiv),!l(this,Ln)&&kt.annotationElementId&&l(this,Oe).addDeletedAnnotationElement(kt)}remove(kt){this.detach(kt),l(this,Oe).removeEditor(kt),kt.div.remove(),kt.isAttachedToDOM=!1,l(this,In)||this.addInkEditorIfNeeded(!1)}changeParent(kt){var k;kt.parent!==this&&(kt.parent&&kt.annotationElementId&&(l(this,Oe).addDeletedAnnotationElement(kt.annotationElementId),a.AnnotationEditor.deleteAnnotationElement(kt),kt.annotationElementId=null),this.attach(kt),(k=kt.parent)==null||k.detach(kt),kt.setParent(this),kt.div&&kt.isAttachedToDOM&&(kt.div.remove(),this.div.append(kt.div)))}add(kt){if(!(kt.parent===this&&kt.isAttachedToDOM)){if(this.changeParent(kt),l(this,Oe).addEditor(kt),this.attach(kt),!kt.isAttachedToDOM){const k=kt.render();this.div.append(k),kt.isAttachedToDOM=!0}kt.fixAndSetPosition(),kt.onceAdded(),l(this,Oe).addToAnnotationStorage(kt),kt._reportTelemetry(kt.telemetryInitialData)}}moveEditorInDOM(kt){var X;if(!kt.isAttachedToDOM)return;const{activeElement:k}=document;kt.div.contains(k)&&!l(this,vn)&&(kt._focusEventsAllowed=!1,J(this,vn,setTimeout(()=>{J(this,vn,null),kt.div.contains(document.activeElement)?kt._focusEventsAllowed=!0:(kt.div.addEventListener("focusin",()=>{kt._focusEventsAllowed=!0},{once:!0}),k.focus())},0))),kt._structTreeParentId=(X=l(this,gs))==null?void 0:X.moveElementInDOM(this.div,kt.div,kt.contentDiv,!0)}addOrRebuild(kt){kt.needsToBeRebuilt()?(kt.parent||(kt.parent=this),kt.rebuild(),kt.show()):this.add(kt)}addUndoableEditor(kt){const k=()=>kt._uiManager.rebuild(kt),X=()=>{kt.remove()};this.addCommands({cmd:k,undo:X,mustExec:!1})}getNextId(){return l(this,Oe).getId()}canCreateNewEmptyEditor(){var kt;return(kt=l(this,ps,Nu))==null?void 0:kt.canCreateNewEmptyEditor()}pasteEditor(kt,k){l(this,Oe).updateToolbar(kt),l(this,Oe).updateMode(kt);const{offsetX:X,offsetY:gt}=Y(this,ms,zu).call(this),mt=this.getNextId(),Rt=Y(this,Sr,Ou).call(this,{parent:this,id:mt,x:X,y:gt,uiManager:l(this,Oe),isCentered:!0,...k});Rt&&this.add(Rt)}deserialize(kt){var k;return((k=l(cn,yn).get(kt.annotationType??kt.annotationEditorType))==null?void 0:k.deserialize(kt,this,l(this,Oe)))||null}createAndAddNewEditor(kt,k,X={}){const gt=this.getNextId(),mt=Y(this,Sr,Ou).call(this,{parent:this,id:gt,x:kt.offsetX,y:kt.offsetY,uiManager:l(this,Oe),isCentered:k,...X});return mt&&this.add(mt),mt}addNewEditor(){this.createAndAddNewEditor(Y(this,ms,zu).call(this),!0)}setSelected(kt){l(this,Oe).setSelected(kt)}toggleSelected(kt){l(this,Oe).toggleSelected(kt)}isSelected(kt){return l(this,Oe).isSelected(kt)}unselect(kt){l(this,Oe).unselect(kt)}pointerup(kt){const{isMac:k}=n.FeatureTest.platform;if(!(kt.button!==0||kt.ctrlKey&&k)&&kt.target===this.div&&l(this,Fn)){if(J(this,Fn,!1),!l(this,Rn)){J(this,Rn,!0);return}if(l(this,Oe).getMode()===n.AnnotationEditorType.STAMP){l(this,Oe).unselectAll();return}this.createAndAddNewEditor(kt,!1)}}pointerdown(kt){if(l(this,Oe).getMode()===n.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),l(this,Fn)){J(this,Fn,!1);return}const{isMac:k}=n.FeatureTest.platform;if(kt.button!==0||kt.ctrlKey&&k||kt.target!==this.div)return;J(this,Fn,!0);const X=l(this,Oe).getActive();J(this,Rn,!X||X.isEmpty())}findNewParent(kt,k,X){const gt=l(this,Oe).findParent(k,X);return gt===null||gt===this?!1:(gt.changeParent(kt),!0)}destroy(){var kt,k;((kt=l(this,Oe).getActive())==null?void 0:kt.parent)===this&&(l(this,Oe).commitOrRemove(),l(this,Oe).setActiveEditor(null)),l(this,vn)&&(clearTimeout(l(this,vn)),J(this,vn,null));for(const X of l(this,cr).values())(k=l(this,gs))==null||k.removePointerInTextLayer(X.contentDiv),X.setParent(null),X.isAttachedToDOM=!1,X.div.remove();this.div=null,l(this,cr).clear(),l(this,Oe).removeLayer(this)}render({viewport:kt}){this.viewport=kt,(0,S.setLayerDimensions)(this.div,kt);for(const k of l(this,Oe).getEditors(this.pageIndex))this.add(k),k.rebuild();this.updateMode()}update({viewport:kt}){l(this,Oe).commitOrRemove(),Y(this,Pr,lc).call(this);const k=this.viewport.rotation,X=kt.rotation;if(this.viewport=kt,(0,S.setLayerDimensions)(this.div,{rotation:X}),k!==X)for(const gt of l(this,cr).values())gt.rotate(X);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:kt,pageHeight:k}=this.viewport.rawDims;return[kt,k]}get scale(){return l(this,Oe).viewParameters.realScale}};let x=cn;gs=new WeakMap,Rn=new WeakMap,pn=new WeakMap,hn=new WeakMap,Qr=new WeakMap,mn=new WeakMap,vn=new WeakMap,cr=new WeakMap,Fn=new WeakMap,In=new WeakMap,Ln=new WeakMap,er=new WeakMap,Oe=new WeakMap,yn=new WeakMap,fa=new WeakSet,r1=function(kt){if(l(this,Oe).unselectAll(),kt.target===l(this,er).div){const{isMac:k}=n.FeatureTest.platform;if(kt.button!==0||kt.ctrlKey&&k)return;l(this,Oe).showAllEditors("highlight",!0,!0),l(this,er).div.classList.add("free"),_.startHighlighting(this,l(this,Oe).direction==="ltr",kt),l(this,er).div.addEventListener("pointerup",()=>{l(this,er).div.classList.remove("free")},{once:!0}),kt.preventDefault()}},ps=new WeakSet,Nu=function(){return l(cn,yn).get(l(this,Oe).getMode())},Sr=new WeakSet,Ou=function(kt){const k=l(this,ps,Nu);return k?new k.prototype.constructor(kt):null},ms=new WeakSet,zu=function(){const{x:kt,y:k,width:X,height:gt}=this.div.getBoundingClientRect(),mt=Math.max(0,kt),Rt=Math.max(0,k),qt=Math.min(window.innerWidth,kt+X),re=Math.min(window.innerHeight,k+gt),Xt=(mt+qt)/2-kt,be=(Rt+re)/2-k,[fe,Ye]=this.viewport.rotation%180===0?[Xt,be]:[be,Xt];return{offsetX:fe,offsetY:Ye}},Pr=new WeakSet,lc=function(){J(this,In,!0);for(const kt of l(this,cr).values())kt.isEmpty()&&kt.remove();J(this,In,!1)},ti(x,"_initialized",!1),N(x,yn,new Map([d,y,b,_].map(kt=>[kt._editorType,kt])))},259:(r,t,s)=>{var u,d,f,m,S,_,y,b,x,E,I,R,p,Hu,A,Bu,B,n1,rt,wa,st,s1,dt,$s;s.d(t,{ColorPicker:()=>c});var n=s(292),a=s(830),o=s(419);const Lt=class{constructor({editor:ct=null,uiManager:Dt=null}){N(this,p);N(this,A);N(this,B);N(this,rt);N(this,st);N(this,dt);N(this,u,Y(this,B,n1).bind(this));N(this,d,Y(this,st,s1).bind(this));N(this,f,null);N(this,m,null);N(this,S,void 0);N(this,_,null);N(this,y,!1);N(this,b,!1);N(this,x,null);N(this,E,void 0);N(this,I,null);N(this,R,void 0);var ee;ct?(J(this,b,!1),J(this,R,n.AnnotationEditorParamsType.HIGHLIGHT_COLOR),J(this,x,ct)):(J(this,b,!0),J(this,R,n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),J(this,I,(ct==null?void 0:ct._uiManager)||Dt),J(this,E,l(this,I)._eventBus),J(this,S,(ct==null?void 0:ct.color)||((ee=l(this,I))==null?void 0:ee.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,n.shadow)(this,"_keyboardManager",new a.KeyboardManager([[["Escape","mac+Escape"],Lt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Lt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Lt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Lt.prototype._moveToPrevious],[["Home","mac+Home"],Lt.prototype._moveToBeginning],[["End","mac+End"],Lt.prototype._moveToEnd]]))}renderButton(){const ct=J(this,f,document.createElement("button"));ct.className="colorPicker",ct.tabIndex="0",ct.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),ct.setAttribute("aria-haspopup",!0),ct.addEventListener("click",Y(this,rt,wa).bind(this)),ct.addEventListener("keydown",l(this,u));const Dt=J(this,m,document.createElement("span"));return Dt.className="swatch",Dt.setAttribute("aria-hidden",!0),Dt.style.backgroundColor=l(this,S),ct.append(Dt),ct}renderMainDropdown(){const ct=J(this,_,Y(this,p,Hu).call(this));return ct.setAttribute("aria-orientation","horizontal"),ct.setAttribute("aria-labelledby","highlightColorPickerLabel"),ct}_colorSelectFromKeyboard(ct){if(ct.target===l(this,f)){Y(this,rt,wa).call(this,ct);return}const Dt=ct.target.getAttribute("data-color");!Dt||Y(this,A,Bu).call(this,Dt,ct)}_moveToNext(ct){var Dt,ee;if(!l(this,dt,$s)){Y(this,rt,wa).call(this,ct);return}if(ct.target===l(this,f)){(Dt=l(this,_).firstChild)==null||Dt.focus();return}(ee=ct.target.nextSibling)==null||ee.focus()}_moveToPrevious(ct){var Dt,ee;if(ct.target===((Dt=l(this,_))==null?void 0:Dt.firstChild)||ct.target===l(this,f)){l(this,dt,$s)&&this._hideDropdownFromKeyboard();return}l(this,dt,$s)||Y(this,rt,wa).call(this,ct),(ee=ct.target.previousSibling)==null||ee.focus()}_moveToBeginning(ct){var Dt;if(!l(this,dt,$s)){Y(this,rt,wa).call(this,ct);return}(Dt=l(this,_).firstChild)==null||Dt.focus()}_moveToEnd(ct){var Dt;if(!l(this,dt,$s)){Y(this,rt,wa).call(this,ct);return}(Dt=l(this,_).lastChild)==null||Dt.focus()}hideDropdown(){var ct;(ct=l(this,_))==null||ct.classList.add("hidden"),window.removeEventListener("pointerdown",l(this,d))}_hideDropdownFromKeyboard(){var ct;if(!l(this,b)){if(!l(this,dt,$s)){(ct=l(this,x))==null||ct.unselect();return}this.hideDropdown(),l(this,f).focus({preventScroll:!0,focusVisible:l(this,y)})}}updateColor(ct){if(l(this,m)&&(l(this,m).style.backgroundColor=ct),!l(this,_))return;const Dt=l(this,I).highlightColors.values();for(const ee of l(this,_).children)ee.setAttribute("aria-selected",Dt.next().value===ct)}destroy(){var ct,Dt;(ct=l(this,f))==null||ct.remove(),J(this,f,null),J(this,m,null),(Dt=l(this,_))==null||Dt.remove(),J(this,_,null)}};let c=Lt;u=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakMap,S=new WeakMap,_=new WeakMap,y=new WeakMap,b=new WeakMap,x=new WeakMap,E=new WeakMap,I=new WeakMap,R=new WeakMap,p=new WeakSet,Hu=function(){const ct=document.createElement("div");ct.addEventListener("contextmenu",o.noContextMenu),ct.className="dropdown",ct.role="listbox",ct.setAttribute("aria-multiselectable",!1),ct.setAttribute("aria-orientation","vertical"),ct.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[Dt,ee]of l(this,I).highlightColors){const zt=document.createElement("button");zt.tabIndex="0",zt.role="option",zt.setAttribute("data-color",ee),zt.title=Dt,zt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${Dt}`);const Jt=document.createElement("span");zt.append(Jt),Jt.className="swatch",Jt.style.backgroundColor=ee,zt.setAttribute("aria-selected",ee===l(this,S)),zt.addEventListener("click",Y(this,A,Bu).bind(this,ee)),ct.append(zt)}return ct.addEventListener("keydown",l(this,u)),ct},A=new WeakSet,Bu=function(ct,Dt){Dt.stopPropagation(),l(this,E).dispatch("switchannotationeditorparams",{source:this,type:l(this,R),value:ct})},B=new WeakSet,n1=function(ct){Lt._keyboardManager.exec(this,ct)},rt=new WeakSet,wa=function(ct){if(l(this,dt,$s)){this.hideDropdown();return}if(J(this,y,ct.detail===0),window.addEventListener("pointerdown",l(this,d)),l(this,_)){l(this,_).classList.remove("hidden");return}const Dt=J(this,_,Y(this,p,Hu).call(this));l(this,f).append(Dt)},st=new WeakSet,s1=function(ct){var Dt;(Dt=l(this,_))!=null&&Dt.contains(ct.target)||this.hideDropdown()},dt=new WeakSet,$s=function(){return l(this,_)&&!l(this,_).classList.contains("hidden")}},310:(r,t,s)=>{var m,S,_,y,b,x,E,I,Uu,w,A,C,B,F,rt,tt,st,wt,dt,Tt,Lt,Qt,ct,Dt,ee,zt,Jt,oe,pe,Ae,Ve,Gu,lt,ju,Wt,Vu,ie,a1,_e,o1,T,Wu,D,$u,L,Ku,j,l1,W,h1,O,c1,et,d1,pt,Xu,Nt,Ko;s.d(t,{AnnotationEditor:()=>d});var n=s(830),a=s(292),o=s(419);const p=class{constructor(Z){N(this,I);N(this,m,"");N(this,S,!1);N(this,_,null);N(this,y,null);N(this,b,null);N(this,x,!1);N(this,E,null);J(this,E,Z)}static initialize(Z){p._l10nPromise||(p._l10nPromise=Z)}async render(){const Z=J(this,_,document.createElement("button"));Z.className="altText";const at=await p._l10nPromise.get("pdfjs-editor-alt-text-button-label");Z.textContent=at,Z.setAttribute("aria-label",at),Z.tabIndex="0",Z.addEventListener("contextmenu",o.noContextMenu),Z.addEventListener("pointerdown",vt=>vt.stopPropagation());const _t=vt=>{vt.preventDefault(),l(this,E)._uiManager.editAltText(l(this,E))};return Z.addEventListener("click",_t,{capture:!0}),Z.addEventListener("keydown",vt=>{vt.target===Z&&vt.key==="Enter"&&(J(this,x,!0),_t(vt))}),await Y(this,I,Uu).call(this),Z}finish(){!l(this,_)||(l(this,_).focus({focusVisible:l(this,x)}),J(this,x,!1))}isEmpty(){return!l(this,m)&&!l(this,S)}get data(){return{altText:l(this,m),decorative:l(this,S)}}set data({altText:Z,decorative:at}){l(this,m)===Z&&l(this,S)===at||(J(this,m,Z),J(this,S,at),Y(this,I,Uu).call(this))}toggle(Z=!1){!l(this,_)||(!Z&&l(this,b)&&(clearTimeout(l(this,b)),J(this,b,null)),l(this,_).disabled=!Z)}destroy(){var Z;(Z=l(this,_))==null||Z.remove(),J(this,_,null),J(this,y,null)}};let c=p;m=new WeakMap,S=new WeakMap,_=new WeakMap,y=new WeakMap,b=new WeakMap,x=new WeakMap,E=new WeakMap,I=new WeakSet,Uu=async function(){var _t,vt;const Z=l(this,_);if(!Z)return;if(!l(this,m)&&!l(this,S)){Z.classList.remove("done"),(_t=l(this,y))==null||_t.remove();return}Z.classList.add("done"),p._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(jt=>{Z.setAttribute("aria-label",jt)});let at=l(this,y);if(!at){J(this,y,at=document.createElement("span")),at.className="tooltip",at.setAttribute("role","tooltip");const jt=at.id=`alt-text-tooltip-${l(this,E).id}`;Z.setAttribute("aria-describedby",jt);const bt=100;Z.addEventListener("mouseenter",()=>{J(this,b,setTimeout(()=>{J(this,b,null),l(this,y).classList.add("show"),l(this,E)._reportTelemetry({action:"alt_text_tooltip"})},bt))}),Z.addEventListener("mouseleave",()=>{var q;l(this,b)&&(clearTimeout(l(this,b)),J(this,b,null)),(q=l(this,y))==null||q.classList.remove("show")})}at.innerText=l(this,S)?await p._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):l(this,m),at.parentNode||Z.append(at),(vt=l(this,E).getImageForAltText())==null||vt.setAttribute("aria-describedby",at.id)},ti(c,"_l10nPromise",null);var u=s(362);const Pt=class{constructor(Z){N(this,Ve);N(this,Wt);N(this,ie);N(this,_e);N(this,T);N(this,D);N(this,L);N(this,j);N(this,W);N(this,O);N(this,et);N(this,pt);N(this,Nt);N(this,w,null);N(this,A,null);N(this,C,!1);N(this,B,!1);N(this,F,null);N(this,rt,null);N(this,tt,this.focusin.bind(this));N(this,st,this.focusout.bind(this));N(this,wt,null);N(this,dt,"");N(this,Tt,!1);N(this,Lt,null);N(this,Qt,!1);N(this,ct,!1);N(this,Dt,!1);N(this,ee,null);N(this,zt,0);N(this,Jt,0);N(this,oe,null);ti(this,"_initialOptions",Object.create(null));ti(this,"_isVisible",!0);ti(this,"_uiManager",null);ti(this,"_focusEventsAllowed",!0);ti(this,"_l10nPromise",null);N(this,pe,!1);N(this,Ae,Pt._zIndex++);this.constructor===Pt&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Z.parent,this.id=Z.id,this.width=this.height=null,this.pageIndex=Z.parent.pageIndex,this.name=Z.name,this.div=null,this._uiManager=Z.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Z.isCentered,this._structTreeParentId=null;const{rotation:at,rawDims:{pageWidth:_t,pageHeight:vt,pageX:jt,pageY:bt}}=this.parent.viewport;this.rotation=at,this.pageRotation=(360+at-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[_t,vt],this.pageTranslation=[jt,bt];const[q,ot]=this.parentDimensions;this.x=Z.x/q,this.y=Z.y/ot,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const Z=Pt.prototype._resizeWithKeyboard,at=n.AnnotationEditorUIManager.TRANSLATE_SMALL,_t=n.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_resizerKeyboardManager",new n.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],Z,{args:[-at,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Z,{args:[-_t,0]}],[["ArrowRight","mac+ArrowRight"],Z,{args:[at,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Z,{args:[_t,0]}],[["ArrowUp","mac+ArrowUp"],Z,{args:[0,-at]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Z,{args:[0,-_t]}],[["ArrowDown","mac+ArrowDown"],Z,{args:[0,at]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Z,{args:[0,_t]}],[["Escape","mac+Escape"],Pt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Z){const at=new f({id:Z.parent.getNextId(),parent:Z.parent,uiManager:Z._uiManager});at.annotationElementId=Z.annotationElementId,at.deleted=!0,at._uiManager.addToAnnotationStorage(at)}static initialize(Z,at,_t){if(Pt._l10nPromise||(Pt._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(jt=>[jt,Z.get(jt.replaceAll(/([A-Z])/g,bt=>`-${bt.toLowerCase()}`))]))),_t==null?void 0:_t.strings)for(const jt of _t.strings)Pt._l10nPromise.set(jt,Z.get(jt));if(Pt._borderLineWidth!==-1)return;const vt=getComputedStyle(document.documentElement);Pt._borderLineWidth=parseFloat(vt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Z,at){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Z){return!1}static paste(Z,at){(0,a.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,pe)}set _isDraggable(Z){var at;J(this,pe,Z),(at=this.div)==null||at.classList.toggle("draggable",Z)}get isEnterHandled(){return!0}center(){const[Z,at]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*at/(Z*2),this.y+=this.width*Z/(at*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*at/(Z*2),this.y-=this.width*Z/(at*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Z){this._uiManager.addCommands(Z)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Ae)}setParent(Z){Z!==null?(this.pageIndex=Z.pageIndex,this.pageDimensions=Z.pageDimensions):Y(this,Nt,Ko).call(this),this.parent=Z}focusin(Z){!this._focusEventsAllowed||(l(this,Tt)?J(this,Tt,!1):this.parent.setSelected(this))}focusout(Z){var at,_t;!this._focusEventsAllowed||!this.isAttachedToDOM||(at=Z.relatedTarget)!=null&&at.closest(`#${this.id}`)||(Z.preventDefault(),(_t=this.parent)!=null&&_t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Z,at,_t,vt){const[jt,bt]=this.parentDimensions;[_t,vt]=this.screenToPageTranslation(_t,vt),this.x=(Z+_t)/jt,this.y=(at+vt)/bt,this.fixAndSetPosition()}translate(Z,at){Y(this,Ve,Gu).call(this,this.parentDimensions,Z,at)}translateInPage(Z,at){l(this,Lt)||J(this,Lt,[this.x,this.y]),Y(this,Ve,Gu).call(this,this.pageDimensions,Z,at),this.div.scrollIntoView({block:"nearest"})}drag(Z,at){l(this,Lt)||J(this,Lt,[this.x,this.y]);const[_t,vt]=this.parentDimensions;if(this.x+=Z/_t,this.y+=at/vt,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ft,y:Et}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ft,Et)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:jt,y:bt}=this;const[q,ot]=this.getBaseTranslation();jt+=q,bt+=ot,this.div.style.left=`${(100*jt).toFixed(2)}%`,this.div.style.top=`${(100*bt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!l(this,Lt)&&(l(this,Lt)[0]!==this.x||l(this,Lt)[1]!==this.y)}getBaseTranslation(){const[Z,at]=this.parentDimensions,{_borderLineWidth:_t}=Pt,vt=_t/Z,jt=_t/at;switch(this.rotation){case 90:return[-vt,jt];case 180:return[vt,jt];case 270:return[vt,-jt];default:return[-vt,-jt]}}get _mustFixPosition(){return!0}fixAndSetPosition(Z=this.rotation){const[at,_t]=this.pageDimensions;let{x:vt,y:jt,width:bt,height:q}=this;if(bt*=at,q*=_t,vt*=at,jt*=_t,this._mustFixPosition)switch(Z){case 0:vt=Math.max(0,Math.min(at-bt,vt)),jt=Math.max(0,Math.min(_t-q,jt));break;case 90:vt=Math.max(0,Math.min(at-q,vt)),jt=Math.min(_t,Math.max(bt,jt));break;case 180:vt=Math.min(at,Math.max(bt,vt)),jt=Math.min(_t,Math.max(q,jt));break;case 270:vt=Math.min(at,Math.max(q,vt)),jt=Math.max(0,Math.min(_t-bt,jt));break}this.x=vt/=at,this.y=jt/=_t;const[ot,ft]=this.getBaseTranslation();vt+=ot,jt+=ft;const{style:Et}=this.div;Et.left=`${(100*vt).toFixed(2)}%`,Et.top=`${(100*jt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Z,at){var _t;return Y(_t=Pt,lt,ju).call(_t,Z,at,this.parentRotation)}pageTranslationToScreen(Z,at){var _t;return Y(_t=Pt,lt,ju).call(_t,Z,at,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Z,pageDimensions:[at,_t]}=this,vt=at*Z,jt=_t*Z;return a.FeatureTest.isCSSRoundSupported?[Math.round(vt),Math.round(jt)]:[vt,jt]}setDims(Z,at){const[_t,vt]=this.parentDimensions;this.div.style.width=`${(100*Z/_t).toFixed(2)}%`,l(this,B)||(this.div.style.height=`${(100*at/vt).toFixed(2)}%`)}fixDims(){const{style:Z}=this.div,{height:at,width:_t}=Z,vt=_t.endsWith("%"),jt=!l(this,B)&&at.endsWith("%");if(vt&&jt)return;const[bt,q]=this.parentDimensions;vt||(Z.width=`${(100*parseFloat(_t)/bt).toFixed(2)}%`),!l(this,B)&&!jt&&(Z.height=`${(100*parseFloat(at)/q).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var Z;(Z=l(this,A))==null||Z.finish()}async addEditToolbar(){return l(this,wt)||l(this,ct)?l(this,wt):(J(this,wt,new u.EditorToolbar(this)),this.div.append(l(this,wt).render()),l(this,A)&&l(this,wt).addAltTextButton(await l(this,A).render()),l(this,wt))}removeEditToolbar(){var Z;!l(this,wt)||(l(this,wt).remove(),J(this,wt,null),(Z=l(this,A))==null||Z.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,A)||(c.initialize(Pt._l10nPromise),J(this,A,new c(this)),await this.addEditToolbar())}get altTextData(){var Z;return(Z=l(this,A))==null?void 0:Z.data}set altTextData(Z){!l(this,A)||(l(this,A).data=Z)}hasAltText(){var Z;return!((Z=l(this,A))!=null&&Z.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,C)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",l(this,tt)),this.div.addEventListener("focusout",l(this,st));const[Z,at]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*at/Z).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Z/at).toFixed(2)}%`);const[_t,vt]=this.getInitialTranslation();return this.translate(_t,vt),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Z){const{isMac:at}=a.FeatureTest.platform;if(Z.button!==0||Z.ctrlKey&&at){Z.preventDefault();return}if(J(this,Tt,!0),this._isDraggable){Y(this,j,l1).call(this,Z);return}Y(this,L,Ku).call(this,Z)}moveInDOM(){l(this,ee)&&clearTimeout(l(this,ee)),J(this,ee,setTimeout(()=>{var Z;J(this,ee,null),(Z=this.parent)==null||Z.moveEditorInDOM(this)},0))}_setParentAndPosition(Z,at,_t){Z.changeParent(this),this.x=at,this.y=_t,this.fixAndSetPosition()}getRect(Z,at,_t=this.rotation){const vt=this.parentScale,[jt,bt]=this.pageDimensions,[q,ot]=this.pageTranslation,ft=Z/vt,Et=at/vt,Kt=this.x*jt,te=this.y*bt,me=this.width*jt,Pe=this.height*bt;switch(_t){case 0:return[Kt+ft+q,bt-te-Et-Pe+ot,Kt+ft+me+q,bt-te-Et+ot];case 90:return[Kt+Et+q,bt-te+ft+ot,Kt+Et+Pe+q,bt-te+ft+me+ot];case 180:return[Kt-ft-me+q,bt-te+Et+ot,Kt-ft+q,bt-te+Et+Pe+ot];case 270:return[Kt-Et-Pe+q,bt-te-ft-me+ot,Kt-Et+q,bt-te-ft+ot];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Z,at){const[_t,vt,jt,bt]=Z,q=jt-_t,ot=bt-vt;switch(this.rotation){case 0:return[_t,at-bt,q,ot];case 90:return[_t,at-vt,ot,q];case 180:return[jt,at-vt,q,ot];case 270:return[jt,at-bt,ot,q];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){J(this,ct,!0)}disableEditMode(){J(this,ct,!1)}isInEditMode(){return l(this,ct)}shouldGetKeyboardEvents(){return l(this,Dt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Z,at;(Z=this.div)==null||Z.addEventListener("focusin",l(this,tt)),(at=this.div)==null||at.addEventListener("focusout",l(this,st))}rotate(Z){}serialize(Z=!1,at=null){(0,a.unreachable)("An editor must be serializable")}static deserialize(Z,at,_t){const vt=new this.prototype.constructor({parent:at,id:at.getNextId(),uiManager:_t});vt.rotation=Z.rotation;const[jt,bt]=vt.pageDimensions,[q,ot,ft,Et]=vt.getRectInCurrentCoords(Z.rect,bt);return vt.x=q/jt,vt.y=ot/bt,vt.width=ft/jt,vt.height=Et/bt,vt}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",l(this,tt)),this.div.removeEventListener("focusout",l(this,st)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,ee)&&(clearTimeout(l(this,ee)),J(this,ee,null)),Y(this,Nt,Ko).call(this),this.removeEditToolbar(),l(this,oe)){for(const Z of l(this,oe).values())clearTimeout(Z);J(this,oe,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,ie,a1).call(this),l(this,F).classList.remove("hidden"),(0,n.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(Z){if(!this.isResizable||Z.target!==this.div||Z.key!=="Enter")return;this._uiManager.setSelected(this),J(this,rt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const at=l(this,F).children;if(!l(this,w)){J(this,w,Array.from(at));const bt=Y(this,W,h1).bind(this),q=Y(this,O,c1).bind(this);for(const ot of l(this,w)){const ft=ot.getAttribute("data-resizer-name");ot.setAttribute("role","spinbutton"),ot.addEventListener("keydown",bt),ot.addEventListener("blur",q),ot.addEventListener("focus",Y(this,et,d1).bind(this,ft)),Pt._l10nPromise.get(`pdfjs-editor-resizer-label-${ft}`).then(Et=>ot.setAttribute("aria-label",Et))}}const _t=l(this,w)[0];let vt=0;for(const bt of at){if(bt===_t)break;vt++}const jt=(360-this.rotation+this.parentRotation)%360/90*(l(this,w).length/4);if(jt!==vt){if(jt<vt)for(let q=0;q<vt-jt;q++)l(this,F).append(l(this,F).firstChild);else if(jt>vt)for(let q=0;q<jt-vt;q++)l(this,F).firstChild.before(l(this,F).lastChild);let bt=0;for(const q of at){const ot=l(this,w)[bt++].getAttribute("data-resizer-name");Pt._l10nPromise.get(`pdfjs-editor-resizer-label-${ot}`).then(ft=>q.setAttribute("aria-label",ft))}}Y(this,pt,Xu).call(this,0),J(this,Dt,!0),l(this,F).firstChild.focus({focusVisible:!0}),Z.preventDefault(),Z.stopImmediatePropagation()}_resizeWithKeyboard(Z,at){!l(this,Dt)||Y(this,D,$u).call(this,l(this,dt),{movementX:Z,movementY:at})}_stopResizingWithKeyboard(){Y(this,Nt,Ko).call(this),this.div.focus()}select(){var Z,at;if(this.makeResizable(),(Z=this.div)==null||Z.classList.add("selectedEditor"),!l(this,wt)){this.addEditToolbar().then(()=>{var _t,vt;(_t=this.div)!=null&&_t.classList.contains("selectedEditor")&&((vt=l(this,wt))==null||vt.show())});return}(at=l(this,wt))==null||at.show()}unselect(){var Z,at,_t,vt;(Z=l(this,F))==null||Z.classList.add("hidden"),(at=this.div)==null||at.classList.remove("selectedEditor"),(_t=this.div)!=null&&_t.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(vt=l(this,wt))==null||vt.hide()}updateParams(Z,at){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,Qt)}set isEditing(Z){J(this,Qt,Z),this.parent&&(Z?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Z,at){J(this,B,!0);const _t=Z/at,{style:vt}=this.div;vt.aspectRatio=_t,vt.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(Z,at=!1){if(at){l(this,oe)||J(this,oe,new Map);const{action:_t}=Z;let vt=l(this,oe).get(_t);vt&&clearTimeout(vt),vt=setTimeout(()=>{this._reportTelemetry(Z),l(this,oe).delete(_t),l(this,oe).size===0&&J(this,oe,null)},Pt._telemetryTimeout),l(this,oe).set(_t,vt);return}Z.type||(Z.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:Z}})}show(Z=this._isVisible){this.div.classList.toggle("hidden",!Z),this._isVisible=Z}enable(){this.div&&(this.div.tabIndex=0),J(this,C,!1)}disable(){this.div&&(this.div.tabIndex=-1),J(this,C,!0)}renderAnnotationElement(Z){let at=Z.container.querySelector(".annotationContent");if(!at)at=document.createElement("div"),at.classList.add("annotationContent",this.editorType),Z.container.prepend(at);else if(at.nodeName==="CANVAS"){const _t=at;at=document.createElement("div"),at.classList.add("annotationContent",this.editorType),_t.before(at)}return at}resetAnnotationElement(Z){const{firstChild:at}=Z.container;at.nodeName==="DIV"&&at.classList.contains("annotationContent")&&at.remove()}};let d=Pt;w=new WeakMap,A=new WeakMap,C=new WeakMap,B=new WeakMap,F=new WeakMap,rt=new WeakMap,tt=new WeakMap,st=new WeakMap,wt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,pe=new WeakMap,Ae=new WeakMap,Ve=new WeakSet,Gu=function([Z,at],_t,vt){[_t,vt]=this.screenToPageTranslation(_t,vt),this.x+=_t/Z,this.y+=vt/at,this.fixAndSetPosition()},lt=new WeakSet,ju=function(Z,at,_t){switch(_t){case 90:return[at,-Z];case 180:return[-Z,-at];case 270:return[-at,Z];default:return[Z,at]}},Wt=new WeakSet,Vu=function(Z){switch(Z){case 90:{const[at,_t]=this.pageDimensions;return[0,-at/_t,_t/at,0]}case 180:return[-1,0,0,-1];case 270:{const[at,_t]=this.pageDimensions;return[0,at/_t,-_t/at,0]}default:return[1,0,0,1]}},ie=new WeakSet,a1=function(){if(l(this,F))return;J(this,F,document.createElement("div")),l(this,F).classList.add("resizers");const Z=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const at of Z){const _t=document.createElement("div");l(this,F).append(_t),_t.classList.add("resizer",at),_t.setAttribute("data-resizer-name",at),_t.addEventListener("pointerdown",Y(this,_e,o1).bind(this,at)),_t.addEventListener("contextmenu",o.noContextMenu),_t.tabIndex=-1}this.div.prepend(l(this,F))},_e=new WeakSet,o1=function(Z,at){var Pe;at.preventDefault();const{isMac:_t}=a.FeatureTest.platform;if(at.button!==0||at.ctrlKey&&_t)return;(Pe=l(this,A))==null||Pe.toggle(!1);const vt=Y(this,D,$u).bind(this,Z),jt=this._isDraggable;this._isDraggable=!1;const bt={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",vt,bt),window.addEventListener("contextmenu",o.noContextMenu);const q=this.x,ot=this.y,ft=this.width,Et=this.height,Kt=this.parent.div.style.cursor,te=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(at.target).cursor;const me=()=>{var Ti;this.parent.togglePointerEvents(!0),(Ti=l(this,A))==null||Ti.toggle(!0),this._isDraggable=jt,window.removeEventListener("pointerup",me),window.removeEventListener("blur",me),window.removeEventListener("pointermove",vt,bt),window.removeEventListener("contextmenu",o.noContextMenu),this.parent.div.style.cursor=Kt,this.div.style.cursor=te,Y(this,T,Wu).call(this,q,ot,ft,Et)};window.addEventListener("pointerup",me),window.addEventListener("blur",me)},T=new WeakSet,Wu=function(Z,at,_t,vt){const jt=this.x,bt=this.y,q=this.width,ot=this.height;jt===Z&&bt===at&&q===_t&&ot===vt||this.addCommands({cmd:()=>{this.width=q,this.height=ot,this.x=jt,this.y=bt;const[ft,Et]=this.parentDimensions;this.setDims(ft*q,Et*ot),this.fixAndSetPosition()},undo:()=>{this.width=_t,this.height=vt,this.x=Z,this.y=at;const[ft,Et]=this.parentDimensions;this.setDims(ft*_t,Et*vt),this.fixAndSetPosition()},mustExec:!0})},D=new WeakSet,$u=function(Z,at){const[_t,vt]=this.parentDimensions,jt=this.x,bt=this.y,q=this.width,ot=this.height,ft=Pt.MIN_SIZE/_t,Et=Pt.MIN_SIZE/vt,Kt=$t=>Math.round($t*1e4)/1e4,te=Y(this,Wt,Vu).call(this,this.rotation),me=($t,ne)=>[te[0]*$t+te[2]*ne,te[1]*$t+te[3]*ne],Pe=Y(this,Wt,Vu).call(this,360-this.rotation),Ti=($t,ne)=>[Pe[0]*$t+Pe[2]*ne,Pe[1]*$t+Pe[3]*ne];let je,hi,ze=!1,vi=!1;switch(Z){case"topLeft":ze=!0,je=($t,ne)=>[0,0],hi=($t,ne)=>[$t,ne];break;case"topMiddle":je=($t,ne)=>[$t/2,0],hi=($t,ne)=>[$t/2,ne];break;case"topRight":ze=!0,je=($t,ne)=>[$t,0],hi=($t,ne)=>[0,ne];break;case"middleRight":vi=!0,je=($t,ne)=>[$t,ne/2],hi=($t,ne)=>[0,ne/2];break;case"bottomRight":ze=!0,je=($t,ne)=>[$t,ne],hi=($t,ne)=>[0,0];break;case"bottomMiddle":je=($t,ne)=>[$t/2,ne],hi=($t,ne)=>[$t/2,0];break;case"bottomLeft":ze=!0,je=($t,ne)=>[0,ne],hi=($t,ne)=>[$t,0];break;case"middleLeft":vi=!0,je=($t,ne)=>[0,ne/2],hi=($t,ne)=>[$t,ne/2];break}const oi=je(q,ot),tr=hi(q,ot);let bi=me(...tr);const Me=Kt(jt+bi[0]),Q=Kt(bt+bi[1]);let K=1,ht=1,[xt,St]=this.screenToPageTranslation(at.movementX,at.movementY);if([xt,St]=Ti(xt/_t,St/vt),ze){const $t=Math.hypot(q,ot);K=ht=Math.max(Math.min(Math.hypot(tr[0]-oi[0]-xt,tr[1]-oi[1]-St)/$t,1/q,1/ot),ft/q,Et/ot)}else vi?K=Math.max(ft,Math.min(1,Math.abs(tr[0]-oi[0]-xt)))/q:ht=Math.max(Et,Math.min(1,Math.abs(tr[1]-oi[1]-St)))/ot;const It=Kt(q*K),Ot=Kt(ot*ht);bi=me(...hi(It,Ot));const ye=Me-bi[0],le=Q-bi[1];this.width=It,this.height=Ot,this.x=ye,this.y=le,this.setDims(_t*It,vt*Ot),this.fixAndSetPosition()},L=new WeakSet,Ku=function(Z){const{isMac:at}=a.FeatureTest.platform;Z.ctrlKey&&!at||Z.shiftKey||Z.metaKey&&at?this.parent.toggleSelected(this):this.parent.setSelected(this)},j=new WeakSet,l1=function(Z){const at=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let _t,vt;at&&(this.div.classList.add("moving"),_t={passive:!0,capture:!0},J(this,zt,Z.clientX),J(this,Jt,Z.clientY),vt=bt=>{const{clientX:q,clientY:ot}=bt,[ft,Et]=this.screenToPageTranslation(q-l(this,zt),ot-l(this,Jt));J(this,zt,q),J(this,Jt,ot),this._uiManager.dragSelectedEditors(ft,Et)},window.addEventListener("pointermove",vt,_t));const jt=()=>{window.removeEventListener("pointerup",jt),window.removeEventListener("blur",jt),at&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",vt,_t)),J(this,Tt,!1),this._uiManager.endDragSession()||Y(this,L,Ku).call(this,Z)};window.addEventListener("pointerup",jt),window.addEventListener("blur",jt)},W=new WeakSet,h1=function(Z){Pt._resizerKeyboardManager.exec(this,Z)},O=new WeakSet,c1=function(Z){var at;l(this,Dt)&&((at=Z.relatedTarget)==null?void 0:at.parentNode)!==l(this,F)&&Y(this,Nt,Ko).call(this)},et=new WeakSet,d1=function(Z){J(this,dt,l(this,Dt)?Z:"")},pt=new WeakSet,Xu=function(Z){if(l(this,w))for(const at of l(this,w))at.tabIndex=Z},Nt=new WeakSet,Ko=function(){if(J(this,Dt,!1),Y(this,pt,Xu).call(this,-1),l(this,rt)){const{savedX:Z,savedY:at,savedWidth:_t,savedHeight:vt}=l(this,rt);Y(this,T,Wu).call(this,Z,at,_t,vt),J(this,rt,null)}},N(d,lt),ti(d,"_borderLineWidth",-1),ti(d,"_colorManager",new n.ColorManager),ti(d,"_zIndex",1),ti(d,"_telemetryTimeout",1e3);class f extends d{constructor(Z){super(Z),this.annotationElementId=Z.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(r,t,s)=>{var f,m,S,_,u1,b,hc,E,f1,R,g1,w,Yu,C,B,F,rt,tt,st,wt,dt,Tt,Lt,Qt,ct,Dt,ee,zt,Jt,oe,pe,Ae,qu,lt,Ft,Wt,ve,ie,xe,_e,ut,Xo,M,Yo,H,p1;s.d(t,{FreeOutliner:()=>u,Outliner:()=>a});var n=s(292);class a{constructor(j,G=0,W=0,U=!0){N(this,_);N(this,b);N(this,E);N(this,R);N(this,w);N(this,f,void 0);N(this,m,[]);N(this,S,[]);let O=1/0,z=-1/0,et=1/0,nt=-1/0;const pt=10**-4;for(const{x:at,y:_t,width:vt,height:jt}of j){const bt=Math.floor((at-G)/pt)*pt,q=Math.ceil((at+vt+G)/pt)*pt,ot=Math.floor((_t-G)/pt)*pt,ft=Math.ceil((_t+jt+G)/pt)*pt,Et=[bt,ot,ft,!0],Kt=[q,ot,ft,!1];l(this,m).push(Et,Kt),O=Math.min(O,bt),z=Math.max(z,q),et=Math.min(et,ot),nt=Math.max(nt,ft)}const yt=z-O+2*W,Nt=nt-et+2*W,Ht=O-W,Pt=et-W,Bt=l(this,m).at(U?-1:-2),Z=[Bt[0],Bt[2]];for(const at of l(this,m)){const[_t,vt,jt]=at;at[0]=(_t-Ht)/yt,at[1]=(vt-Pt)/Nt,at[2]=(jt-Pt)/Nt}J(this,f,{x:Ht,y:Pt,width:yt,height:Nt,lastPoint:Z})}getOutlines(){l(this,m).sort((G,W)=>G[0]-W[0]||G[1]-W[1]||G[2]-W[2]);const j=[];for(const G of l(this,m))G[3]?(j.push(...Y(this,w,Yu).call(this,G)),Y(this,E,f1).call(this,G)):(Y(this,R,g1).call(this,G),j.push(...Y(this,w,Yu).call(this,G)));return Y(this,_,u1).call(this,j)}}f=new WeakMap,m=new WeakMap,S=new WeakMap,_=new WeakSet,u1=function(j){const G=[],W=new Set;for(const z of j){const[et,nt,pt]=z;G.push([et,nt,z],[et,pt,z])}G.sort((z,et)=>z[1]-et[1]||z[0]-et[0]);for(let z=0,et=G.length;z<et;z+=2){const nt=G[z][2],pt=G[z+1][2];nt.push(pt),pt.push(nt),W.add(nt),W.add(pt)}const U=[];let O;for(;W.size>0;){const z=W.values().next().value;let[et,nt,pt,yt,Nt]=z;W.delete(z);let Ht=et,Pt=nt;for(O=[et,pt],U.push(O);;){let Bt;if(W.has(yt))Bt=yt;else if(W.has(Nt))Bt=Nt;else break;W.delete(Bt),[et,nt,pt,yt,Nt]=Bt,Ht!==et&&(O.push(Ht,Pt,et,Pt===nt?nt:pt),Ht=et),Pt=Pt===nt?pt:nt}O.push(Ht,Pt)}return new c(U,l(this,f))},b=new WeakSet,hc=function(j){const G=l(this,S);let W=0,U=G.length-1;for(;W<=U;){const O=W+U>>1,z=G[O][0];if(z===j)return O;z<j?W=O+1:U=O-1}return U+1},E=new WeakSet,f1=function([,j,G]){const W=Y(this,b,hc).call(this,j);l(this,S).splice(W,0,[j,G])},R=new WeakSet,g1=function([,j,G]){const W=Y(this,b,hc).call(this,j);for(let U=W;U<l(this,S).length;U++){const[O,z]=l(this,S)[U];if(O!==j)break;if(O===j&&z===G){l(this,S).splice(U,1);return}}for(let U=W-1;U>=0;U--){const[O,z]=l(this,S)[U];if(O!==j)break;if(O===j&&z===G){l(this,S).splice(U,1);return}}},w=new WeakSet,Yu=function(j){const[G,W,U]=j,O=[[G,W,U]],z=Y(this,b,hc).call(this,U);for(let et=0;et<z;et++){const[nt,pt]=l(this,S)[et];for(let yt=0,Nt=O.length;yt<Nt;yt++){const[,Ht,Pt]=O[yt];if(!(pt<=Ht||Pt<=nt)){if(Ht>=nt){if(Pt>pt)O[yt][1]=pt;else{if(Nt===1)return[];O.splice(yt,1),yt--,Nt--}continue}O[yt][2]=nt,Pt>pt&&O.push([G,pt,Pt])}}}return O};class o{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(j,G){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof d}}class c extends o{constructor(G,W){super();N(this,C,void 0);N(this,B,void 0);J(this,B,G),J(this,C,W)}toSVGPath(){const G=[];for(const W of l(this,B)){let[U,O]=W;G.push(`M${U} ${O}`);for(let z=2;z<W.length;z+=2){const et=W[z],nt=W[z+1];et===U?(G.push(`V${nt}`),O=nt):nt===O&&(G.push(`H${et}`),U=et)}G.push("Z")}return G.join(" ")}serialize([G,W,U,O],z){const et=[],nt=U-G,pt=O-W;for(const yt of l(this,B)){const Nt=new Array(yt.length);for(let Ht=0;Ht<yt.length;Ht+=2)Nt[Ht]=G+yt[Ht]*nt,Nt[Ht+1]=O-yt[Ht+1]*pt;et.push(Nt)}return et}get box(){return l(this,C)}}C=new WeakMap,B=new WeakMap;const Gt=class{constructor({x:j,y:G},W,U,O,z,et=0){N(this,Ae);N(this,F,void 0);N(this,rt,[]);N(this,tt,void 0);N(this,st,void 0);N(this,wt,[]);N(this,dt,new Float64Array(18));N(this,Tt,void 0);N(this,Lt,void 0);N(this,Qt,void 0);N(this,ct,void 0);N(this,Dt,void 0);N(this,ee,void 0);N(this,zt,[]);J(this,F,W),J(this,ee,O*U),J(this,st,z),l(this,dt).set([NaN,NaN,NaN,NaN,j,G],6),J(this,tt,et),J(this,ct,l(Gt,Jt)*U),J(this,Qt,l(Gt,pe)*U),J(this,Dt,U),l(this,zt).push(j,G)}get free(){return!0}isEmpty(){return isNaN(l(this,dt)[8])}add({x:j,y:G}){var Et;J(this,Tt,j),J(this,Lt,G);const[W,U,O,z]=l(this,F);let[et,nt,pt,yt]=l(this,dt).subarray(8,12);const Nt=j-pt,Ht=G-yt,Pt=Math.hypot(Nt,Ht);if(Pt<l(this,Qt))return!1;const Bt=Pt-l(this,ct),Z=Bt/Pt,at=Z*Nt,_t=Z*Ht;let vt=et,jt=nt;et=pt,nt=yt,pt+=at,yt+=_t,(Et=l(this,zt))==null||Et.push(j,G);const bt=-_t/Bt,q=at/Bt,ot=bt*l(this,ee),ft=q*l(this,ee);return l(this,dt).set(l(this,dt).subarray(2,8),0),l(this,dt).set([pt+ot,yt+ft],4),l(this,dt).set(l(this,dt).subarray(14,18),12),l(this,dt).set([pt-ot,yt-ft],16),isNaN(l(this,dt)[6])?(l(this,wt).length===0&&(l(this,dt).set([et+ot,nt+ft],2),l(this,wt).push(NaN,NaN,NaN,NaN,(et+ot-W)/O,(nt+ft-U)/z),l(this,dt).set([et-ot,nt-ft],14),l(this,rt).push(NaN,NaN,NaN,NaN,(et-ot-W)/O,(nt-ft-U)/z)),l(this,dt).set([vt,jt,et,nt,pt,yt],6),!this.isEmpty()):(l(this,dt).set([vt,jt,et,nt,pt,yt],6),Math.abs(Math.atan2(jt-nt,vt-et)-Math.atan2(_t,at))<Math.PI/2?([et,nt,pt,yt]=l(this,dt).subarray(2,6),l(this,wt).push(NaN,NaN,NaN,NaN,((et+pt)/2-W)/O,((nt+yt)/2-U)/z),[et,nt,vt,jt]=l(this,dt).subarray(14,18),l(this,rt).push(NaN,NaN,NaN,NaN,((vt+et)/2-W)/O,((jt+nt)/2-U)/z),!0):([vt,jt,et,nt,pt,yt]=l(this,dt).subarray(0,6),l(this,wt).push(((vt+5*et)/6-W)/O,((jt+5*nt)/6-U)/z,((5*et+pt)/6-W)/O,((5*nt+yt)/6-U)/z,((et+pt)/2-W)/O,((nt+yt)/2-U)/z),[pt,yt,et,nt,vt,jt]=l(this,dt).subarray(12,18),l(this,rt).push(((vt+5*et)/6-W)/O,((jt+5*nt)/6-U)/z,((5*et+pt)/6-W)/O,((5*nt+yt)/6-U)/z,((et+pt)/2-W)/O,((nt+yt)/2-U)/z),!0))}toSVGPath(){if(this.isEmpty())return"";const j=l(this,wt),G=l(this,rt),W=l(this,dt).subarray(4,6),U=l(this,dt).subarray(16,18),[O,z,et,nt]=l(this,F),[pt,yt,Nt,Ht]=Y(this,Ae,qu).call(this);if(isNaN(l(this,dt)[6])&&!this.isEmpty())return`M${(l(this,dt)[2]-O)/et} ${(l(this,dt)[3]-z)/nt} L${(l(this,dt)[4]-O)/et} ${(l(this,dt)[5]-z)/nt} L${pt} ${yt} L${Nt} ${Ht} L${(l(this,dt)[16]-O)/et} ${(l(this,dt)[17]-z)/nt} L${(l(this,dt)[14]-O)/et} ${(l(this,dt)[15]-z)/nt} Z`;const Pt=[];Pt.push(`M${j[4]} ${j[5]}`);for(let Bt=6;Bt<j.length;Bt+=6)isNaN(j[Bt])?Pt.push(`L${j[Bt+4]} ${j[Bt+5]}`):Pt.push(`C${j[Bt]} ${j[Bt+1]} ${j[Bt+2]} ${j[Bt+3]} ${j[Bt+4]} ${j[Bt+5]}`);Pt.push(`L${(W[0]-O)/et} ${(W[1]-z)/nt} L${pt} ${yt} L${Nt} ${Ht} L${(U[0]-O)/et} ${(U[1]-z)/nt}`);for(let Bt=G.length-6;Bt>=6;Bt-=6)isNaN(G[Bt])?Pt.push(`L${G[Bt+4]} ${G[Bt+5]}`):Pt.push(`C${G[Bt]} ${G[Bt+1]} ${G[Bt+2]} ${G[Bt+3]} ${G[Bt+4]} ${G[Bt+5]}`);return Pt.push(`L${G[4]} ${G[5]} Z`),Pt.join(" ")}getOutlines(){var _t;const j=l(this,wt),G=l(this,rt),W=l(this,dt),U=W.subarray(4,6),O=W.subarray(16,18),[z,et,nt,pt]=l(this,F),yt=new Float64Array((((_t=l(this,zt))==null?void 0:_t.length)??0)+2);for(let vt=0,jt=yt.length-2;vt<jt;vt+=2)yt[vt]=(l(this,zt)[vt]-z)/nt,yt[vt+1]=(l(this,zt)[vt+1]-et)/pt;yt[yt.length-2]=(l(this,Tt)-z)/nt,yt[yt.length-1]=(l(this,Lt)-et)/pt;const[Nt,Ht,Pt,Bt]=Y(this,Ae,qu).call(this);if(isNaN(W[6])&&!this.isEmpty()){const vt=new Float64Array(36);return vt.set([NaN,NaN,NaN,NaN,(W[2]-z)/nt,(W[3]-et)/pt,NaN,NaN,NaN,NaN,(W[4]-z)/nt,(W[5]-et)/pt,NaN,NaN,NaN,NaN,Nt,Ht,NaN,NaN,NaN,NaN,Pt,Bt,NaN,NaN,NaN,NaN,(W[16]-z)/nt,(W[17]-et)/pt,NaN,NaN,NaN,NaN,(W[14]-z)/nt,(W[15]-et)/pt],0),new d(vt,yt,l(this,F),l(this,Dt),l(this,tt),l(this,st))}const Z=new Float64Array(l(this,wt).length+24+l(this,rt).length);let at=j.length;for(let vt=0;vt<at;vt+=2){if(isNaN(j[vt])){Z[vt]=Z[vt+1]=NaN;continue}Z[vt]=j[vt],Z[vt+1]=j[vt+1]}Z.set([NaN,NaN,NaN,NaN,(U[0]-z)/nt,(U[1]-et)/pt,NaN,NaN,NaN,NaN,Nt,Ht,NaN,NaN,NaN,NaN,Pt,Bt,NaN,NaN,NaN,NaN,(O[0]-z)/nt,(O[1]-et)/pt],at),at+=24;for(let vt=G.length-6;vt>=6;vt-=6)for(let jt=0;jt<6;jt+=2){if(isNaN(G[vt+jt])){Z[at]=Z[at+1]=NaN,at+=2;continue}Z[at]=G[vt+jt],Z[at+1]=G[vt+jt+1],at+=2}return Z.set([NaN,NaN,NaN,NaN,G[4],G[5]],at),new d(Z,yt,l(this,F),l(this,Dt),l(this,tt),l(this,st))}};let u=Gt;F=new WeakMap,rt=new WeakMap,tt=new WeakMap,st=new WeakMap,wt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,pe=new WeakMap,Ae=new WeakSet,qu=function(){const j=l(this,dt).subarray(4,6),G=l(this,dt).subarray(16,18),[W,U,O,z]=l(this,F);return[(l(this,Tt)+(j[0]-G[0])/2-W)/O,(l(this,Lt)+(j[1]-G[1])/2-U)/z,(l(this,Tt)+(G[0]-j[0])/2-W)/O,(l(this,Lt)+(G[1]-j[1])/2-U)/z]},N(u,Jt,8),N(u,oe,2),N(u,pe,l(Gt,Jt)+l(Gt,oe));class d extends o{constructor(G,W,U,O,z,et){super();N(this,ut);N(this,M);N(this,H);N(this,lt,void 0);N(this,Ft,null);N(this,Wt,void 0);N(this,ve,void 0);N(this,ie,void 0);N(this,xe,void 0);N(this,_e,void 0);J(this,_e,G),J(this,ie,W),J(this,lt,U),J(this,xe,O),J(this,Wt,z),J(this,ve,et),Y(this,H,p1).call(this,et);const{x:nt,y:pt,width:yt,height:Nt}=l(this,Ft);for(let Ht=0,Pt=G.length;Ht<Pt;Ht+=2)G[Ht]=(G[Ht]-nt)/yt,G[Ht+1]=(G[Ht+1]-pt)/Nt;for(let Ht=0,Pt=W.length;Ht<Pt;Ht+=2)W[Ht]=(W[Ht]-nt)/yt,W[Ht+1]=(W[Ht+1]-pt)/Nt}toSVGPath(){const G=[`M${l(this,_e)[4]} ${l(this,_e)[5]}`];for(let W=6,U=l(this,_e).length;W<U;W+=6){if(isNaN(l(this,_e)[W])){G.push(`L${l(this,_e)[W+4]} ${l(this,_e)[W+5]}`);continue}G.push(`C${l(this,_e)[W]} ${l(this,_e)[W+1]} ${l(this,_e)[W+2]} ${l(this,_e)[W+3]} ${l(this,_e)[W+4]} ${l(this,_e)[W+5]}`)}return G.push("Z"),G.join(" ")}serialize([G,W,U,O],z){const et=U-G,nt=O-W;let pt,yt;switch(z){case 0:pt=Y(this,ut,Xo).call(this,l(this,_e),G,O,et,-nt),yt=Y(this,ut,Xo).call(this,l(this,ie),G,O,et,-nt);break;case 90:pt=Y(this,M,Yo).call(this,l(this,_e),G,W,et,nt),yt=Y(this,M,Yo).call(this,l(this,ie),G,W,et,nt);break;case 180:pt=Y(this,ut,Xo).call(this,l(this,_e),U,W,-et,nt),yt=Y(this,ut,Xo).call(this,l(this,ie),U,W,-et,nt);break;case 270:pt=Y(this,M,Yo).call(this,l(this,_e),U,O,-et,-nt),yt=Y(this,M,Yo).call(this,l(this,ie),U,O,-et,-nt);break}return{outline:Array.from(pt),points:[Array.from(yt)]}}get box(){return l(this,Ft)}getNewOutline(G,W){const{x:U,y:O,width:z,height:et}=l(this,Ft),[nt,pt,yt,Nt]=l(this,lt),Ht=z*yt,Pt=et*Nt,Bt=U*yt+nt,Z=O*Nt+pt,at=new u({x:l(this,ie)[0]*Ht+Bt,y:l(this,ie)[1]*Pt+Z},l(this,lt),l(this,xe),G,l(this,ve),W??l(this,Wt));for(let _t=2;_t<l(this,ie).length;_t+=2)at.add({x:l(this,ie)[_t]*Ht+Bt,y:l(this,ie)[_t+1]*Pt+Z});return at.getOutlines()}}lt=new WeakMap,Ft=new WeakMap,Wt=new WeakMap,ve=new WeakMap,ie=new WeakMap,xe=new WeakMap,_e=new WeakMap,ut=new WeakSet,Xo=function(G,W,U,O,z){const et=new Float64Array(G.length);for(let nt=0,pt=G.length;nt<pt;nt+=2)et[nt]=W+G[nt]*O,et[nt+1]=U+G[nt+1]*z;return et},M=new WeakSet,Yo=function(G,W,U,O,z){const et=new Float64Array(G.length);for(let nt=0,pt=G.length;nt<pt;nt+=2)et[nt]=W+G[nt+1]*O,et[nt+1]=U+G[nt]*z;return et},H=new WeakSet,p1=function(G){const W=l(this,_e);let U=W[4],O=W[5],z=U,et=O,nt=U,pt=O,yt=U,Nt=O;const Ht=G?Math.max:Math.min;for(let _t=6,vt=W.length;_t<vt;_t+=6){if(isNaN(W[_t]))z=Math.min(z,W[_t+4]),et=Math.min(et,W[_t+5]),nt=Math.max(nt,W[_t+4]),pt=Math.max(pt,W[_t+5]),Nt<W[_t+5]?(yt=W[_t+4],Nt=W[_t+5]):Nt===W[_t+5]&&(yt=Ht(yt,W[_t+4]));else{const jt=n.Util.bezierBoundingBox(U,O,...W.slice(_t,_t+6));z=Math.min(z,jt[0]),et=Math.min(et,jt[1]),nt=Math.max(nt,jt[2]),pt=Math.max(pt,jt[3]),Nt<jt[3]?(yt=jt[2],Nt=jt[3]):Nt===jt[3]&&(yt=Ht(yt,jt[2]))}U=W[_t+4],O=W[_t+5]}const Pt=z-l(this,Wt),Bt=et-l(this,Wt),Z=nt-z+2*l(this,Wt),at=pt-et+2*l(this,Wt);J(this,Ft,{x:Pt,y:Bt,width:Z,height:at,lastPoint:[yt,Nt]})}},362:(r,t,s)=>{var c,u,d,f,m,m1,_,v1,b,y1,E,cc,R,b1,w,Qu,B,F,rt,tt,_1,wt,x1,Tt,w1;s.d(t,{EditorToolbar:()=>a,HighlightToolbar:()=>o});var n=s(419);const C=class{constructor(ct){N(this,_);N(this,b);N(this,E);N(this,R);N(this,w);N(this,c,null);N(this,u,null);N(this,d,void 0);N(this,f,null);J(this,d,ct)}render(){const ct=J(this,c,document.createElement("div"));ct.className="editToolbar",ct.setAttribute("role","toolbar"),ct.addEventListener("contextmenu",n.noContextMenu),ct.addEventListener("pointerdown",Y(C,m,m1));const Dt=J(this,f,document.createElement("div"));Dt.className="buttons",ct.append(Dt);const ee=l(this,d).toolbarPosition;if(ee){const{style:zt}=ct,Jt=l(this,d)._uiManager.direction==="ltr"?1-ee[0]:ee[0];zt.insetInlineEnd=`${100*Jt}%`,zt.top=`calc(${100*ee[1]}% + var(--editor-toolbar-vert-offset))`}return Y(this,R,b1).call(this),ct}hide(){var ct;l(this,c).classList.add("hidden"),(ct=l(this,u))==null||ct.hideDropdown()}show(){l(this,c).classList.remove("hidden")}addAltTextButton(ct){Y(this,E,cc).call(this,ct),l(this,f).prepend(ct,l(this,w,Qu))}addColorPicker(ct){J(this,u,ct);const Dt=ct.renderButton();Y(this,E,cc).call(this,Dt),l(this,f).prepend(Dt,l(this,w,Qu))}remove(){var ct;l(this,c).remove(),(ct=l(this,u))==null||ct.destroy(),J(this,u,null)}};let a=C;c=new WeakMap,u=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakSet,m1=function(ct){ct.stopPropagation()},_=new WeakSet,v1=function(ct){l(this,d)._focusEventsAllowed=!1,ct.preventDefault(),ct.stopPropagation()},b=new WeakSet,y1=function(ct){l(this,d)._focusEventsAllowed=!0,ct.preventDefault(),ct.stopPropagation()},E=new WeakSet,cc=function(ct){ct.addEventListener("focusin",Y(this,_,v1).bind(this),{capture:!0}),ct.addEventListener("focusout",Y(this,b,y1).bind(this),{capture:!0}),ct.addEventListener("contextmenu",n.noContextMenu)},R=new WeakSet,b1=function(){const ct=document.createElement("button");ct.className="delete",ct.tabIndex=0,ct.setAttribute("data-l10n-id",`pdfjs-editor-remove-${l(this,d).editorType}-button`),Y(this,E,cc).call(this,ct),ct.addEventListener("click",Dt=>{l(this,d)._uiManager.delete()}),l(this,f).append(ct)},w=new WeakSet,Qu=function(){const ct=document.createElement("div");return ct.className="divider",ct},N(a,m);class o{constructor(ct){N(this,tt);N(this,wt);N(this,Tt);N(this,B,null);N(this,F,null);N(this,rt,void 0);J(this,rt,ct)}show(ct,Dt,ee){const[zt,Jt]=Y(this,wt,x1).call(this,Dt,ee),{style:oe}=l(this,F)||J(this,F,Y(this,tt,_1).call(this));ct.append(l(this,F)),oe.insetInlineEnd=`${100*zt}%`,oe.top=`calc(${100*Jt}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,F).remove()}}B=new WeakMap,F=new WeakMap,rt=new WeakMap,tt=new WeakSet,_1=function(){const ct=J(this,F,document.createElement("div"));ct.className="editToolbar",ct.setAttribute("role","toolbar"),ct.addEventListener("contextmenu",n.noContextMenu);const Dt=J(this,B,document.createElement("div"));return Dt.className="buttons",ct.append(Dt),Y(this,Tt,w1).call(this),ct},wt=new WeakSet,x1=function(ct,Dt){let ee=0,zt=0;for(const Jt of ct){const oe=Jt.y+Jt.height;if(oe<ee)continue;const pe=Jt.x+(Dt?Jt.width:0);if(oe>ee){zt=pe,ee=oe;continue}Dt?pe>zt&&(zt=pe):pe<zt&&(zt=pe)}return[Dt?1-zt:zt,ee]},Tt=new WeakSet,w1=function(){const ct=document.createElement("button");ct.className="highlightButton",ct.tabIndex=0,ct.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const Dt=document.createElement("span");ct.append(Dt),Dt.className="visuallyHidden",Dt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),ct.addEventListener("contextmenu",n.noContextMenu),ct.addEventListener("click",()=>{l(this,rt).highlightSelection("floating_button")}),l(this,B).append(ct)}},830:(r,t,s)=>{var b,x,E,I,R,Zu,A,C,B,F,rt,A1,wt,dt,Tt,Lt,Qt,ct,Dt,ee,zt,Jt,oe,pe,Ae,Ve,Gt,lt,Ft,Wt,ve,ie,xe,_e,ut,T,M,D,H,L,V,j,G,W,U,O,z,et,nt,pt,yt,Nt,Ht,Pt,Bt,Z,at,_t,vt,dc,bt,S1,ot,E1,Et,uc,te,C1,Pe,k1,je,T1,ze,Ju,oi,tf,bi,ef,Q,rf,ht,nf,St,Yr,Ot,Ks,le,P1,ne,M1,he,sf,we,R1,Ue,qo,ei,af;s.d(t,{AnnotationEditorUIManager:()=>y,ColorManager:()=>_,KeyboardManager:()=>S,bindEvents:()=>c,opacityToHex:()=>u});var n=s(292),a=s(419),o=s(362);function c(qe,$,At){for(const Zt of At)$.addEventListener(Zt,qe[Zt].bind(qe))}function u(qe){return Math.round(Math.min(255,Math.max(1,255*qe))).toString(16).padStart(2,"0")}class d{constructor(){N(this,b,0)}get id(){return`${n.AnnotationEditorPrefix}${xs(this,b)._++}`}}b=new WeakMap;const w=class{constructor(){N(this,R);N(this,x,(0,n.getUuid)());N(this,E,0);N(this,I,null)}static get _isSVGFittingCanvas(){const $='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',At=new OffscreenCanvas(1,3).getContext("2d"),Zt=new Image;Zt.src=$;const ae=Zt.decode().then(()=>(At.drawImage(Zt,0,0,1,1,0,0,1,3),new Uint32Array(At.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",ae)}async getFromFile($){const{lastModified:At,name:Zt,size:ae,type:de}=$;return Y(this,R,Zu).call(this,`${At}_${Zt}_${ae}_${de}`,$)}async getFromUrl($){return Y(this,R,Zu).call(this,$,$)}async getFromId($){l(this,I)||J(this,I,new Map);const At=l(this,I).get($);return At?At.bitmap?(At.refCounter+=1,At):At.file?this.getFromFile(At.file):this.getFromUrl(At.url):null}getSvgUrl($){const At=l(this,I).get($);return At!=null&&At.isSvg?At.svgUrl:null}deleteId($){l(this,I)||J(this,I,new Map);const At=l(this,I).get($);!At||(At.refCounter-=1,At.refCounter===0&&(At.bitmap=null))}isValidId($){return $.startsWith(`image_${l(this,x)}_`)}};let f=w;x=new WeakMap,E=new WeakMap,I=new WeakMap,R=new WeakSet,Zu=async function($,At){l(this,I)||J(this,I,new Map);let Zt=l(this,I).get($);if(Zt===null)return null;if(Zt!=null&&Zt.bitmap)return Zt.refCounter+=1,Zt;try{Zt||(Zt={bitmap:null,id:`image_${l(this,x)}_${xs(this,E)._++}`,refCounter:0,isSvg:!1});let ae;if(typeof At=="string"?(Zt.url=At,ae=await(0,a.fetchData)(At,"blob")):ae=Zt.file=At,ae.type==="image/svg+xml"){const de=w._isSVGFittingCanvas,Ce=new FileReader,Se=new Image,ri=new Promise((ci,mr)=>{Se.onload=()=>{Zt.bitmap=Se,Zt.isSvg=!0,ci()},Ce.onload=async()=>{const Hi=Zt.svgUrl=Ce.result;Se.src=await de?`${Hi}#svgView(preserveAspectRatio(none))`:Hi},Se.onerror=Ce.onerror=mr});Ce.readAsDataURL(ae),await ri}else Zt.bitmap=await createImageBitmap(ae);Zt.refCounter=1}catch(ae){console.error(ae),Zt=null}return l(this,I).set($,Zt),Zt&&l(this,I).set(Zt.id,Zt),Zt};class m{constructor($=128){N(this,A,[]);N(this,C,!1);N(this,B,void 0);N(this,F,-1);J(this,B,$)}add({cmd:$,undo:At,post:Zt,mustExec:ae,type:de=NaN,overwriteIfSameType:Ce=!1,keepUndo:Se=!1}){if(ae&&$(),l(this,C))return;const ri={cmd:$,undo:At,post:Zt,type:de};if(l(this,F)===-1){l(this,A).length>0&&(l(this,A).length=0),J(this,F,0),l(this,A).push(ri);return}if(Ce&&l(this,A)[l(this,F)].type===de){Se&&(ri.undo=l(this,A)[l(this,F)].undo),l(this,A)[l(this,F)]=ri;return}const ci=l(this,F)+1;ci===l(this,B)?l(this,A).splice(0,1):(J(this,F,ci),ci<l(this,A).length&&l(this,A).splice(ci)),l(this,A).push(ri)}undo(){if(l(this,F)===-1)return;J(this,C,!0);const{undo:$,post:At}=l(this,A)[l(this,F)];$(),At==null||At(),J(this,C,!1),J(this,F,l(this,F)-1)}redo(){if(l(this,F)<l(this,A).length-1){J(this,F,l(this,F)+1),J(this,C,!0);const{cmd:$,post:At}=l(this,A)[l(this,F)];$(),At==null||At(),J(this,C,!1)}}hasSomethingToUndo(){return l(this,F)!==-1}hasSomethingToRedo(){return l(this,F)<l(this,A).length-1}destroy(){J(this,A,null)}}A=new WeakMap,C=new WeakMap,B=new WeakMap,F=new WeakMap;class S{constructor($){N(this,rt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:At}=n.FeatureTest.platform;for(const[Zt,ae,de={}]of $)for(const Ce of Zt){const Se=Ce.startsWith("mac+");At&&Se?(this.callbacks.set(Ce.slice(4),{callback:ae,options:de}),this.allKeys.add(Ce.split("+").at(-1))):!At&&!Se&&(this.callbacks.set(Ce,{callback:ae,options:de}),this.allKeys.add(Ce.split("+").at(-1)))}}exec($,At){if(!this.allKeys.has(At.key))return;const Zt=this.callbacks.get(Y(this,rt,A1).call(this,At));if(!Zt)return;const{callback:ae,options:{bubbles:de=!1,args:Ce=[],checker:Se=null}}=Zt;Se&&!Se($,At)||(ae.bind($,...Ce,At)(),de||(At.stopPropagation(),At.preventDefault()))}}rt=new WeakSet,A1=function($){$.altKey&&this.buffer.push("alt"),$.ctrlKey&&this.buffer.push("ctrl"),$.metaKey&&this.buffer.push("meta"),$.shiftKey&&this.buffer.push("shift"),this.buffer.push($.key);const At=this.buffer.join("+");return this.buffer.length=0,At};const st=class{get _colors(){const $=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)($),(0,n.shadow)(this,"_colors",$)}convert($){const At=(0,a.getRGB)($);if(!window.matchMedia("(forced-colors: active)").matches)return At;for(const[Zt,ae]of this._colors)if(ae.every((de,Ce)=>de===At[Ce]))return st._colorsMapping.get(Zt);return At}getHexCode($){const At=this._colors.get($);return At?n.Util.makeHexColor(...At):$}};let _=st;ti(_,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));const zi=class{constructor($,At,Zt,ae,de,Ce,Se,ri,ci){N(this,vt);N(this,bt);N(this,ot);N(this,Et);N(this,te);N(this,Pe);N(this,je);N(this,ze);N(this,oi);N(this,bi);N(this,Q);N(this,ht);N(this,St);N(this,Ot);N(this,le);N(this,ne);N(this,he);N(this,we);N(this,Ue);N(this,ei);N(this,wt,null);N(this,dt,new Map);N(this,Tt,new Map);N(this,Lt,null);N(this,Qt,null);N(this,ct,null);N(this,Dt,new m);N(this,ee,0);N(this,zt,new Set);N(this,Jt,null);N(this,oe,null);N(this,pe,new Set);N(this,Ae,!1);N(this,Ve,null);N(this,Gt,null);N(this,lt,null);N(this,Ft,!1);N(this,Wt,null);N(this,ve,new d);N(this,ie,!1);N(this,xe,!1);N(this,_e,null);N(this,ut,null);N(this,T,null);N(this,M,n.AnnotationEditorType.NONE);N(this,D,new Set);N(this,H,null);N(this,L,null);N(this,V,null);N(this,j,this.blur.bind(this));N(this,G,this.focus.bind(this));N(this,W,this.copy.bind(this));N(this,U,this.cut.bind(this));N(this,O,this.paste.bind(this));N(this,z,this.keydown.bind(this));N(this,et,this.keyup.bind(this));N(this,nt,this.onEditingAction.bind(this));N(this,pt,this.onPageChanging.bind(this));N(this,yt,this.onScaleChanging.bind(this));N(this,Nt,Y(this,ot,E1).bind(this));N(this,Ht,this.onRotationChanging.bind(this));N(this,Pt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});N(this,Bt,[0,0]);N(this,Z,null);N(this,at,null);N(this,_t,null);J(this,at,$),J(this,_t,At),J(this,Lt,Zt),this._eventBus=ae,this._eventBus._on("editingaction",l(this,nt)),this._eventBus._on("pagechanging",l(this,pt)),this._eventBus._on("scalechanging",l(this,yt)),this._eventBus._on("rotationchanging",l(this,Ht)),Y(this,te,C1).call(this),Y(this,oi,tf).call(this),J(this,Qt,de.annotationStorage),J(this,Ve,de.filterFactory),J(this,L,Ce),J(this,lt,Se||null),J(this,Ae,ri),J(this,T,ci||null),this.viewParameters={realScale:a.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const $=zi.prototype,At=Ce=>l(Ce,at).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Ce.hasSomethingToControl(),Zt=(Ce,{target:Se})=>{if(Se instanceof HTMLInputElement){const{type:ri}=Se;return ri!=="text"&&ri!=="number"}return!0},ae=this.TRANSLATE_SMALL,de=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new S([[["ctrl+a","mac+meta+a"],$.selectAll,{checker:Zt}],[["ctrl+z","mac+meta+z"],$.undo,{checker:Zt}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],$.redo,{checker:Zt}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],$.delete,{checker:Zt}],[["Enter","mac+Enter"],$.addNewEditorFromKeyboard,{checker:(Ce,{target:Se})=>!(Se instanceof HTMLButtonElement)&&l(Ce,at).contains(Se)&&!Ce.isEnterHandled}],[[" ","mac+ "],$.addNewEditorFromKeyboard,{checker:(Ce,{target:Se})=>!(Se instanceof HTMLButtonElement)&&l(Ce,at).contains(document.activeElement)}],[["Escape","mac+Escape"],$.unselectAll],[["ArrowLeft","mac+ArrowLeft"],$.translateSelectedEditors,{args:[-ae,0],checker:At}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],$.translateSelectedEditors,{args:[-de,0],checker:At}],[["ArrowRight","mac+ArrowRight"],$.translateSelectedEditors,{args:[ae,0],checker:At}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],$.translateSelectedEditors,{args:[de,0],checker:At}],[["ArrowUp","mac+ArrowUp"],$.translateSelectedEditors,{args:[0,-ae],checker:At}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],$.translateSelectedEditors,{args:[0,-de],checker:At}],[["ArrowDown","mac+ArrowDown"],$.translateSelectedEditors,{args:[0,ae],checker:At}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],$.translateSelectedEditors,{args:[0,de],checker:At}]]))}destroy(){var $,At;Y(this,bi,ef).call(this),Y(this,ze,Ju).call(this),this._eventBus._off("editingaction",l(this,nt)),this._eventBus._off("pagechanging",l(this,pt)),this._eventBus._off("scalechanging",l(this,yt)),this._eventBus._off("rotationchanging",l(this,Ht));for(const Zt of l(this,Tt).values())Zt.destroy();l(this,Tt).clear(),l(this,dt).clear(),l(this,pe).clear(),J(this,wt,null),l(this,D).clear(),l(this,Dt).destroy(),($=l(this,Lt))==null||$.destroy(),(At=l(this,Wt))==null||At.hide(),J(this,Wt,null),l(this,Gt)&&(clearTimeout(l(this,Gt)),J(this,Gt,null)),l(this,Z)&&(clearTimeout(l(this,Z)),J(this,Z,null)),Y(this,Pe,k1).call(this)}async mlGuess($){var At;return((At=l(this,T))==null?void 0:At.guess($))||null}get hasMLManager(){return!!l(this,T)}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",l(this,L)?l(this,Ve).addHCMFilter(l(this,L).foreground,l(this,L).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(l(this,at)).direction)}get highlightColors(){return(0,n.shadow)(this,"highlightColors",l(this,lt)?new Map(l(this,lt).split(",").map($=>$.split("=").map(At=>At.trim()))):null)}get highlightColorNames(){return(0,n.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,$=>$.reverse())):null)}setMainHighlightColorPicker($){J(this,ut,$)}editAltText($){var At;(At=l(this,Lt))==null||At.editAltText(this,$)}onPageChanging({pageNumber:$}){J(this,ee,$-1)}focusMainContainer(){l(this,at).focus()}findParent($,At){for(const Zt of l(this,Tt).values()){const{x:ae,y:de,width:Ce,height:Se}=Zt.div.getBoundingClientRect();if($>=ae&&$<=ae+Ce&&At>=de&&At<=de+Se)return Zt}return null}disableUserSelect($=!1){l(this,_t).classList.toggle("noUserSelect",$)}addShouldRescale($){l(this,pe).add($)}removeShouldRescale($){l(this,pe).delete($)}onScaleChanging({scale:$}){this.commitOrRemove(),this.viewParameters.realScale=$*a.PixelsPerInch.PDF_TO_CSS_UNITS;for(const At of l(this,pe))At.onScaleChanging()}onRotationChanging({pagesRotation:$}){this.commitOrRemove(),this.viewParameters.rotation=$}highlightSelection($=""){const At=document.getSelection();if(!At||At.isCollapsed)return;const{anchorNode:Zt,anchorOffset:ae,focusNode:de,focusOffset:Ce}=At,Se=At.toString(),ri=Y(this,vt,dc).call(this,At).closest(".textLayer"),ci=this.getSelectionBoxes(ri);if(ci){At.empty(),l(this,M)===n.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:n.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const mr of l(this,Tt).values())if(mr.hasTextLayer(ri)){mr.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:$,boxes:ci,anchorNode:Zt,anchorOffset:ae,focusNode:de,focusOffset:Ce,text:Se});break}}}addToAnnotationStorage($){!$.isEmpty()&&l(this,Qt)&&!l(this,Qt).has($.id)&&l(this,Qt).setValue($.id,$)}blur(){if(this.isShiftKeyDown=!1,l(this,Ft)&&(J(this,Ft,!1),Y(this,Et,uc).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:$}=document;for(const At of l(this,D))if(At.div.contains($)){J(this,_e,[At,$]),At._focusEventsAllowed=!1;break}}focus(){if(!l(this,_e))return;const[$,At]=l(this,_e);J(this,_e,null),At.addEventListener("focusin",()=>{$._focusEventsAllowed=!0},{once:!0}),At.focus()}addEditListeners(){Y(this,oi,tf).call(this),Y(this,Q,rf).call(this)}removeEditListeners(){Y(this,bi,ef).call(this),Y(this,ht,nf).call(this)}copy($){var Zt;if($.preventDefault(),(Zt=l(this,wt))==null||Zt.commitOrRemove(),!this.hasSelection)return;const At=[];for(const ae of l(this,D)){const de=ae.serialize(!0);de&&At.push(de)}At.length!==0&&$.clipboardData.setData("application/pdfjs",JSON.stringify(At))}cut($){this.copy($),this.delete()}paste($){$.preventDefault();const{clipboardData:At}=$;for(const de of At.items)for(const Ce of l(this,oe))if(Ce.isHandlingMimeForPasting(de.type)){Ce.paste(de,this.currentLayer);return}let Zt=At.getData("application/pdfjs");if(!Zt)return;try{Zt=JSON.parse(Zt)}catch(de){(0,n.warn)(`paste: "${de.message}".`);return}if(!Array.isArray(Zt))return;this.unselectAll();const ae=this.currentLayer;try{const de=[];for(const ri of Zt){const ci=ae.deserialize(ri);if(!ci)return;de.push(ci)}const Ce=()=>{for(const ri of de)Y(this,he,sf).call(this,ri);Y(this,ei,af).call(this,de)},Se=()=>{for(const ri of de)ri.remove()};this.addCommands({cmd:Ce,undo:Se,mustExec:!0})}catch(de){(0,n.warn)(`paste: "${de.message}".`)}}keydown($){!this.isShiftKeyDown&&$.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,M)!==n.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&zi._keyboardManager.exec(this,$)}keyup($){this.isShiftKeyDown&&$.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Ft)&&(J(this,Ft,!1),Y(this,Et,uc).call(this,"main_toolbar")))}onEditingAction({name:$}){switch($){case"undo":case"redo":case"delete":case"selectAll":this[$]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState($){$?(Y(this,je,T1).call(this),Y(this,Q,rf).call(this),Y(this,St,Yr).call(this,{isEditing:l(this,M)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,Ue,qo).call(this),hasSomethingToUndo:l(this,Dt).hasSomethingToUndo(),hasSomethingToRedo:l(this,Dt).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,ze,Ju).call(this),Y(this,ht,nf).call(this),Y(this,St,Yr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes($){if(!l(this,oe)){J(this,oe,$);for(const At of l(this,oe))Y(this,Ot,Ks).call(this,At.defaultPropertiesToUpdate)}}getId(){return l(this,ve).id}get currentLayer(){return l(this,Tt).get(l(this,ee))}getLayer($){return l(this,Tt).get($)}get currentPageIndex(){return l(this,ee)}addLayer($){l(this,Tt).set($.pageIndex,$),l(this,ie)?$.enable():$.disable()}removeLayer($){l(this,Tt).delete($.pageIndex)}updateMode($,At=null,Zt=!1){if(l(this,M)!==$){if(J(this,M,$),$===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,ne,M1).call(this);return}this.setEditingState(!0),Y(this,le,P1).call(this),this.unselectAll();for(const ae of l(this,Tt).values())ae.updateMode($);if(!At&&Zt){this.addNewEditorFromKeyboard();return}if(At){for(const ae of l(this,dt).values())if(ae.annotationElementId===At){this.setSelected(ae),ae.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar($){$!==l(this,M)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:$})}updateParams($,At){var Zt;if(l(this,oe)){switch($){case n.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case n.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Zt=l(this,ut))==null||Zt.updateColor(At);break;case n.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,V)||J(this,V,new Map)).set($,At),this.showAllEditors("highlight",At);break}for(const ae of l(this,D))ae.updateParams($,At);for(const ae of l(this,oe))ae.updateDefaultParams($,At)}}showAllEditors($,At,Zt=!1){var ae;for(const de of l(this,dt).values())de.editorType===$&&de.show(At);(((ae=l(this,V))==null?void 0:ae.get(n.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==At&&Y(this,Ot,Ks).call(this,[[n.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,At]])}enableWaiting($=!1){if(l(this,xe)!==$){J(this,xe,$);for(const At of l(this,Tt).values())$?At.disableClick():At.enableClick(),At.div.classList.toggle("waiting",$)}}getEditors($){const At=[];for(const Zt of l(this,dt).values())Zt.pageIndex===$&&At.push(Zt);return At}getEditor($){return l(this,dt).get($)}addEditor($){l(this,dt).set($.id,$)}removeEditor($){var At;$.div.contains(document.activeElement)&&(l(this,Gt)&&clearTimeout(l(this,Gt)),J(this,Gt,setTimeout(()=>{this.focusMainContainer(),J(this,Gt,null)},0))),l(this,dt).delete($.id),this.unselect($),(!$.annotationElementId||!l(this,zt).has($.annotationElementId))&&((At=l(this,Qt))==null||At.remove($.id))}addDeletedAnnotationElement($){l(this,zt).add($.annotationElementId),this.addChangedExistingAnnotation($),$.deleted=!0}isDeletedAnnotationElement($){return l(this,zt).has($)}removeDeletedAnnotationElement($){l(this,zt).delete($.annotationElementId),this.removeChangedExistingAnnotation($),$.deleted=!1}setActiveEditor($){l(this,wt)!==$&&(J(this,wt,$),$&&Y(this,Ot,Ks).call(this,$.propertiesToUpdate))}updateUI($){l(this,we,R1)===$&&Y(this,Ot,Ks).call(this,$.propertiesToUpdate)}toggleSelected($){if(l(this,D).has($)){l(this,D).delete($),$.unselect(),Y(this,St,Yr).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,D).add($),$.select(),Y(this,Ot,Ks).call(this,$.propertiesToUpdate),Y(this,St,Yr).call(this,{hasSelectedEditor:!0})}setSelected($){for(const At of l(this,D))At!==$&&At.unselect();l(this,D).clear(),l(this,D).add($),$.select(),Y(this,Ot,Ks).call(this,$.propertiesToUpdate),Y(this,St,Yr).call(this,{hasSelectedEditor:!0})}isSelected($){return l(this,D).has($)}get firstSelectedEditor(){return l(this,D).values().next().value}unselect($){$.unselect(),l(this,D).delete($),Y(this,St,Yr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,D).size!==0}get isEnterHandled(){return l(this,D).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){l(this,Dt).undo(),Y(this,St,Yr).call(this,{hasSomethingToUndo:l(this,Dt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,Ue,qo).call(this)})}redo(){l(this,Dt).redo(),Y(this,St,Yr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,Dt).hasSomethingToRedo(),isEmpty:Y(this,Ue,qo).call(this)})}addCommands($){l(this,Dt).add($),Y(this,St,Yr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,Ue,qo).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const $=[...l(this,D)],At=()=>{for(const ae of $)ae.remove()},Zt=()=>{for(const ae of $)Y(this,he,sf).call(this,ae)};this.addCommands({cmd:At,undo:Zt,mustExec:!0})}commitOrRemove(){var $;($=l(this,wt))==null||$.commitOrRemove()}hasSomethingToControl(){return l(this,wt)||this.hasSelection}selectAll(){for(const $ of l(this,D))$.commit();Y(this,ei,af).call(this,l(this,dt).values())}unselectAll(){if(!(l(this,wt)&&(l(this,wt).commitOrRemove(),l(this,M)!==n.AnnotationEditorType.NONE))&&this.hasSelection){for(const $ of l(this,D))$.unselect();l(this,D).clear(),Y(this,St,Yr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors($,At,Zt=!1){if(Zt||this.commitOrRemove(),!this.hasSelection)return;l(this,Bt)[0]+=$,l(this,Bt)[1]+=At;const[ae,de]=l(this,Bt),Ce=[...l(this,D)],Se=1e3;l(this,Z)&&clearTimeout(l(this,Z)),J(this,Z,setTimeout(()=>{J(this,Z,null),l(this,Bt)[0]=l(this,Bt)[1]=0,this.addCommands({cmd:()=>{for(const ri of Ce)l(this,dt).has(ri.id)&&ri.translateInPage(ae,de)},undo:()=>{for(const ri of Ce)l(this,dt).has(ri.id)&&ri.translateInPage(-ae,-de)},mustExec:!1})},Se));for(const ri of Ce)ri.translateInPage($,At)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),J(this,Jt,new Map);for(const $ of l(this,D))l(this,Jt).set($,{savedX:$.x,savedY:$.y,savedPageIndex:$.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Jt))return!1;this.disableUserSelect(!1);const $=l(this,Jt);J(this,Jt,null);let At=!1;for(const[{x:ae,y:de,pageIndex:Ce},Se]of $)Se.newX=ae,Se.newY=de,Se.newPageIndex=Ce,At||(At=ae!==Se.savedX||de!==Se.savedY||Ce!==Se.savedPageIndex);if(!At)return!1;const Zt=(ae,de,Ce,Se)=>{if(l(this,dt).has(ae.id)){const ri=l(this,Tt).get(Se);ri?ae._setParentAndPosition(ri,de,Ce):(ae.pageIndex=Se,ae.x=de,ae.y=Ce)}};return this.addCommands({cmd:()=>{for(const[ae,{newX:de,newY:Ce,newPageIndex:Se}]of $)Zt(ae,de,Ce,Se)},undo:()=>{for(const[ae,{savedX:de,savedY:Ce,savedPageIndex:Se}]of $)Zt(ae,de,Ce,Se)},mustExec:!0}),!0}dragSelectedEditors($,At){if(l(this,Jt))for(const Zt of l(this,Jt).keys())Zt.drag($,At)}rebuild($){if($.parent===null){const At=this.getLayer($.pageIndex);At?(At.changeParent($),At.addOrRebuild($)):(this.addEditor($),this.addToAnnotationStorage($),$.rebuild())}else $.parent.addOrRebuild($)}get isEditorHandlingKeyboard(){var $;return(($=this.getActive())==null?void 0:$.shouldGetKeyboardEvents())||l(this,D).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive($){return l(this,wt)===$}getActive(){return l(this,wt)}getMode(){return l(this,M)}get imageManager(){return(0,n.shadow)(this,"imageManager",new f)}getSelectionBoxes($){if(!$)return null;const At=document.getSelection();for(let ci=0,mr=At.rangeCount;ci<mr;ci++)if(!$.contains(At.getRangeAt(ci).commonAncestorContainer))return null;const{x:Zt,y:ae,width:de,height:Ce}=$.getBoundingClientRect();let Se;switch($.getAttribute("data-main-rotation")){case"90":Se=(ci,mr,Hi,qr)=>({x:(mr-ae)/Ce,y:1-(ci+Hi-Zt)/de,width:qr/Ce,height:Hi/de});break;case"180":Se=(ci,mr,Hi,qr)=>({x:1-(ci+Hi-Zt)/de,y:1-(mr+qr-ae)/Ce,width:Hi/de,height:qr/Ce});break;case"270":Se=(ci,mr,Hi,qr)=>({x:1-(mr+qr-ae)/Ce,y:(ci-Zt)/de,width:qr/Ce,height:Hi/de});break;default:Se=(ci,mr,Hi,qr)=>({x:(ci-Zt)/de,y:(mr-ae)/Ce,width:Hi/de,height:qr/Ce});break}const ri=[];for(let ci=0,mr=At.rangeCount;ci<mr;ci++){const Hi=At.getRangeAt(ci);if(!Hi.collapsed)for(const{x:qr,y:wr,width:gh,height:cs}of Hi.getClientRects())gh===0||cs===0||ri.push(Se(qr,wr,gh,cs))}return ri.length===0?null:ri}addChangedExistingAnnotation({annotationElementId:$,id:At}){(l(this,ct)||J(this,ct,new Map)).set($,At)}removeChangedExistingAnnotation({annotationElementId:$}){var At;(At=l(this,ct))==null||At.delete($)}renderAnnotationElement($){var ae;const At=(ae=l(this,ct))==null?void 0:ae.get($.data.id);if(!At)return;const Zt=l(this,Qt).getRawValue(At);!Zt||l(this,M)===n.AnnotationEditorType.NONE&&!Zt.hasBeenModified||Zt.renderAnnotationElement($)}};let y=zi;wt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,Qt=new WeakMap,ct=new WeakMap,Dt=new WeakMap,ee=new WeakMap,zt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,pe=new WeakMap,Ae=new WeakMap,Ve=new WeakMap,Gt=new WeakMap,lt=new WeakMap,Ft=new WeakMap,Wt=new WeakMap,ve=new WeakMap,ie=new WeakMap,xe=new WeakMap,_e=new WeakMap,ut=new WeakMap,T=new WeakMap,M=new WeakMap,D=new WeakMap,H=new WeakMap,L=new WeakMap,V=new WeakMap,j=new WeakMap,G=new WeakMap,W=new WeakMap,U=new WeakMap,O=new WeakMap,z=new WeakMap,et=new WeakMap,nt=new WeakMap,pt=new WeakMap,yt=new WeakMap,Nt=new WeakMap,Ht=new WeakMap,Pt=new WeakMap,Bt=new WeakMap,Z=new WeakMap,at=new WeakMap,_t=new WeakMap,vt=new WeakSet,dc=function({anchorNode:$}){return $.nodeType===Node.TEXT_NODE?$.parentElement:$},bt=new WeakSet,S1=function(){const $=document.getSelection();if(!$||$.isCollapsed)return;const At=Y(this,vt,dc).call(this,$).closest(".textLayer"),Zt=this.getSelectionBoxes(At);!Zt||(l(this,Wt)||J(this,Wt,new o.HighlightToolbar(this)),l(this,Wt).show(At,Zt,this.direction==="ltr"))},ot=new WeakSet,E1=function(){var Zt,ae,de;const $=document.getSelection();if(!$||$.isCollapsed){l(this,H)&&((Zt=l(this,Wt))==null||Zt.hide(),J(this,H,null),Y(this,St,Yr).call(this,{hasSelectedText:!1}));return}const{anchorNode:At}=$;if(At!==l(this,H)){if(!Y(this,vt,dc).call(this,$).closest(".textLayer")){l(this,H)&&((ae=l(this,Wt))==null||ae.hide(),J(this,H,null),Y(this,St,Yr).call(this,{hasSelectedText:!1}));return}if((de=l(this,Wt))==null||de.hide(),J(this,H,At),Y(this,St,Yr).call(this,{hasSelectedText:!0}),!(l(this,M)!==n.AnnotationEditorType.HIGHLIGHT&&l(this,M)!==n.AnnotationEditorType.NONE)&&(l(this,M)===n.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),J(this,Ft,this.isShiftKeyDown),!this.isShiftKeyDown)){const Ce=Se=>{Se.type==="pointerup"&&Se.button!==0||(window.removeEventListener("pointerup",Ce),window.removeEventListener("blur",Ce),Se.type==="pointerup"&&Y(this,Et,uc).call(this,"main_toolbar"))};window.addEventListener("pointerup",Ce),window.addEventListener("blur",Ce)}}},Et=new WeakSet,uc=function($=""){l(this,M)===n.AnnotationEditorType.HIGHLIGHT?this.highlightSelection($):l(this,Ae)&&Y(this,bt,S1).call(this)},te=new WeakSet,C1=function(){document.addEventListener("selectionchange",l(this,Nt))},Pe=new WeakSet,k1=function(){document.removeEventListener("selectionchange",l(this,Nt))},je=new WeakSet,T1=function(){window.addEventListener("focus",l(this,G)),window.addEventListener("blur",l(this,j))},ze=new WeakSet,Ju=function(){window.removeEventListener("focus",l(this,G)),window.removeEventListener("blur",l(this,j))},oi=new WeakSet,tf=function(){window.addEventListener("keydown",l(this,z)),window.addEventListener("keyup",l(this,et))},bi=new WeakSet,ef=function(){window.removeEventListener("keydown",l(this,z)),window.removeEventListener("keyup",l(this,et))},Q=new WeakSet,rf=function(){document.addEventListener("copy",l(this,W)),document.addEventListener("cut",l(this,U)),document.addEventListener("paste",l(this,O))},ht=new WeakSet,nf=function(){document.removeEventListener("copy",l(this,W)),document.removeEventListener("cut",l(this,U)),document.removeEventListener("paste",l(this,O))},St=new WeakSet,Yr=function($){Object.entries($).some(([At,Zt])=>l(this,Pt)[At]!==Zt)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,Pt),$)}),l(this,M)===n.AnnotationEditorType.HIGHLIGHT&&$.hasSelectedEditor===!1&&Y(this,Ot,Ks).call(this,[[n.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},Ot=new WeakSet,Ks=function($){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:$})},le=new WeakSet,P1=function(){if(!l(this,ie)){J(this,ie,!0);for(const $ of l(this,Tt).values())$.enable();for(const $ of l(this,dt).values())$.enable()}},ne=new WeakSet,M1=function(){if(this.unselectAll(),l(this,ie)){J(this,ie,!1);for(const $ of l(this,Tt).values())$.disable();for(const $ of l(this,dt).values())$.disable()}},he=new WeakSet,sf=function($){const At=l(this,Tt).get($.pageIndex);At?At.addOrRebuild($):(this.addEditor($),this.addToAnnotationStorage($))},we=new WeakSet,R1=function(){let $=null;for($ of l(this,D));return $},Ue=new WeakSet,qo=function(){if(l(this,dt).size===0)return!0;if(l(this,dt).size===1)for(const $ of l(this,dt).values())return $.isEmpty();return!1},ei=new WeakSet,af=function($){for(const At of l(this,D))At.unselect();l(this,D).clear();for(const At of $)At.isEmpty()||(l(this,D).add(At),At.select());Y(this,St,Yr).call(this,{hasSelectedEditor:this.hasSelection})},ti(y,"TRANSLATE_SMALL",1),ti(y,"TRANSLATE_BIG",10)},94:(r,t,s)=>{s.d(t,{PDFFetchStream:()=>d});var n=s(292),a=s(490);function o(S,_,y){return{method:"GET",headers:S,signal:y.signal,mode:"cors",credentials:_?"include":"same-origin",redirect:"follow"}}function c(S){const _=new Headers;for(const y in S){const b=S[y];b!==void 0&&_.append(y,b)}return _}function u(S){return S instanceof Uint8Array?S.buffer:S instanceof ArrayBuffer?S:((0,n.warn)(`getArrayBuffer - unexpected data format: ${S}`),new Uint8Array(S).buffer)}class d{constructor(_){this.source=_,this.isHttp=/^https?:/i.test(_.url),this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _;return((_=this._fullRequestReader)==null?void 0:_._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f(this),this._fullRequestReader}getRangeReader(_,y){if(y<=this._progressiveDataLength)return null;const b=new m(this,_,y);return this._rangeRequestReaders.push(b),b}cancelAllRequests(_){var y;(y=this._fullRequestReader)==null||y.cancel(_);for(const b of this._rangeRequestReaders.slice(0))b.cancel(_)}}class f{constructor(_){this._stream=_,this._reader=null,this._loaded=0,this._filename=null;const y=_.source;this._withCredentials=y.withCredentials||!1,this._contentLength=y.length,this._headersCapability=Promise.withResolvers(),this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._headers=c(this._stream.httpHeaders);const b=y.url;fetch(b,o(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,a.validateResponseStatus)(x.status))throw(0,a.createResponseStatusError)(x.status,b);this._reader=x.body.getReader(),this._headersCapability.resolve();const E=p=>x.headers.get(p),{allowRangeRequests:I,suggestedLength:R}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=I,this._contentLength=R||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(E),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._headersCapability.promise;const{value:_,done:y}=await this._reader.read();return y?{value:_,done:y}:(this._loaded+=_.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded,total:this._contentLength}),{value:u(_),done:!1})}cancel(_){var y;(y=this._reader)==null||y.cancel(_),this._abortController.abort()}}class m{constructor(_,y,b){this._stream=_,this._reader=null,this._loaded=0;const x=_.source;this._withCredentials=x.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!x.disableStream,this._abortController=new AbortController,this._headers=c(this._stream.httpHeaders),this._headers.append("Range",`bytes=${y}-${b-1}`);const E=x.url;fetch(E,o(this._headers,this._withCredentials,this._abortController)).then(I=>{if(!(0,a.validateResponseStatus)(I.status))throw(0,a.createResponseStatusError)(I.status,E);this._readCapability.resolve(),this._reader=I.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._readCapability.promise;const{value:_,done:y}=await this._reader.read();return y?{value:_,done:y}:(this._loaded+=_.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded}),{value:u(_),done:!1})}cancel(_){var y;(y=this._reader)==null||y.cancel(_),this._abortController.abort()}}},10:(r,t,s)=>{var c;s.d(t,{FontFaceObject:()=>o,FontLoader:()=>a});var n=s(292);class a{constructor({ownerDocument:d=globalThis.document,styleElement:f=null}){N(this,c,new Set);this._document=d,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(d){this.nativeFontFaces.add(d),this._document.fonts.add(d)}removeNativeFontFace(d){this.nativeFontFaces.delete(d),this._document.fonts.delete(d)}insertRule(d){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const f=this.styleElement.sheet;f.insertRule(d,f.cssRules.length)}clear(){for(const d of this.nativeFontFaces)this._document.fonts.delete(d);this.nativeFontFaces.clear(),l(this,c).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:d,_inspectFont:f}){if(!(!d||l(this,c).has(d.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:m,src:S,style:_}=d,y=new FontFace(m,S,_);this.addNativeFontFace(y);try{await y.load(),l(this,c).add(m),f==null||f(d)}catch{(0,n.warn)(`Cannot load system font: ${d.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(y)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(d){if(d.attached||d.missingFile&&!d.systemFontInfo)return;if(d.attached=!0,d.systemFontInfo){await this.loadSystemFont(d);return}if(this.isFontLoadingAPISupported){const m=d.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(S){throw(0,n.warn)(`Failed to load font '${m.family}': '${S}'.`),d.disableFontFace=!0,S}}return}const f=d.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const S=this._queueLoadingCallback(m);this._prepareFontLoadEvent(d,S)})}}get isFontLoadingAPISupported(){var f;const d=!!((f=this._document)!=null&&f.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",d)}get isSyncFontLoadingSupported(){let d=!1;return(n.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(d=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",d)}_queueLoadingCallback(d){function f(){for((0,n.assert)(!S.done,"completeRequest() cannot be called twice."),S.done=!0;m.length>0&&m[0].done;){const _=m.shift();setTimeout(_.callback,0)}}const{loadingRequests:m}=this,S={done:!1,complete:f,callback:d};return m.push(S),S}get _loadTestFont(){const d=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",d)}_prepareFontLoadEvent(d,f){function m(tt,st){return tt.charCodeAt(st)<<24|tt.charCodeAt(st+1)<<16|tt.charCodeAt(st+2)<<8|tt.charCodeAt(st+3)&255}function S(tt,st,wt,dt){const Tt=tt.substring(0,st),Lt=tt.substring(st+wt);return Tt+dt+Lt}let _,y;const b=this._document.createElement("canvas");b.width=1,b.height=1;const x=b.getContext("2d");let E=0;function I(tt,st){if(++E>30){(0,n.warn)("Load test font never loaded."),st();return}if(x.font="30px "+tt,x.fillText(".",0,20),x.getImageData(0,0,1,1).data[3]>0){st();return}setTimeout(I.bind(null,tt,st))}const R=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=S(p,976,R.length,R);const w=16,A=1482184792;let C=m(p,w);for(_=0,y=R.length-3;_<y;_+=4)C=C-A+m(R,_)|0;_<R.length&&(C=C-A+m(R+"XXX",_)|0),p=S(p,w,4,(0,n.string32)(C));const B=`url(data:font/opentype;base64,${btoa(p)});`,F=`@font-face {font-family:"${R}";src:${B}}`;this.insertRule(F);const rt=this._document.createElement("div");rt.style.visibility="hidden",rt.style.width=rt.style.height="10px",rt.style.position="absolute",rt.style.top=rt.style.left="0px";for(const tt of[d.loadedName,R]){const st=this._document.createElement("span");st.textContent="Hi",st.style.fontFamily=tt,rt.append(st)}this._document.body.append(rt),I(R,()=>{rt.remove(),f.complete()})}}c=new WeakMap;class o{constructor(d,{disableFontFace:f=!1,ignoreErrors:m=!1,inspectFont:S=null}){this.compiledGlyphs=Object.create(null);for(const _ in d)this[_]=d[_];this.disableFontFace=f===!0,this.ignoreErrors=m===!0,this._inspectFont=S}createNativeFontFace(){var f;if(!this.data||this.disableFontFace)return null;let d;if(!this.cssFontInfo)d=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),d=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(f=this._inspectFont)==null||f.call(this,this),d}createFontFaceRule(){var S;if(!this.data||this.disableFontFace)return null;const d=(0,n.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(d)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let _=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_}src:${f}}`}return(S=this._inspectFont)==null||S.call(this,this,f),m}getPathGenerator(d,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let m;try{m=d.get(this.loadedName+"_path_"+f)}catch(_){if(!this.ignoreErrors)throw _;(0,n.warn)(`getPathGenerator - ignoring character: "${_}".`)}if(!Array.isArray(m)||m.length===0)return this.compiledGlyphs[f]=function(_,y){};const S=[];for(let _=0,y=m.length;_<y;)switch(m[_++]){case n.FontRenderOps.BEZIER_CURVE_TO:{const[b,x,E,I,R,p]=m.slice(_,_+6);S.push(w=>w.bezierCurveTo(b,x,E,I,R,p)),_+=6}break;case n.FontRenderOps.MOVE_TO:{const[b,x]=m.slice(_,_+2);S.push(E=>E.moveTo(b,x)),_+=2}break;case n.FontRenderOps.LINE_TO:{const[b,x]=m.slice(_,_+2);S.push(E=>E.lineTo(b,x)),_+=2}break;case n.FontRenderOps.QUADRATIC_CURVE_TO:{const[b,x,E,I]=m.slice(_,_+4);S.push(R=>R.quadraticCurveTo(b,x,E,I)),_+=4}break;case n.FontRenderOps.RESTORE:S.push(b=>b.restore());break;case n.FontRenderOps.SAVE:S.push(b=>b.save());break;case n.FontRenderOps.SCALE:(0,n.assert)(S.length===2,"Scale command is only valid at the third position.");break;case n.FontRenderOps.TRANSFORM:{const[b,x,E,I,R,p]=m.slice(_,_+6);S.push(w=>w.transform(b,x,E,I,R,p)),_+=6}break;case n.FontRenderOps.TRANSLATE:{const[b,x]=m.slice(_,_+2);S.push(E=>E.translate(b,x)),_+=2}break}return this.compiledGlyphs[f]=function(_,y){S[0](_),S[1](_),_.scale(y,-y);for(let b=2,x=S.length;b<x;b++)S[b](_)}}}},62:(r,t,s)=>{var o,c;s.d(t,{Metadata:()=>a});var n=s(292);class a{constructor({parsedData:d,rawData:f}){N(this,o,void 0);N(this,c,void 0);J(this,o,d),J(this,c,f)}getRaw(){return l(this,c)}get(d){return l(this,o).get(d)??null}getAll(){return(0,n.objectFromMap)(l(this,o))}has(d){return l(this,o).has(d)}}o=new WeakMap,c=new WeakMap},457:(r,t,s)=>{s.d(t,{PDFNetworkStream:()=>f});var n=s(292),a=s(490);const o=200,c=206;function u(_){const y=_.response;return typeof y!="string"?y:(0,n.stringToBytes)(y).buffer}class d{constructor(y,b={}){this.url=y,this.isHttp=/^https?:/i.test(y),this.httpHeaders=this.isHttp&&b.httpHeaders||Object.create(null),this.withCredentials=b.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(y,b,x){const E={begin:y,end:b};for(const I in x)E[I]=x[I];return this.request(E)}requestFull(y){return this.request(y)}request(y){const b=new XMLHttpRequest,x=this.currXhrId++,E=this.pendingRequests[x]={xhr:b};b.open("GET",this.url),b.withCredentials=this.withCredentials;for(const I in this.httpHeaders){const R=this.httpHeaders[I];R!==void 0&&b.setRequestHeader(I,R)}return this.isHttp&&"begin"in y&&"end"in y?(b.setRequestHeader("Range",`bytes=${y.begin}-${y.end-1}`),E.expectedStatus=c):E.expectedStatus=o,b.responseType="arraybuffer",y.onError&&(b.onerror=function(I){y.onError(b.status)}),b.onreadystatechange=this.onStateChange.bind(this,x),b.onprogress=this.onProgress.bind(this,x),E.onHeadersReceived=y.onHeadersReceived,E.onDone=y.onDone,E.onError=y.onError,E.onProgress=y.onProgress,b.send(null),x}onProgress(y,b){var E;const x=this.pendingRequests[y];!x||((E=x.onProgress)==null||E.call(x,b))}onStateChange(y,b){var p,w,A;const x=this.pendingRequests[y];if(!x)return;const E=x.xhr;if(E.readyState>=2&&x.onHeadersReceived&&(x.onHeadersReceived(),delete x.onHeadersReceived),E.readyState!==4||!(y in this.pendingRequests))return;if(delete this.pendingRequests[y],E.status===0&&this.isHttp){(p=x.onError)==null||p.call(x,E.status);return}const I=E.status||o;if(!(I===o&&x.expectedStatus===c)&&I!==x.expectedStatus){(w=x.onError)==null||w.call(x,E.status);return}const R=u(E);if(I===c){const C=E.getResponseHeader("Content-Range"),B=/bytes (\d+)-(\d+)\/(\d+)/.exec(C);x.onDone({begin:parseInt(B[1],10),chunk:R})}else R?x.onDone({begin:0,chunk:R}):(A=x.onError)==null||A.call(x,E.status)}getRequestXhr(y){return this.pendingRequests[y].xhr}isPendingRequest(y){return y in this.pendingRequests}abortRequest(y){const b=this.pendingRequests[y].xhr;delete this.pendingRequests[y],b.abort()}}class f{constructor(y){this._source=y,this._manager=new d(y.url,{httpHeaders:y.httpHeaders,withCredentials:y.withCredentials}),this._rangeChunkSize=y.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(y){const b=this._rangeRequestReaders.indexOf(y);b>=0&&this._rangeRequestReaders.splice(b,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(y,b){const x=new S(this._manager,y,b);return x.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(x),x}cancelAllRequests(y){var b;(b=this._fullRequestReader)==null||b.cancel(y);for(const x of this._rangeRequestReaders.slice(0))x.cancel(y)}}class m{constructor(y,b){this._manager=y;const x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._fullRequestId=y.requestFull(x),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=b.disableRange||!1,this._contentLength=b.length,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const y=this._fullRequestId,b=this._manager.getRequestXhr(y),x=R=>b.getResponseHeader(R),{allowRangeRequests:E,suggestedLength:I}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});E&&(this._isRangeSupported=!0),this._contentLength=I||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(x),this._isRangeSupported&&this._manager.abortRequest(y),this._headersReceivedCapability.resolve()}_onDone(y){if(y&&(this._requests.length>0?this._requests.shift().resolve({value:y.chunk,done:!1}):this._cachedChunks.push(y.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(y){this._storedError=(0,a.createResponseStatusError)(y,this._url),this._headersReceivedCapability.reject(this._storedError);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(y){var b;(b=this.onProgress)==null||b.call(this,{loaded:y.loaded,total:y.lengthComputable?y.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0,this._headersReceivedCapability.reject(y);for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class S{constructor(y,b,x){this._manager=y;const E={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._requestId=y.requestRange(b,x,E),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var y;(y=this.onClosed)==null||y.call(this,this)}_onDone(y){const b=y.chunk;this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunk=b,this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(y){this._storedError=(0,a.createResponseStatusError)(y,this._url);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(y){var b;this.isStreamingSupported||((b=this.onProgress)==null||b.call(this,{loaded:y.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(r,t,s)=>{s.d(t,{createResponseStatusError:()=>d,extractFilenameFromHeader:()=>u,validateRangeRequestCapabilities:()=>c,validateResponseStatus:()=>f});var n=s(292);function a(m){let S=!0,_=y("filename\\*","i").exec(m);if(_){_=_[1];let w=I(_);return w=unescape(w),w=R(w),w=p(w),x(w)}if(_=E(m),_){const w=p(_);return x(w)}if(_=y("filename","i").exec(m),_){_=_[1];let w=I(_);return w=p(w),x(w)}function y(w,A){return new RegExp("(?:^|;)\\s*"+w+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',A)}function b(w,A){if(w){if(!/^[\x00-\xFF]+$/.test(A))return A;try{const C=new TextDecoder(w,{fatal:!0}),B=(0,n.stringToBytes)(A);A=C.decode(B),S=!1}catch{}}return A}function x(w){return S&&/[\x80-\xff]/.test(w)&&(w=b("utf-8",w),S&&(w=b("iso-8859-1",w))),w}function E(w){const A=[];let C;const B=y("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(C=B.exec(w))!==null;){let[,rt,tt,st]=C;if(rt=parseInt(rt,10),rt in A){if(rt===0)break;continue}A[rt]=[tt,st]}const F=[];for(let rt=0;rt<A.length&&rt in A;++rt){let[tt,st]=A[rt];st=I(st),tt&&(st=unescape(st),rt===0&&(st=R(st))),F.push(st)}return F.join("")}function I(w){if(w.startsWith('"')){const A=w.slice(1).split('\\"');for(let C=0;C<A.length;++C){const B=A[C].indexOf('"');B!==-1&&(A[C]=A[C].slice(0,B),A.length=C+1),A[C]=A[C].replaceAll(/\\(.)/g,"$1")}w=A.join('"')}return w}function R(w){const A=w.indexOf("'");if(A===-1)return w;const C=w.slice(0,A),B=w.slice(A+1).replace(/^[^']*'/,"");return b(C,B)}function p(w){return!w.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(w)?w:w.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(A,C,B,F){if(B==="q"||B==="Q")return F=F.replaceAll("_"," "),F=F.replaceAll(/=([0-9a-fA-F]{2})/g,function(rt,tt){return String.fromCharCode(parseInt(tt,16))}),b(C,F);try{F=atob(F)}catch{}return b(C,F)})}return""}var o=s(419);function c({getResponseHeader:m,isHttp:S,rangeChunkSize:_,disableRange:y}){const b={allowRangeRequests:!1,suggestedLength:void 0},x=parseInt(m("Content-Length"),10);return!Number.isInteger(x)||(b.suggestedLength=x,x<=2*_)||y||!S||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(b.allowRangeRequests=!0),b}function u(m){const S=m("Content-Disposition");if(S){let _=a(S);if(_.includes("%"))try{_=decodeURIComponent(_)}catch{}if((0,o.isPdfFile)(_))return _}return null}function d(m,S){return m===404||m===0&&S.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+S+'".'):new n.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${S}".`,m)}function f(m){return m===200||m===206}},786:(r,t,s)=>{s.a(r,async(n,a)=>{try{let u=function(A){const C=_.parse(A);return C.protocol==="file:"||C.host?C:/^[a-z]:[/\\]/i.test(A)?_.parse(`file:///${A}`):(C.host||(C.protocol="file:"),C)},d=function(A,C){return{protocol:A.protocol,auth:A.auth,host:A.hostname,port:A.port,path:A.path,method:"GET",headers:C}};s.d(t,{PDFNodeStream:()=>b});var o=s(292),c=s(490);let f,m,S,_;o.isNodeJS&&(f=await Ws(()=>import("./__vite-browser-external-b25bb000.js"),[]),m=await Ws(()=>import("./__vite-browser-external-b25bb000.js"),[]),S=await Ws(()=>import("./__vite-browser-external-b25bb000.js"),[]),_=await Ws(()=>import("./__vite-browser-external-b25bb000.js"),[]));const y=/^file:\/\/\/[a-zA-Z]:\//;class b{constructor(C){this.source=C,this.url=u(C.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new I(this),this._fullRequestReader}getRangeReader(C,B){if(B<=this._progressiveDataLength)return null;const F=this.isFsUrl?new w(this,C,B):new R(this,C,B);return this._rangeRequestReaders.push(F),F}cancelAllRequests(C){var B;(B=this._fullRequestReader)==null||B.cancel(C);for(const F of this._rangeRequestReaders.slice(0))F.cancel(C)}}class x{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null;const B=C.source;this._contentLength=B.length,this._loaded=0,this._filename=null,this._disableRange=B.disableRange||!1,this._rangeChunkSize=B.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!B.disableStream,this._isRangeSupported=!B.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var B;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=C.length,(B=this.onProgress)==null||B.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",B=>{this._error(B)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class E{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const B=C.source;this._isStreamingSupported=!B.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var B;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=C.length,(B=this.onProgress)==null||B.call(this,{loaded:this._loaded}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",B=>{this._error(B)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class I extends x{constructor(C){super(C);const B=F=>{if(F.statusCode===404){const wt=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=wt,this._headersCapability.reject(wt);return}this._headersCapability.resolve(),this._setReadableStream(F);const rt=wt=>this._readableStream.headers[wt.toLowerCase()],{allowRangeRequests:tt,suggestedLength:st}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:rt,isHttp:C.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=tt,this._contentLength=st||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(rt)};this._request=null,this._url.protocol==="http:"?this._request=m.request(d(this._url,C.httpHeaders),B):this._request=S.request(d(this._url,C.httpHeaders),B),this._request.on("error",F=>{this._storedError=F,this._headersCapability.reject(F)}),this._request.end()}}class R extends E{constructor(C,B,F){super(C),this._httpHeaders={};for(const tt in C.httpHeaders){const st=C.httpHeaders[tt];st!==void 0&&(this._httpHeaders[tt]=st)}this._httpHeaders.Range=`bytes=${B}-${F-1}`;const rt=tt=>{if(tt.statusCode===404){const st=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=st;return}this._setReadableStream(tt)};this._request=null,this._url.protocol==="http:"?this._request=m.request(d(this._url,this._httpHeaders),rt):this._request=S.request(d(this._url,this._httpHeaders),rt),this._request.on("error",tt=>{this._storedError=tt}),this._request.end()}}class p extends x{constructor(C){super(C);let B=decodeURIComponent(this._url.path);y.test(this._url.href)&&(B=B.replace(/^\//,"")),f.promises.lstat(B).then(F=>{this._contentLength=F.size,this._setReadableStream(f.createReadStream(B)),this._headersCapability.resolve()},F=>{F.code==="ENOENT"&&(F=new o.MissingPDFException(`Missing PDF "${B}".`)),this._storedError=F,this._headersCapability.reject(F)})}}class w extends E{constructor(C,B,F){super(C);let rt=decodeURIComponent(this._url.path);y.test(this._url.href)&&(rt=rt.replace(/^\//,"")),this._setReadableStream(f.createReadStream(rt,{start:B,end:F-1}))}}a()}catch(u){a(u)}},1)},573:(r,t,s)=>{s.a(r,async(n,a)=>{try{s.d(t,{NodeCMapReaderFactory:()=>y,NodeCanvasFactory:()=>_,NodeFilterFactory:()=>S,NodeStandardFontDataFactory:()=>b});var o=s(583),c=s(292);let u,d,f;if(c.isNodeJS){u=await Ws(()=>import("./__vite-browser-external-b25bb000.js"),[]);try{d=await Ws(()=>import("./__vite-browser-external-b25bb000.js"),[])}catch{}try{f=await Ws(()=>import("./index-60f13653.js"),[])}catch{}}const m=function(x){return u.promises.readFile(x).then(E=>new Uint8Array(E))};class S extends o.BaseFilterFactory{}class _ extends o.BaseCanvasFactory{_createCanvas(E,I){return d.createCanvas(E,I)}}class y extends o.BaseCMapReaderFactory{_fetchData(E,I){return m(E).then(R=>({cMapData:R,compressionType:I}))}}class b extends o.BaseStandardFontDataFactory{_fetchData(E){return m(E)}}a()}catch(u){a(u)}},1)},626:(r,t,s)=>{var d,f,m,S,_,y,b,x,E,of;s.d(t,{OptionalContentConfig:()=>u});var n=s(292),a=s(651);const o=Symbol("INTERNAL");class c{constructor(p,{name:w,intent:A,usage:C}){N(this,d,!1);N(this,f,!1);N(this,m,!1);N(this,S,!0);J(this,d,!!(p&n.RenderingIntentFlag.DISPLAY)),J(this,f,!!(p&n.RenderingIntentFlag.PRINT)),this.name=w,this.intent=A,this.usage=C}get visible(){if(l(this,m))return l(this,S);if(!l(this,S))return!1;const{print:p,view:w}=this.usage;return l(this,d)?(w==null?void 0:w.viewState)!=="OFF":l(this,f)?(p==null?void 0:p.printState)!=="OFF":!0}_setVisible(p,w,A=!1){p!==o&&(0,n.unreachable)("Internal method `_setVisible` called."),J(this,m,A),J(this,S,w)}}d=new WeakMap,f=new WeakMap,m=new WeakMap,S=new WeakMap;class u{constructor(p,w=n.RenderingIntentFlag.DISPLAY){N(this,E);N(this,_,null);N(this,y,new Map);N(this,b,null);N(this,x,null);if(this.renderingIntent=w,this.name=null,this.creator=null,p!==null){this.name=p.name,this.creator=p.creator,J(this,x,p.order);for(const A of p.groups)l(this,y).set(A.id,new c(w,A));if(p.baseState==="OFF")for(const A of l(this,y).values())A._setVisible(o,!1);for(const A of p.on)l(this,y).get(A)._setVisible(o,!0);for(const A of p.off)l(this,y).get(A)._setVisible(o,!1);J(this,b,this.getHash())}}isVisible(p){if(l(this,y).size===0)return!0;if(!p)return(0,n.info)("Optional content group not defined."),!0;if(p.type==="OCG")return l(this,y).has(p.id)?l(this,y).get(p.id).visible:((0,n.warn)(`Optional content group not found: ${p.id}`),!0);if(p.type==="OCMD"){if(p.expression)return Y(this,E,of).call(this,p.expression);if(!p.policy||p.policy==="AnyOn"){for(const w of p.ids){if(!l(this,y).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(l(this,y).get(w).visible)return!0}return!1}else if(p.policy==="AllOn"){for(const w of p.ids){if(!l(this,y).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(!l(this,y).get(w).visible)return!1}return!0}else if(p.policy==="AnyOff"){for(const w of p.ids){if(!l(this,y).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(!l(this,y).get(w).visible)return!0}return!1}else if(p.policy==="AllOff"){for(const w of p.ids){if(!l(this,y).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(l(this,y).get(w).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${p.policy}.`),!0}return(0,n.warn)(`Unknown group type ${p.type}.`),!0}setVisibility(p,w=!0){const A=l(this,y).get(p);if(!A){(0,n.warn)(`Optional content group not found: ${p}`);return}A._setVisible(o,!!w,!0),J(this,_,null)}setOCGState({state:p,preserveRB:w}){let A;for(const C of p){switch(C){case"ON":case"OFF":case"Toggle":A=C;continue}const B=l(this,y).get(C);if(B)switch(A){case"ON":B._setVisible(o,!0);break;case"OFF":B._setVisible(o,!1);break;case"Toggle":B._setVisible(o,!B.visible);break}}J(this,_,null)}get hasInitialVisibility(){return l(this,b)===null||this.getHash()===l(this,b)}getOrder(){return l(this,y).size?l(this,x)?l(this,x).slice():[...l(this,y).keys()]:null}getGroups(){return l(this,y).size>0?(0,n.objectFromMap)(l(this,y)):null}getGroup(p){return l(this,y).get(p)||null}getHash(){if(l(this,_)!==null)return l(this,_);const p=new a.MurmurHash3_64;for(const[w,A]of l(this,y))p.update(`${w}:${A.visible}`);return J(this,_,p.hexdigest())}}_=new WeakMap,y=new WeakMap,b=new WeakMap,x=new WeakMap,E=new WeakSet,of=function(p){const w=p.length;if(w<2)return!0;const A=p[0];for(let C=1;C<w;C++){const B=p[C];let F;if(Array.isArray(B))F=Y(this,E,of).call(this,B);else if(l(this,y).has(B))F=l(this,y).get(B).visible;else return(0,n.warn)(`Optional content group not found: ${B}`),!0;switch(A){case"And":if(!F)return!1;break;case"Or":if(F)return!0;break;case"Not":return!F;default:return!0}}return A==="And"}},814:(r,t,s)=>{s.d(t,{cleanupTextLayer:()=>S,renderTextLayer:()=>I,updateTextLayer:()=>R});var n=s(292),a=s(419);const o=1e5,c=30,u=.8,d=new Map;let f=null;function m(){if(!f){const p=document.createElement("canvas");p.className="hiddenCanvasElement",document.body.append(p),f=p.getContext("2d",{alpha:!1})}return f}function S(){f==null||f.canvas.remove(),f=null}function _(p){const w=d.get(p);if(w)return w;const A=m(),C=A.font;A.canvas.width=A.canvas.height=c,A.font=`${c}px ${p}`;const B=A.measureText("");let F=B.fontBoundingBoxAscent,rt=Math.abs(B.fontBoundingBoxDescent);if(F){const st=F/(F+rt);return d.set(p,st),A.canvas.width=A.canvas.height=0,A.font=C,st}A.strokeStyle="red",A.clearRect(0,0,c,c),A.strokeText("g",0,0);let tt=A.getImageData(0,0,c,c).data;rt=0;for(let st=tt.length-1-3;st>=0;st-=4)if(tt[st]>0){rt=Math.ceil(st/4/c);break}A.clearRect(0,0,c,c),A.strokeText("A",0,c),tt=A.getImageData(0,0,c,c).data,F=0;for(let st=0,wt=tt.length;st<wt;st+=4)if(tt[st]>0){F=c-Math.floor(st/4/c);break}if(A.canvas.width=A.canvas.height=0,A.font=C,F){const st=F/(F+rt);return d.set(p,st),st}return d.set(p,u),u}function y(p,w,A){const C=document.createElement("span"),B={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};p._textDivs.push(C);const F=n.Util.transform(p._transform,w.transform);let rt=Math.atan2(F[1],F[0]);const tt=A[w.fontName];tt.vertical&&(rt+=Math.PI/2);const st=p._fontInspectorEnabled&&tt.fontSubstitution||tt.fontFamily,wt=Math.hypot(F[2],F[3]),dt=wt*_(st);let Tt,Lt;rt===0?(Tt=F[4],Lt=F[5]-dt):(Tt=F[4]+dt*Math.sin(rt),Lt=F[5]-dt*Math.cos(rt));const Qt="calc(var(--scale-factor)*",ct=C.style;p._container===p._rootContainer?(ct.left=`${(100*Tt/p._pageWidth).toFixed(2)}%`,ct.top=`${(100*Lt/p._pageHeight).toFixed(2)}%`):(ct.left=`${Qt}${Tt.toFixed(2)}px)`,ct.top=`${Qt}${Lt.toFixed(2)}px)`),ct.fontSize=`${Qt}${wt.toFixed(2)}px)`,ct.fontFamily=st,B.fontSize=wt,C.setAttribute("role","presentation"),C.textContent=w.str,C.dir=w.dir,p._fontInspectorEnabled&&(C.dataset.fontName=tt.fontSubstitutionLoadedName||w.fontName),rt!==0&&(B.angle=rt*(180/Math.PI));let Dt=!1;if(w.str.length>1)Dt=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const ee=Math.abs(w.transform[0]),zt=Math.abs(w.transform[3]);ee!==zt&&Math.max(ee,zt)/Math.min(ee,zt)>1.5&&(Dt=!0)}Dt&&(B.canvasWidth=tt.vertical?w.height:w.width),p._textDivProperties.set(C,B),p._isReadableStream&&p._layoutText(C)}function b(p){const{div:w,scale:A,properties:C,ctx:B,prevFontSize:F,prevFontFamily:rt}=p,{style:tt}=w;let st="";if(C.canvasWidth!==0&&C.hasText){const{fontFamily:wt}=tt,{canvasWidth:dt,fontSize:Tt}=C;(F!==Tt||rt!==wt)&&(B.font=`${Tt*A}px ${wt}`,p.prevFontSize=Tt,p.prevFontFamily=wt);const{width:Lt}=B.measureText(w.textContent);Lt>0&&(st=`scaleX(${dt*A/Lt})`)}C.angle!==0&&(st=`rotate(${C.angle}deg) ${st}`),st.length>0&&(tt.transform=st)}function x(p){if(p._canceled)return;const w=p._textDivs,A=p._capability;if(w.length>o){A.resolve();return}if(!p._isReadableStream)for(const C of w)p._layoutText(C);A.resolve()}class E{constructor({textContentSource:w,container:A,viewport:C,textDivs:B,textDivProperties:F,textContentItemsStr:rt}){var Tt;this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=A,this._textDivs=B||[],this._textContentItemsStr=rt||[],this._fontInspectorEnabled=!!((Tt=globalThis.FontInspector)!=null&&Tt.enabled),this._reader=null,this._textDivProperties=F||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:m()};const{pageWidth:tt,pageHeight:st,pageX:wt,pageY:dt}=C.rawDims;this._transform=[1,0,0,-1,-wt,dt+st],this._pageWidth=tt,this._pageHeight=st,(0,a.setLayerDimensions)(A,C),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(w,A){for(const C of w){if(C.str===void 0){if(C.type==="beginMarkedContentProps"||C.type==="beginMarkedContent"){const B=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),C.id!==null&&this._container.setAttribute("id",`${C.id}`),B.append(this._container)}else C.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(C.str),y(this,C,A)}}_layoutText(w){const A=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,b(this._layoutTextParams),A.hasText&&this._container.append(w),A.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),this._container.append(C)}}_render(){const{promise:w,resolve:A,reject:C}=Promise.withResolvers();let B=Object.create(null);if(this._isReadableStream){const F=()=>{this._reader.read().then(({value:rt,done:tt})=>{if(tt){A();return}Object.assign(B,rt.styles),this._processItems(rt.items,B),F()},C)};this._reader=this._textContentSource.getReader(),F()}else if(this._textContentSource){const{items:F,styles:rt}=this._textContentSource;this._processItems(F,rt),A()}else throw new Error('No "textContentSource" parameter specified.');w.then(()=>{B=null,x(this)},this._capability.reject)}}function I(p){const w=new E(p);return w._render(),w}function R({container:p,viewport:w,textDivs:A,textDivProperties:C,mustRotate:B=!0,mustRescale:F=!0}){if(B&&(0,a.setLayerDimensions)(p,{rotation:w.rotation}),F){const rt=m(),tt={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:rt};for(const st of A)tt.properties=C.get(st),tt.div=st,b(tt)}}},585:(r,t,s)=>{s.d(t,{PDFDataTransportStream:()=>o});var n=s(292),a=s(419);class o{constructor(f,{disableRange:m=!1,disableStream:S=!1}){(0,n.assert)(f,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:_,initialData:y,progressiveDone:b,contentDispositionFilename:x}=f;if(this._queuedChunks=[],this._progressiveDone=b,this._contentDispositionFilename=x,(y==null?void 0:y.length)>0){const E=y instanceof Uint8Array&&y.byteLength===y.buffer.byteLength?y.buffer:new Uint8Array(y).buffer;this._queuedChunks.push(E)}this._pdfDataRangeTransport=f,this._isStreamingSupported=!S,this._isRangeSupported=!m,this._contentLength=_,this._fullRequestReader=null,this._rangeReaders=[],f.addRangeListener((E,I)=>{this._onReceiveData({begin:E,chunk:I})}),f.addProgressListener((E,I)=>{this._onProgress({loaded:E,total:I})}),f.addProgressiveReadListener(E=>{this._onReceiveData({chunk:E})}),f.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),f.transportReady()}_onReceiveData({begin:f,chunk:m}){const S=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(f===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(S):this._queuedChunks.push(S);else{const _=this._rangeReaders.some(function(y){return y._begin!==f?!1:(y._enqueue(S),!0)});(0,n.assert)(_,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){var m,S,_,y;f.total===void 0?(S=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||S.call(m,{loaded:f.loaded}):(y=(_=this._fullRequestReader)==null?void 0:_.onProgress)==null||y.call(_,{loaded:f.loaded,total:f.total})}_onProgressiveDone(){var f;(f=this._fullRequestReader)==null||f.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const m=this._rangeReaders.indexOf(f);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new c(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,m){if(m<=this._progressiveDataLength)return null;const S=new u(this,f,m);return this._pdfDataRangeTransport.requestDataRange(f,m),this._rangeReaders.push(S),S}cancelAllRequests(f){var m;(m=this._fullRequestReader)==null||m.cancel(f);for(const S of this._rangeReaders.slice(0))S.cancel(f);this._pdfDataRangeTransport.abort()}}class c{constructor(f,m,S=!1,_=null){this._stream=f,this._done=S||!1,this._filename=(0,a.isPdfFile)(_)?_:null,this._queuedChunks=m||[],this._loaded=0;for(const y of this._queuedChunks)this._loaded+=y.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=Promise.withResolvers();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class u{constructor(f,m,S){this._stream=f,this._begin=m,this._end=S,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const f=Promise.withResolvers();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(r,t,s)=>{var a,o;s.d(t,{GlobalWorkerOptions:()=>n});class n{static get workerPort(){return l(this,a)}static set workerPort(u){if(!(typeof Worker<"u"&&u instanceof Worker)&&u!==null)throw new Error("Invalid `workerPort` type.");J(this,a,u)}static get workerSrc(){return l(this,o)}static set workerSrc(u){if(typeof u!="string")throw new Error("Invalid `workerSrc` type.");J(this,o,u)}}a=new WeakMap,o=new WeakMap,N(n,a,null),N(n,o,"")},284:(r,t,s)=>{s.d(t,{XfaLayer:()=>a});var n=s(50);class a{static setupStorage(c,u,d,f,m){const S=f.getValue(u,{value:null});switch(d.name){case"textarea":if(S.value!==null&&(c.textContent=S.value),m==="print")break;c.addEventListener("input",_=>{f.setValue(u,{value:_.target.value})});break;case"input":if(d.attributes.type==="radio"||d.attributes.type==="checkbox"){if(S.value===d.attributes.xfaOn?c.setAttribute("checked",!0):S.value===d.attributes.xfaOff&&c.removeAttribute("checked"),m==="print")break;c.addEventListener("change",_=>{f.setValue(u,{value:_.target.checked?_.target.getAttribute("xfaOn"):_.target.getAttribute("xfaOff")})})}else{if(S.value!==null&&c.setAttribute("value",S.value),m==="print")break;c.addEventListener("input",_=>{f.setValue(u,{value:_.target.value})})}break;case"select":if(S.value!==null){c.setAttribute("value",S.value);for(const _ of d.children)_.attributes.value===S.value?_.attributes.selected=!0:_.attributes.hasOwnProperty("selected")&&delete _.attributes.selected}c.addEventListener("input",_=>{const y=_.target.options,b=y.selectedIndex===-1?"":y[y.selectedIndex].value;f.setValue(u,{value:b})});break}}static setAttributes({html:c,element:u,storage:d=null,intent:f,linkService:m}){const{attributes:S}=u,_=c instanceof HTMLAnchorElement;S.type==="radio"&&(S.name=`${S.name}-${f}`);for(const[y,b]of Object.entries(S))if(b!=null)switch(y){case"class":b.length&&c.setAttribute(y,b.join(" "));break;case"dataId":break;case"id":c.setAttribute("data-element-id",b);break;case"style":Object.assign(c.style,b);break;case"textContent":c.textContent=b;break;default:(!_||y!=="href"&&y!=="newWindow")&&c.setAttribute(y,b)}_&&m.addLinkAttributes(c,S.href,S.newWindow),d&&S.dataId&&this.setupStorage(c,S.dataId,u,d)}static render(c){var E,I;const u=c.annotationStorage,d=c.linkService,f=c.xfaHtml,m=c.intent||"display",S=document.createElement(f.name);f.attributes&&this.setAttributes({html:S,element:f,intent:m,linkService:d});const _=m!=="richText",y=c.div;if(y.append(S),c.viewport){const R=`matrix(${c.viewport.transform.join(",")})`;y.style.transform=R}_&&y.setAttribute("class","xfaLayer xfaFont");const b=[];if(f.children.length===0){if(f.value){const R=document.createTextNode(f.value);S.append(R),_&&n.XfaText.shouldBuildText(f.name)&&b.push(R)}return{textDivs:b}}const x=[[f,-1,S]];for(;x.length>0;){const[R,p,w]=x.at(-1);if(p+1===R.children.length){x.pop();continue}const A=R.children[++x.at(-1)[1]];if(A===null)continue;const{name:C}=A;if(C==="#text"){const F=document.createTextNode(A.value);b.push(F),w.append(F);continue}const B=(E=A==null?void 0:A.attributes)!=null&&E.xmlns?document.createElementNS(A.attributes.xmlns,C):document.createElement(C);if(w.append(B),A.attributes&&this.setAttributes({html:B,element:A,storage:u,intent:m,linkService:d}),((I=A.children)==null?void 0:I.length)>0)x.push([A,-1,B]);else if(A.value){const F=document.createTextNode(A.value);_&&n.XfaText.shouldBuildText(C)&&b.push(F),B.append(F)}}for(const R of y.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))R.setAttribute("readOnly",!0);return{textDivs:b}}static update(c){const u=`matrix(${c.viewport.transform.join(",")})`;c.div.style.transform=u,c.div.hidden=!1}}},50:(r,t,s)=>{s.d(t,{XfaText:()=>n});class n{static textContent(o){const c=[],u={items:c,styles:Object.create(null)};function d(f){var _;if(!f)return;let m=null;const S=f.name;if(S==="#text")m=f.value;else if(n.shouldBuildText(S))(_=f==null?void 0:f.attributes)!=null&&_.textContent?m=f.attributes.textContent:f.value&&(m=f.value);else return;if(m!==null&&c.push({str:m}),!!f.children)for(const y of f.children)d(y)}return d(o),u}static shouldBuildText(o){return!(o==="textarea"||o==="input"||o==="option"||o==="select")}}},228:(r,t,s)=>{s.a(r,async(n,a)=>{try{s.d(t,{AbortException:()=>o.AbortException,AnnotationEditorLayer:()=>f.AnnotationEditorLayer,AnnotationEditorParamsType:()=>o.AnnotationEditorParamsType,AnnotationEditorType:()=>o.AnnotationEditorType,AnnotationEditorUIManager:()=>m.AnnotationEditorUIManager,AnnotationLayer:()=>S.AnnotationLayer,AnnotationMode:()=>o.AnnotationMode,CMapCompressionType:()=>o.CMapCompressionType,ColorPicker:()=>_.ColorPicker,DOMSVGFactory:()=>u.DOMSVGFactory,DrawLayer:()=>y.DrawLayer,FeatureTest:()=>o.FeatureTest,GlobalWorkerOptions:()=>b.GlobalWorkerOptions,ImageKind:()=>o.ImageKind,InvalidPDFException:()=>o.InvalidPDFException,MissingPDFException:()=>o.MissingPDFException,OPS:()=>o.OPS,Outliner:()=>x.Outliner,PDFDataRangeTransport:()=>c.PDFDataRangeTransport,PDFDateString:()=>u.PDFDateString,PDFWorker:()=>c.PDFWorker,PasswordResponses:()=>o.PasswordResponses,PermissionFlag:()=>o.PermissionFlag,PixelsPerInch:()=>u.PixelsPerInch,RenderingCancelledException:()=>u.RenderingCancelledException,UnexpectedResponseException:()=>o.UnexpectedResponseException,Util:()=>o.Util,VerbosityLevel:()=>o.VerbosityLevel,XfaLayer:()=>E.XfaLayer,build:()=>c.build,createValidAbsoluteUrl:()=>o.createValidAbsoluteUrl,fetchData:()=>u.fetchData,getDocument:()=>c.getDocument,getFilenameFromUrl:()=>u.getFilenameFromUrl,getPdfFilenameFromUrl:()=>u.getPdfFilenameFromUrl,getXfaPageViewport:()=>u.getXfaPageViewport,isDataScheme:()=>u.isDataScheme,isPdfFile:()=>u.isPdfFile,noContextMenu:()=>u.noContextMenu,normalizeUnicode:()=>o.normalizeUnicode,renderTextLayer:()=>d.renderTextLayer,setLayerDimensions:()=>u.setLayerDimensions,shadow:()=>o.shadow,updateTextLayer:()=>d.updateTextLayer,version:()=>c.version});var o=s(292),c=s(831),u=s(419),d=s(814),f=s(731),m=s(830),S=s(976),_=s(259),y=s(47),b=s(164),x=s(61),E=s(284),I=n([c]);c=(I.then?(await I)():I)[0];const R="4.2.67",p="49b388101";a()}catch(R){a(R)}})},178:(r,t,s)=>{var d,F1,m,I1,_,fc;s.d(t,{MessageHandler:()=>u});var n=s(292);const a={UNKNOWN:0,DATA:1,ERROR:2},o={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function c(b){switch(b instanceof Error||typeof b=="object"&&b!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),b.name){case"AbortException":return new n.AbortException(b.message);case"MissingPDFException":return new n.MissingPDFException(b.message);case"PasswordException":return new n.PasswordException(b.message,b.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(b.message,b.status);case"UnknownErrorException":return new n.UnknownErrorException(b.message,b.details);default:return new n.UnknownErrorException(b.message,b.toString())}}class u{constructor(x,E,I){N(this,d);N(this,m);N(this,_);this.sourceName=x,this.targetName=E,this.comObj=I,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=R=>{const p=R.data;if(p.targetName!==this.sourceName)return;if(p.stream){Y(this,m,I1).call(this,p);return}if(p.callback){const A=p.callbackId,C=this.callbackCapabilities[A];if(!C)throw new Error(`Cannot resolve callback ${A}`);if(delete this.callbackCapabilities[A],p.callback===a.DATA)C.resolve(p.data);else if(p.callback===a.ERROR)C.reject(c(p.reason));else throw new Error("Unexpected callback case");return}const w=this.actionHandler[p.action];if(!w)throw new Error(`Unknown action from worker: ${p.action}`);if(p.callbackId){const A=this.sourceName,C=p.sourceName;new Promise(function(B){B(w(p.data))}).then(function(B){I.postMessage({sourceName:A,targetName:C,callback:a.DATA,callbackId:p.callbackId,data:B})},function(B){I.postMessage({sourceName:A,targetName:C,callback:a.ERROR,callbackId:p.callbackId,reason:c(B)})});return}if(p.streamId){Y(this,d,F1).call(this,p);return}w(p.data)},I.addEventListener("message",this._onComObjOnMessage)}on(x,E){const I=this.actionHandler;if(I[x])throw new Error(`There is already an actionName called "${x}"`);I[x]=E}send(x,E,I){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,data:E},I)}sendWithPromise(x,E,I){const R=this.callbackId++,p=Promise.withResolvers();this.callbackCapabilities[R]=p;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,callbackId:R,data:E},I)}catch(w){p.reject(w)}return p.promise}sendWithStream(x,E,I,R){const p=this.streamId++,w=this.sourceName,A=this.targetName,C=this.comObj;return new ReadableStream({start:B=>{const F=Promise.withResolvers();return this.streamControllers[p]={controller:B,startCall:F,pullCall:null,cancelCall:null,isClosed:!1},C.postMessage({sourceName:w,targetName:A,action:x,streamId:p,data:E,desiredSize:B.desiredSize},R),F.promise},pull:B=>{const F=Promise.withResolvers();return this.streamControllers[p].pullCall=F,C.postMessage({sourceName:w,targetName:A,stream:o.PULL,streamId:p,desiredSize:B.desiredSize}),F.promise},cancel:B=>{(0,n.assert)(B instanceof Error,"cancel must have a valid reason");const F=Promise.withResolvers();return this.streamControllers[p].cancelCall=F,this.streamControllers[p].isClosed=!0,C.postMessage({sourceName:w,targetName:A,stream:o.CANCEL,streamId:p,reason:c(B)}),F.promise}},I)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}d=new WeakSet,F1=function(x){const E=x.streamId,I=this.sourceName,R=x.sourceName,p=this.comObj,w=this,A=this.actionHandler[x.action],C={enqueue(B,F=1,rt){if(this.isCancelled)return;const tt=this.desiredSize;this.desiredSize-=F,tt>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),p.postMessage({sourceName:I,targetName:R,stream:o.ENQUEUE,streamId:E,chunk:B},rt)},close(){this.isCancelled||(this.isCancelled=!0,p.postMessage({sourceName:I,targetName:R,stream:o.CLOSE,streamId:E}),delete w.streamSinks[E])},error(B){(0,n.assert)(B instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,p.postMessage({sourceName:I,targetName:R,stream:o.ERROR,streamId:E,reason:c(B)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:x.desiredSize,ready:null};C.sinkCapability.resolve(),C.ready=C.sinkCapability.promise,this.streamSinks[E]=C,new Promise(function(B){B(A(x.data,C))}).then(function(){p.postMessage({sourceName:I,targetName:R,stream:o.START_COMPLETE,streamId:E,success:!0})},function(B){p.postMessage({sourceName:I,targetName:R,stream:o.START_COMPLETE,streamId:E,reason:c(B)})})},m=new WeakSet,I1=function(x){const E=x.streamId,I=this.sourceName,R=x.sourceName,p=this.comObj,w=this.streamControllers[E],A=this.streamSinks[E];switch(x.stream){case o.START_COMPLETE:x.success?w.startCall.resolve():w.startCall.reject(c(x.reason));break;case o.PULL_COMPLETE:x.success?w.pullCall.resolve():w.pullCall.reject(c(x.reason));break;case o.PULL:if(!A){p.postMessage({sourceName:I,targetName:R,stream:o.PULL_COMPLETE,streamId:E,success:!0});break}A.desiredSize<=0&&x.desiredSize>0&&A.sinkCapability.resolve(),A.desiredSize=x.desiredSize,new Promise(function(C){var B;C((B=A.onPull)==null?void 0:B.call(A))}).then(function(){p.postMessage({sourceName:I,targetName:R,stream:o.PULL_COMPLETE,streamId:E,success:!0})},function(C){p.postMessage({sourceName:I,targetName:R,stream:o.PULL_COMPLETE,streamId:E,reason:c(C)})});break;case o.ENQUEUE:if((0,n.assert)(w,"enqueue should have stream controller"),w.isClosed)break;w.controller.enqueue(x.chunk);break;case o.CLOSE:if((0,n.assert)(w,"close should have stream controller"),w.isClosed)break;w.isClosed=!0,w.controller.close(),Y(this,_,fc).call(this,w,E);break;case o.ERROR:(0,n.assert)(w,"error should have stream controller"),w.controller.error(c(x.reason)),Y(this,_,fc).call(this,w,E);break;case o.CANCEL_COMPLETE:x.success?w.cancelCall.resolve():w.cancelCall.reject(c(x.reason)),Y(this,_,fc).call(this,w,E);break;case o.CANCEL:if(!A)break;new Promise(function(C){var B;C((B=A.onCancel)==null?void 0:B.call(A,c(x.reason)))}).then(function(){p.postMessage({sourceName:I,targetName:R,stream:o.CANCEL_COMPLETE,streamId:E,success:!0})},function(C){p.postMessage({sourceName:I,targetName:R,stream:o.CANCEL_COMPLETE,streamId:E,reason:c(C)})}),A.sinkCapability.reject(c(x.reason)),A.isCancelled=!0,delete this.streamSinks[E];break;default:throw new Error("Unexpected stream case")}},_=new WeakSet,fc=async function(x,E){var I,R,p;await Promise.allSettled([(I=x.startCall)==null?void 0:I.promise,(R=x.pullCall)==null?void 0:R.promise,(p=x.cancelCall)==null?void 0:p.promise]),delete this.streamControllers[E]}},651:(r,t,s)=>{s.d(t,{MurmurHash3_64:()=>c});const n=3285377520,a=4294901760,o=65535;class c{constructor(d){this.h1=d?d&4294967295:n,this.h2=d?d&4294967295:n}update(d){let f,m;if(typeof d=="string"){f=new Uint8Array(d.length*2),m=0;for(let C=0,B=d.length;C<B;C++){const F=d.charCodeAt(C);F<=255?f[m++]=F:(f[m++]=F>>>8,f[m++]=F&255)}}else if(ArrayBuffer.isView(d))f=d.slice(),m=f.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const S=m>>2,_=m-S*4,y=new Uint32Array(f.buffer,0,S);let b=0,x=0,E=this.h1,I=this.h2;const R=3432918353,p=461845907,w=R&o,A=p&o;for(let C=0;C<S;C++)C&1?(b=y[C],b=b*R&a|b*w&o,b=b<<15|b>>>17,b=b*p&a|b*A&o,E^=b,E=E<<13|E>>>19,E=E*5+3864292196):(x=y[C],x=x*R&a|x*w&o,x=x<<15|x>>>17,x=x*p&a|x*A&o,I^=x,I=I<<13|I>>>19,I=I*5+3864292196);switch(b=0,_){case 3:b^=f[S*4+2]<<16;case 2:b^=f[S*4+1]<<8;case 1:b^=f[S*4],b=b*R&a|b*w&o,b=b<<15|b>>>17,b=b*p&a|b*A&o,S&1?E^=b:I^=b}this.h1=E,this.h2=I}hexdigest(){let d=this.h1,f=this.h2;return d^=f>>>1,d=d*3981806797&a|d*36045&o,f=f*4283543511&a|((f<<16|d>>>16)*2950163797&a)>>>16,d^=f>>>1,d=d*444984403&a|d*60499&o,f=f*3301882366&a|((f<<16|d>>>16)*3120437893&a)>>>16,d^=f>>>1,(d>>>0).toString(16).padStart(8,"0")+(f>>>0).toString(16).padStart(8,"0")}}},292:(r,t,s)=>{var V,gc,G,lf;s.d(t,{AbortException:()=>pe,AnnotationBorderStyleType:()=>I,AnnotationEditorParamsType:()=>_,AnnotationEditorPrefix:()=>m,AnnotationEditorType:()=>S,AnnotationMode:()=>f,AnnotationPrefix:()=>H,AnnotationType:()=>E,BaseException:()=>Qt,CMapCompressionType:()=>p,FONT_IDENTITY_MATRIX:()=>o,FeatureTest:()=>ve,FontRenderOps:()=>L,FormatError:()=>oe,IDENTITY_MATRIX:()=>a,ImageKind:()=>x,InvalidPDFException:()=>ee,LINE_FACTOR:()=>u,MAX_IMAGE_SIZE_TO_CACHE:()=>c,MissingPDFException:()=>zt,OPS:()=>w,PasswordException:()=>ct,PasswordResponses:()=>A,PermissionFlag:()=>y,RenderingIntentFlag:()=>d,TextRenderingMode:()=>b,UnexpectedResponseException:()=>Jt,UnknownErrorException:()=>Dt,Util:()=>xe,VerbosityLevel:()=>R,assert:()=>wt,bytesToString:()=>Ae,createValidAbsoluteUrl:()=>Tt,getUuid:()=>D,getVerbosityLevel:()=>F,info:()=>rt,isNodeJS:()=>n,normalizeUnicode:()=>M,objectFromMap:()=>lt,setVerbosityLevel:()=>B,shadow:()=>Lt,string32:()=>Gt,stringToBytes:()=>Ve,unreachable:()=>st,warn:()=>tt});const n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),a=[1,0,0,1,0,0],o=[.001,0,0,.001,0,0],c=1e7,u=1.35,d={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},m="pdfjs_internal_editor_",S={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},_={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},y={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},b={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},x={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},E={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},I={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},R={ERRORS:0,WARNINGS:1,INFOS:5},p={NONE:0,BINARY:1},w={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},A={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let C=R.WARNINGS;function B(U){Number.isInteger(U)&&(C=U)}function F(){return C}function rt(U){C>=R.INFOS&&console.log(`Info: ${U}`)}function tt(U){C>=R.WARNINGS&&console.log(`Warning: ${U}`)}function st(U){throw new Error(U)}function wt(U,O){U||st(O)}function dt(U){switch(U==null?void 0:U.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Tt(U,O=null,z=null){var et;if(!U)return null;try{if(z&&typeof U=="string"&&(z.addDefaultProtocol&&U.startsWith("www.")&&((et=U.match(/\./g))==null?void 0:et.length)>=2&&(U=`http://${U}`),z.tryConvertEncoding))try{U=_e(U)}catch{}const nt=O?new URL(U,O):new URL(U);if(dt(nt))return nt}catch{}return null}function Lt(U,O,z,et=!1){return Object.defineProperty(U,O,{value:z,enumerable:!et,configurable:!0,writable:!1}),z}const Qt=function(){function U(O,z){this.constructor===U&&st("Cannot initialize BaseException."),this.message=O,this.name=z}return U.prototype=new Error,U.constructor=U,U}();class ct extends Qt{constructor(O,z){super(O,"PasswordException"),this.code=z}}class Dt extends Qt{constructor(O,z){super(O,"UnknownErrorException"),this.details=z}}class ee extends Qt{constructor(O){super(O,"InvalidPDFException")}}class zt extends Qt{constructor(O){super(O,"MissingPDFException")}}class Jt extends Qt{constructor(O,z){super(O,"UnexpectedResponseException"),this.status=z}}class oe extends Qt{constructor(O){super(O,"FormatError")}}class pe extends Qt{constructor(O){super(O,"AbortException")}}function Ae(U){(typeof U!="object"||(U==null?void 0:U.length)===void 0)&&st("Invalid argument for bytesToString");const O=U.length,z=8192;if(O<z)return String.fromCharCode.apply(null,U);const et=[];for(let nt=0;nt<O;nt+=z){const pt=Math.min(nt+z,O),yt=U.subarray(nt,pt);et.push(String.fromCharCode.apply(null,yt))}return et.join("")}function Ve(U){typeof U!="string"&&st("Invalid argument for stringToBytes");const O=U.length,z=new Uint8Array(O);for(let et=0;et<O;++et)z[et]=U.charCodeAt(et)&255;return z}function Gt(U){return String.fromCharCode(U>>24&255,U>>16&255,U>>8&255,U&255)}function lt(U){const O=Object.create(null);for(const[z,et]of U)O[z]=et;return O}function Ft(){const U=new Uint8Array(4);return U[0]=1,new Uint32Array(U.buffer,0,1)[0]===1}function Wt(){try{return new Function(""),!0}catch{return!1}}class ve{static get isLittleEndian(){return Lt(this,"isLittleEndian",Ft())}static get isEvalSupported(){return Lt(this,"isEvalSupported",Wt())}static get isOffscreenCanvasSupported(){return Lt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Lt(this,"platform",{isMac:navigator.platform.includes("Mac")}):Lt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var O,z;return Lt(this,"isCSSRoundSupported",(z=(O=globalThis.CSS)==null?void 0:O.supports)==null?void 0:z.call(O,"width: round(1.5px, 1px)"))}}const ie=Array.from(Array(256).keys(),U=>U.toString(16).padStart(2,"0"));class xe{static makeHexColor(O,z,et){return`#${ie[O]}${ie[z]}${ie[et]}`}static scaleMinMax(O,z){let et;O[0]?(O[0]<0&&(et=z[0],z[0]=z[2],z[2]=et),z[0]*=O[0],z[2]*=O[0],O[3]<0&&(et=z[1],z[1]=z[3],z[3]=et),z[1]*=O[3],z[3]*=O[3]):(et=z[0],z[0]=z[1],z[1]=et,et=z[2],z[2]=z[3],z[3]=et,O[1]<0&&(et=z[1],z[1]=z[3],z[3]=et),z[1]*=O[1],z[3]*=O[1],O[2]<0&&(et=z[0],z[0]=z[2],z[2]=et),z[0]*=O[2],z[2]*=O[2]),z[0]+=O[4],z[1]+=O[5],z[2]+=O[4],z[3]+=O[5]}static transform(O,z){return[O[0]*z[0]+O[2]*z[1],O[1]*z[0]+O[3]*z[1],O[0]*z[2]+O[2]*z[3],O[1]*z[2]+O[3]*z[3],O[0]*z[4]+O[2]*z[5]+O[4],O[1]*z[4]+O[3]*z[5]+O[5]]}static applyTransform(O,z){const et=O[0]*z[0]+O[1]*z[2]+z[4],nt=O[0]*z[1]+O[1]*z[3]+z[5];return[et,nt]}static applyInverseTransform(O,z){const et=z[0]*z[3]-z[1]*z[2],nt=(O[0]*z[3]-O[1]*z[2]+z[2]*z[5]-z[4]*z[3])/et,pt=(-O[0]*z[1]+O[1]*z[0]+z[4]*z[1]-z[5]*z[0])/et;return[nt,pt]}static getAxialAlignedBoundingBox(O,z){const et=this.applyTransform(O,z),nt=this.applyTransform(O.slice(2,4),z),pt=this.applyTransform([O[0],O[3]],z),yt=this.applyTransform([O[2],O[1]],z);return[Math.min(et[0],nt[0],pt[0],yt[0]),Math.min(et[1],nt[1],pt[1],yt[1]),Math.max(et[0],nt[0],pt[0],yt[0]),Math.max(et[1],nt[1],pt[1],yt[1])]}static inverseTransform(O){const z=O[0]*O[3]-O[1]*O[2];return[O[3]/z,-O[1]/z,-O[2]/z,O[0]/z,(O[2]*O[5]-O[4]*O[3])/z,(O[4]*O[1]-O[5]*O[0])/z]}static singularValueDecompose2dScale(O){const z=[O[0],O[2],O[1],O[3]],et=O[0]*z[0]+O[1]*z[2],nt=O[0]*z[1]+O[1]*z[3],pt=O[2]*z[0]+O[3]*z[2],yt=O[2]*z[1]+O[3]*z[3],Nt=(et+yt)/2,Ht=Math.sqrt((et+yt)**2-4*(et*yt-pt*nt))/2,Pt=Nt+Ht||1,Bt=Nt-Ht||1;return[Math.sqrt(Pt),Math.sqrt(Bt)]}static normalizeRect(O){const z=O.slice(0);return O[0]>O[2]&&(z[0]=O[2],z[2]=O[0]),O[1]>O[3]&&(z[1]=O[3],z[3]=O[1]),z}static intersect(O,z){const et=Math.max(Math.min(O[0],O[2]),Math.min(z[0],z[2])),nt=Math.min(Math.max(O[0],O[2]),Math.max(z[0],z[2]));if(et>nt)return null;const pt=Math.max(Math.min(O[1],O[3]),Math.min(z[1],z[3])),yt=Math.min(Math.max(O[1],O[3]),Math.max(z[1],z[3]));return pt>yt?null:[et,pt,nt,yt]}static bezierBoundingBox(O,z,et,nt,pt,yt,Nt,Ht,Pt){return Pt?(Pt[0]=Math.min(Pt[0],O,Nt),Pt[1]=Math.min(Pt[1],z,Ht),Pt[2]=Math.max(Pt[2],O,Nt),Pt[3]=Math.max(Pt[3],z,Ht)):Pt=[Math.min(O,Nt),Math.min(z,Ht),Math.max(O,Nt),Math.max(z,Ht)],Y(this,G,lf).call(this,O,et,pt,Nt,z,nt,yt,Ht,3*(-O+3*(et-pt)+Nt),6*(O-2*et+pt),3*(et-O),Pt),Y(this,G,lf).call(this,O,et,pt,Nt,z,nt,yt,Ht,3*(-z+3*(nt-yt)+Ht),6*(z-2*nt+yt),3*(nt-z),Pt),Pt}}V=new WeakSet,gc=function(O,z,et,nt,pt,yt,Nt,Ht,Pt,Bt){if(Pt<=0||Pt>=1)return;const Z=1-Pt,at=Pt*Pt,_t=at*Pt,vt=Z*(Z*(Z*O+3*Pt*z)+3*at*et)+_t*nt,jt=Z*(Z*(Z*pt+3*Pt*yt)+3*at*Nt)+_t*Ht;Bt[0]=Math.min(Bt[0],vt),Bt[1]=Math.min(Bt[1],jt),Bt[2]=Math.max(Bt[2],vt),Bt[3]=Math.max(Bt[3],jt)},G=new WeakSet,lf=function(O,z,et,nt,pt,yt,Nt,Ht,Pt,Bt,Z,at){if(Math.abs(Pt)<1e-12){Math.abs(Bt)>=1e-12&&Y(this,V,gc).call(this,O,z,et,nt,pt,yt,Nt,Ht,-Z/Bt,at);return}const _t=Bt**2-4*Z*Pt;if(_t<0)return;const vt=Math.sqrt(_t),jt=2*Pt;Y(this,V,gc).call(this,O,z,et,nt,pt,yt,Nt,Ht,(-Bt+vt)/jt,at),Y(this,V,gc).call(this,O,z,et,nt,pt,yt,Nt,Ht,(-Bt-vt)/jt,at)},N(xe,V),N(xe,G);function _e(U){return decodeURIComponent(escape(U))}let ut=null,T=null;function M(U){return ut||(ut=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,T=new Map([["\uFB05","\u017Ft"]])),U.replaceAll(ut,(O,z,et)=>z?z.normalize("NFKC"):T.get(et))}function D(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const U=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(U);else for(let O=0;O<32;O++)U[O]=Math.floor(Math.random()*255);return Ae(U)}const H="pdfjs_internal_id_",L={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8}}},Pi={};function Mi(r){var t=Pi[r];if(t!==void 0)return t.exports;var s=Pi[r]={exports:{}};return Ni[r](s,s.exports,Mi),s.exports}(()=>{var r=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",t=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",s=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",n=o=>{o&&o.d<1&&(o.d=1,o.forEach(c=>c.r--),o.forEach(c=>c.r--?c.r++:c()))},a=o=>o.map(c=>{if(c!==null&&typeof c=="object"){if(c[r])return c;if(c.then){var u=[];u.d=0,c.then(m=>{d[t]=m,n(u)},m=>{d[s]=m,n(u)});var d={};return d[r]=m=>m(u),d}}var f={};return f[r]=m=>{},f[t]=c,f});Mi.a=(o,c,u)=>{var d;u&&((d=[]).d=-1);var f=new Set,m=o.exports,S,_,y,b=new Promise((x,E)=>{y=E,_=x});b[t]=m,b[r]=x=>(d&&x(d),f.forEach(x),b.catch(E=>{})),o.exports=b,c(x=>{S=a(x);var E,I=()=>S.map(p=>{if(p[s])throw p[s];return p[t]}),R=new Promise(p=>{E=()=>p(I),E.r=0;var w=A=>A!==d&&!f.has(A)&&(f.add(A),A&&!A.d&&(E.r++,A.push(E)));S.map(A=>A[r](w))});return E.r?R:I()},x=>(x?y(b[s]=x):_(m),n(d))),d&&d.d<0&&(d.d=0)}})(),Mi.d=(r,t)=>{for(var s in t)Mi.o(t,s)&&!Mi.o(r,s)&&Object.defineProperty(r,s,{enumerable:!0,get:t[s]})},Mi.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var Be=Mi(228);Be=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=Be),Be.AbortException,Be.AnnotationEditorLayer,Be.AnnotationEditorParamsType,Be.AnnotationEditorType,Be.AnnotationEditorUIManager,Be.AnnotationLayer,Be.AnnotationMode,Be.CMapCompressionType,Be.ColorPicker,Be.DOMSVGFactory,Be.DrawLayer,Be.FeatureTest,x0=Be.GlobalWorkerOptions,Be.ImageKind,Be.InvalidPDFException,Be.MissingPDFException,Be.OPS,Be.Outliner,Be.PDFDataRangeTransport,Be.PDFDateString,Be.PDFWorker,Be.PasswordResponses,Be.PermissionFlag,Be.PixelsPerInch,Be.RenderingCancelledException,Be.UnexpectedResponseException,Be.Util,Be.VerbosityLevel,Be.XfaLayer,Be.build,Be.createValidAbsoluteUrl,Be.fetchData,_0=Be.getDocument,Be.getFilenameFromUrl,Be.getPdfFilenameFromUrl,Be.getXfaPageViewport,Be.isDataScheme,Be.isPdfFile,Be.noContextMenu,Be.normalizeUnicode,Be.renderTextLayer,Be.setLayerDimensions,Be.shadow,Be.updateTextLayer,Be.version;const Aa=0,ws=1,Sa=2,hf=4;function cf(r,t){return s=>r(t(s))}function L1(r,t){return t(r)}function df(r,t){return s=>r(t,s)}function uf(r,t){return()=>r(t)}function Qo(r,t){return t(r),r}function Gi(...r){return r}function D1(r){r()}function ff(r){return()=>r}function N1(...r){return()=>{r.map(D1)}}function pc(r){return r!==void 0}function Ea(){}function Ci(r,t){return r(ws,t)}function ii(r,t){r(Aa,t)}function mc(r){r(Sa)}function Ir(r){return r(hf)}function Ne(r,t){return Ci(r,df(t,Aa))}function zn(r,t){const s=r(ws,n=>{s(),t(n)});return s}function _i(){const r=[];return(t,s)=>{switch(t){case Sa:r.splice(0,r.length);return;case ws:return r.push(s),()=>{const n=r.indexOf(s);n>-1&&r.splice(n,1)};case Aa:r.slice().forEach(n=>{n(s)});return;default:throw new Error(`unrecognized action ${t}`)}}}function Ee(r){let t=r;const s=_i();return(n,a)=>{switch(n){case ws:a(t);break;case Aa:t=a;break;case hf:return t}return s(n,a)}}function O1(r){let t,s;const n=()=>t&&t();return function(a,o){switch(a){case ws:return o?s===o?void 0:(n(),s=o,t=Ci(r,o),t):(n(),Ea);case Sa:n(),s=null;return;default:throw new Error(`unrecognized action ${a}`)}}}function rn(r){return Qo(_i(),t=>Ne(r,t))}function Br(r,t){return Qo(Ee(t),s=>Ne(r,s))}function z1(...r){return t=>r.reduceRight(L1,t)}function ce(r,...t){const s=z1(...t);return(n,a)=>{switch(n){case ws:return Ci(r,s(a));case Sa:mc(r);return}}}function gf(r,t){return r===t}function ji(r=gf){let t;return s=>n=>{r(t,n)||(t=n,s(n))}}function $e(r){return t=>s=>{r(s)&&t(s)}}function Fe(r){return t=>cf(t,r)}function Hn(r){return t=>()=>t(r)}function Bn(r,t){return s=>n=>s(t=r(t,n))}function Ca(r){return t=>s=>{r>0?r--:t(s)}}function As(r){let t=null,s;return n=>a=>{t=a,!s&&(s=setTimeout(()=>{s=void 0,n(t)},r))}}function pf(r){let t,s;return n=>a=>{t=a,s&&clearTimeout(s),s=setTimeout(()=>{n(t)},r)}}function li(...r){const t=new Array(r.length);let s=0,n=null;const a=Math.pow(2,r.length)-1;return r.forEach((o,c)=>{const u=Math.pow(2,c);Ci(o,d=>{const f=s;s=s|u,t[c]=d,f!==a&&s===a&&n&&(n(),n=null)})}),o=>c=>{const u=()=>o([c].concat(t));s===a?u():n=u}}function mf(...r){return function(t,s){switch(t){case ws:return N1(...r.map(n=>Ci(n,s)));case Sa:return;default:throw new Error(`unrecognized action ${t}`)}}}function Ke(r,t=gf){return ce(r,ji(t))}function xr(...r){const t=_i(),s=new Array(r.length);let n=0;const a=Math.pow(2,r.length)-1;return r.forEach((o,c)=>{const u=Math.pow(2,c);Ci(o,d=>{s[c]=d,n=n|u,n===a&&ii(t,s)})}),function(o,c){switch(o){case ws:return n===a&&c(s),Ci(t,c);case Sa:return mc(t);default:throw new Error(`unrecognized action ${o}`)}}}function ki(r,t=[],{singleton:s}={singleton:!0}){return{id:H1(),constructor:r,dependencies:t,singleton:s}}const H1=()=>Symbol();function B1(r){const t=new Map,s=({id:n,constructor:a,dependencies:o,singleton:c})=>{if(c&&t.has(n))return t.get(n);const u=a(o.map(d=>s(d)));return c&&t.set(n,u),u};return s(r)}function U1(r,t){const s={},n={};let a=0;const o=r.length;for(;a<o;)n[r[a]]=1,a+=1;for(const c in t)n.hasOwnProperty(c)||(s[c]=t[c]);return s}const Zo=typeof document<"u"?se.useLayoutEffect:se.useEffect;function vf(r,t,s){const n=Object.keys(t.required||{}),a=Object.keys(t.optional||{}),o=Object.keys(t.methods||{}),c=Object.keys(t.events||{}),u=se.createContext({});function d(E,I){E.propsReady&&ii(E.propsReady,!1);for(const R of n){const p=E[t.required[R]];ii(p,I[R])}for(const R of a)if(R in I){const p=E[t.optional[R]];ii(p,I[R])}E.propsReady&&ii(E.propsReady,!0)}function f(E){return o.reduce((I,R)=>(I[R]=p=>{const w=E[t.methods[R]];ii(w,p)},I),{})}function m(E){return c.reduce((I,R)=>(I[R]=O1(E[t.events[R]]),I),{})}const S=se.forwardRef((E,I)=>{const{children:R,...p}=E,[w]=se.useState(()=>Qo(B1(r),C=>d(C,p))),[A]=se.useState(uf(m,w));return Zo(()=>{for(const C of c)C in p&&Ci(A[C],p[C]);return()=>{Object.values(A).map(mc)}},[p,A,w]),Zo(()=>{d(w,p)}),se.useImperativeHandle(I,ff(f(w))),se.createElement(u.Provider,{value:w},s?se.createElement(s,U1([...n,...a,...c],p),R):R)}),_=E=>se.useCallback(df(ii,se.useContext(u)[E]),[E]),y=E=>{const I=se.useContext(u)[E],R=se.useCallback(p=>Ci(I,p),[I]);return se.useSyncExternalStore(R,()=>Ir(I),()=>Ir(I))},b=E=>{const I=se.useContext(u)[E],[R,p]=se.useState(uf(Ir,I));return Zo(()=>Ci(I,w=>{w!==R&&p(ff(w))}),[I,R]),R},x=se.version.startsWith("18")?y:b;return{Component:S,usePublisher:_,useEmitterValue:x,useEmitter:(E,I)=>{const R=se.useContext(u)[E];Zo(()=>Ci(R,I),[I,R])}}}const G1=typeof document<"u"?se.useLayoutEffect:se.useEffect,j1=G1;var nn=(r=>(r[r.DEBUG=0]="DEBUG",r[r.INFO=1]="INFO",r[r.WARN=2]="WARN",r[r.ERROR=3]="ERROR",r))(nn||{});const V1={[0]:"debug",[1]:"log",[2]:"warn",[3]:"error"},W1=()=>typeof globalThis>"u"?window:globalThis,Ss=ki(()=>{const r=Ee(3);return{log:Ee((t,s,n=1)=>{var a;const o=(a=W1().VIRTUOSO_LOG_LEVEL)!=null?a:Ir(r);n>=o&&console[V1[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,s)}),logLevel:r}},[],{singleton:!0});function vc(r,t=!0){const s=se.useRef(null);let n=a=>{};if(typeof ResizeObserver<"u"){const a=se.useMemo(()=>new ResizeObserver(o=>{requestAnimationFrame(()=>{const c=o[0].target;c.offsetParent!==null&&r(c)})}),[r]);n=o=>{o&&t?(a.observe(o),s.current=o):(s.current&&a.unobserve(s.current),s.current=null)}}return{ref:s,callbackRef:n}}function Xs(r,t=!0){return vc(r,t).callbackRef}function $1(r,t,s,n,a,o,c){const u=se.useCallback(d=>{const f=K1(d.children,t,"offsetHeight",a);let m=d.parentElement;for(;!m.dataset.virtuosoScroller;)m=m.parentElement;const S=m.lastElementChild.dataset.viewportType==="window",_=c?c.scrollTop:S?window.pageYOffset||document.documentElement.scrollTop:m.scrollTop,y=c?c.scrollHeight:S?document.documentElement.scrollHeight:m.scrollHeight,b=c?c.offsetHeight:S?window.innerHeight:m.offsetHeight;n({scrollTop:Math.max(_,0),scrollHeight:y,viewportHeight:b}),o==null||o(X1("row-gap",getComputedStyle(d).rowGap,a)),f!==null&&r(f)},[r,t,a,o,c,n]);return vc(u,s)}function K1(r,t,s,n){const a=r.length;if(a===0)return null;const o=[];for(let c=0;c<a;c++){const u=r.item(c);if(!u||u.dataset.index===void 0)continue;const d=parseInt(u.dataset.index),f=parseFloat(u.dataset.knownSize),m=t(u,s);if(m===0&&n("Zero-sized element, this should not happen",{child:u},nn.ERROR),m===f)continue;const S=o[o.length-1];o.length===0||S.size!==m||S.endIndex!==d-1?o.push({startIndex:d,endIndex:d,size:m}):o[o.length-1].endIndex++}return o}function X1(r,t,s){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&s(`${r} was not resolved to pixel value correctly`,t,nn.WARN),t==="normal"?0:parseInt(t??"0",10)}function Es(r,t){return Math.round(r.getBoundingClientRect()[t])}function yf(r,t){return Math.abs(r-t)<1.01}function bf(r,t,s,n=Ea,a){const o=se.useRef(null),c=se.useRef(null),u=se.useRef(null),d=se.useCallback(S=>{const _=S.target,y=_===window||_===document,b=y?window.pageYOffset||document.documentElement.scrollTop:_.scrollTop,x=y?document.documentElement.scrollHeight:_.scrollHeight,E=y?window.innerHeight:_.offsetHeight,I=()=>{r({scrollTop:Math.max(b,0),scrollHeight:x,viewportHeight:E})};S.suppressFlushSync?I():kw.flushSync(I),c.current!==null&&(b===c.current||b<=0||b===x-E)&&(c.current=null,t(!0),u.current&&(clearTimeout(u.current),u.current=null))},[r,t]);se.useEffect(()=>{const S=a||o.current;return n(a||o.current),d({target:S,suppressFlushSync:!0}),S.addEventListener("scroll",d,{passive:!0}),()=>{n(null),S.removeEventListener("scroll",d)}},[o,d,s,n,a]);function f(S){const _=o.current;if(!_||"offsetHeight"in _&&_.offsetHeight===0)return;const y=S.behavior==="smooth";let b,x,E;_===window?(x=Math.max(Es(document.documentElement,"height"),document.documentElement.scrollHeight),b=window.innerHeight,E=document.documentElement.scrollTop):(x=_.scrollHeight,b=Es(_,"height"),E=_.scrollTop);const I=x-b;if(S.top=Math.ceil(Math.max(Math.min(I,S.top),0)),yf(b,x)||S.top===E){r({scrollTop:E,scrollHeight:x,viewportHeight:b}),y&&t(!0);return}y?(c.current=S.top,u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{u.current=null,c.current=null,t(!0)},1e3)):c.current=null,_.scrollTo(S)}function m(S){o.current.scrollBy(S)}return{scrollerRef:o,scrollByCallback:m,scrollToCallback:f}}const Ur=ki(()=>{const r=_i(),t=_i(),s=Ee(0),n=_i(),a=Ee(0),o=_i(),c=_i(),u=Ee(0),d=Ee(0),f=Ee(0),m=Ee(0),S=_i(),_=_i(),y=Ee(!1);return Ne(ce(r,Fe(({scrollTop:b})=>b)),t),Ne(ce(r,Fe(({scrollHeight:b})=>b)),c),Ne(t,a),{scrollContainerState:r,scrollTop:t,viewportHeight:o,headerHeight:u,fixedHeaderHeight:d,fixedFooterHeight:f,footerHeight:m,scrollHeight:c,smoothScrollTargetReached:n,scrollTo:S,scrollBy:_,statefulScrollTop:a,deviation:s,scrollingInProgress:y}},[],{singleton:!0}),so={lvl:0};function _f(r,t,s,n=so,a=so){return{k:r,v:t,lvl:s,l:n,r:a}}function Ii(r){return r===so}function ka(){return so}function yc(r,t){if(Ii(r))return so;const{k:s,l:n,r:a}=r;if(t===s){if(Ii(n))return a;if(Ii(a))return n;{const[o,c]=xf(n);return Jo(ur(r,{k:o,v:c,l:wf(n)}))}}else return t<s?Jo(ur(r,{l:yc(n,t)})):Jo(ur(r,{r:yc(a,t)}))}function ao(r,t){if(!Ii(r))return t===r.k?r.v:t<r.k?ao(r.l,t):ao(r.r,t)}function wn(r,t,s="k"){if(Ii(r))return[-1/0,void 0];if(Number(r[s])===t)return[r.k,r.v];if(Number(r[s])<t){const n=wn(r.r,t,s);return n[0]===-1/0?[r.k,r.v]:n}return wn(r.l,t,s)}function sn(r,t,s){return Ii(r)?_f(t,s,1):t===r.k?ur(r,{k:t,v:s}):t<r.k?Af(ur(r,{l:sn(r.l,t,s)})):Af(ur(r,{r:sn(r.r,t,s)}))}function bc(r,t,s){if(Ii(r))return[];const{k:n,v:a,l:o,r:c}=r;let u=[];return n>t&&(u=u.concat(bc(o,t,s))),n>=t&&n<=s&&u.push({k:n,v:a}),n<=s&&(u=u.concat(bc(c,t,s))),u}function Ys(r){return Ii(r)?[]:[...Ys(r.l),{k:r.k,v:r.v},...Ys(r.r)]}function xf(r){return Ii(r.r)?[r.k,r.v]:xf(r.r)}function wf(r){return Ii(r.r)?r.l:Jo(ur(r,{r:wf(r.r)}))}function ur(r,t){return _f(t.k!==void 0?t.k:r.k,t.v!==void 0?t.v:r.v,t.lvl!==void 0?t.lvl:r.lvl,t.l!==void 0?t.l:r.l,t.r!==void 0?t.r:r.r)}function _c(r){return Ii(r)||r.lvl>r.r.lvl}function Af(r){return xc(Ef(r))}function Jo(r){const{l:t,r:s,lvl:n}=r;if(s.lvl>=n-1&&t.lvl>=n-1)return r;if(n>s.lvl+1){if(_c(t))return Ef(ur(r,{lvl:n-1}));if(!Ii(t)&&!Ii(t.r))return ur(t.r,{l:ur(t,{r:t.r.l}),r:ur(r,{l:t.r.r,lvl:n-1}),lvl:n});throw new Error("Unexpected empty nodes")}else{if(_c(r))return xc(ur(r,{lvl:n-1}));if(!Ii(s)&&!Ii(s.l)){const a=s.l,o=_c(a)?s.lvl-1:s.lvl;return ur(a,{l:ur(r,{r:a.l,lvl:n-1}),r:xc(ur(s,{l:a.r,lvl:o})),lvl:a.lvl+1})}else throw new Error("Unexpected empty nodes")}}function tl(r,t,s){if(Ii(r))return[];const n=wn(r,t)[0];return Y1(bc(r,n,s))}function Sf(r,t){const s=r.length;if(s===0)return[];let{index:n,value:a}=t(r[0]);const o=[];for(let c=1;c<s;c++){const{index:u,value:d}=t(r[c]);o.push({start:n,end:u-1,value:a}),n=u,a=d}return o.push({start:n,end:1/0,value:a}),o}function Y1(r){return Sf(r,({k:t,v:s})=>({index:t,value:s}))}function xc(r){const{r:t,lvl:s}=r;return!Ii(t)&&!Ii(t.r)&&t.lvl===s&&t.r.lvl===s?ur(t,{l:ur(r,{r:t.l}),lvl:s+1}):r}function Ef(r){const{l:t}=r;return!Ii(t)&&t.lvl===r.lvl?ur(t,{r:ur(r,{l:t.r})}):r}function el(r,t,s,n=0){let a=r.length-1;for(;n<=a;){const o=Math.floor((n+a)/2),c=r[o],u=s(c,t);if(u===0)return o;if(u===-1){if(a-n<2)return o-1;a=o-1}else{if(a===n)return o;n=o+1}}throw new Error(`Failed binary finding record in array - ${r.join(",")}, searched for ${t}`)}function Cf(r,t,s){return r[el(r,t,s)]}function q1(r,t,s,n){const a=el(r,t,n),o=el(r,s,n,a);return r.slice(a,o+1)}const wc=ki(()=>({recalcInProgress:Ee(!1)}),[],{singleton:!0});function Q1(r){const{size:t,startIndex:s,endIndex:n}=r;return a=>a.start===s&&(a.end===n||a.end===1/0)&&a.value===t}function kf(r,t){let s=0,n=0;for(;s<r;)s+=t[n+1]-t[n]-1,n++;return n-(s===r?0:1)}function Z1(r,t){let s=Ii(r)?0:1/0;for(const n of t){const{size:a,startIndex:o,endIndex:c}=n;if(s=Math.min(s,o),Ii(r)){r=sn(r,0,a);continue}const u=tl(r,o-1,c+1);if(u.some(Q1(n)))continue;let d=!1,f=!1;for(const{start:m,end:S,value:_}of u)d?(c>=m||a===_)&&(r=yc(r,m)):(f=_!==a,d=!0),S>c&&c>=m&&_!==a&&(r=sn(r,c+1,_));f&&(r=sn(r,o,a))}return[r,s]}function J1(){return{offsetTree:[],sizeTree:ka(),groupOffsetTree:ka(),lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]}}function Ac({index:r},t){return t===r?0:t<r?-1:1}function tv({offset:r},t){return t===r?0:t<r?-1:1}function ev(r){return{index:r.index,value:r}}function iv(r,t,s,n=0){return n>0&&(t=Math.max(t,Cf(r,n,Ac).offset)),Sf(q1(r,t,s,tv),ev)}function Sc(r,t,s,n){let a=r,o=0,c=0,u=0,d=0;if(t!==0){d=el(a,t-1,Ac),u=a[d].offset;const f=wn(s,t-1);o=f[0],c=f[1],a.length&&a[d].size===wn(s,t)[1]&&(d-=1),a=a.slice(0,d+1)}else a=[];for(const{start:f,value:m}of tl(s,t,1/0)){const S=f-o,_=S*c+u+S*n;a.push({offset:_,size:m,index:f}),o=f,u=_,c=m}return{offsetTree:a,lastIndex:o,lastOffset:u,lastSize:c}}function rv(r,[t,s,n,a]){t.length>0&&n("received item sizes",t,nn.DEBUG);const o=r.sizeTree;let c=o,u=0;if(s.length>0&&Ii(o)&&t.length===2){const _=t[0].size,y=t[1].size;c=s.reduce((b,x)=>sn(sn(b,x,_),x+1,y),c)}else[c,u]=Z1(c,t);if(c===o)return r;const{offsetTree:d,lastIndex:f,lastSize:m,lastOffset:S}=Sc(r.offsetTree,u,c,a);return{sizeTree:c,offsetTree:d,lastIndex:f,lastOffset:S,lastSize:m,groupOffsetTree:s.reduce((_,y)=>sn(_,y,oo(y,d,a)),ka()),groupIndices:s}}function oo(r,t,s){if(t.length===0)return 0;const{offset:n,index:a,size:o}=Cf(t,r,Ac),c=r-a,u=o*c+(c-1)*s+n;return u>0?u+s:u}function nv(r){return typeof r.groupIndex<"u"}function Tf(r,t,s){if(nv(r))return t.groupIndices[r.groupIndex]+1;{const n=r.index==="LAST"?s:r.index;let a=Pf(n,t);return a=Math.max(0,a,Math.min(s,a)),a}}function Pf(r,t){if(!il(t))return r;let s=0;for(;t.groupIndices[s]<=r+s;)s++;return r+s}function il(r){return!Ii(r.groupOffsetTree)}function sv(r){return Ys(r).map(({k:t,v:s},n,a)=>{const o=a[n+1],c=o?o.k-1:1/0;return{startIndex:t,endIndex:c,size:s}})}const av={offsetHeight:"height",offsetWidth:"width"},Un=ki(([{log:r},{recalcInProgress:t}])=>{const s=_i(),n=_i(),a=Br(n,0),o=_i(),c=_i(),u=Ee(0),d=Ee([]),f=Ee(void 0),m=Ee(void 0),S=Ee((A,C)=>Es(A,av[C])),_=Ee(void 0),y=Ee(0),b=J1(),x=Br(ce(s,li(d,r,y),Bn(rv,b),ji()),b),E=Br(ce(d,ji(),Bn((A,C)=>({prev:A.current,current:C}),{prev:[],current:[]}),Fe(({prev:A})=>A)),[]);Ne(ce(d,$e(A=>A.length>0),li(x,y),Fe(([A,C,B])=>{const F=A.reduce((rt,tt,st)=>sn(rt,tt,oo(tt,C.offsetTree,B)||st),ka());return{...C,groupIndices:A,groupOffsetTree:F}})),x),Ne(ce(n,li(x),$e(([A,{lastIndex:C}])=>A<C),Fe(([A,{lastIndex:C,lastSize:B}])=>[{startIndex:A,endIndex:C,size:B}])),s),Ne(f,m);const I=Br(ce(f,Fe(A=>A===void 0)),!0);Ne(ce(m,$e(A=>A!==void 0&&Ii(Ir(x).sizeTree)),Fe(A=>[{startIndex:0,endIndex:0,size:A}])),s);const R=rn(ce(s,li(x),Bn(({sizes:A},[C,B])=>({changed:B!==A,sizes:B}),{changed:!1,sizes:b}),Fe(A=>A.changed)));Ci(ce(u,Bn((A,C)=>({diff:A.prev-C,prev:C}),{diff:0,prev:0}),Fe(A=>A.diff)),A=>{const{groupIndices:C}=Ir(x);if(A>0)ii(t,!0),ii(o,A+kf(A,C));else if(A<0){const B=Ir(E);B.length>0&&(A-=kf(-A,B)),ii(c,A)}}),Ci(ce(u,li(r)),([A,C])=>{A<0&&C("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:u},nn.ERROR)});const p=rn(o);Ne(ce(o,li(x),Fe(([A,C])=>{const B=C.groupIndices.length>0,F=[],rt=C.lastSize;if(B){const tt=ao(C.sizeTree,0);let st=0,wt=0;for(;st<A;){const Tt=C.groupIndices[wt],Lt=C.groupIndices.length===wt+1?1/0:C.groupIndices[wt+1]-Tt-1;F.push({startIndex:Tt,endIndex:Tt,size:tt}),F.push({startIndex:Tt+1,endIndex:Tt+1+Lt-1,size:rt}),wt++,st+=Lt+1}const dt=Ys(C.sizeTree);return st!==A&&dt.shift(),dt.reduce((Tt,{k:Lt,v:Qt})=>{let ct=Tt.ranges;return Tt.prevSize!==0&&(ct=[...Tt.ranges,{startIndex:Tt.prevIndex,endIndex:Lt+A-1,size:Tt.prevSize}]),{ranges:ct,prevIndex:Lt+A,prevSize:Qt}},{ranges:F,prevIndex:A,prevSize:0}).ranges}return Ys(C.sizeTree).reduce((tt,{k:st,v:wt})=>({ranges:[...tt.ranges,{startIndex:tt.prevIndex,endIndex:st+A-1,size:tt.prevSize}],prevIndex:st+A,prevSize:wt}),{ranges:[],prevIndex:0,prevSize:rt}).ranges})),s);const w=rn(ce(c,li(x,y),Fe(([A,{offsetTree:C},B])=>{const F=-A;return oo(F,C,B)})));return Ne(ce(c,li(x,y),Fe(([A,C,B])=>{if(C.groupIndices.length>0){if(Ii(C.sizeTree))return C;let F=ka();const rt=Ir(E);let tt=0,st=0,wt=0;for(;tt<-A;){wt=rt[st];const dt=rt[st+1]-wt-1;st++,tt+=dt+1}if(F=Ys(C.sizeTree).reduce((dt,{k:Tt,v:Lt})=>sn(dt,Math.max(0,Tt+A),Lt),F),tt!==-A){const dt=ao(C.sizeTree,wt);F=sn(F,0,dt);const Tt=wn(C.sizeTree,-A+1)[1];F=sn(F,1,Tt)}return{...C,sizeTree:F,...Sc(C.offsetTree,0,F,B)}}else{const F=Ys(C.sizeTree).reduce((rt,{k:tt,v:st})=>sn(rt,Math.max(0,tt+A),st),ka());return{...C,sizeTree:F,...Sc(C.offsetTree,0,F,B)}}})),x),{data:_,totalCount:n,sizeRanges:s,groupIndices:d,defaultItemSize:m,fixedItemSize:f,unshiftWith:o,shiftWith:c,shiftWithOffset:w,beforeUnshiftWith:p,firstItemIndex:u,gap:y,sizes:x,listRefresh:R,statefulTotalCount:a,trackItemSizes:I,itemSize:S}},Gi(Ss,wc),{singleton:!0}),ov=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function Mf(r){const t=typeof r=="number"?{index:r}:r;return t.align||(t.align="start"),(!t.behavior||!ov)&&(t.behavior="auto"),t.offset||(t.offset=0),t}const lo=ki(([{sizes:r,totalCount:t,listRefresh:s,gap:n},{scrollingInProgress:a,viewportHeight:o,scrollTo:c,smoothScrollTargetReached:u,headerHeight:d,footerHeight:f,fixedHeaderHeight:m,fixedFooterHeight:S},{log:_}])=>{const y=_i(),b=_i(),x=Ee(0);let E=null,I=null,R=null;function p(){E&&(E(),E=null),R&&(R(),R=null),I&&(clearTimeout(I),I=null),ii(a,!1)}return Ne(ce(y,li(r,o,t,x,d,f,_),li(n,m,S),Fe(([[w,A,C,B,F,rt,tt,st],wt,dt,Tt])=>{const Lt=Mf(w),{align:Qt,behavior:ct,offset:Dt}=Lt,ee=B-1,zt=Tf(Lt,A,ee);let Jt=oo(zt,A.offsetTree,wt)+rt;Qt==="end"?(Jt+=dt+wn(A.sizeTree,zt)[1]-C+Tt,zt===ee&&(Jt+=tt)):Qt==="center"?Jt+=(dt+wn(A.sizeTree,zt)[1]-C+Tt)/2:Jt-=F,Dt&&(Jt+=Dt);const oe=pe=>{p(),pe?(st("retrying to scroll to",{location:w},nn.DEBUG),ii(y,w)):(ii(b,!0),st("list did not change, scroll successful",{},nn.DEBUG))};if(p(),ct==="smooth"){let pe=!1;R=Ci(s,Ae=>{pe=pe||Ae}),E=zn(u,()=>{oe(pe)})}else E=zn(ce(s,lv(150)),oe);return I=setTimeout(()=>{p()},1200),ii(a,!0),st("scrolling from index to",{index:zt,top:Jt,behavior:ct},nn.DEBUG),{top:Jt,behavior:ct}})),c),{scrollToIndex:y,scrollTargetReached:b,topListHeight:x}},Gi(Un,Ur,Ss),{singleton:!0});function lv(r){return t=>{const s=setTimeout(()=>{t(!1)},r);return n=>{n&&(t(!0),clearTimeout(s))}}}const ho="up",co="down",hv="none",cv={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},dv=0,uo=ki(([{scrollContainerState:r,scrollTop:t,viewportHeight:s,headerHeight:n,footerHeight:a,scrollBy:o}])=>{const c=Ee(!1),u=Ee(!0),d=_i(),f=_i(),m=Ee(4),S=Ee(dv),_=Br(ce(mf(ce(Ke(t),Ca(1),Hn(!0)),ce(Ke(t),Ca(1),Hn(!1),pf(100))),ji()),!1),y=Br(ce(mf(ce(o,Hn(!0)),ce(o,Hn(!1),pf(200))),ji()),!1);Ne(ce(xr(Ke(t),Ke(S)),Fe(([R,p])=>R<=p),ji()),u),Ne(ce(u,As(50)),f);const b=rn(ce(xr(r,Ke(s),Ke(n),Ke(a),Ke(m)),Bn((R,[{scrollTop:p,scrollHeight:w},A,C,B,F])=>{const rt=p+A-w>-F,tt={viewportHeight:A,scrollTop:p,scrollHeight:w};if(rt){let wt,dt;return p>R.state.scrollTop?(wt="SCROLLED_DOWN",dt=R.state.scrollTop-p):(wt="SIZE_DECREASED",dt=R.state.scrollTop-p||R.scrollTopDelta),{atBottom:!0,state:tt,atBottomBecause:wt,scrollTopDelta:dt}}let st;return tt.scrollHeight>R.state.scrollHeight?st="SIZE_INCREASED":A<R.state.viewportHeight?st="VIEWPORT_HEIGHT_DECREASING":p<R.state.scrollTop?st="SCROLLING_UPWARDS":st="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:st,state:tt}},cv),ji((R,p)=>R&&R.atBottom===p.atBottom))),x=Br(ce(r,Bn((R,{scrollTop:p,scrollHeight:w,viewportHeight:A})=>{if(yf(R.scrollHeight,w))return{scrollTop:p,scrollHeight:w,jump:0,changed:!1};{const C=w-(p+A)<1;return R.scrollTop!==p&&C?{scrollHeight:w,scrollTop:p,jump:R.scrollTop-p,changed:!0}:{scrollHeight:w,scrollTop:p,jump:0,changed:!0}}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),$e(R=>R.changed),Fe(R=>R.jump)),0);Ne(ce(b,Fe(R=>R.atBottom)),c),Ne(ce(c,As(50)),d);const E=Ee(co);Ne(ce(r,Fe(({scrollTop:R})=>R),ji(),Bn((R,p)=>Ir(y)?{direction:R.direction,prevScrollTop:p}:{direction:p<R.prevScrollTop?ho:co,prevScrollTop:p},{direction:co,prevScrollTop:0}),Fe(R=>R.direction)),E),Ne(ce(r,As(50),Hn(hv)),E);const I=Ee(0);return Ne(ce(_,$e(R=>!R),Hn(0)),I),Ne(ce(t,As(100),li(_),$e(([R,p])=>!!p),Bn(([R,p],[w])=>[p,w],[0,0]),Fe(([R,p])=>p-R)),I),{isScrolling:_,isAtTop:u,isAtBottom:c,atBottomState:b,atTopStateChange:f,atBottomStateChange:d,scrollDirection:E,atBottomThreshold:m,atTopThreshold:S,scrollVelocity:I,lastJumpDueToItemResize:x}},Gi(Ur)),Cs=ki(([{log:r}])=>{const t=Ee(!1),s=rn(ce(t,$e(n=>n),ji()));return Ci(t,n=>{n&&Ir(r)("props updated",{},nn.DEBUG)}),{propsReady:t,didMount:s}},Gi(Ss),{singleton:!0});function Ec(r,t){r==0?t():requestAnimationFrame(()=>Ec(r-1,t))}function Cc(r,t){const s=t-1;return typeof r=="number"?r:r.index==="LAST"?s:r.index}const fo=ki(([{sizes:r,listRefresh:t,defaultItemSize:s},{scrollTop:n},{scrollToIndex:a,scrollTargetReached:o},{didMount:c}])=>{const u=Ee(!0),d=Ee(0),f=Ee(!0);return Ne(ce(c,li(d),$e(([m,S])=>!!S),Hn(!1)),u),Ne(ce(c,li(d),$e(([m,S])=>!!S),Hn(!1)),f),Ci(ce(xr(t,c),li(u,r,s,f),$e(([[,m],S,{sizeTree:_},y,b])=>m&&(!Ii(_)||pc(y))&&!S&&!b),li(d)),([,m])=>{zn(o,()=>{ii(f,!0)}),Ec(4,()=>{zn(n,()=>{ii(u,!0)}),ii(a,m)})}),{scrolledToInitialItem:u,initialTopMostItemIndex:d,initialItemFinalLocationReached:f}},Gi(Un,Ur,lo,Cs),{singleton:!0});function Rf(r){return r?r==="smooth"?"smooth":"auto":!1}const uv=(r,t)=>typeof r=="function"?Rf(r(t)):t&&Rf(r),fv=ki(([{totalCount:r,listRefresh:t},{isAtBottom:s,atBottomState:n},{scrollToIndex:a},{scrolledToInitialItem:o},{propsReady:c,didMount:u},{log:d},{scrollingInProgress:f}])=>{const m=Ee(!1),S=_i();let _=null;function y(x){ii(a,{index:"LAST",align:"end",behavior:x})}Ci(ce(xr(ce(Ke(r),Ca(1)),u),li(Ke(m),s,o,f),Fe(([[x,E],I,R,p,w])=>{let A=E&&p,C="auto";return A&&(C=uv(I,R||w),A=A&&!!C),{totalCount:x,shouldFollow:A,followOutputBehavior:C}}),$e(({shouldFollow:x})=>x)),({totalCount:x,followOutputBehavior:E})=>{_&&(_(),_=null),_=zn(t,()=>{Ir(d)("following output to ",{totalCount:x},nn.DEBUG),y(E),_=null})});function b(x){const E=zn(n,I=>{x&&!I.atBottom&&I.notAtBottomBecause==="SIZE_INCREASED"&&!_&&(Ir(d)("scrolling to bottom due to increased size",{},nn.DEBUG),y("auto"))});setTimeout(E,100)}return Ci(ce(xr(Ke(m),r,c),$e(([x,,E])=>x&&E),Bn(({value:x},[,E])=>({refreshed:x===E,value:E}),{refreshed:!1,value:0}),$e(({refreshed:x})=>x),li(m,r)),([,x])=>{Ir(o)&&b(x!==!1)}),Ci(S,()=>{b(Ir(m)!==!1)}),Ci(xr(Ke(m),n),([x,E])=>{x&&!E.atBottom&&E.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&y("auto")}),{followOutput:m,autoscrollToBottom:S}},Gi(Un,uo,lo,fo,Cs,Ss,Ur));function gv(r){return r.reduce((t,s)=>(t.groupIndices.push(t.totalCount),t.totalCount+=s+1,t),{totalCount:0,groupIndices:[]})}const Ff=ki(([{totalCount:r,groupIndices:t,sizes:s},{scrollTop:n,headerHeight:a}])=>{const o=_i(),c=_i(),u=rn(ce(o,Fe(gv)));return Ne(ce(u,Fe(d=>d.totalCount)),r),Ne(ce(u,Fe(d=>d.groupIndices)),t),Ne(ce(xr(n,s,a),$e(([d,f])=>il(f)),Fe(([d,f,m])=>wn(f.groupOffsetTree,Math.max(d-m,0),"v")[0]),ji(),Fe(d=>[d])),c),{groupCounts:o,topItemsIndexes:c}},Gi(Un,Ur));function go(r,t){return!!(r&&r[0]===t[0]&&r[1]===t[1])}function If(r,t){return!!(r&&r.startIndex===t.startIndex&&r.endIndex===t.endIndex)}const rl="top",nl="bottom",Lf="none";function Df(r,t,s){return typeof r=="number"?s===ho&&t===rl||s===co&&t===nl?r:0:s===ho?t===rl?r.main:r.reverse:t===nl?r.main:r.reverse}function Nf(r,t){return typeof r=="number"?r:r[t]||0}const kc=ki(([{scrollTop:r,viewportHeight:t,deviation:s,headerHeight:n,fixedHeaderHeight:a}])=>{const o=_i(),c=Ee(0),u=Ee(0),d=Ee(0),f=Br(ce(xr(Ke(r),Ke(t),Ke(n),Ke(o,go),Ke(d),Ke(c),Ke(a),Ke(s),Ke(u)),Fe(([m,S,_,[y,b],x,E,I,R,p])=>{const w=m-R,A=E+I,C=Math.max(_-w,0);let B=Lf;const F=Nf(p,rl),rt=Nf(p,nl);return y-=R,y+=_+I,b+=_+I,b-=R,y>m+A-F&&(B=ho),b<m-C+S+rt&&(B=co),B!==Lf?[Math.max(w-_-Df(x,rl,B)-F,0),w-C-I+S+Df(x,nl,B)+rt]:null}),$e(m=>m!=null),ji(go)),[0,0]);return{listBoundary:o,overscan:d,topListHeight:c,increaseViewportBy:u,visibleRange:f}},Gi(Ur),{singleton:!0});function pv(r,t,s){if(il(t)){const n=Pf(r,t);return[{index:wn(t.groupOffsetTree,n)[0],size:0,offset:0},{index:n,size:0,offset:0,data:s&&s[0]}]}return[{index:r,size:0,offset:0,data:s&&s[0]}]}const Tc={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0};function Of(r,t,s){if(r.length===0)return[];if(!il(t))return r.map(f=>({...f,index:f.index+s,originalIndex:f.index}));const n=r[0].index,a=r[r.length-1].index,o=[],c=tl(t.groupOffsetTree,n,a);let u,d=0;for(const f of r){(!u||u.end<f.index)&&(u=c.shift(),d=t.groupIndices.indexOf(u.start));let m;f.index===u.start?m={type:"group",index:d}:m={index:f.index-(d+1)+s,groupIndex:d},o.push({...m,size:f.size,offset:f.offset,originalIndex:f.index,data:f.data})}return o}function sl(r,t,s,n,a,o){const{lastSize:c,lastOffset:u,lastIndex:d}=a;let f=0,m=0;if(r.length>0){f=r[0].offset;const x=r[r.length-1];m=x.offset+x.size}const S=s-d,_=u+S*c+(S-1)*n,y=f,b=_-m;return{items:Of(r,a,o),topItems:Of(t,a,o),topListHeight:t.reduce((x,E)=>E.size+x,0),offsetTop:f,offsetBottom:b,top:y,bottom:m,totalCount:s,firstItemIndex:o}}function zf(r,t,s,n,a,o){let c=0;if(s.groupIndices.length>0)for(const m of s.groupIndices){if(m-c>=r)break;c++}const u=r+c,d=Cc(t,u),f=Array.from({length:u}).map((m,S)=>({index:S+d,size:0,offset:0,data:o[S+d]}));return sl(f,[],u,a,s,n)}const qs=ki(([{sizes:r,totalCount:t,data:s,firstItemIndex:n,gap:a},o,{visibleRange:c,listBoundary:u,topListHeight:d},{scrolledToInitialItem:f,initialTopMostItemIndex:m},{topListHeight:S},_,{didMount:y},{recalcInProgress:b}])=>{const x=Ee([]),E=Ee(0),I=_i();Ne(o.topItemsIndexes,x);const R=Br(ce(xr(y,b,Ke(c,go),Ke(t),Ke(r),Ke(m),f,Ke(x),Ke(n),Ke(a),s),$e(([C,B,,F,,,,,,,rt])=>{const tt=rt&&rt.length!==F;return C&&!B&&!tt}),Fe(([,,[C,B],F,rt,tt,st,wt,dt,Tt,Lt])=>{const Qt=rt,{sizeTree:ct,offsetTree:Dt}=Qt,ee=Ir(E);if(F===0)return{...Tc,totalCount:F};if(C===0&&B===0)return ee===0?{...Tc,totalCount:F}:zf(ee,tt,rt,dt,Tt,Lt||[]);if(Ii(ct))return ee>0?null:sl(pv(Cc(tt,F),Qt,Lt),[],F,Tt,Qt,dt);const zt=[];if(wt.length>0){const Ve=wt[0],Gt=wt[wt.length-1];let lt=0;for(const Ft of tl(ct,Ve,Gt)){const Wt=Ft.value,ve=Math.max(Ft.start,Ve),ie=Math.min(Ft.end,Gt);for(let xe=ve;xe<=ie;xe++)zt.push({index:xe,size:Wt,offset:lt,data:Lt&&Lt[xe]}),lt+=Wt}}if(!st)return sl([],zt,F,Tt,Qt,dt);const Jt=wt.length>0?wt[wt.length-1]+1:0,oe=iv(Dt,C,B,Jt);if(oe.length===0)return null;const pe=F-1,Ae=Qo([],Ve=>{for(const Gt of oe){const lt=Gt.value;let Ft=lt.offset,Wt=Gt.start;const ve=lt.size;if(lt.offset<C){Wt+=Math.floor((C-lt.offset+Tt)/(ve+Tt));const xe=Wt-Gt.start;Ft+=xe*ve+xe*Tt}Wt<Jt&&(Ft+=(Jt-Wt)*ve,Wt=Jt);const ie=Math.min(Gt.end,pe);for(let xe=Wt;xe<=ie&&!(Ft>=B);xe++)Ve.push({index:xe,size:ve,offset:Ft,data:Lt&&Lt[xe]}),Ft+=ve+Tt}});return sl(Ae,zt,F,Tt,Qt,dt)}),$e(C=>C!==null),ji()),Tc);Ne(ce(s,$e(pc),Fe(C=>C==null?void 0:C.length)),t),Ne(ce(R,Fe(C=>C.topListHeight)),S),Ne(S,d),Ne(ce(R,Fe(C=>[C.top,C.bottom])),u),Ne(ce(R,Fe(C=>C.items)),I);const p=rn(ce(R,$e(({items:C})=>C.length>0),li(t,s),$e(([{items:C},B])=>C[C.length-1].originalIndex===B-1),Fe(([,C,B])=>[C-1,B]),ji(go),Fe(([C])=>C))),w=rn(ce(R,As(200),$e(({items:C,topItems:B})=>C.length>0&&C[0].originalIndex===B.length),Fe(({items:C})=>C[0].index),ji())),A=rn(ce(R,$e(({items:C})=>C.length>0),Fe(({items:C})=>{let B=0,F=C.length-1;for(;C[B].type==="group"&&B<F;)B++;for(;C[F].type==="group"&&F>B;)F--;return{startIndex:C[B].index,endIndex:C[F].index}}),ji(If)));return{listState:R,topItemsIndexes:x,endReached:p,startReached:w,rangeChanged:A,itemsRendered:I,initialItemCount:E,..._}},Gi(Un,Ff,kc,fo,lo,uo,Cs,wc),{singleton:!0}),mv=ki(([{sizes:r,firstItemIndex:t,data:s,gap:n},{initialTopMostItemIndex:a},{initialItemCount:o,listState:c},{didMount:u}])=>(Ne(ce(u,li(o),$e(([,d])=>d!==0),li(a,r,t,n,s),Fe(([[,d],f,m,S,_,y=[]])=>zf(d,f,m,S,_,y))),c),{}),Gi(Un,fo,qs,Cs),{singleton:!0}),Hf=ki(([{scrollVelocity:r}])=>{const t=Ee(!1),s=_i(),n=Ee(!1);return Ne(ce(r,li(n,t,s),$e(([a,o])=>!!o),Fe(([a,o,c,u])=>{const{exit:d,enter:f}=o;if(c){if(d(a,u))return!1}else if(f(a,u))return!0;return c}),ji()),t),Ci(ce(xr(t,r,s),li(n)),([[a,o,c],u])=>a&&u&&u.change&&u.change(o,c)),{isSeeking:t,scrollSeekConfiguration:n,scrollVelocity:r,scrollSeekRangeChanged:s}},Gi(uo),{singleton:!0}),vv=ki(([{topItemsIndexes:r}])=>{const t=Ee(0);return Ne(ce(t,$e(s=>s>0),Fe(s=>Array.from({length:s}).map((n,a)=>a))),r),{topItemCount:t}},Gi(qs)),Bf=ki(([{footerHeight:r,headerHeight:t,fixedHeaderHeight:s,fixedFooterHeight:n},{listState:a}])=>{const o=_i(),c=Br(ce(xr(r,n,t,s,a),Fe(([u,d,f,m,S])=>u+d+f+m+S.offsetBottom+S.bottom)),0);return Ne(Ke(c),o),{totalListHeight:c,totalListHeightChanged:o}},Gi(Ur,qs),{singleton:!0});function Uf(r){let t=!1,s;return()=>(t||(t=!0,s=r()),s)}const yv=Uf(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),bv=ki(([{scrollBy:r,scrollTop:t,deviation:s,scrollingInProgress:n},{isScrolling:a,isAtBottom:o,scrollDirection:c,lastJumpDueToItemResize:u},{listState:d},{beforeUnshiftWith:f,shiftWithOffset:m,sizes:S,gap:_},{log:y},{recalcInProgress:b}])=>{const x=rn(ce(d,li(u),Bn(([,I,R,p],[{items:w,totalCount:A,bottom:C,offsetBottom:B},F])=>{const rt=C+B;let tt=0;return R===A&&I.length>0&&w.length>0&&(w[0].originalIndex===0&&I[0].originalIndex===0||(tt=rt-p,tt!==0&&(tt+=F))),[tt,w,A,rt]},[0,[],0,0]),$e(([I])=>I!==0),li(t,c,n,o,y,b),$e(([,I,R,p,,,w])=>!w&&!p&&I!==0&&R===ho),Fe(([[I],,,,,R])=>(R("Upward scrolling compensation",{amount:I},nn.DEBUG),I))));function E(I){I>0?(ii(r,{top:-I,behavior:"auto"}),ii(s,0)):(ii(s,0),ii(r,{top:-I,behavior:"auto"}))}return Ci(ce(x,li(s,a)),([I,R,p])=>{p&&yv()?ii(s,R-I):E(-I)}),Ci(ce(xr(Br(a,!1),s,b),$e(([I,R,p])=>!I&&!p&&R!==0),Fe(([I,R])=>R),As(1)),E),Ne(ce(m,Fe(I=>({top:-I}))),r),Ci(ce(f,li(S,_),Fe(([I,{lastSize:R,groupIndices:p,sizeTree:w},A])=>{function C(B){return B*(R+A)}if(p.length===0)return C(I);{let B=0;const F=ao(w,0);let rt=0,tt=0;for(;rt<I;){rt++,B+=F;let st=p.length===tt+1?1/0:p[tt+1]-p[tt]-1;rt+st>I&&(B-=F,st=I-rt+1),rt+=st,B+=C(st),tt++}return B}})),I=>{ii(s,I),requestAnimationFrame(()=>{ii(r,{top:I}),requestAnimationFrame(()=>{ii(s,0),ii(b,!1)})})}),{deviation:s}},Gi(Ur,uo,qs,Un,Ss,wc)),_v=ki(([{didMount:r},{scrollTo:t},{listState:s}])=>{const n=Ee(0);return Ci(ce(r,li(n),$e(([,a])=>a!==0),Fe(([,a])=>({top:a}))),a=>{zn(ce(s,Ca(1),$e(o=>o.items.length>1)),()=>{requestAnimationFrame(()=>{ii(t,a)})})}),{initialScrollTop:n}},Gi(Cs,Ur,qs),{singleton:!0}),xv=ki(([{viewportHeight:r},{totalListHeight:t}])=>{const s=Ee(!1),n=Br(ce(xr(s,r,t),$e(([a])=>a),Fe(([,a,o])=>Math.max(0,a-o)),As(0),ji()),0);return{alignToBottom:s,paddingTopAddition:n}},Gi(Ur,Bf),{singleton:!0}),Pc=ki(([{scrollTo:r,scrollContainerState:t}])=>{const s=_i(),n=_i(),a=_i(),o=Ee(!1),c=Ee(void 0);return Ne(ce(xr(s,n),Fe(([{viewportHeight:u,scrollTop:d,scrollHeight:f},{offsetTop:m}])=>({scrollTop:Math.max(0,d-m),scrollHeight:f,viewportHeight:u}))),t),Ne(ce(r,li(n),Fe(([u,{offsetTop:d}])=>({...u,top:u.top+d}))),a),{useWindowScroll:o,customScrollParent:c,windowScrollContainerState:s,windowViewportRect:n,windowScrollTo:a}},Gi(Ur)),wv=({itemTop:r,itemBottom:t,viewportTop:s,viewportBottom:n,locationParams:{behavior:a,align:o,...c}})=>r<s?{...c,behavior:a,align:o??"start"}:t>n?{...c,behavior:a,align:o??"end"}:null,Av=ki(([{sizes:r,totalCount:t,gap:s},{scrollTop:n,viewportHeight:a,headerHeight:o,fixedHeaderHeight:c,fixedFooterHeight:u,scrollingInProgress:d},{scrollToIndex:f}])=>{const m=_i();return Ne(ce(m,li(r,a,t,o,c,u,n),li(s),Fe(([[S,_,y,b,x,E,I,R],p])=>{const{done:w,behavior:A,align:C,calculateViewLocation:B=wv,...F}=S,rt=Tf(S,_,b-1),tt=oo(rt,_.offsetTree,p)+x+E,st=tt+wn(_.sizeTree,rt)[1],wt=R+E,dt=R+y-I,Tt=B({itemTop:tt,itemBottom:st,viewportTop:wt,viewportBottom:dt,locationParams:{behavior:A,align:C,...F}});return Tt?w&&zn(ce(d,$e(Lt=>Lt===!1),Ca(Ir(d)?1:2)),w):w&&w(),Tt}),$e(S=>S!==null)),f),{scrollIntoView:m}},Gi(Un,Ur,lo,qs,Ss),{singleton:!0}),Sv=ki(([{sizes:r,sizeRanges:t},{scrollTop:s},{initialTopMostItemIndex:n},{didMount:a},{useWindowScroll:o,windowScrollContainerState:c,windowViewportRect:u}])=>{const d=_i(),f=Ee(void 0),m=Ee(null),S=Ee(null);return Ne(c,m),Ne(u,S),Ci(ce(d,li(r,s,o,m,S)),([_,y,b,x,E,I])=>{const R=sv(y.sizeTree);x&&E!==null&&I!==null&&(b=E.scrollTop-I.offsetTop),_({ranges:R,scrollTop:b})}),Ne(ce(f,$e(pc),Fe(Ev)),n),Ne(ce(a,li(f),$e(([,_])=>_!==void 0),ji(),Fe(([,_])=>_.ranges)),t),{getState:d,restoreStateFrom:f}},Gi(Un,Ur,fo,Cs,Pc));function Ev(r){return{offset:r.scrollTop,index:0,align:"start"}}const Cv=ki(([r,t,s,n,a,o,c,u,d,f])=>({...r,...t,...s,...n,...a,...o,...c,...u,...d,...f}),Gi(kc,mv,Cs,Hf,Bf,_v,xv,Pc,Av,Ss)),kv=ki(([{totalCount:r,sizeRanges:t,fixedItemSize:s,defaultItemSize:n,trackItemSizes:a,itemSize:o,data:c,firstItemIndex:u,groupIndices:d,statefulTotalCount:f,gap:m,sizes:S},{initialTopMostItemIndex:_,scrolledToInitialItem:y,initialItemFinalLocationReached:b},x,E,I,{listState:R,topItemsIndexes:p,...w},{scrollToIndex:A},C,{topItemCount:B},{groupCounts:F},rt])=>(Ne(w.rangeChanged,rt.scrollSeekRangeChanged),Ne(ce(rt.windowViewportRect,Fe(tt=>tt.visibleHeight)),x.viewportHeight),{totalCount:r,data:c,firstItemIndex:u,sizeRanges:t,initialTopMostItemIndex:_,scrolledToInitialItem:y,initialItemFinalLocationReached:b,topItemsIndexes:p,topItemCount:B,groupCounts:F,fixedItemHeight:s,defaultItemHeight:n,gap:m,...I,statefulTotalCount:f,listState:R,scrollToIndex:A,trackItemSizes:a,itemSize:o,groupIndices:d,...w,...rt,...x,sizes:S,...E}),Gi(Un,fo,Ur,Sv,fv,qs,lo,bv,vv,Ff,Cv)),Mc="-webkit-sticky",Gf="sticky",jf=Uf(()=>{if(typeof document>"u")return Gf;const r=document.createElement("div");return r.style.position=Mc,r.style.position===Mc?Mc:Gf});function Vf(r,t){const s=se.useRef(null),n=se.useCallback(u=>{if(u===null||!u.offsetParent)return;const d=u.getBoundingClientRect(),f=d.width;let m,S;if(t){const _=t.getBoundingClientRect(),y=d.top-_.top;m=_.height-Math.max(0,y),S=y+t.scrollTop}else m=window.innerHeight-Math.max(0,d.top),S=d.top+window.pageYOffset;s.current={offsetTop:S,visibleHeight:m,visibleWidth:f},r(s.current)},[r,t]),{callbackRef:a,ref:o}=vc(n),c=se.useCallback(()=>{n(o.current)},[n,o]);return se.useEffect(()=>{if(t){t.addEventListener("scroll",c);const u=new ResizeObserver(()=>{requestAnimationFrame(c)});return u.observe(t),()=>{t.removeEventListener("scroll",c),u.unobserve(t)}}else return window.addEventListener("scroll",c),window.addEventListener("resize",c),()=>{window.removeEventListener("scroll",c),window.removeEventListener("resize",c)}},[c,t]),a}const Wf=se.createContext(void 0),$f=se.createContext(void 0);function Kf(r){return r}const Tv=ki(()=>{const r=Ee(d=>`Item ${d}`),t=Ee(null),s=Ee(d=>`Group ${d}`),n=Ee({}),a=Ee(Kf),o=Ee("div"),c=Ee(Ea),u=(d,f=null)=>Br(ce(n,Fe(m=>m[d]),ji()),f);return{context:t,itemContent:r,groupContent:s,components:n,computeItemKey:a,headerFooterTag:o,scrollerRef:c,FooterComponent:u("Footer"),HeaderComponent:u("Header"),TopItemListComponent:u("TopItemList"),ListComponent:u("List","div"),ItemComponent:u("Item","div"),GroupComponent:u("Group","div"),ScrollerComponent:u("Scroller","div"),EmptyPlaceholder:u("EmptyPlaceholder"),ScrollSeekPlaceholder:u("ScrollSeekPlaceholder")}}),Pv=ki(([r,t])=>({...r,...t}),Gi(kv,Tv)),Mv=({height:r})=>se.createElement("div",{style:{height:r}}),Rv={position:jf(),zIndex:1,overflowAnchor:"none"},Fv={overflowAnchor:"none"},Xf=se.memo(function({showTopList:r=!1}){const t=gi("listState"),s=an("sizeRanges"),n=gi("useWindowScroll"),a=gi("customScrollParent"),o=an("windowScrollContainerState"),c=an("scrollContainerState"),u=a||n?o:c,d=gi("itemContent"),f=gi("context"),m=gi("groupContent"),S=gi("trackItemSizes"),_=gi("itemSize"),y=gi("log"),b=an("gap"),{callbackRef:x}=$1(s,_,S,r?Ea:u,y,b,a),[E,I]=se.useState(0);ol("deviation",dt=>{E!==dt&&I(dt)});const R=gi("EmptyPlaceholder"),p=gi("ScrollSeekPlaceholder")||Mv,w=gi("ListComponent"),A=gi("ItemComponent"),C=gi("GroupComponent"),B=gi("computeItemKey"),F=gi("isSeeking"),rt=gi("groupIndices").length>0,tt=gi("alignToBottom"),st=gi("initialItemFinalLocationReached"),wt=r?{}:{boxSizing:"border-box",paddingTop:t.offsetTop,paddingBottom:t.offsetBottom,marginTop:E!==0?E:tt?"auto":0,...st?{}:{visibility:"hidden"}};return!r&&t.totalCount===0&&R?se.createElement(R,Gr(R,f)):se.createElement(w,{...Gr(w,f),ref:x,style:wt,"data-testid":r?"virtuoso-top-item-list":"virtuoso-item-list"},(r?t.topItems:t.items).map(dt=>{const Tt=dt.originalIndex,Lt=B(Tt+t.firstItemIndex,dt.data,f);return F?se.createElement(p,{...Gr(p,f),key:Lt,index:dt.index,height:dt.size,type:dt.type||"item",...dt.type==="group"?{}:{groupIndex:dt.groupIndex}}):dt.type==="group"?se.createElement(C,{...Gr(C,f),key:Lt,"data-index":Tt,"data-known-size":dt.size,"data-item-index":dt.index,style:Rv},m(dt.index,f)):se.createElement(A,{...Gr(A,f),...Dv(A,dt.data),key:Lt,"data-index":Tt,"data-known-size":dt.size,"data-item-index":dt.index,"data-item-group-index":dt.groupIndex,style:Fv},rt?d(dt.index,dt.groupIndex,dt.data,f):d(dt.index,dt.data,f))}))}),Iv={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},al=r=>({width:"100%",height:"100%",position:"absolute",top:0,...r?{display:"flex",flexDirection:"column"}:{}}),Lv={width:"100%",position:jf(),top:0,zIndex:1};function Gr(r,t){if(typeof r!="string")return{context:t}}function Dv(r,t){return{item:typeof r=="string"?void 0:t}}const Nv=se.memo(function(){const r=gi("HeaderComponent"),t=an("headerHeight"),s=gi("headerFooterTag"),n=Xs(o=>t(Es(o,"height"))),a=gi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null}),Ov=se.memo(function(){const r=gi("FooterComponent"),t=an("footerHeight"),s=gi("headerFooterTag"),n=Xs(o=>t(Es(o,"height"))),a=gi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null});function Yf({usePublisher:r,useEmitter:t,useEmitterValue:s}){return se.memo(function({style:n,children:a,...o}){const c=r("scrollContainerState"),u=s("ScrollerComponent"),d=r("smoothScrollTargetReached"),f=s("scrollerRef"),m=s("context"),{scrollerRef:S,scrollByCallback:_,scrollToCallback:y}=bf(c,d,u,f);return t("scrollTo",y),t("scrollBy",_),se.createElement(u,{ref:S,style:{...Iv,...n},"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0,...o,...Gr(u,m)},a)})}function qf({usePublisher:r,useEmitter:t,useEmitterValue:s}){return se.memo(function({style:n,children:a,...o}){const c=r("windowScrollContainerState"),u=s("ScrollerComponent"),d=r("smoothScrollTargetReached"),f=s("totalListHeight"),m=s("deviation"),S=s("customScrollParent"),_=s("context"),{scrollerRef:y,scrollByCallback:b,scrollToCallback:x}=bf(c,d,u,Ea,S);return j1(()=>(y.current=S||window,()=>{y.current=null}),[y,S]),t("windowScrollTo",x),t("scrollBy",b),se.createElement(u,{style:{position:"relative",...n,...f!==0?{height:f+m}:{}},"data-virtuoso-scroller":!0,...o,...Gr(u,_)},a)})}let Qf,Zf,Jf,tg,eg,an,gi,ol,ig,rg,Rc,ng,Fc,Ic,po,ll,Ta;Qf=({children:r})=>{const t=se.useContext(Wf),s=an("viewportHeight"),n=an("fixedItemHeight"),a=gi("alignToBottom"),o=Xs(cf(s,c=>Es(c,"height")));return se.useEffect(()=>{t&&(s(t.viewportHeight),n(t.itemHeight))},[t,s,n]),se.createElement("div",{style:al(a),ref:o,"data-viewport-type":"element"},r)},Zf=({children:r})=>{const t=se.useContext(Wf),s=an("windowViewportRect"),n=an("fixedItemHeight"),a=gi("customScrollParent"),o=Vf(s,a),c=gi("alignToBottom");return se.useEffect(()=>{t&&(n(t.itemHeight),s({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,s,n]),se.createElement("div",{ref:o,style:al(c),"data-viewport-type":"window"},r)},Jf=({children:r})=>{const t=gi("TopItemListComponent")||"div",s=gi("headerHeight"),n={...Lv,marginTop:`${s}px`},a=gi("context");return se.createElement(t,{style:n,...Gr(t,a)},r)},tg=se.memo(function(r){const t=gi("useWindowScroll"),s=gi("topItemsIndexes").length>0,n=gi("customScrollParent"),a=n||t?rg:ig,o=n||t?Zf:Qf;return se.createElement(a,{...r},s&&se.createElement(Jf,null,se.createElement(Xf,{showTopList:!0})),se.createElement(o,null,se.createElement(Nv,null),se.createElement(Xf,null),se.createElement(Ov,null)))}),{Component:eg,usePublisher:an,useEmitterValue:gi,useEmitter:ol}=vf(Pv,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},tg),ig=Yf({usePublisher:an,useEmitterValue:gi,useEmitter:ol}),rg=qf({usePublisher:an,useEmitterValue:gi,useEmitter:ol}),b0=eg,Rc={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},ng={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},{round:Fc,ceil:Ic,floor:po,min:ll,max:Ta}=Math;function zv(r){return{...ng,items:r}}function sg(r,t,s){return Array.from({length:t-r+1}).map((n,a)=>{const o=s===null?null:s[a+r];return{index:a+r,data:o}})}function Hv(r,t){return r&&r.column===t.column&&r.row===t.row}function hl(r,t){return r&&r.width===t.width&&r.height===t.height}const Bv=ki(([{overscan:r,visibleRange:t,listBoundary:s},{scrollTop:n,viewportHeight:a,scrollBy:o,scrollTo:c,smoothScrollTargetReached:u,scrollContainerState:d,footerHeight:f,headerHeight:m},S,_,{propsReady:y,didMount:b},{windowViewportRect:x,useWindowScroll:E,customScrollParent:I,windowScrollContainerState:R,windowScrollTo:p},w])=>{const A=Ee(0),C=Ee(0),B=Ee(Rc),F=Ee({height:0,width:0}),rt=Ee({height:0,width:0}),tt=_i(),st=_i(),wt=Ee(0),dt=Ee(null),Tt=Ee({row:0,column:0}),Lt=_i(),Qt=_i(),ct=Ee(!1),Dt=Ee(0),ee=Ee(!0),zt=Ee(!1);Ci(ce(b,li(Dt),$e(([Gt,lt])=>!!lt)),()=>{ii(ee,!1),ii(C,0)}),Ci(ce(xr(b,ee,rt,F,Dt,zt),$e(([Gt,lt,Ft,Wt,,ve])=>Gt&&!lt&&Ft.height!==0&&Wt.height!==0&&!ve)),([,,,,Gt])=>{ii(zt,!0),Ec(1,()=>{ii(tt,Gt)}),zn(ce(n),()=>{ii(s,[0,0]),ii(ee,!0)})}),Ne(ce(Qt,$e(Gt=>Gt!=null&&Gt.scrollTop>0),Hn(0)),C),Ci(ce(b,li(Qt),$e(([,Gt])=>Gt!=null)),([,Gt])=>{!Gt||(ii(F,Gt.viewport),ii(rt,Gt==null?void 0:Gt.item),ii(Tt,Gt.gap),Gt.scrollTop>0&&(ii(ct,!0),zn(ce(n,Ca(1)),lt=>{ii(ct,!1)}),ii(c,{top:Gt.scrollTop})))}),Ne(ce(F,Fe(({height:Gt})=>Gt)),a),Ne(ce(xr(Ke(F,hl),Ke(rt,hl),Ke(Tt,(Gt,lt)=>Gt&&Gt.column===lt.column&&Gt.row===lt.row),Ke(n)),Fe(([Gt,lt,Ft,Wt])=>({viewport:Gt,item:lt,gap:Ft,scrollTop:Wt}))),Lt),Ne(ce(xr(Ke(A),t,Ke(Tt,Hv),Ke(rt,hl),Ke(F,hl),Ke(dt),Ke(C),Ke(ct),Ke(ee),Ke(Dt)),$e(([,,,,,,,Gt])=>!Gt),Fe(([Gt,[lt,Ft],Wt,ve,ie,xe,_e,,ut,T])=>{const{row:M,column:D}=Wt,{height:H,width:L}=ve,{width:V}=ie;if(_e===0&&(Gt===0||V===0))return Rc;if(L===0){const pt=Cc(T,Gt),yt=pt===0?Math.max(_e-1,0):pt;return zv(sg(pt,yt,xe))}const j=og(V,L,D);let G,W;ut?lt===0&&Ft===0&&_e>0?(G=0,W=_e-1):(G=j*po((lt+M)/(H+M)),W=j*Ic((Ft+M)/(H+M))-1,W=ll(Gt-1,Ta(W,j-1)),G=ll(W,Ta(0,G))):(G=0,W=-1);const U=sg(G,W,xe),{top:O,bottom:z}=ag(ie,Wt,ve,U),et=Ic(Gt/j),nt=et*H+(et-1)*M-z;return{items:U,offsetTop:O,offsetBottom:nt,top:O,bottom:z,itemHeight:H,itemWidth:L}})),B),Ne(ce(dt,$e(Gt=>Gt!==null),Fe(Gt=>Gt.length)),A),Ne(ce(xr(F,rt,B,Tt),$e(([Gt,lt,{items:Ft}])=>Ft.length>0&&lt.height!==0&&Gt.height!==0),Fe(([Gt,lt,{items:Ft},Wt])=>{const{top:ve,bottom:ie}=ag(Gt,Wt,lt,Ft);return[ve,ie]}),ji(go)),s);const Jt=Ee(!1);Ne(ce(n,li(Jt),Fe(([Gt,lt])=>lt||Gt!==0)),Jt);const oe=rn(ce(Ke(B),$e(({items:Gt})=>Gt.length>0),li(A,Jt),$e(([{items:Gt},lt,Ft])=>Ft&&Gt[Gt.length-1].index===lt-1),Fe(([,Gt])=>Gt-1),ji())),pe=rn(ce(Ke(B),$e(({items:Gt})=>Gt.length>0&&Gt[0].index===0),Hn(0),ji())),Ae=rn(ce(Ke(B),li(ct),$e(([{items:Gt},lt])=>Gt.length>0&&!lt),Fe(([{items:Gt}])=>({startIndex:Gt[0].index,endIndex:Gt[Gt.length-1].index})),ji(If),As(0)));Ne(Ae,_.scrollSeekRangeChanged),Ne(ce(tt,li(F,rt,A,Tt),Fe(([Gt,lt,Ft,Wt,ve])=>{const ie=Mf(Gt),{align:xe,behavior:_e,offset:ut}=ie;let T=ie.index;T==="LAST"&&(T=Wt-1),T=Ta(0,T,ll(Wt-1,T));let M=Lc(lt,ve,Ft,T);return xe==="end"?M=Fc(M-lt.height+Ft.height):xe==="center"&&(M=Fc(M-lt.height/2+Ft.height/2)),ut&&(M+=ut),{top:M,behavior:_e}})),c);const Ve=Br(ce(B,Fe(Gt=>Gt.offsetBottom+Gt.bottom)),0);return Ne(ce(x,Fe(Gt=>({width:Gt.visibleWidth,height:Gt.visibleHeight}))),F),{data:dt,totalCount:A,viewportDimensions:F,itemDimensions:rt,scrollTop:n,scrollHeight:st,overscan:r,scrollBy:o,scrollTo:c,scrollToIndex:tt,smoothScrollTargetReached:u,windowViewportRect:x,windowScrollTo:p,useWindowScroll:E,customScrollParent:I,windowScrollContainerState:R,deviation:wt,scrollContainerState:d,footerHeight:f,headerHeight:m,initialItemCount:C,gap:Tt,restoreStateFrom:Qt,..._,initialTopMostItemIndex:Dt,gridState:B,totalListHeight:Ve,...S,startReached:pe,endReached:oe,rangeChanged:Ae,stateChanged:Lt,propsReady:y,stateRestoreInProgress:ct,...w}},Gi(kc,Ur,uo,Hf,Cs,Pc,Ss));function ag(r,t,s,n){const{height:a}=s;if(a===void 0||n.length===0)return{top:0,bottom:0};const o=Lc(r,t,s,n[0].index),c=Lc(r,t,s,n[n.length-1].index)+a;return{top:o,bottom:c}}function Lc(r,t,s,n){const a=og(r.width,s.width,t.column),o=po(n/a),c=o*s.height+Ta(0,o-1)*t.row;return c>0?c+t.row:c}function og(r,t,s){return Ta(1,po((r+s)/(po(t)+s)))}const Uv=ki(()=>{const r=Ee(f=>`Item ${f}`),t=Ee({}),s=Ee(null),n=Ee("virtuoso-grid-item"),a=Ee("virtuoso-grid-list"),o=Ee(Kf),c=Ee("div"),u=Ee(Ea),d=(f,m=null)=>Br(ce(t,Fe(S=>S[f]),ji()),m);return{context:s,itemContent:r,components:t,computeItemKey:o,itemClassName:n,listClassName:a,headerFooterTag:c,scrollerRef:u,FooterComponent:d("Footer"),HeaderComponent:d("Header"),ListComponent:d("List","div"),ItemComponent:d("Item","div"),ScrollerComponent:d("Scroller","div"),ScrollSeekPlaceholder:d("ScrollSeekPlaceholder","div")}}),Gv=ki(([r,t])=>({...r,...t}),Gi(Bv,Uv)),jv=se.memo(function(){const r=Yi("gridState"),t=Yi("listClassName"),s=Yi("itemClassName"),n=Yi("itemContent"),a=Yi("computeItemKey"),o=Yi("isSeeking"),c=An("scrollHeight"),u=Yi("ItemComponent"),d=Yi("ListComponent"),f=Yi("ScrollSeekPlaceholder"),m=Yi("context"),S=An("itemDimensions"),_=An("gap"),y=Yi("log"),b=Yi("stateRestoreInProgress"),x=Xs(E=>{const I=E.parentElement.parentElement.scrollHeight;c(I);const R=E.firstChild;if(R){const{width:p,height:w}=R.getBoundingClientRect();S({width:p,height:w})}_({row:hg("row-gap",getComputedStyle(E).rowGap,y),column:hg("column-gap",getComputedStyle(E).columnGap,y)})});return b?null:se.createElement(d,{ref:x,className:t,...Gr(d,m),style:{paddingTop:r.offsetTop,paddingBottom:r.offsetBottom},"data-testid":"virtuoso-item-list"},r.items.map(E=>{const I=a(E.index,E.data,m);return o?se.createElement(f,{key:I,...Gr(f,m),index:E.index,height:r.itemHeight,width:r.itemWidth}):se.createElement(u,{...Gr(u,m),className:s,"data-index":E.index,key:I},n(E.index,E.data,m))}))}),Vv=se.memo(function(){const r=Yi("HeaderComponent"),t=An("headerHeight"),s=Yi("headerFooterTag"),n=Xs(o=>t(Es(o,"height"))),a=Yi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null}),Wv=se.memo(function(){const r=Yi("FooterComponent"),t=An("footerHeight"),s=Yi("headerFooterTag"),n=Xs(o=>t(Es(o,"height"))),a=Yi("context");return r?se.createElement(s,{ref:n},se.createElement(r,Gr(r,a))):null}),$v=({children:r})=>{const t=se.useContext($f),s=An("itemDimensions"),n=An("viewportDimensions"),a=Xs(o=>{n(o.getBoundingClientRect())});return se.useEffect(()=>{t&&(n({height:t.viewportHeight,width:t.viewportWidth}),s({height:t.itemHeight,width:t.itemWidth}))},[t,n,s]),se.createElement("div",{style:al(!1),ref:a},r)},Kv=({children:r})=>{const t=se.useContext($f),s=An("windowViewportRect"),n=An("itemDimensions"),a=Yi("customScrollParent"),o=Vf(s,a);return se.useEffect(()=>{t&&(n({height:t.itemHeight,width:t.itemWidth}),s({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,s,n]),se.createElement("div",{ref:o,style:al(!1)},r)},Xv=se.memo(function({...r}){const t=Yi("useWindowScroll"),s=Yi("customScrollParent"),n=s||t?qv:Yv,a=s||t?Kv:$v;return se.createElement(n,{...r},se.createElement(a,null,se.createElement(Vv,null),se.createElement(jv,null),se.createElement(Wv,null)))}),{Component:Mw,usePublisher:An,useEmitterValue:Yi,useEmitter:lg}=vf(Gv,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged"}},Xv),Yv=Yf({usePublisher:An,useEmitterValue:Yi,useEmitter:lg}),qv=qf({usePublisher:An,useEmitterValue:Yi,useEmitter:lg});function hg(r,t,s){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&s(`${r} was not resolved to pixel value correctly`,t,nn.WARN),t==="normal"?0:parseInt(t??"0",10)}var cg={exports:{}},cl={},dl={},si={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._registerNode=r.Konva=r.glob=void 0;const t=Math.PI/180;function s(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}r.glob=typeof u0<"u"?u0:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},r.Konva={_global:r.glob,version:"9.3.6",isBrowser:s(),isUnminified:/param/.test(function(a){}.toString()),dblClickWindow:400,getAngle(a){return r.Konva.angleDeg?a*t:a},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return r.Konva.DD.isDragging},isTransforming(){var a;return(a=r.Konva.Transformer)===null||a===void 0?void 0:a.isTransforming()},isDragReady(){return!!r.Konva.DD.node},releaseCanvasOnDestroy:!0,document:r.glob.document,_injectGlobal(a){r.glob.Konva=a}};const n=a=>{r.Konva[a.prototype.getClassName()]=a};r._registerNode=n,r.Konva._injectGlobal(r.Konva)})(si);var qi={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=r.Transform=void 0;const t=si;class s{constructor(w=[1,0,0,1,0,0]){this.dirty=!1,this.m=w&&w.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new s(this.m)}copyInto(w){w.m[0]=this.m[0],w.m[1]=this.m[1],w.m[2]=this.m[2],w.m[3]=this.m[3],w.m[4]=this.m[4],w.m[5]=this.m[5]}point(w){var A=this.m;return{x:A[0]*w.x+A[2]*w.y+A[4],y:A[1]*w.x+A[3]*w.y+A[5]}}translate(w,A){return this.m[4]+=this.m[0]*w+this.m[2]*A,this.m[5]+=this.m[1]*w+this.m[3]*A,this}scale(w,A){return this.m[0]*=w,this.m[1]*=w,this.m[2]*=A,this.m[3]*=A,this}rotate(w){var A=Math.cos(w),C=Math.sin(w),B=this.m[0]*A+this.m[2]*C,F=this.m[1]*A+this.m[3]*C,rt=this.m[0]*-C+this.m[2]*A,tt=this.m[1]*-C+this.m[3]*A;return this.m[0]=B,this.m[1]=F,this.m[2]=rt,this.m[3]=tt,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(w,A){var C=this.m[0]+this.m[2]*A,B=this.m[1]+this.m[3]*A,F=this.m[2]+this.m[0]*w,rt=this.m[3]+this.m[1]*w;return this.m[0]=C,this.m[1]=B,this.m[2]=F,this.m[3]=rt,this}multiply(w){var A=this.m[0]*w.m[0]+this.m[2]*w.m[1],C=this.m[1]*w.m[0]+this.m[3]*w.m[1],B=this.m[0]*w.m[2]+this.m[2]*w.m[3],F=this.m[1]*w.m[2]+this.m[3]*w.m[3],rt=this.m[0]*w.m[4]+this.m[2]*w.m[5]+this.m[4],tt=this.m[1]*w.m[4]+this.m[3]*w.m[5]+this.m[5];return this.m[0]=A,this.m[1]=C,this.m[2]=B,this.m[3]=F,this.m[4]=rt,this.m[5]=tt,this}invert(){var w=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),A=this.m[3]*w,C=-this.m[1]*w,B=-this.m[2]*w,F=this.m[0]*w,rt=w*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),tt=w*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=A,this.m[1]=C,this.m[2]=B,this.m[3]=F,this.m[4]=rt,this.m[5]=tt,this}getMatrix(){return this.m}decompose(){var w=this.m[0],A=this.m[1],C=this.m[2],B=this.m[3],F=this.m[4],rt=this.m[5],tt=w*B-A*C;let st={x:F,y:rt,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(w!=0||A!=0){var wt=Math.sqrt(w*w+A*A);st.rotation=A>0?Math.acos(w/wt):-Math.acos(w/wt),st.scaleX=wt,st.scaleY=tt/wt,st.skewX=(w*C+A*B)/tt,st.skewY=0}else if(C!=0||B!=0){var dt=Math.sqrt(C*C+B*B);st.rotation=Math.PI/2-(B>0?Math.acos(-C/dt):-Math.acos(C/dt)),st.scaleX=tt/dt,st.scaleY=dt,st.skewX=0,st.skewY=(w*C+A*B)/tt}return st.rotation=r.Util._getRotation(st.rotation),st}}r.Transform=s;var n="[object Array]",a="[object Number]",o="[object String]",c="[object Boolean]",u=Math.PI/180,d=180/Math.PI,f="#",m="",S="0",_="Konva warning: ",y="Konva error: ",b="rgb(",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},E=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,I=[];const R=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(p){setTimeout(p,60)};r.Util={_isElement(p){return!!(p&&p.nodeType==1)},_isFunction(p){return!!(p&&p.constructor&&p.call&&p.apply)},_isPlainObject(p){return!!p&&p.constructor===Object},_isArray(p){return Object.prototype.toString.call(p)===n},_isNumber(p){return Object.prototype.toString.call(p)===a&&!isNaN(p)&&isFinite(p)},_isString(p){return Object.prototype.toString.call(p)===o},_isBoolean(p){return Object.prototype.toString.call(p)===c},isObject(p){return p instanceof Object},isValidSelector(p){if(typeof p!="string")return!1;var w=p[0];return w==="#"||w==="."||w===w.toUpperCase()},_sign(p){return p===0||p>0?1:-1},requestAnimFrame(p){I.push(p),I.length===1&&R(function(){const w=I;I=[],w.forEach(function(A){A()})})},createCanvasElement(){var p=document.createElement("canvas");try{p.style=p.style||{}}catch{}return p},createImageElement(){return document.createElement("img")},_isInDocument(p){for(;p=p.parentNode;)if(p==document)return!0;return!1},_urlToImage(p,w){var A=r.Util.createImageElement();A.onload=function(){w(A)},A.src=p},_rgbToHex(p,w,A){return((1<<24)+(p<<16)+(w<<8)+A).toString(16).slice(1)},_hexToRgb(p){p=p.replace(f,m);var w=parseInt(p,16);return{r:w>>16&255,g:w>>8&255,b:w&255}},getRandomColor(){for(var p=(Math.random()*16777215<<0).toString(16);p.length<6;)p=S+p;return f+p},getRGB(p){var w;return p in x?(w=x[p],{r:w[0],g:w[1],b:w[2]}):p[0]===f?this._hexToRgb(p.substring(1)):p.substr(0,4)===b?(w=E.exec(p.replace(/ /g,"")),{r:parseInt(w[1],10),g:parseInt(w[2],10),b:parseInt(w[3],10)}):{r:0,g:0,b:0}},colorToRGBA(p){return p=p||"black",r.Util._namedColorToRBA(p)||r.Util._hex3ColorToRGBA(p)||r.Util._hex4ColorToRGBA(p)||r.Util._hex6ColorToRGBA(p)||r.Util._hex8ColorToRGBA(p)||r.Util._rgbColorToRGBA(p)||r.Util._rgbaColorToRGBA(p)||r.Util._hslColorToRGBA(p)},_namedColorToRBA(p){var w=x[p.toLowerCase()];return w?{r:w[0],g:w[1],b:w[2],a:1}:null},_rgbColorToRGBA(p){if(p.indexOf("rgb(")===0){p=p.match(/rgb\(([^)]+)\)/)[1];var w=p.split(/ *, */).map(Number);return{r:w[0],g:w[1],b:w[2],a:1}}},_rgbaColorToRGBA(p){if(p.indexOf("rgba(")===0){p=p.match(/rgba\(([^)]+)\)/)[1];var w=p.split(/ *, */).map((A,C)=>A.slice(-1)==="%"?C===3?parseInt(A)/100:parseInt(A)/100*255:Number(A));return{r:w[0],g:w[1],b:w[2],a:w[3]}}},_hex8ColorToRGBA(p){if(p[0]==="#"&&p.length===9)return{r:parseInt(p.slice(1,3),16),g:parseInt(p.slice(3,5),16),b:parseInt(p.slice(5,7),16),a:parseInt(p.slice(7,9),16)/255}},_hex6ColorToRGBA(p){if(p[0]==="#"&&p.length===7)return{r:parseInt(p.slice(1,3),16),g:parseInt(p.slice(3,5),16),b:parseInt(p.slice(5,7),16),a:1}},_hex4ColorToRGBA(p){if(p[0]==="#"&&p.length===5)return{r:parseInt(p[1]+p[1],16),g:parseInt(p[2]+p[2],16),b:parseInt(p[3]+p[3],16),a:parseInt(p[4]+p[4],16)/255}},_hex3ColorToRGBA(p){if(p[0]==="#"&&p.length===4)return{r:parseInt(p[1]+p[1],16),g:parseInt(p[2]+p[2],16),b:parseInt(p[3]+p[3],16),a:1}},_hslColorToRGBA(p){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(p)){const[w,...A]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(p),C=Number(A[0])/360,B=Number(A[1])/100,F=Number(A[2])/100;let rt,tt,st;if(B===0)return st=F*255,{r:Math.round(st),g:Math.round(st),b:Math.round(st),a:1};F<.5?rt=F*(1+B):rt=F+B-F*B;const wt=2*F-rt,dt=[0,0,0];for(let Tt=0;Tt<3;Tt++)tt=C+1/3*-(Tt-1),tt<0&&tt++,tt>1&&tt--,6*tt<1?st=wt+(rt-wt)*6*tt:2*tt<1?st=rt:3*tt<2?st=wt+(rt-wt)*(2/3-tt)*6:st=wt,dt[Tt]=st*255;return{r:Math.round(dt[0]),g:Math.round(dt[1]),b:Math.round(dt[2]),a:1}}},haveIntersection(p,w){return!(w.x>p.x+p.width||w.x+w.width<p.x||w.y>p.y+p.height||w.y+w.height<p.y)},cloneObject(p){var w={};for(var A in p)this._isPlainObject(p[A])?w[A]=this.cloneObject(p[A]):this._isArray(p[A])?w[A]=this.cloneArray(p[A]):w[A]=p[A];return w},cloneArray(p){return p.slice(0)},degToRad(p){return p*u},radToDeg(p){return p*d},_degToRad(p){return r.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),r.Util.degToRad(p)},_radToDeg(p){return r.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),r.Util.radToDeg(p)},_getRotation(p){return t.Konva.angleDeg?r.Util.radToDeg(p):p},_capitalize(p){return p.charAt(0).toUpperCase()+p.slice(1)},throw(p){throw new Error(y+p)},error(p){console.error(y+p)},warn(p){!t.Konva.showWarnings||console.warn(_+p)},each(p,w){for(var A in p)w(A,p[A])},_inRange(p,w,A){return w<=p&&p<A},_getProjectionToSegment(p,w,A,C,B,F){var rt,tt,st,wt=(p-A)*(p-A)+(w-C)*(w-C);if(wt==0)rt=p,tt=w,st=(B-A)*(B-A)+(F-C)*(F-C);else{var dt=((B-p)*(A-p)+(F-w)*(C-w))/wt;dt<0?(rt=p,tt=w,st=(p-B)*(p-B)+(w-F)*(w-F)):dt>1?(rt=A,tt=C,st=(A-B)*(A-B)+(C-F)*(C-F)):(rt=p+dt*(A-p),tt=w+dt*(C-w),st=(rt-B)*(rt-B)+(tt-F)*(tt-F))}return[rt,tt,st]},_getProjectionToLine(p,w,A){var C=r.Util.cloneObject(p),B=Number.MAX_VALUE;return w.forEach(function(F,rt){if(!(!A&&rt===w.length-1)){var tt=w[(rt+1)%w.length],st=r.Util._getProjectionToSegment(F.x,F.y,tt.x,tt.y,p.x,p.y),wt=st[0],dt=st[1],Tt=st[2];Tt<B&&(C.x=wt,C.y=dt,B=Tt)}}),C},_prepareArrayForTween(p,w,A){var C,B=[],F=[];if(p.length>w.length){var rt=w;w=p,p=rt}for(C=0;C<p.length;C+=2)B.push({x:p[C],y:p[C+1]});for(C=0;C<w.length;C+=2)F.push({x:w[C],y:w[C+1]});var tt=[];return F.forEach(function(st){var wt=r.Util._getProjectionToLine(st,B,A);tt.push(wt.x),tt.push(wt.y)}),tt},_prepareToStringify(p){var w;p.visitedByCircularReferenceRemoval=!0;for(var A in p)if(p.hasOwnProperty(A)&&p[A]&&typeof p[A]=="object"){if(w=Object.getOwnPropertyDescriptor(p,A),p[A].visitedByCircularReferenceRemoval||r.Util._isElement(p[A]))if(w.configurable)delete p[A];else return null;else if(r.Util._prepareToStringify(p[A])===null)if(w.configurable)delete p[A];else return null}return delete p.visitedByCircularReferenceRemoval,p},_assign(p,w){for(var A in w)p[A]=w[A];return p},_getFirstPointerId(p){return p.touches?p.changedTouches[0].identifier:p.pointerId||999},releaseCanvas(...p){!t.Konva.releaseCanvasOnDestroy||p.forEach(w=>{w.width=0,w.height=0})},drawRoundedRectPath(p,w,A,C){let B=0,F=0,rt=0,tt=0;typeof C=="number"?B=F=rt=tt=Math.min(C,w/2,A/2):(B=Math.min(C[0]||0,w/2,A/2),F=Math.min(C[1]||0,w/2,A/2),tt=Math.min(C[2]||0,w/2,A/2),rt=Math.min(C[3]||0,w/2,A/2)),p.moveTo(B,0),p.lineTo(w-F,0),p.arc(w-F,F,F,Math.PI*3/2,0,!1),p.lineTo(w,A-tt),p.arc(w-tt,A-tt,tt,0,Math.PI/2,!1),p.lineTo(rt,A),p.arc(rt,A-rt,rt,Math.PI/2,Math.PI,!1),p.lineTo(0,B),p.arc(B,B,B,Math.PI,Math.PI*3/2,!1)}}})(qi);var Vi={},ai={},De={};Object.defineProperty(De,"__esModule",{value:!0}),De.getComponentValidator=De.getBooleanValidator=De.getNumberArrayValidator=De.getFunctionValidator=De.getStringOrGradientValidator=De.getStringValidator=De.getNumberOrAutoValidator=De.getNumberOrArrayOfNumbersValidator=De.getNumberValidator=De.alphaComponent=De.RGBComponent=void 0;const rs=si,Zi=qi;function ns(r){return Zi.Util._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||Zi.Util._isBoolean(r)?r:Object.prototype.toString.call(r)}function Qv(r){return r>255?255:r<0?0:Math.round(r)}De.RGBComponent=Qv;function Zv(r){return r>1?1:r<1e-4?1e-4:r}De.alphaComponent=Zv;function Jv(){if(rs.Konva.isUnminified)return function(r,t){return Zi.Util._isNumber(r)||Zi.Util.warn(ns(r)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),r}}De.getNumberValidator=Jv;function ty(r){if(rs.Konva.isUnminified)return function(t,s){let n=Zi.Util._isNumber(t),a=Zi.Util._isArray(t)&&t.length==r;return!n&&!a&&Zi.Util.warn(ns(t)+' is a not valid value for "'+s+'" attribute. The value should be a number or Array<number>('+r+")"),t}}De.getNumberOrArrayOfNumbersValidator=ty;function ey(){if(rs.Konva.isUnminified)return function(r,t){var s=Zi.Util._isNumber(r),n=r==="auto";return s||n||Zi.Util.warn(ns(r)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),r}}De.getNumberOrAutoValidator=ey;function iy(){if(rs.Konva.isUnminified)return function(r,t){return Zi.Util._isString(r)||Zi.Util.warn(ns(r)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),r}}De.getStringValidator=iy;function ry(){if(rs.Konva.isUnminified)return function(r,t){const s=Zi.Util._isString(r),n=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return s||n||Zi.Util.warn(ns(r)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),r}}De.getStringOrGradientValidator=ry;function ny(){if(rs.Konva.isUnminified)return function(r,t){return Zi.Util._isFunction(r)||Zi.Util.warn(ns(r)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),r}}De.getFunctionValidator=ny;function sy(){if(rs.Konva.isUnminified)return function(r,t){const s=Int8Array?Object.getPrototypeOf(Int8Array):null;return s&&r instanceof s||(Zi.Util._isArray(r)?r.forEach(function(n){Zi.Util._isNumber(n)||Zi.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Zi.Util.warn(ns(r)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),r}}De.getNumberArrayValidator=sy;function ay(){if(rs.Konva.isUnminified)return function(r,t){var s=r===!0||r===!1;return s||Zi.Util.warn(ns(r)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),r}}De.getBooleanValidator=ay;function oy(r){if(rs.Konva.isUnminified)return function(t,s){return t==null||Zi.Util.isObject(t)||Zi.Util.warn(ns(t)+' is a not valid value for "'+s+'" attribute. The value should be an object with properties '+r),t}}De.getComponentValidator=oy,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Factory=void 0;const t=qi,s=De;var n="get",a="set";r.Factory={addGetterSetter(o,c,u,d,f){r.Factory.addGetter(o,c,u),r.Factory.addSetter(o,c,d,f),r.Factory.addOverloadedGetterSetter(o,c)},addGetter(o,c,u){var d=n+t.Util._capitalize(c);o.prototype[d]=o.prototype[d]||function(){var f=this.attrs[c];return f===void 0?u:f}},addSetter(o,c,u,d){var f=a+t.Util._capitalize(c);o.prototype[f]||r.Factory.overWriteSetter(o,c,u,d)},overWriteSetter(o,c,u,d){var f=a+t.Util._capitalize(c);o.prototype[f]=function(m){return u&&m!==void 0&&m!==null&&(m=u.call(this,m,c)),this._setAttr(c,m),d&&d.call(this),this}},addComponentsGetterSetter(o,c,u,d,f){var m=u.length,S=t.Util._capitalize,_=n+S(c),y=a+S(c),b,x;o.prototype[_]=function(){var I={};for(b=0;b<m;b++)x=u[b],I[x]=this.getAttr(c+S(x));return I};var E=(0,s.getComponentValidator)(u);o.prototype[y]=function(I){var R=this.attrs[c],p;d&&(I=d.call(this,I)),E&&E.call(this,I,c);for(p in I)!I.hasOwnProperty(p)||this._setAttr(c+S(p),I[p]);return I||u.forEach(w=>{this._setAttr(c+S(w),void 0)}),this._fireChangeEvent(c,R,I),f&&f.call(this),this},r.Factory.addOverloadedGetterSetter(o,c)},addOverloadedGetterSetter(o,c){var u=t.Util._capitalize(c),d=a+u,f=n+u;o.prototype[c]=function(){return arguments.length?(this[d](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(o,c,u,d){t.Util.error("Adding deprecated "+c);var f=n+t.Util._capitalize(c),m=c+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[f]=function(){t.Util.error(m);var S=this.attrs[c];return S===void 0?u:S},r.Factory.addSetter(o,c,d,function(){t.Util.error(m)}),r.Factory.addOverloadedGetterSetter(o,c)},backCompat(o,c){t.Util.each(c,function(u,d){var f=o.prototype[d],m=n+t.Util._capitalize(u),S=a+t.Util._capitalize(u);function _(){f.apply(this,arguments),t.Util.error('"'+u+'" method is deprecated and will be removed soon. Use ""'+d+'" instead.')}o.prototype[u]=_,o.prototype[m]=_,o.prototype[S]=_})},afterSetFilter(){this._filterUpToDate=!1}}}(ai);var Sn={},ss={};Object.defineProperty(ss,"__esModule",{value:!0}),ss.HitContext=ss.SceneContext=ss.Context=void 0;const dg=qi,ly=si;function hy(r){var t=[],s=r.length,n=dg.Util,a,o;for(a=0;a<s;a++)o=r[a],n._isNumber(o)?o=Math.round(o*1e3)/1e3:n._isString(o)||(o=o+""),t.push(o);return t}var ug=",",cy="(",dy=")",uy="([",fy="])",gy=";",py="()",my="=",fg=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],vy=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const yy=100;class ul{constructor(t){this.canvas=t,ly.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,s){var n=this.traceArr,a=n.length,o="",c,u,d,f;for(c=0;c<a;c++)u=n[c],d=u.method,d?(f=u.args,o+=d,t?o+=py:dg.Util._isArray(f[0])?o+=uy+f.join(ug)+fy:(s&&(f=f.map(m=>typeof m=="number"?Math.floor(m):m)),o+=cy+f.join(ug)+dy)):(o+=u.property,t||(o+=my+u.val)),o+=gy;return o}clearTrace(){this.traceArr=[]}_trace(t){var s=this.traceArr,n;s.push(t),n=s.length,n>=yy&&s.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var s=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,s.getWidth()/s.pixelRatio,s.getHeight()/s.pixelRatio)}_applyLineCap(t){const s=t.attrs.lineCap;s&&this.setAttr("lineCap",s)}_applyOpacity(t){var s=t.getAbsoluteOpacity();s!==1&&this.setAttr("globalAlpha",s)}_applyLineJoin(t){const s=t.attrs.lineJoin;s&&this.setAttr("lineJoin",s)}setAttr(t,s){this._context[t]=s}arc(t,s,n,a,o,c){this._context.arc(t,s,n,a,o,c)}arcTo(t,s,n,a,o){this._context.arcTo(t,s,n,a,o)}beginPath(){this._context.beginPath()}bezierCurveTo(t,s,n,a,o,c){this._context.bezierCurveTo(t,s,n,a,o,c)}clearRect(t,s,n,a){this._context.clearRect(t,s,n,a)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,s){var n=arguments;if(n.length===2)return this._context.createImageData(t,s);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,s,n,a){return this._context.createLinearGradient(t,s,n,a)}createPattern(t,s){return this._context.createPattern(t,s)}createRadialGradient(t,s,n,a,o,c){return this._context.createRadialGradient(t,s,n,a,o,c)}drawImage(t,s,n,a,o,c,u,d,f){var m=arguments,S=this._context;m.length===3?S.drawImage(t,s,n):m.length===5?S.drawImage(t,s,n,a,o):m.length===9&&S.drawImage(t,s,n,a,o,c,u,d,f)}ellipse(t,s,n,a,o,c,u,d){this._context.ellipse(t,s,n,a,o,c,u,d)}isPointInPath(t,s,n,a){return n?this._context.isPointInPath(n,t,s,a):this._context.isPointInPath(t,s,a)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,s,n,a){this._context.fillRect(t,s,n,a)}strokeRect(t,s,n,a){this._context.strokeRect(t,s,n,a)}fillText(t,s,n,a){a?this._context.fillText(t,s,n,a):this._context.fillText(t,s,n)}measureText(t){return this._context.measureText(t)}getImageData(t,s,n,a){return this._context.getImageData(t,s,n,a)}lineTo(t,s){this._context.lineTo(t,s)}moveTo(t,s){this._context.moveTo(t,s)}rect(t,s,n,a){this._context.rect(t,s,n,a)}roundRect(t,s,n,a,o){this._context.roundRect(t,s,n,a,o)}putImageData(t,s,n){this._context.putImageData(t,s,n)}quadraticCurveTo(t,s,n,a){this._context.quadraticCurveTo(t,s,n,a)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,s){this._context.scale(t,s)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,s,n,a,o,c){this._context.setTransform(t,s,n,a,o,c)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,s,n,a){this._context.strokeText(t,s,n,a)}transform(t,s,n,a,o,c){this._context.transform(t,s,n,a,o,c)}translate(t,s){this._context.translate(t,s)}_enableTrace(){var t=this,s=fg.length,n=this.setAttr,a,o,c=function(u){var d=t[u],f;t[u]=function(){return o=hy(Array.prototype.slice.call(arguments,0)),f=d.apply(t,arguments),t._trace({method:u,args:o}),f}};for(a=0;a<s;a++)c(fg[a]);t.setAttr=function(){n.apply(t,arguments);var u=arguments[0],d=arguments[1];(u==="shadowOffsetX"||u==="shadowOffsetY"||u==="shadowBlur")&&(d=d/this.canvas.getPixelRatio()),t._trace({property:u,val:d})}}_applyGlobalCompositeOperation(t){const s=t.attrs.globalCompositeOperation;var n=!s||s==="source-over";n||this.setAttr("globalCompositeOperation",s)}}ss.Context=ul,vy.forEach(function(r){Object.defineProperty(ul.prototype,r,{get(){return this._context[r]},set(t){this._context[r]=t}})});class by extends ul{constructor(t,{willReadFrequently:s=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:s})}_fillColor(t){var s=t.fill();this.setAttr("fillStyle",s),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var s=t._getLinearGradient();s&&(this.setAttr("fillStyle",s),t._fillFunc(this))}_fillRadialGradient(t){const s=t._getRadialGradient();s&&(this.setAttr("fillStyle",s),t._fillFunc(this))}_fill(t){const s=t.fill(),n=t.getFillPriority();if(s&&n==="color"){this._fillColor(t);return}const a=t.getFillPatternImage();if(a&&n==="pattern"){this._fillPattern(t);return}const o=t.getFillLinearGradientColorStops();if(o&&n==="linear-gradient"){this._fillLinearGradient(t);return}const c=t.getFillRadialGradientColorStops();if(c&&n==="radial-gradient"){this._fillRadialGradient(t);return}s?this._fillColor(t):a?this._fillPattern(t):o?this._fillLinearGradient(t):c&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const s=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),a=t.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(s.x,s.y,n.x,n.y);if(a){for(var c=0;c<a.length;c+=2)o.addColorStop(a[c],a[c+1]);this.setAttr("strokeStyle",o)}}_stroke(t){var s=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();var a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),s&&t.dashEnabled()&&(this.setLineDash(s),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var o=t.getStrokeLinearGradientColorStops();o?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var s,n,a,o=(s=t.getShadowRGBA())!==null&&s!==void 0?s:"black",c=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,u=(a=t.getShadowOffset())!==null&&a!==void 0?a:{x:0,y:0},d=t.getAbsoluteScale(),f=this.canvas.getPixelRatio(),m=d.x*f,S=d.y*f;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",c*Math.min(Math.abs(m),Math.abs(S))),this.setAttr("shadowOffsetX",u.x*m),this.setAttr("shadowOffsetY",u.y*S)}}ss.SceneContext=by;class _y extends ul{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const o=t.getStrokeScaleEnabled();if(!o){this.save();var s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(t);var n=t.hitStrokeWidth(),a=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",a),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),o||this.restore()}}}ss.HitContext=_y,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.HitCanvas=Sn.SceneCanvas=Sn.Canvas=void 0;const fl=qi,gg=ss,pg=si,xy=ai,wy=De;var gl;function Ay(){if(gl)return gl;var r=fl.Util.createCanvasElement(),t=r.getContext("2d");return gl=function(){var s=pg.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return s/n}(),fl.Util.releaseCanvas(r),gl}class pl{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var s=t||{},n=s.pixelRatio||pg.Konva.pixelRatio||Ay();this.pixelRatio=n,this._canvas=fl.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var s=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/s,this.getHeight()/s)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var s=this.pixelRatio,n=this.getContext()._context;n.scale(s,s)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var s=this.pixelRatio,n=this.getContext()._context;n.scale(s,s)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,s){this.setWidth(t||0),this.setHeight(s||0)}toDataURL(t,s){try{return this._canvas.toDataURL(t,s)}catch{try{return this._canvas.toDataURL()}catch(n){return fl.Util.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Sn.Canvas=pl,xy.Factory.addGetterSetter(pl,"pixelRatio",void 0,(0,wy.getNumberValidator)());class Sy extends pl{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new gg.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}Sn.SceneCanvas=Sy;class Ey extends pl{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new gg.HitContext(this),this.setSize(t.width,t.height)}}Sn.HitCanvas=Ey;var ml={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DD=void 0;const t=si,s=qi;r.DD={get isDragging(){var n=!1;return r.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){var n;return r.DD._dragElements.forEach(a=>{n=a.node}),n},_dragElements:new Map,_drag(n){const a=[];r.DD._dragElements.forEach((o,c)=>{const{node:u}=o,d=u.getStage();d.setPointersPositions(n),o.pointerId===void 0&&(o.pointerId=s.Util._getFirstPointerId(n));const f=d._changedPointerPositions.find(_=>_.id===o.pointerId);if(f){if(o.dragStatus!=="dragging"){var m=u.dragDistance(),S=Math.max(Math.abs(f.x-o.startPointerPos.x),Math.abs(f.y-o.startPointerPos.y));if(S<m||(u.startDrag({evt:n}),!u.isDragging()))return}u._setDragPosition(n,o),a.push(u)}}),a.forEach(o=>{o.fire("dragmove",{type:"dragmove",target:o,evt:n},!0)})},_endDragBefore(n){const a=[];r.DD._dragElements.forEach(o=>{const{node:c}=o,u=c.getStage();if(n&&u.setPointersPositions(n),!u._changedPointerPositions.find(f=>f.id===o.pointerId))return;(o.dragStatus==="dragging"||o.dragStatus==="stopped")&&(r.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,o.dragStatus="stopped");const d=o.node.getLayer()||o.node instanceof t.Konva.Stage&&o.node;d&&a.indexOf(d)===-1&&a.push(d)}),a.forEach(o=>{o.draw()})},_endDragAfter(n){r.DD._dragElements.forEach((a,o)=>{a.dragStatus==="stopped"&&a.node.fire("dragend",{type:"dragend",target:a.node,evt:n},!0),a.dragStatus!=="dragging"&&r.DD._dragElements.delete(o)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",r.DD._endDragBefore,!0),window.addEventListener("touchend",r.DD._endDragBefore,!0),window.addEventListener("mousemove",r.DD._drag),window.addEventListener("touchmove",r.DD._drag),window.addEventListener("mouseup",r.DD._endDragAfter,!1),window.addEventListener("touchend",r.DD._endDragAfter,!1))})(ml),Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.Node=void 0;const mi=qi,mo=ai,vo=Sn,ks=si,fn=ml,nr=De;var vl="absoluteOpacity",yl="allEventListeners",as="absoluteTransform",mg="absoluteScale",Qs="canvas",Cy="Change",ky="children",Ty="konva",Dc="listening",vg="mouseenter",yg="mouseleave",bg="set",_g="Shape",bl=" ",xg="stage",Ts="transform",Py="Stage",Nc="visible",My=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(bl);let Ry=1,Xe=class{constructor(r){this._id=Ry++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(r),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(r){(r===Ts||r===as)&&this._cache.get(r)?this._cache.get(r).dirty=!0:r?this._cache.delete(r):this._cache.clear()}_getCache(r,t){var s=this._cache.get(r),n=r===Ts||r===as,a=s===void 0||n&&s.dirty===!0;return a&&(s=t.call(this),this._cache.set(r,s)),s}_calculate(r,t,s){if(!this._attachedDepsListeners.get(r)){const n=t.map(a=>a+"Change.konva").join(bl);this.on(n,()=>{this._clearCache(r)}),this._attachedDepsListeners.set(r,!0)}return this._getCache(r,s)}_getCanvasCache(){return this._cache.get(Qs)}_clearSelfAndDescendantCache(r){this._clearCache(r),r===as&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Qs)){const{scene:r,filter:t,hit:s}=this._cache.get(Qs);mi.Util.releaseCanvas(r,t,s),this._cache.delete(Qs)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(r){var t=r||{},s={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(s=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var n=Math.ceil(t.width||s.width),a=Math.ceil(t.height||s.height),o=t.pixelRatio,c=t.x===void 0?Math.floor(s.x):t.x,u=t.y===void 0?Math.floor(s.y):t.y,d=t.offset||0,f=t.drawBorder||!1,m=t.hitCanvasPixelRatio||1;if(!n||!a){mi.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const S=Math.abs(Math.round(s.x)-c)>.5?1:0,_=Math.abs(Math.round(s.y)-u)>.5?1:0;n+=d*2+S,a+=d*2+_,c-=d,u-=d;var y=new vo.SceneCanvas({pixelRatio:o,width:n,height:a}),b=new vo.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),x=new vo.HitCanvas({pixelRatio:m,width:n,height:a}),E=y.getContext(),I=x.getContext();return x.isCache=!0,y.isCache=!0,this._cache.delete(Qs),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(y.getContext()._context.imageSmoothingEnabled=!1,b.getContext()._context.imageSmoothingEnabled=!1),E.save(),I.save(),E.translate(-c,-u),I.translate(-c,-u),this._isUnderCache=!0,this._clearSelfAndDescendantCache(vl),this._clearSelfAndDescendantCache(mg),this.drawScene(y,this),this.drawHit(x,this),this._isUnderCache=!1,E.restore(),I.restore(),f&&(E.save(),E.beginPath(),E.rect(0,0,n,a),E.closePath(),E.setAttr("strokeStyle","red"),E.setAttr("lineWidth",5),E.stroke(),E.restore()),this._cache.set(Qs,{scene:y,filter:b,hit:x,x:c,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(Qs)}getClientRect(r){throw new Error('abstract "getClientRect" method call')}_transformedRect(r,t){var s=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],n=1/0,a=1/0,o=-1/0,c=-1/0,u=this.getAbsoluteTransform(t);return s.forEach(function(d){var f=u.point(d);n===void 0&&(n=o=f.x,a=c=f.y),n=Math.min(n,f.x),a=Math.min(a,f.y),o=Math.max(o,f.x),c=Math.max(c,f.y)}),{x:n,y:a,width:o-n,height:c-a}}_drawCachedSceneCanvas(r){r.save(),r._applyOpacity(this),r._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();r.translate(t.x,t.y);var s=this._getCachedSceneCanvas(),n=s.pixelRatio;r.drawImage(s._canvas,0,0,s.width/n,s.height/n),r.restore()}_drawCachedHitCanvas(r){var t=this._getCanvasCache(),s=t.hit;r.save(),r.translate(t.x,t.y),r.drawImage(s._canvas,0,0,s.width/s.pixelRatio,s.height/s.pixelRatio),r.restore()}_getCachedSceneCanvas(){var r=this.filters(),t=this._getCanvasCache(),s=t.scene,n=t.filter,a=n.getContext(),o,c,u,d;if(r){if(!this._filterUpToDate){var f=s.pixelRatio;n.setSize(s.width/s.pixelRatio,s.height/s.pixelRatio);try{for(o=r.length,a.clear(),a.drawImage(s._canvas,0,0,s.getWidth()/f,s.getHeight()/f),c=a.getImageData(0,0,n.getWidth(),n.getHeight()),u=0;u<o;u++){if(d=r[u],typeof d!="function"){mi.Util.error("Filter should be type of function, but got "+typeof d+" instead. Please check correct filters");continue}d.call(this,c),a.putImageData(c,0,0)}}catch(m){mi.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return s}on(r,t){if(this._cache&&this._cache.delete(yl),arguments.length===3)return this._delegate.apply(this,arguments);var s=r.split(bl),n=s.length,a,o,c,u,d;for(a=0;a<n;a++)o=s[a],c=o.split("."),u=c[0],d=c[1]||"",this.eventListeners[u]||(this.eventListeners[u]=[]),this.eventListeners[u].push({name:d,handler:t});return this}off(r,t){var s=(r||"").split(bl),n=s.length,a,o,c,u,d,f;if(this._cache&&this._cache.delete(yl),!r)for(o in this.eventListeners)this._off(o);for(a=0;a<n;a++)if(c=s[a],u=c.split("."),d=u[0],f=u[1],d)this.eventListeners[d]&&this._off(d,f,t);else for(o in this.eventListeners)this._off(o,f,t);return this}dispatchEvent(r){var t={target:this,type:r.type,evt:r};return this.fire(r.type,t),this}addEventListener(r,t){return this.on(r,function(s){t.call(this,s.evt)}),this}removeEventListener(r){return this.off(r),this}_delegate(r,t,s){var n=this;this.on(r,function(a){for(var o=a.target.findAncestors(t,!0,n),c=0;c<o.length;c++)a=mi.Util.cloneObject(a),a.currentTarget=o[c],s.call(o[c],a)})}remove(){return this.isDragging()&&this.stopDrag(),fn.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(as),this._clearSelfAndDescendantCache(vl),this._clearSelfAndDescendantCache(mg),this._clearSelfAndDescendantCache(xg),this._clearSelfAndDescendantCache(Nc),this._clearSelfAndDescendantCache(Dc)}_remove(){this._clearCaches();var r=this.getParent();r&&r.children&&(r.children.splice(this.index,1),r._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(r){var t="get"+mi.Util._capitalize(r);return mi.Util._isFunction(this[t])?this[t]():this.attrs[r]}getAncestors(){for(var r=this.getParent(),t=[];r;)t.push(r),r=r.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(r){return this._batchTransformChanges(()=>{var t,s;if(!r)return this;for(t in r)t!==ky&&(s=bg+mi.Util._capitalize(t),mi.Util._isFunction(this[s])?this[s](r[t]):this._setAttr(t,r[t]))}),this}isListening(){return this._getCache(Dc,this._isListening)}_isListening(r){if(!this.listening())return!1;const t=this.getParent();return t&&t!==r&&this!==r?t._isListening(r):!0}isVisible(){return this._getCache(Nc,this._isVisible)}_isVisible(r){if(!this.visible())return!1;const t=this.getParent();return t&&t!==r&&this!==r?t._isVisible(r):!0}shouldDrawHit(r,t=!1){if(r)return this._isVisible(r)&&this._isListening(r);var s=this.getLayer(),n=!1;fn.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===s)&&(n=!0)});var a=!t&&!ks.Konva.hitOnDragEnabled&&(n||ks.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var r=this.getDepth(),t=this,s=0,n,a,o,c;function u(f){for(n=[],a=f.length,o=0;o<a;o++)c=f[o],s++,c.nodeType!==_g&&(n=n.concat(c.getChildren().slice())),c._id===t._id&&(o=a);n.length>0&&n[0].getDepth()<=r&&u(n)}const d=this.getStage();return t.nodeType!==Py&&d&&u(d.getChildren()),s}getDepth(){for(var r=0,t=this.parent;t;)r++,t=t.parent;return r}_batchTransformChanges(r){this._batchingTransformChange=!0,r(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ts),this._clearSelfAndDescendantCache(as)),this._needClearTransformCache=!1}setPosition(r){return this._batchTransformChanges(()=>{this.x(r.x),this.y(r.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const r=this.getStage();if(!r)return null;var t=r.getPointerPosition();if(!t)return null;var s=this.getAbsoluteTransform().copy();return s.invert(),s.point(t)}getAbsolutePosition(r){let t=!1,s=this.parent;for(;s;){if(s.isCached()){t=!0;break}s=s.parent}t&&!r&&(r=!0);var n=this.getAbsoluteTransform(r).getMatrix(),a=new mi.Transform,o=this.offset();return a.m=n.slice(),a.translate(o.x,o.y),a.getTranslation()}setAbsolutePosition(r){const{x:t,y:s,...n}=this._clearTransform();this.attrs.x=t,this.attrs.y=s,this._clearCache(Ts);var a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(r.x,r.y),r={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(n),this.setPosition({x:r.x,y:r.y}),this._clearCache(Ts),this._clearSelfAndDescendantCache(as),this}_setTransform(r){var t;for(t in r)this.attrs[t]=r[t]}_clearTransform(){var r={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,r}move(r){var t=r.x,s=r.y,n=this.x(),a=this.y();return t!==void 0&&(n+=t),s!==void 0&&(a+=s),this.setPosition({x:n,y:a}),this}_eachAncestorReverse(r,t){var s=[],n=this.getParent(),a,o;if(!(t&&t._id===this._id)){for(s.unshift(this);n&&(!t||n._id!==t._id);)s.unshift(n),n=n.parent;for(a=s.length,o=0;o<a;o++)r(s[o])}}rotate(r){return this.rotation(this.rotation()+r),this}moveToTop(){if(!this.parent)return mi.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var r=this.index,t=this.parent.getChildren().length;return r<t-1?(this.parent.children.splice(r,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return mi.Util.warn("Node has no parent. moveUp function is ignored."),!1;var r=this.index,t=this.parent.getChildren().length;return r<t-1?(this.parent.children.splice(r,1),this.parent.children.splice(r+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return mi.Util.warn("Node has no parent. moveDown function is ignored."),!1;var r=this.index;return r>0?(this.parent.children.splice(r,1),this.parent.children.splice(r-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return mi.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var r=this.index;return r>0?(this.parent.children.splice(r,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(r){if(!this.parent)return mi.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(r<0||r>=this.parent.children.length)&&mi.Util.warn("Unexpected value "+r+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(r,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(vl,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var r=this.opacity(),t=this.getParent();return t&&!t._isUnderCache&&(r*=t.getAbsoluteOpacity()),r}moveTo(r){return this.getParent()!==r&&(this._remove(),r.add(this)),this}toObject(){var r=this.getAttrs(),t,s,n,a,o;const c={attrs:{},className:this.getClassName()};for(t in r)s=r[t],o=mi.Util.isObject(s)&&!mi.Util._isPlainObject(s)&&!mi.Util._isArray(s),!o&&(n=typeof this[t]=="function"&&this[t],delete r[t],a=n?n.call(this):null,r[t]=s,a!==s&&(c.attrs[t]=s));return mi.Util._prepareToStringify(c)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(r,t,s){var n=[];t&&this._isMatch(r)&&n.push(this);for(var a=this.parent;a;){if(a===s)return n;a._isMatch(r)&&n.push(a),a=a.parent}return n}isAncestorOf(r){return!1}findAncestor(r,t,s){return this.findAncestors(r,t,s)[0]}_isMatch(r){if(!r)return!1;if(typeof r=="function")return r(this);var t=r.replace(/ /g,"").split(","),s=t.length,n,a;for(n=0;n<s;n++)if(a=t[n],mi.Util.isValidSelector(a)||(mi.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),mi.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),mi.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){var r=this.getParent();return r?r.getLayer():null}getStage(){return this._getCache(xg,this._getStage)}_getStage(){var r=this.getParent();return r?r.getStage():null}fire(r,t={},s){return t.target=t.target||this,s?this._fireAndBubble(r,t):this._fire(r,t),this}getAbsoluteTransform(r){return r?this._getAbsoluteTransform(r):this._getCache(as,this._getAbsoluteTransform)}_getAbsoluteTransform(r){var t;if(r)return t=new mi.Transform,this._eachAncestorReverse(function(n){var a=n.transformsEnabled();a==="all"?t.multiply(n.getTransform()):a==="position"&&t.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},r),t;t=this._cache.get(as)||new mi.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();var s=this.transformsEnabled();if(s==="all")t.multiply(this.getTransform());else if(s==="position"){const n=this.attrs.x||0,a=this.attrs.y||0,o=this.attrs.offsetX||0,c=this.attrs.offsetY||0;t.translate(n-o,a-c)}return t.dirty=!1,t}getAbsoluteScale(r){for(var t=this;t;)t._isUnderCache&&(r=t),t=t.getParent();const s=this.getAbsoluteTransform(r).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ts,this._getTransform)}_getTransform(){var r,t,s=this._cache.get(Ts)||new mi.Transform;s.reset();var n=this.x(),a=this.y(),o=ks.Konva.getAngle(this.rotation()),c=(r=this.attrs.scaleX)!==null&&r!==void 0?r:1,u=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,d=this.attrs.skewX||0,f=this.attrs.skewY||0,m=this.attrs.offsetX||0,S=this.attrs.offsetY||0;return(n!==0||a!==0)&&s.translate(n,a),o!==0&&s.rotate(o),(d!==0||f!==0)&&s.skew(d,f),(c!==1||u!==1)&&s.scale(c,u),(m!==0||S!==0)&&s.translate(-1*m,-1*S),s.dirty=!1,s}clone(r){var t=mi.Util.cloneObject(this.attrs),s,n,a,o,c;for(s in r)t[s]=r[s];var u=new this.constructor(t);for(s in this.eventListeners)for(n=this.eventListeners[s],a=n.length,o=0;o<a;o++)c=n[o],c.name.indexOf(Ty)<0&&(u.eventListeners[s]||(u.eventListeners[s]=[]),u.eventListeners[s].push(c));return u}_toKonvaCanvas(r){r=r||{};var t=this.getClientRect(),s=this.getStage(),n=r.x!==void 0?r.x:Math.floor(t.x),a=r.y!==void 0?r.y:Math.floor(t.y),o=r.pixelRatio||1,c=new vo.SceneCanvas({width:r.width||Math.ceil(t.width)||(s?s.width():0),height:r.height||Math.ceil(t.height)||(s?s.height():0),pixelRatio:o}),u=c.getContext();const d=new vo.SceneCanvas({width:c.width/c.pixelRatio+Math.abs(n),height:c.height/c.pixelRatio+Math.abs(a),pixelRatio:c.pixelRatio});return r.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(n||a)&&u.translate(-1*n,-1*a),this.drawScene(c,void 0,d),u.restore(),c}toCanvas(r){return this._toKonvaCanvas(r)._canvas}toDataURL(r){r=r||{};var t=r.mimeType||null,s=r.quality||null,n=this._toKonvaCanvas(r).toDataURL(t,s);return r.callback&&r.callback(n),n}toImage(r){return new Promise((t,s)=>{try{const n=r==null?void 0:r.callback;n&&delete r.callback,mi.Util._urlToImage(this.toDataURL(r),function(a){t(a),n==null||n(a)})}catch(n){s(n)}})}toBlob(r){return new Promise((t,s)=>{try{const n=r==null?void 0:r.callback;n&&delete r.callback,this.toCanvas(r).toBlob(a=>{t(a),n==null||n(a)},r==null?void 0:r.mimeType,r==null?void 0:r.quality)}catch(n){s(n)}})}setSize(r){return this.width(r.width),this.height(r.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():ks.Konva.dragDistance}_off(r,t,s){var n=this.eventListeners[r],a,o,c;for(a=0;a<n.length;a++)if(o=n[a].name,c=n[a].handler,(o!=="konva"||t==="konva")&&(!t||o===t)&&(!s||s===c)){if(n.splice(a,1),n.length===0){delete this.eventListeners[r];break}a--}}_fireChangeEvent(r,t,s){this._fire(r+Cy,{oldVal:t,newVal:s})}addName(r){if(!this.hasName(r)){var t=this.name(),s=t?t+" "+r:r;this.name(s)}return this}hasName(r){if(!r)return!1;const t=this.name();if(!t)return!1;var s=(t||"").split(/\s/g);return s.indexOf(r)!==-1}removeName(r){var t=(this.name()||"").split(/\s/g),s=t.indexOf(r);return s!==-1&&(t.splice(s,1),this.name(t.join(" "))),this}setAttr(r,t){var s=this[bg+mi.Util._capitalize(r)];return mi.Util._isFunction(s)?s.call(this,t):this._setAttr(r,t),this}_requestDraw(){if(ks.Konva.autoDrawEnabled){const r=this.getLayer()||this.getStage();r==null||r.batchDraw()}}_setAttr(r,t){var s=this.attrs[r];s===t&&!mi.Util.isObject(t)||(t==null?delete this.attrs[r]:this.attrs[r]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(r,s,t),this._requestDraw())}_setComponentAttr(r,t,s){var n;s!==void 0&&(n=this.attrs[r],n||(this.attrs[r]=this.getAttr(r)),this.attrs[r][t]=s,this._fireChangeEvent(r,n,s))}_fireAndBubble(r,t,s){t&&this.nodeType===_g&&(t.target=this);var n=(r===vg||r===yg)&&(s&&(this===s||this.isAncestorOf&&this.isAncestorOf(s))||this.nodeType==="Stage"&&!s);if(!n){this._fire(r,t);var a=(r===vg||r===yg)&&s&&s.isAncestorOf&&s.isAncestorOf(this)&&!s.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!a&&(s&&s.parent?this._fireAndBubble.call(this.parent,r,t,s):this._fireAndBubble.call(this.parent,r,t))}}_getProtoListeners(r){var t,s,n;const a=(t=this._cache.get(yl))!==null&&t!==void 0?t:{};let o=a==null?void 0:a[r];if(o===void 0){o=[];let c=Object.getPrototypeOf(this);for(;c;){const u=(n=(s=c.eventListeners)===null||s===void 0?void 0:s[r])!==null&&n!==void 0?n:[];o.push(...u),c=Object.getPrototypeOf(c)}a[r]=o,this._cache.set(yl,a)}return o}_fire(r,t){t=t||{},t.currentTarget=this,t.type=r;const s=this._getProtoListeners(r);if(s)for(var n=0;n<s.length;n++)s[n].handler.call(this,t);const a=this.eventListeners[r];if(a)for(var n=0;n<a.length;n++)a[n].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(r){var t=r?r.pointerId:void 0,s=this.getStage(),n=this.getAbsolutePosition();if(s){var a=s._getPointerById(t)||s._changedPointerPositions[0]||n;fn.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-n.x,y:a.y-n.y},dragStatus:"ready",pointerId:t})}}startDrag(r,t=!0){fn.DD._dragElements.has(this._id)||this._createDragElement(r);const s=fn.DD._dragElements.get(this._id);s.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:r&&r.evt},t)}_setDragPosition(r,t){const s=this.getStage()._getPointerById(t.pointerId);if(s){var n={x:s.x-t.offset.x,y:s.y-t.offset.y},a=this.dragBoundFunc();if(a!==void 0){const o=a.call(this,n,r);o?n=o:mi.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==n.x||this._lastPos.y!==n.y)&&(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}}stopDrag(r){const t=fn.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),fn.DD._endDragBefore(r),fn.DD._endDragAfter(r)}setDraggable(r){this._setAttr("draggable",r),this._dragChange()}isDragging(){const r=fn.DD._dragElements.get(this._id);return r?r.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(r){var t=r.evt.button!==void 0,s=!t||ks.Konva.dragButtons.indexOf(r.evt.button)>=0;if(s&&!this.isDragging()){var n=!1;fn.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(n=!0)}),n||this._createDragElement(r)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var r=this.getStage();if(!r)return;const t=fn.DD._dragElements.get(this._id),s=t&&t.dragStatus==="dragging",n=t&&t.dragStatus==="ready";s?this.stopDrag():n&&fn.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(r={x:0,y:0}){const t=this.getStage();if(!t)return!1;const s={x:-r.x,y:-r.y,width:t.width()+2*r.x,height:t.height()+2*r.y};return mi.Util.haveIntersection(s,this.getClientRect())}static create(r,t){return mi.Util._isString(r)&&(r=JSON.parse(r)),this._createNode(r,t)}static _createNode(r,t){var s=Xe.prototype.getClassName.call(r),n=r.children,a,o,c;t&&(r.attrs.container=t),ks.Konva[s]||(mi.Util.warn('Can not find a node with class name "'+s+'". Fallback to "Shape".'),s="Shape");const u=ks.Konva[s];if(a=new u(r.attrs),n)for(o=n.length,c=0;c<o;c++)a.add(Xe._createNode(n[c]));return a}};Vi.Node=Xe,Xe.prototype.nodeType="Node",Xe.prototype._attrsAffectingSize=[],Xe.prototype.eventListeners={},Xe.prototype.on.call(Xe.prototype,My,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ts),this._clearSelfAndDescendantCache(as)}),Xe.prototype.on.call(Xe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Nc)}),Xe.prototype.on.call(Xe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Dc)}),Xe.prototype.on.call(Xe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(vl)});const Li=mo.Factory.addGetterSetter;Li(Xe,"zIndex"),Li(Xe,"absolutePosition"),Li(Xe,"position"),Li(Xe,"x",0,(0,nr.getNumberValidator)()),Li(Xe,"y",0,(0,nr.getNumberValidator)()),Li(Xe,"globalCompositeOperation","source-over",(0,nr.getStringValidator)()),Li(Xe,"opacity",1,(0,nr.getNumberValidator)()),Li(Xe,"name","",(0,nr.getStringValidator)()),Li(Xe,"id","",(0,nr.getStringValidator)()),Li(Xe,"rotation",0,(0,nr.getNumberValidator)()),mo.Factory.addComponentsGetterSetter(Xe,"scale",["x","y"]),Li(Xe,"scaleX",1,(0,nr.getNumberValidator)()),Li(Xe,"scaleY",1,(0,nr.getNumberValidator)()),mo.Factory.addComponentsGetterSetter(Xe,"skew",["x","y"]),Li(Xe,"skewX",0,(0,nr.getNumberValidator)()),Li(Xe,"skewY",0,(0,nr.getNumberValidator)()),mo.Factory.addComponentsGetterSetter(Xe,"offset",["x","y"]),Li(Xe,"offsetX",0,(0,nr.getNumberValidator)()),Li(Xe,"offsetY",0,(0,nr.getNumberValidator)()),Li(Xe,"dragDistance",null,(0,nr.getNumberValidator)()),Li(Xe,"width",0,(0,nr.getNumberValidator)()),Li(Xe,"height",0,(0,nr.getNumberValidator)()),Li(Xe,"listening",!0,(0,nr.getBooleanValidator)()),Li(Xe,"preventDefault",!0,(0,nr.getBooleanValidator)()),Li(Xe,"filters",null,function(r){return this._filterUpToDate=!1,r}),Li(Xe,"visible",!0,(0,nr.getBooleanValidator)()),Li(Xe,"transformsEnabled","all",(0,nr.getStringValidator)()),Li(Xe,"size"),Li(Xe,"dragBoundFunc"),Li(Xe,"draggable",!1,(0,nr.getBooleanValidator)()),mo.Factory.backCompat(Xe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Zs={};Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.Container=void 0;const Pa=ai,Oc=Vi,_l=De;class Js extends Oc.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const s=this.children||[];var n=[];return s.forEach(function(a){t(a)&&n.push(a)}),n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(var s=0;s<t.length;s++)this.add(t[s]);return this}const n=t[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var s=this._generalFind(t,!0);return s.length>0?s[0]:void 0}_generalFind(t,s){var n=[];return this._descendants(a=>{const o=a._isMatch(t);return o&&n.push(a),!!(o&&s)}),n}_descendants(t){let s=!1;const n=this.getChildren();for(const a of n)if(s=t(a),s||a.hasChildren()&&(s=a._descendants(t),s))return!0;return!1}toObject(){var t=Oc.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(s=>{t.children.push(s.toObject())}),t}isAncestorOf(t){for(var s=t.getParent();s;){if(s._id===this._id)return!0;s=s.getParent()}return!1}clone(t){var s=Oc.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){s.add(n.clone())}),s}getAllIntersections(t){var s=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&s.push(n)}),s}_clearSelfAndDescendantCache(t){var s;super._clearSelfAndDescendantCache(t),!this.isCached()&&((s=this.children)===null||s===void 0||s.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(s,n){s.index=n}),this._requestDraw()}drawScene(t,s,n){var a=this.getLayer(),o=t||a&&a.getCanvas(),c=o&&o.getContext(),u=this._getCanvasCache(),d=u&&u.scene,f=o&&o.isCache;if(!this.isVisible()&&!f)return this;if(d){c.save();var m=this.getAbsoluteTransform(s).getMatrix();c.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",o,s,n);return this}drawHit(t,s){if(!this.shouldDrawHit(s))return this;var n=this.getLayer(),a=t||n&&n.hitCanvas,o=a&&a.getContext(),c=this._getCanvasCache(),u=c&&c.hit;if(u){o.save();var d=this.getAbsoluteTransform(s).getMatrix();o.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",a,s);return this}_drawChildren(t,s,n,a){var o,c=s&&s.getContext(),u=this.clipWidth(),d=this.clipHeight(),f=this.clipFunc(),m=typeof u=="number"&&typeof d=="number"||f;const S=n===this;if(m){c.save();var _=this.getAbsoluteTransform(n),y=_.getMatrix();c.transform(y[0],y[1],y[2],y[3],y[4],y[5]),c.beginPath();let I;if(f)I=f.call(this,c,this);else{var b=this.clipX(),x=this.clipY();c.rect(b||0,x||0,u,d)}c.clip.apply(c,I),y=_.copy().invert().getMatrix(),c.transform(y[0],y[1],y[2],y[3],y[4],y[5])}var E=!S&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";E&&(c.save(),c._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(I){I[t](s,n,a)}),E&&c.restore(),m&&c.restore()}getClientRect(t={}){var s,n=t.skipTransform,a=t.relativeTo,o,c,u,d,f={x:1/0,y:1/0,width:0,height:0},m=this;(s=this.children)===null||s===void 0||s.forEach(function(x){if(x.visible()){var E=x.getClientRect({relativeTo:m,skipShadow:t.skipShadow,skipStroke:t.skipStroke});E.width===0&&E.height===0||(o===void 0?(o=E.x,c=E.y,u=E.x+E.width,d=E.y+E.height):(o=Math.min(o,E.x),c=Math.min(c,E.y),u=Math.max(u,E.x+E.width),d=Math.max(d,E.y+E.height)))}});for(var S=this.find("Shape"),_=!1,y=0;y<S.length;y++){var b=S[y];if(b._isVisible(this)){_=!0;break}}return _&&o!==void 0?f={x:o,y:c,width:u-o,height:d-c}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,a)}}Zs.Container=Js,Pa.Factory.addComponentsGetterSetter(Js,"clip",["x","y","width","height"]),Pa.Factory.addGetterSetter(Js,"clipX",void 0,(0,_l.getNumberValidator)()),Pa.Factory.addGetterSetter(Js,"clipY",void 0,(0,_l.getNumberValidator)()),Pa.Factory.addGetterSetter(Js,"clipWidth",void 0,(0,_l.getNumberValidator)()),Pa.Factory.addGetterSetter(Js,"clipHeight",void 0,(0,_l.getNumberValidator)()),Pa.Factory.addGetterSetter(Js,"clipFunc");var wg={},on={};Object.defineProperty(on,"__esModule",{value:!0}),on.releaseCapture=on.setPointerCapture=on.hasPointerCapture=on.createEvent=on.getCapturedShape=void 0;const Fy=si,yo=new Map,Ag=Fy.Konva._global.PointerEvent!==void 0;function Iy(r){return yo.get(r)}on.getCapturedShape=Iy;function zc(r){return{evt:r,pointerId:r.pointerId}}on.createEvent=zc;function Ly(r,t){return yo.get(r)===t}on.hasPointerCapture=Ly;function Dy(r,t){Sg(r),t.getStage()&&(yo.set(r,t),Ag&&t._fire("gotpointercapture",zc(new PointerEvent("gotpointercapture"))))}on.setPointerCapture=Dy;function Sg(r,t){const s=yo.get(r);if(!s)return;const n=s.getStage();n&&n.content,yo.delete(r),Ag&&s._fire("lostpointercapture",zc(new PointerEvent("lostpointercapture")))}on.releaseCapture=Sg,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Stage=r.stages=void 0;const t=qi,s=ai,n=Zs,a=si,o=Sn,c=ml,u=si,d=on;var f="Stage",m="string",S="px",_="mouseout",y="mouseleave",b="mouseover",x="mouseenter",E="mousemove",I="mousedown",R="mouseup",p="pointermove",w="pointerdown",A="pointerup",C="pointercancel",B="lostpointercapture",F="pointerout",rt="pointerleave",tt="pointerover",st="pointerenter",wt="contextmenu",dt="touchstart",Tt="touchend",Lt="touchmove",Qt="touchcancel",ct="wheel",Dt=5,ee=[[x,"_pointerenter"],[I,"_pointerdown"],[E,"_pointermove"],[R,"_pointerup"],[y,"_pointerleave"],[dt,"_pointerdown"],[Lt,"_pointermove"],[Tt,"_pointerup"],[Qt,"_pointercancel"],[b,"_pointerover"],[ct,"_wheel"],[wt,"_contextmenu"],[w,"_pointerdown"],[p,"_pointermove"],[A,"_pointerup"],[C,"_pointercancel"],[B,"_lostpointercapture"]];const zt={mouse:{[F]:_,[rt]:y,[tt]:b,[st]:x,[p]:E,[w]:I,[A]:R,[C]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[F]:"touchout",[rt]:"touchleave",[tt]:"touchover",[st]:"touchenter",[p]:Lt,[w]:dt,[A]:Tt,[C]:Qt,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[F]:F,[rt]:rt,[tt]:tt,[st]:st,[p]:p,[w]:w,[A]:A,[C]:C,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Jt=Gt=>Gt.indexOf("pointer")>=0?"pointer":Gt.indexOf("touch")>=0?"touch":"mouse",oe=Gt=>{const lt=Jt(Gt);if(lt==="pointer")return a.Konva.pointerEventsEnabled&&zt.pointer;if(lt==="touch")return zt.touch;if(lt==="mouse")return zt.mouse};function pe(Gt={}){return(Gt.clipFunc||Gt.clipWidth||Gt.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Gt}const Ae="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";r.stages=[];class Ve extends n.Container{constructor(lt){super(pe(lt)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),r.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{pe(this.attrs)}),this._checkVisibility()}_validateAdd(lt){const Ft=lt.getType()==="Layer",Wt=lt.getType()==="FastLayer";Ft||Wt||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const lt=this.visible()?"":"none";this.content.style.display=lt}setContainer(lt){if(typeof lt===m){if(lt.charAt(0)==="."){var Ft=lt.slice(1);lt=document.getElementsByClassName(Ft)[0]}else{var Wt;lt.charAt(0)!=="#"?Wt=lt:Wt=lt.slice(1),lt=document.getElementById(Wt)}if(!lt)throw"Can not find container in document with id "+Wt}return this._setAttr("container",lt),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),lt.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var lt=this.children,Ft=lt.length,Wt;for(Wt=0;Wt<Ft;Wt++)lt[Wt].clear();return this}clone(lt){return lt||(lt={}),lt.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,lt)}destroy(){super.destroy();var lt=this.content;lt&&t.Util._isInDocument(lt)&&this.container().removeChild(lt);var Ft=r.stages.indexOf(this);return Ft>-1&&r.stages.splice(Ft,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const lt=this._pointerPositions[0]||this._changedPointerPositions[0];return lt?{x:lt.x,y:lt.y}:(t.Util.warn(Ae),null)}_getPointerById(lt){return this._pointerPositions.find(Ft=>Ft.id===lt)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(lt){lt=lt||{},lt.x=lt.x||0,lt.y=lt.y||0,lt.width=lt.width||this.width(),lt.height=lt.height||this.height();var Ft=new o.SceneCanvas({width:lt.width,height:lt.height,pixelRatio:lt.pixelRatio||1}),Wt=Ft.getContext()._context,ve=this.children;return(lt.x||lt.y)&&Wt.translate(-1*lt.x,-1*lt.y),ve.forEach(function(ie){if(ie.isVisible()){var xe=ie._toKonvaCanvas(lt);Wt.drawImage(xe._canvas,lt.x,lt.y,xe.getWidth()/xe.getPixelRatio(),xe.getHeight()/xe.getPixelRatio())}}),Ft}getIntersection(lt){if(!lt)return null;var Ft=this.children,Wt=Ft.length,ve=Wt-1,ie;for(ie=ve;ie>=0;ie--){const xe=Ft[ie].getIntersection(lt);if(xe)return xe}return null}_resizeDOM(){var lt=this.width(),Ft=this.height();this.content&&(this.content.style.width=lt+S,this.content.style.height=Ft+S),this.bufferCanvas.setSize(lt,Ft),this.bufferHitCanvas.setSize(lt,Ft),this.children.forEach(Wt=>{Wt.setSize({width:lt,height:Ft}),Wt.draw()})}add(lt,...Ft){if(arguments.length>1){for(var Wt=0;Wt<arguments.length;Wt++)this.add(arguments[Wt]);return this}super.add(lt);var ve=this.children.length;return ve>Dt&&t.Util.warn("The stage has "+ve+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),lt.setSize({width:this.width(),height:this.height()}),lt.draw(),a.Konva.isBrowser&&this.content.appendChild(lt.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(lt){return d.hasPointerCapture(lt,this)}setPointerCapture(lt){d.setPointerCapture(lt,this)}releaseCapture(lt){d.releaseCapture(lt,this)}getLayers(){return this.children}_bindContentEvents(){!a.Konva.isBrowser||ee.forEach(([lt,Ft])=>{this.content.addEventListener(lt,Wt=>{this[Ft](Wt)},{passive:!1})})}_pointerenter(lt){this.setPointersPositions(lt);const Ft=oe(lt.type);Ft&&this._fire(Ft.pointerenter,{evt:lt,target:this,currentTarget:this})}_pointerover(lt){this.setPointersPositions(lt);const Ft=oe(lt.type);Ft&&this._fire(Ft.pointerover,{evt:lt,target:this,currentTarget:this})}_getTargetShape(lt){let Ft=this[lt+"targetShape"];return Ft&&!Ft.getStage()&&(Ft=null),Ft}_pointerleave(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(Ft){this.setPointersPositions(lt);var ve=this._getTargetShape(Wt),ie=!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled;ve&&ie?(ve._fireAndBubble(Ft.pointerout,{evt:lt}),ve._fireAndBubble(Ft.pointerleave,{evt:lt}),this._fire(Ft.pointerleave,{evt:lt,target:this,currentTarget:this}),this[Wt+"targetShape"]=null):ie&&(this._fire(Ft.pointerleave,{evt:lt,target:this,currentTarget:this}),this._fire(Ft.pointerout,{evt:lt,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(Ft){this.setPointersPositions(lt);var ve=!1;this._changedPointerPositions.forEach(ie=>{var xe=this.getIntersection(ie);if(c.DD.justDragged=!1,a.Konva["_"+Wt+"ListenClick"]=!0,!xe||!xe.isListening())return;a.Konva.capturePointerEventsEnabled&&xe.setPointerCapture(ie.id),this[Wt+"ClickStartShape"]=xe,xe._fireAndBubble(Ft.pointerdown,{evt:lt,pointerId:ie.id}),ve=!0;const _e=lt.type.indexOf("touch")>=0;xe.preventDefault()&&lt.cancelable&&_e&&lt.preventDefault()}),ve||this._fire(Ft.pointerdown,{evt:lt,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(!Ft)return;a.Konva.isDragging()&&c.DD.node.preventDefault()&&lt.cancelable&&lt.preventDefault(),this.setPointersPositions(lt);var ve=!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled;if(!ve)return;var ie={};let xe=!1;var _e=this._getTargetShape(Wt);this._changedPointerPositions.forEach(ut=>{const T=d.getCapturedShape(ut.id)||this.getIntersection(ut),M=ut.id,D={evt:lt,pointerId:M};var H=_e!==T;if(H&&_e&&(_e._fireAndBubble(Ft.pointerout,{...D},T),_e._fireAndBubble(Ft.pointerleave,{...D},T)),T){if(ie[T._id])return;ie[T._id]=!0}T&&T.isListening()?(xe=!0,H&&(T._fireAndBubble(Ft.pointerover,{...D},_e),T._fireAndBubble(Ft.pointerenter,{...D},_e),this[Wt+"targetShape"]=T),T._fireAndBubble(Ft.pointermove,{...D})):_e&&(this._fire(Ft.pointerover,{evt:lt,target:this,currentTarget:this,pointerId:M}),this[Wt+"targetShape"]=null)}),xe||this._fire(Ft.pointermove,{evt:lt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(lt){const Ft=oe(lt.type),Wt=Jt(lt.type);if(!Ft)return;this.setPointersPositions(lt);const ve=this[Wt+"ClickStartShape"],ie=this[Wt+"ClickEndShape"];var xe={};let _e=!1;this._changedPointerPositions.forEach(ut=>{const T=d.getCapturedShape(ut.id)||this.getIntersection(ut);if(T){if(T.releaseCapture(ut.id),xe[T._id])return;xe[T._id]=!0}const M=ut.id,D={evt:lt,pointerId:M};let H=!1;a.Konva["_"+Wt+"InDblClickWindow"]?(H=!0,clearTimeout(this[Wt+"DblTimeout"])):c.DD.justDragged||(a.Konva["_"+Wt+"InDblClickWindow"]=!0,clearTimeout(this[Wt+"DblTimeout"])),this[Wt+"DblTimeout"]=setTimeout(function(){a.Konva["_"+Wt+"InDblClickWindow"]=!1},a.Konva.dblClickWindow),T&&T.isListening()?(_e=!0,this[Wt+"ClickEndShape"]=T,T._fireAndBubble(Ft.pointerup,{...D}),a.Konva["_"+Wt+"ListenClick"]&&ve&&ve===T&&(T._fireAndBubble(Ft.pointerclick,{...D}),H&&ie&&ie===T&&T._fireAndBubble(Ft.pointerdblclick,{...D}))):(this[Wt+"ClickEndShape"]=null,a.Konva["_"+Wt+"ListenClick"]&&this._fire(Ft.pointerclick,{evt:lt,target:this,currentTarget:this,pointerId:M}),H&&this._fire(Ft.pointerdblclick,{evt:lt,target:this,currentTarget:this,pointerId:M}))}),_e||this._fire(Ft.pointerup,{evt:lt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a.Konva["_"+Wt+"ListenClick"]=!1,lt.cancelable&&Wt!=="touch"&&lt.preventDefault()}_contextmenu(lt){this.setPointersPositions(lt);var Ft=this.getIntersection(this.getPointerPosition());Ft&&Ft.isListening()?Ft._fireAndBubble(wt,{evt:lt}):this._fire(wt,{evt:lt,target:this,currentTarget:this})}_wheel(lt){this.setPointersPositions(lt);var Ft=this.getIntersection(this.getPointerPosition());Ft&&Ft.isListening()?Ft._fireAndBubble(ct,{evt:lt}):this._fire(ct,{evt:lt,target:this,currentTarget:this})}_pointercancel(lt){this.setPointersPositions(lt);const Ft=d.getCapturedShape(lt.pointerId)||this.getIntersection(this.getPointerPosition());Ft&&Ft._fireAndBubble(A,d.createEvent(lt)),d.releaseCapture(lt.pointerId)}_lostpointercapture(lt){d.releaseCapture(lt.pointerId)}setPointersPositions(lt){var Ft=this._getContentPosition(),Wt=null,ve=null;lt=lt||window.event,lt.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(lt.touches,ie=>{this._pointerPositions.push({id:ie.identifier,x:(ie.clientX-Ft.left)/Ft.scaleX,y:(ie.clientY-Ft.top)/Ft.scaleY})}),Array.prototype.forEach.call(lt.changedTouches||lt.touches,ie=>{this._changedPointerPositions.push({id:ie.identifier,x:(ie.clientX-Ft.left)/Ft.scaleX,y:(ie.clientY-Ft.top)/Ft.scaleY})})):(Wt=(lt.clientX-Ft.left)/Ft.scaleX,ve=(lt.clientY-Ft.top)/Ft.scaleY,this.pointerPos={x:Wt,y:ve},this._pointerPositions=[{x:Wt,y:ve,id:t.Util._getFirstPointerId(lt)}],this._changedPointerPositions=[{x:Wt,y:ve,id:t.Util._getFirstPointerId(lt)}])}_setPointerPosition(lt){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(lt)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var lt=this.content.getBoundingClientRect();return{top:lt.top,left:lt.left,scaleX:lt.width/this.content.clientWidth||1,scaleY:lt.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!a.Konva.isBrowser){var lt=this.container();if(!lt)throw"Stage has no container. A container is required.";lt.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),lt.appendChild(this.content),this._resizeDOM()}}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(lt){lt.batchDraw()}),this}}r.Stage=Ve,Ve.prototype.nodeType=f,(0,u._registerNode)(Ve),s.Factory.addGetterSetter(Ve,"container")}(wg);var bo={},fr={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Shape=r.shapes=void 0;const t=si,s=qi,n=ai,a=Vi,o=De,c=si,u=on;var d="hasShadow",f="shadowRGBA",m="patternImage",S="linearGradient",_="radialGradient";let y;function b(){return y||(y=s.Util.createCanvasElement().getContext("2d"),y)}r.shapes={};function x(rt){const tt=this.attrs.fillRule;tt?rt.fill(tt):rt.fill()}function E(rt){rt.stroke()}function I(rt){rt.fill()}function R(rt){rt.stroke()}function p(){this._clearCache(d)}function w(){this._clearCache(f)}function A(){this._clearCache(m)}function C(){this._clearCache(S)}function B(){this._clearCache(_)}class F extends a.Node{constructor(tt){super(tt);let st;for(;st=s.Util.getRandomColor(),!(st&&!(st in r.shapes)););this.colorKey=st,r.shapes[st]=this}getContext(){return s.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return s.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(d,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(m,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var tt=b();const st=tt.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(st&&st.setTransform){const wt=new s.Transform;wt.translate(this.fillPatternX(),this.fillPatternY()),wt.rotate(t.Konva.getAngle(this.fillPatternRotation())),wt.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),wt.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const dt=wt.getMatrix(),Tt=typeof DOMMatrix>"u"?{a:dt[0],b:dt[1],c:dt[2],d:dt[3],e:dt[4],f:dt[5]}:new DOMMatrix(dt);st.setTransform(Tt)}return st}}_getLinearGradient(){return this._getCache(S,this.__getLinearGradient)}__getLinearGradient(){var tt=this.fillLinearGradientColorStops();if(tt){for(var st=b(),wt=this.fillLinearGradientStartPoint(),dt=this.fillLinearGradientEndPoint(),Tt=st.createLinearGradient(wt.x,wt.y,dt.x,dt.y),Lt=0;Lt<tt.length;Lt+=2)Tt.addColorStop(tt[Lt],tt[Lt+1]);return Tt}}_getRadialGradient(){return this._getCache(_,this.__getRadialGradient)}__getRadialGradient(){var tt=this.fillRadialGradientColorStops();if(tt){for(var st=b(),wt=this.fillRadialGradientStartPoint(),dt=this.fillRadialGradientEndPoint(),Tt=st.createRadialGradient(wt.x,wt.y,this.fillRadialGradientStartRadius(),dt.x,dt.y,this.fillRadialGradientEndRadius()),Lt=0;Lt<tt.length;Lt+=2)Tt.addColorStop(tt[Lt],tt[Lt+1]);return Tt}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var tt=s.Util.colorToRGBA(this.shadowColor());if(tt)return"rgba("+tt.r+","+tt.g+","+tt.b+","+tt.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const tt=this.hitStrokeWidth();return tt==="auto"?this.hasStroke():this.strokeEnabled()&&!!tt}intersects(tt){var st=this.getStage();if(!st)return!1;const wt=st.bufferHitCanvas;return wt.getContext().clear(),this.drawHit(wt,void 0,!0),wt.context.getImageData(Math.round(tt.x),Math.round(tt.y),1,1).data[3]>0}destroy(){return a.Node.prototype.destroy.call(this),delete r.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(tt){var st;if(!(!((st=this.attrs.perfectDrawEnabled)!==null&&st!==void 0)||st))return!1;const wt=tt||this.hasFill(),dt=this.hasStroke(),Tt=this.getAbsoluteOpacity()!==1;if(wt&&dt&&Tt)return!0;const Lt=this.hasShadow(),Qt=this.shadowForStrokeEnabled();return!!(wt&&dt&&Lt&&Qt)}setStrokeHitEnabled(tt){s.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),tt?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var tt=this.size();return{x:this._centroid?-tt.width/2:0,y:this._centroid?-tt.height/2:0,width:tt.width,height:tt.height}}getClientRect(tt={}){const st=tt.skipTransform,wt=tt.relativeTo,dt=this.getSelfRect(),Tt=!tt.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Lt=dt.width+Tt,Qt=dt.height+Tt,ct=!tt.skipShadow&&this.hasShadow(),Dt=ct?this.shadowOffsetX():0,ee=ct?this.shadowOffsetY():0,zt=Lt+Math.abs(Dt),Jt=Qt+Math.abs(ee),oe=ct&&this.shadowBlur()||0,pe=zt+oe*2,Ae=Jt+oe*2,Ve={width:pe,height:Ae,x:-(Tt/2+oe)+Math.min(Dt,0)+dt.x,y:-(Tt/2+oe)+Math.min(ee,0)+dt.y};return st?Ve:this._transformedRect(Ve,wt)}drawScene(tt,st,wt){var dt=this.getLayer(),Tt=tt||dt.getCanvas(),Lt=Tt.getContext(),Qt=this._getCanvasCache(),ct=this.getSceneFunc(),Dt=this.hasShadow(),ee,zt,Jt=Tt.isCache,oe=st===this;if(!this.isVisible()&&!oe)return this;if(Qt){Lt.save();var pe=this.getAbsoluteTransform(st).getMatrix();return Lt.transform(pe[0],pe[1],pe[2],pe[3],pe[4],pe[5]),this._drawCachedSceneCanvas(Lt),Lt.restore(),this}if(!ct)return this;if(Lt.save(),this._useBufferCanvas()&&!Jt){ee=this.getStage();const Gt=wt||ee.bufferCanvas;zt=Gt.getContext(),zt.clear(),zt.save(),zt._applyLineJoin(this);var Ae=this.getAbsoluteTransform(st).getMatrix();zt.transform(Ae[0],Ae[1],Ae[2],Ae[3],Ae[4],Ae[5]),ct.call(this,zt,this),zt.restore();var Ve=Gt.pixelRatio;Dt&&Lt._applyShadow(this),Lt._applyOpacity(this),Lt._applyGlobalCompositeOperation(this),Lt.drawImage(Gt._canvas,0,0,Gt.width/Ve,Gt.height/Ve)}else{if(Lt._applyLineJoin(this),!oe){var Ae=this.getAbsoluteTransform(st).getMatrix();Lt.transform(Ae[0],Ae[1],Ae[2],Ae[3],Ae[4],Ae[5]),Lt._applyOpacity(this),Lt._applyGlobalCompositeOperation(this)}Dt&&Lt._applyShadow(this),ct.call(this,Lt,this)}return Lt.restore(),this}drawHit(tt,st,wt=!1){if(!this.shouldDrawHit(st,wt))return this;var dt=this.getLayer(),Tt=tt||dt.hitCanvas,Lt=Tt&&Tt.getContext(),Qt=this.hitFunc()||this.sceneFunc(),ct=this._getCanvasCache(),Dt=ct&&ct.hit;if(this.colorKey||s.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Dt){Lt.save();var ee=this.getAbsoluteTransform(st).getMatrix();return Lt.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),this._drawCachedHitCanvas(Lt),Lt.restore(),this}if(!Qt)return this;if(Lt.save(),Lt._applyLineJoin(this),this!==st){var zt=this.getAbsoluteTransform(st).getMatrix();Lt.transform(zt[0],zt[1],zt[2],zt[3],zt[4],zt[5])}return Qt.call(this,Lt,this),Lt.restore(),this}drawHitFromCache(tt=0){var st=this._getCanvasCache(),wt=this._getCachedSceneCanvas(),dt=st.hit,Tt=dt.getContext(),Lt=dt.getWidth(),Qt=dt.getHeight(),ct,Dt,ee,zt,Jt,oe;Tt.clear(),Tt.drawImage(wt._canvas,0,0,Lt,Qt);try{for(ct=Tt.getImageData(0,0,Lt,Qt),Dt=ct.data,ee=Dt.length,zt=s.Util._hexToRgb(this.colorKey),Jt=0;Jt<ee;Jt+=4)oe=Dt[Jt+3],oe>tt?(Dt[Jt]=zt.r,Dt[Jt+1]=zt.g,Dt[Jt+2]=zt.b,Dt[Jt+3]=255):Dt[Jt+3]=0;Tt.putImageData(ct,0,0)}catch(pe){s.Util.error("Unable to draw hit graph from cached scene canvas. "+pe.message)}return this}hasPointerCapture(tt){return u.hasPointerCapture(tt,this)}setPointerCapture(tt){u.setPointerCapture(tt,this)}releaseCapture(tt){u.releaseCapture(tt,this)}}r.Shape=F,F.prototype._fillFunc=x,F.prototype._strokeFunc=E,F.prototype._fillFuncHit=I,F.prototype._strokeFuncHit=R,F.prototype._centroid=!1,F.prototype.nodeType="Shape",(0,c._registerNode)(F),F.prototype.eventListeners={},F.prototype.on.call(F.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",p),F.prototype.on.call(F.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",C),F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",B),n.Factory.addGetterSetter(F,"stroke",void 0,(0,o.getStringOrGradientValidator)()),n.Factory.addGetterSetter(F,"strokeWidth",2,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(F,"hitStrokeWidth","auto",(0,o.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(F,"strokeHitEnabled",!0,(0,o.getBooleanValidator)()),n.Factory.addGetterSetter(F,"perfectDrawEnabled",!0,(0,o.getBooleanValidator)()),n.Factory.addGetterSetter(F,"shadowForStrokeEnabled",!0,(0,o.getBooleanValidator)()),n.Factory.addGetterSetter(F,"lineJoin"),n.Factory.addGetterSetter(F,"lineCap"),n.Factory.addGetterSetter(F,"sceneFunc"),n.Factory.addGetterSetter(F,"hitFunc"),n.Factory.addGetterSetter(F,"dash"),n.Factory.addGetterSetter(F,"dashOffset",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"shadowColor",void 0,(0,o.getStringValidator)()),n.Factory.addGetterSetter(F,"shadowBlur",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"shadowOpacity",1,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(F,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(F,"shadowOffsetX",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"shadowOffsetY",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternImage"),n.Factory.addGetterSetter(F,"fill",void 0,(0,o.getStringOrGradientValidator)()),n.Factory.addGetterSetter(F,"fillPatternX",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternY",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(F,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(F,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(F,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(F,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(F,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(F,"fillEnabled",!0),n.Factory.addGetterSetter(F,"strokeEnabled",!0),n.Factory.addGetterSetter(F,"shadowEnabled",!0),n.Factory.addGetterSetter(F,"dashEnabled",!0),n.Factory.addGetterSetter(F,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(F,"fillPriority","color"),n.Factory.addComponentsGetterSetter(F,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(F,"fillPatternOffsetX",0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternOffsetY",0,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(F,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(F,"fillPatternScaleX",1,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternScaleY",1,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(F,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(F,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(F,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(F,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(F,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(F,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(F,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(F,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(F,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(F,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(F,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(F,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(F,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(F,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(F,"fillPatternRotation",0),n.Factory.addGetterSetter(F,"fillRule",void 0,(0,o.getStringValidator)()),n.Factory.backCompat(F,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(fr),Object.defineProperty(bo,"__esModule",{value:!0}),bo.Layer=void 0;const os=qi,Hc=Zs,Ma=Vi,Bc=ai,Eg=Sn,Ny=De,Oy=fr,zy=si;var Hy="#",By="beforeDraw",Uy="draw",Cg=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Gy=Cg.length;let Ra=class extends Hc.Container{constructor(r){super(r),this.canvas=new Eg.SceneCanvas,this.hitCanvas=new Eg.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(r){return this.getContext().clear(r),this.getHitCanvas().getContext().clear(r),this}setZIndex(r){super.setZIndex(r);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),r<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[r+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Ma.Node.prototype.moveToTop.call(this);var r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),r.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var r=Ma.Node.prototype.moveUp.call(this);if(!r)return!1;var t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Ma.Node.prototype.moveDown.call(this)){var r=this.getStage();if(r){var t=r.children;r.content&&(r.content.removeChild(this.getNativeCanvasElement()),r.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Ma.Node.prototype.moveToBottom.call(this)){var r=this.getStage();if(r){var t=r.children;r.content&&(r.content.removeChild(this.getNativeCanvasElement()),r.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var r=this.getNativeCanvasElement();return Ma.Node.prototype.remove.call(this),r&&r.parentNode&&os.Util._isInDocument(r)&&r.parentNode.removeChild(r),this}getStage(){return this.parent}setSize({width:r,height:t}){return this.canvas.setSize(r,t),this.hitCanvas.setSize(r,t),this._setSmoothEnabled(),this}_validateAdd(r){var t=r.getType();t!=="Group"&&t!=="Shape"&&os.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(r){return r=r||{},r.width=r.width||this.getWidth(),r.height=r.height||this.getHeight(),r.x=r.x!==void 0?r.x:this.x(),r.y=r.y!==void 0?r.y:this.y(),Ma.Node.prototype._toKonvaCanvas.call(this,r)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){os.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){os.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,os.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(r){if(!this.isListening()||!this.isVisible())return null;for(var t=1,s=!1;;){for(let n=0;n<Gy;n++){const a=Cg[n],o=this._getIntersection({x:r.x+a.x*t,y:r.y+a.y*t}),c=o.shape;if(c)return c;if(s=!!o.antialiased,!o.antialiased)break}if(s)t+=1;else return null}}_getIntersection(r){const t=this.hitCanvas.pixelRatio,s=this.hitCanvas.context.getImageData(Math.round(r.x*t),Math.round(r.y*t),1,1).data,n=s[3];if(n===255){const a=os.Util._rgbToHex(s[0],s[1],s[2]),o=Oy.shapes[Hy+a];return o?{shape:o}:{antialiased:!0}}else if(n>0)return{antialiased:!0};return{}}drawScene(r,t){var s=this.getLayer(),n=r||s&&s.getCanvas();return this._fire(By,{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),Hc.Container.prototype.drawScene.call(this,n,t),this._fire(Uy,{node:this}),this}drawHit(r,t){var s=this.getLayer(),n=r||s&&s.hitCanvas;return s&&s.clearBeforeDraw()&&s.getHitCanvas().getContext().clear(),Hc.Container.prototype.drawHit.call(this,n,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(r){os.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(r)}getHitGraphEnabled(r){return os.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var r=this.parent,t=!!this.hitCanvas._canvas.parentNode;t?r.content.removeChild(this.hitCanvas._canvas):r.content.appendChild(this.hitCanvas._canvas)}}destroy(){return os.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};bo.Layer=Ra,Ra.prototype.nodeType="Layer",(0,zy._registerNode)(Ra),Bc.Factory.addGetterSetter(Ra,"imageSmoothingEnabled",!0),Bc.Factory.addGetterSetter(Ra,"clearBeforeDraw",!0),Bc.Factory.addGetterSetter(Ra,"hitGraphEnabled",!0,(0,Ny.getBooleanValidator)());var xl={};Object.defineProperty(xl,"__esModule",{value:!0}),xl.FastLayer=void 0;const jy=qi,Vy=bo,Wy=si;class Uc extends Vy.Layer{constructor(t){super(t),this.listening(!1),jy.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}xl.FastLayer=Uc,Uc.prototype.nodeType="FastLayer",(0,Wy._registerNode)(Uc);var Fa={};Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.Group=void 0;const $y=qi,Ky=Zs,Xy=si;let Gc=class extends Ky.Container{_validateAdd(r){var t=r.getType();t!=="Group"&&t!=="Shape"&&$y.Util.throw("You may only add groups and shapes to groups.")}};Fa.Group=Gc,Gc.prototype.nodeType="Group",(0,Xy._registerNode)(Gc);var Ia={};Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.Animation=void 0;const jc=si,kg=qi,Vc=function(){return jc.glob.performance&&jc.glob.performance.now?function(){return jc.glob.performance.now()}:function(){return new Date().getTime()}}();class Gn{constructor(t,s){this.id=Gn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Vc(),frameRate:0},this.func=t,this.setLayers(s)}setLayers(t){let s=[];return t&&(s=Array.isArray(t)?t:[t]),this.layers=s,this}getLayers(){return this.layers}addLayer(t){const s=this.layers,n=s.length;for(let a=0;a<n;a++)if(s[a]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const t=Gn.animations,s=t.length;for(let n=0;n<s;n++)if(t[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Vc(),Gn._addAnimation(this),this}stop(){return Gn._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const s=t.id,n=this.animations,a=n.length;for(let o=0;o<a;o++)if(n[o].id===s){this.animations.splice(o,1);break}}static _runFrames(){const t={},s=this.animations;for(let n=0;n<s.length;n++){const a=s[n],o=a.layers,c=a.func;a._updateFrameObject(Vc());const u=o.length;let d;if(c?d=c.call(a,a.frame)!==!1:d=!0,!!d)for(let f=0;f<u;f++){const m=o[f];m._id!==void 0&&(t[m._id]=m)}}for(let n in t)!t.hasOwnProperty(n)||t[n].batchDraw()}static _animationLoop(){const t=Gn;t.animations.length?(t._runFrames(),kg.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,kg.Util.requestAnimFrame(this._animationLoop))}}Ia.Animation=Gn,Gn.animations=[],Gn.animIdCounter=0,Gn.animRunning=!1;var Tg={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Easings=r.Tween=void 0;const t=qi,s=Ia,n=Vi,a=si;var o={node:1,duration:1,easing:1,onFinish:1,yoyo:1},c=1,u=2,d=3,f=0,m=["fill","stroke","shadowColor"];class S{constructor(b,x,E,I,R,p,w){this.prop=b,this.propFunc=x,this.begin=I,this._pos=I,this.duration=p,this._change=0,this.prevPos=0,this.yoyo=w,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=E,this._change=R-this.begin,this.pause()}fire(b){var x=this[b];x&&x()}setTime(b){b>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():b<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=b,this.update())}getTime(){return this._time}setPosition(b){this.prevPos=this._pos,this.propFunc(b),this._pos=b}getPosition(b){return b===void 0&&(b=this._time),this.func(b,this.begin,this._change,this.duration)}play(){this.state=u,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=d,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(b){this.pause(),this._time=b,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var b=this.getTimer()-this._startTime;this.state===u?this.setTime(b):this.state===d&&this.setTime(this.duration-b)}pause(){this.state=c,this.fire("onPause")}getTimer(){return new Date().getTime()}}class _{constructor(b){var x=this,E=b.node,I=E._id,R,p=b.easing||r.Easings.Linear,w=!!b.yoyo,A;typeof b.duration>"u"?R=.3:b.duration===0?R=.001:R=b.duration,this.node=E,this._id=f++;var C=E.getLayer()||(E instanceof a.Konva.Stage?E.getLayers():null);C||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new s.Animation(function(){x.tween.onEnterFrame()},C),this.tween=new S(A,function(B){x._tweenFunc(B)},p,0,1,R*1e3,w),this._addListeners(),_.attrs[I]||(_.attrs[I]={}),_.attrs[I][this._id]||(_.attrs[I][this._id]={}),_.tweens[I]||(_.tweens[I]={});for(A in b)o[A]===void 0&&this._addAttr(A,b[A]);this.reset(),this.onFinish=b.onFinish,this.onReset=b.onReset,this.onUpdate=b.onUpdate}_addAttr(b,x){var E=this.node,I=E._id,R,p,w,A,C,B,F,rt;if(w=_.tweens[I][b],w&&delete _.attrs[I][w][b],R=E.getAttr(b),t.Util._isArray(x))if(p=[],C=Math.max(x.length,R.length),b==="points"&&x.length!==R.length&&(x.length>R.length?(F=R,R=t.Util._prepareArrayForTween(R,x,E.closed())):(B=x,x=t.Util._prepareArrayForTween(x,R,E.closed()))),b.indexOf("fill")===0)for(A=0;A<C;A++)if(A%2===0)p.push(x[A]-R[A]);else{var tt=t.Util.colorToRGBA(R[A]);rt=t.Util.colorToRGBA(x[A]),R[A]=tt,p.push({r:rt.r-tt.r,g:rt.g-tt.g,b:rt.b-tt.b,a:rt.a-tt.a})}else for(A=0;A<C;A++)p.push(x[A]-R[A]);else m.indexOf(b)!==-1?(R=t.Util.colorToRGBA(R),rt=t.Util.colorToRGBA(x),p={r:rt.r-R.r,g:rt.g-R.g,b:rt.b-R.b,a:rt.a-R.a}):p=x-R;_.attrs[I][this._id][b]={start:R,diff:p,end:x,trueEnd:B,trueStart:F},_.tweens[I][b]=this._id}_tweenFunc(b){var x=this.node,E=_.attrs[x._id][this._id],I,R,p,w,A,C,B,F;for(I in E){if(R=E[I],p=R.start,w=R.diff,F=R.end,t.Util._isArray(p))if(A=[],B=Math.max(p.length,F.length),I.indexOf("fill")===0)for(C=0;C<B;C++)C%2===0?A.push((p[C]||0)+w[C]*b):A.push("rgba("+Math.round(p[C].r+w[C].r*b)+","+Math.round(p[C].g+w[C].g*b)+","+Math.round(p[C].b+w[C].b*b)+","+(p[C].a+w[C].a*b)+")");else for(C=0;C<B;C++)A.push((p[C]||0)+w[C]*b);else m.indexOf(I)!==-1?A="rgba("+Math.round(p.r+w.r*b)+","+Math.round(p.g+w.g*b)+","+Math.round(p.b+w.b*b)+","+(p.a+w.a*b)+")":A=p+w*b;x.setAttr(I,A)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var b=this.node,x=_.attrs[b._id][this._id];x.points&&x.points.trueEnd&&b.setAttr("points",x.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var b=this.node,x=_.attrs[b._id][this._id];x.points&&x.points.trueStart&&b.points(x.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(b){return this.tween.seek(b*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var b=this.node._id,x=this._id,E=_.tweens[b],I;this.pause();for(I in E)delete _.tweens[b][I];delete _.attrs[b][x]}}r.Tween=_,_.attrs={},_.tweens={},n.Node.prototype.to=function(y){var b=y.onFinish;y.node=this,y.onFinish=function(){this.destroy(),b&&b()};var x=new _(y);x.play()},r.Easings={BackEaseIn(y,b,x,E){var I=1.70158;return x*(y/=E)*y*((I+1)*y-I)+b},BackEaseOut(y,b,x,E){var I=1.70158;return x*((y=y/E-1)*y*((I+1)*y+I)+1)+b},BackEaseInOut(y,b,x,E){var I=1.70158;return(y/=E/2)<1?x/2*(y*y*(((I*=1.525)+1)*y-I))+b:x/2*((y-=2)*y*(((I*=1.525)+1)*y+I)+2)+b},ElasticEaseIn(y,b,x,E,I,R){var p=0;return y===0?b:(y/=E)===1?b+x:(R||(R=E*.3),!I||I<Math.abs(x)?(I=x,p=R/4):p=R/(2*Math.PI)*Math.asin(x/I),-(I*Math.pow(2,10*(y-=1))*Math.sin((y*E-p)*(2*Math.PI)/R))+b)},ElasticEaseOut(y,b,x,E,I,R){var p=0;return y===0?b:(y/=E)===1?b+x:(R||(R=E*.3),!I||I<Math.abs(x)?(I=x,p=R/4):p=R/(2*Math.PI)*Math.asin(x/I),I*Math.pow(2,-10*y)*Math.sin((y*E-p)*(2*Math.PI)/R)+x+b)},ElasticEaseInOut(y,b,x,E,I,R){var p=0;return y===0?b:(y/=E/2)===2?b+x:(R||(R=E*(.3*1.5)),!I||I<Math.abs(x)?(I=x,p=R/4):p=R/(2*Math.PI)*Math.asin(x/I),y<1?-.5*(I*Math.pow(2,10*(y-=1))*Math.sin((y*E-p)*(2*Math.PI)/R))+b:I*Math.pow(2,-10*(y-=1))*Math.sin((y*E-p)*(2*Math.PI)/R)*.5+x+b)},BounceEaseOut(y,b,x,E){return(y/=E)<1/2.75?x*(7.5625*y*y)+b:y<2/2.75?x*(7.5625*(y-=1.5/2.75)*y+.75)+b:y<2.5/2.75?x*(7.5625*(y-=2.25/2.75)*y+.9375)+b:x*(7.5625*(y-=2.625/2.75)*y+.984375)+b},BounceEaseIn(y,b,x,E){return x-r.Easings.BounceEaseOut(E-y,0,x,E)+b},BounceEaseInOut(y,b,x,E){return y<E/2?r.Easings.BounceEaseIn(y*2,0,x,E)*.5+b:r.Easings.BounceEaseOut(y*2-E,0,x,E)*.5+x*.5+b},EaseIn(y,b,x,E){return x*(y/=E)*y+b},EaseOut(y,b,x,E){return-x*(y/=E)*(y-2)+b},EaseInOut(y,b,x,E){return(y/=E/2)<1?x/2*y*y+b:-x/2*(--y*(y-2)-1)+b},StrongEaseIn(y,b,x,E){return x*(y/=E)*y*y*y*y+b},StrongEaseOut(y,b,x,E){return x*((y=y/E-1)*y*y*y*y+1)+b},StrongEaseInOut(y,b,x,E){return(y/=E/2)<1?x/2*y*y*y*y*y+b:x/2*((y-=2)*y*y*y*y+2)+b},Linear(y,b,x,E){return x*y/E+b}}})(Tg),function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Konva=void 0;const t=si,s=qi,n=Vi,a=Zs,o=wg,c=bo,u=xl,d=Fa,f=ml,m=fr,S=Ia,_=Tg,y=ss,b=Sn;r.Konva=s.Util._assign(t.Konva,{Util:s.Util,Transform:s.Transform,Node:n.Node,Container:a.Container,Stage:o.Stage,stages:o.stages,Layer:c.Layer,FastLayer:u.FastLayer,Group:d.Group,DD:f.DD,Shape:m.Shape,shapes:m.shapes,Animation:S.Animation,Tween:_.Tween,Easings:_.Easings,Context:y.Context,Canvas:b.Canvas}),r.default=r.Konva}(dl);var wl={};Object.defineProperty(wl,"__esModule",{value:!0}),wl.Arc=void 0;const Al=ai,Yy=fr,Pg=si,Sl=De,qy=si;class ls extends Yy.Shape{_sceneFunc(t){var s=Pg.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,s,n),t.arc(0,0,this.innerRadius(),s,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),s=this.outerRadius(),n=this.clockwise(),a=Pg.Konva.getAngle(n?360-this.angle():this.angle()),o=Math.cos(Math.min(a,Math.PI)),c=1,u=Math.sin(Math.min(Math.max(Math.PI,a),3*Math.PI/2)),d=Math.sin(Math.min(a,Math.PI/2)),f=o*(o>0?t:s),m=c*s,S=u*(u>0?t:s),_=d*(d>0?s:t);return{x:f,y:n?-1*_:S,width:m-f,height:_-S}}}wl.Arc=ls,ls.prototype._centroid=!0,ls.prototype.className="Arc",ls.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,qy._registerNode)(ls),Al.Factory.addGetterSetter(ls,"innerRadius",0,(0,Sl.getNumberValidator)()),Al.Factory.addGetterSetter(ls,"outerRadius",0,(0,Sl.getNumberValidator)()),Al.Factory.addGetterSetter(ls,"angle",0,(0,Sl.getNumberValidator)()),Al.Factory.addGetterSetter(ls,"clockwise",!1,(0,Sl.getBooleanValidator)());var El={},_o={};Object.defineProperty(_o,"__esModule",{value:!0}),_o.Line=void 0;const Cl=ai,Qy=fr,Mg=De,Zy=si;function Wc(r,t,s,n,a,o,c){var u=Math.sqrt(Math.pow(s-r,2)+Math.pow(n-t,2)),d=Math.sqrt(Math.pow(a-s,2)+Math.pow(o-n,2)),f=c*u/(u+d),m=c*d/(u+d),S=s-f*(a-r),_=n-f*(o-t),y=s+m*(a-r),b=n+m*(o-t);return[S,_,y,b]}function Rg(r,t){var s=r.length,n=[],a,o;for(a=2;a<s-2;a+=2)o=Wc(r[a-2],r[a-1],r[a],r[a+1],r[a+2],r[a+3],t),!isNaN(o[0])&&(n.push(o[0]),n.push(o[1]),n.push(r[a]),n.push(r[a+1]),n.push(o[2]),n.push(o[3]));return n}class Ps extends Qy.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){var s=this.points(),n=s.length,a=this.tension(),o=this.closed(),c=this.bezier(),u,d,f;if(n){if(t.beginPath(),t.moveTo(s[0],s[1]),a!==0&&n>4){for(u=this.getTensionPoints(),d=u.length,f=o?0:4,o||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);f<d-2;)t.bezierCurveTo(u[f++],u[f++],u[f++],u[f++],u[f++],u[f++]);o||t.quadraticCurveTo(u[d-2],u[d-1],s[n-2],s[n-1])}else if(c)for(f=2;f<n;)t.bezierCurveTo(s[f++],s[f++],s[f++],s[f++],s[f++],s[f++]);else for(f=2;f<n;f+=2)t.lineTo(s[f],s[f+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Rg(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),s=t.length,n=this.tension(),a=Wc(t[s-2],t[s-1],t[0],t[1],t[2],t[3],n),o=Wc(t[s-4],t[s-3],t[s-2],t[s-1],t[0],t[1],n),c=Rg(t,n),u=[a[2],a[3]].concat(c).concat([o[0],o[1],t[s-2],t[s-1],o[2],o[3],a[0],a[1],t[0],t[1]]);return u}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();for(var s=t[0],n=t[0],a=t[1],o=t[1],c,u,d=0;d<t.length/2;d++)c=t[d*2],u=t[d*2+1],s=Math.min(s,c),n=Math.max(n,c),a=Math.min(a,u),o=Math.max(o,u);return{x:s,y:a,width:n-s,height:o-a}}}_o.Line=Ps,Ps.prototype.className="Line",Ps.prototype._attrsAffectingSize=["points","bezier","tension"],(0,Zy._registerNode)(Ps),Cl.Factory.addGetterSetter(Ps,"closed",!1),Cl.Factory.addGetterSetter(Ps,"bezier",!1),Cl.Factory.addGetterSetter(Ps,"tension",0,(0,Mg.getNumberValidator)()),Cl.Factory.addGetterSetter(Ps,"points",[],(0,Mg.getNumberArrayValidator)());var La={},Fg={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.t2length=r.getQuadraticArcLength=r.getCubicArcLength=r.binomialCoefficients=r.cValues=r.tValues=void 0,r.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427584,.9491079123427584],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975364,.9602898564975364],[0,-.8360311073266358,.8360311073266358,-.968160239507626,.968160239507626,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171716,.9739065285171716],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704748,.9041172563704748,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.917598399222978,.917598399222978,-.984183054718588,.984183054718588],[-.10805494870734368,.10805494870734368,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635736,.9284348836635736,-.9862838086968124,.9862838086968124],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.98940093499165,.98940093499165],[0,-.17848418149584783,.17848418149584783,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713976,.9558239495713976,-.9915651684209308,.9915651684209308],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.903155903614818,.903155903614818,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.3737060887154195,.3737060887154195,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850948,.9931285991850948],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663064,.9672268385663064,-.9937521706203896,.9937521706203896],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354288,.9700604978354288,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.932971086826016,.932971086826016,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713096,.9747285559713096,-.9951872199970212,.9951872199970212]],r.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773423,.18629021092773423,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531844,.10693932599531844,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772844,.09212149983772844,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793785,.18553839747793785,.15720316715819355,.15720316715819355,.1215185706879032,.1215185706879032,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.1984314853271116,.1984314853271116,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.1826034150449236,.1826034150449236,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.0951585116824928,.0951585116824928,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340395,.11188384719340395,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065063,.14064291467065063,.12255520671147846,.12255520671147846,.10094204410628715,.10094204410628715,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.1287539625393362,.1287539625393362,.111566645547334,.111566645547334,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.01946178822972648,.01946178822972648],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.1181945319615184,.1181945319615184,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.1460811336496904,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372852,.12183141605372852,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.1336545721861062,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672952,.12304908430672952,.11499664022241136,.11499664022241136,.1048920914645414,.1048920914645414,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.1216704729278034,.1216704729278034,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(c,u,d)=>{let f,m,S;f=d/2,m=0;for(let _=0;_<20;_++)S=f*r.tValues[20][_]+f,m+=r.cValues[20][_]*n(c,u,S);return f*m};r.getCubicArcLength=t;const s=(c,u,d)=>{d===void 0&&(d=1);const f=c[0]-2*c[1]+c[2],m=u[0]-2*u[1]+u[2],S=2*c[1]-2*c[0],_=2*u[1]-2*u[0],y=4*(f*f+m*m),b=4*(f*S+m*_),x=S*S+_*_;if(y===0)return d*Math.sqrt(Math.pow(c[2]-c[0],2)+Math.pow(u[2]-u[0],2));const E=b/(2*y),I=x/y,R=d+E,p=I-E*E,w=R*R+p>0?Math.sqrt(R*R+p):0,A=E*E+p>0?Math.sqrt(E*E+p):0,C=E+Math.sqrt(E*E+p)!==0?p*Math.log(Math.abs((R+w)/(E+A))):0;return Math.sqrt(y)/2*(R*w-E*A+C)};r.getQuadraticArcLength=s;function n(c,u,d){const f=a(1,d,c),m=a(1,d,u),S=f*f+m*m;return Math.sqrt(S)}const a=(c,u,d)=>{const f=d.length-1;let m,S;if(f===0)return 0;if(c===0){S=0;for(let _=0;_<=f;_++)S+=r.binomialCoefficients[f][_]*Math.pow(1-u,f-_)*Math.pow(u,_)*d[_];return S}else{m=new Array(f);for(let _=0;_<f;_++)m[_]=f*(d[_+1]-d[_]);return a(c-1,u,m)}},o=(c,u,d)=>{let f=1,m=c/u,S=(c-d(m))/u,_=0;for(;f>.001;){const y=d(m+S),b=Math.abs(c-y)/u;if(b<f)f=b,m+=S;else{const x=d(m-S),E=Math.abs(c-x)/u;E<f?(f=E,m-=S):S/=2}if(_++,_>500)break}return m};r.t2length=o})(Fg),Object.defineProperty(La,"__esModule",{value:!0}),La.Path=void 0;const Jy=ai,tb=fr,eb=si,Da=Fg;class gr extends tb.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=gr.parsePathData(this.data()),this.pathLength=gr.getPathLength(this.dataArray)}_sceneFunc(t){var s=this.dataArray;t.beginPath();for(var n=!1,a=0;a<s.length;a++){var o=s[a].command,c=s[a].points;switch(o){case"L":t.lineTo(c[0],c[1]);break;case"M":t.moveTo(c[0],c[1]);break;case"C":t.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":t.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":var u=c[0],d=c[1],f=c[2],m=c[3],S=c[4],_=c[5],y=c[6],b=c[7],x=f>m?f:m,E=f>m?1:f/m,I=f>m?m/f:1;t.translate(u,d),t.rotate(y),t.scale(E,I),t.arc(0,0,x,S,S+_,1-b),t.scale(1/E,1/I),t.rotate(-y),t.translate(-u,-d);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach(function(f){if(f.command==="A"){var m=f.points[4],S=f.points[5],_=f.points[4]+S,y=Math.PI/180;if(Math.abs(m-_)<y&&(y=Math.abs(m-_)),S<0)for(let b=m-y;b>_;b-=y){const x=gr.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],b,0);t.push(x.x,x.y)}else for(let b=m+y;b<_;b+=y){const x=gr.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],b,0);t.push(x.x,x.y)}}else if(f.command==="C")for(let b=0;b<=1;b+=.01){const x=gr.getPointOnCubicBezier(b,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3],f.points[4],f.points[5]);t.push(x.x,x.y)}else t=t.concat(f.points)});for(var s=t[0],n=t[0],a=t[1],o=t[1],c,u,d=0;d<t.length/2;d++)c=t[d*2],u=t[d*2+1],isNaN(c)||(s=Math.min(s,c),n=Math.max(n,c)),isNaN(u)||(a=Math.min(a,u),o=Math.max(o,u));return{x:s,y:a,width:n-s,height:o-a}}getLength(){return this.pathLength}getPointAtLength(t){return gr.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,s,n,a){return Math.sqrt((n-t)*(n-t)+(a-s)*(a-s))}static getPathLength(t){let s=0;for(var n=0;n<t.length;++n)s+=t[n].pathLength;return s}static getPointAtLengthOfDataArray(t,s){var n,a=0,o=s.length;if(!o)return null;for(;a<o&&t>s[a].pathLength;)t-=s[a].pathLength,++a;if(a===o)return n=s[a-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return n=s[a].points.slice(0,2),{x:n[0],y:n[1]};var c=s[a],u=c.points;switch(c.command){case"L":return gr.getPointOnLine(t,c.start.x,c.start.y,u[0],u[1]);case"C":return gr.getPointOnCubicBezier((0,Da.t2length)(t,gr.getPathLength(s),x=>(0,Da.getCubicArcLength)([c.start.x,u[0],u[2],u[4]],[c.start.y,u[1],u[3],u[5]],x)),c.start.x,c.start.y,u[0],u[1],u[2],u[3],u[4],u[5]);case"Q":return gr.getPointOnQuadraticBezier((0,Da.t2length)(t,gr.getPathLength(s),x=>(0,Da.getQuadraticArcLength)([c.start.x,u[0],u[2]],[c.start.y,u[1],u[3]],x)),c.start.x,c.start.y,u[0],u[1],u[2],u[3]);case"A":var d=u[0],f=u[1],m=u[2],S=u[3],_=u[4],y=u[5],b=u[6];return _+=y*t/c.pathLength,gr.getPointOnEllipticalArc(d,f,m,S,_,b)}return null}static getPointOnLine(t,s,n,a,o,c,u){c===void 0&&(c=s),u===void 0&&(u=n);var d=(o-n)/(a-s+1e-8),f=Math.sqrt(t*t/(1+d*d));a<s&&(f*=-1);var m=d*f,S;if(a===s)S={x:c,y:u+m};else if((u-n)/(c-s+1e-8)===d)S={x:c+f,y:u+m};else{var _,y,b=this.getLineLength(s,n,a,o),x=(c-s)*(a-s)+(u-n)*(o-n);x=x/(b*b),_=s+x*(a-s),y=n+x*(o-n);var E=this.getLineLength(c,u,_,y),I=Math.sqrt(t*t-E*E);f=Math.sqrt(I*I/(1+d*d)),a<s&&(f*=-1),m=d*f,S={x:_+f,y:y+m}}return S}static getPointOnCubicBezier(t,s,n,a,o,c,u,d,f){function m(E){return E*E*E}function S(E){return 3*E*E*(1-E)}function _(E){return 3*E*(1-E)*(1-E)}function y(E){return(1-E)*(1-E)*(1-E)}var b=d*m(t)+c*S(t)+a*_(t)+s*y(t),x=f*m(t)+u*S(t)+o*_(t)+n*y(t);return{x:b,y:x}}static getPointOnQuadraticBezier(t,s,n,a,o,c,u){function d(y){return y*y}function f(y){return 2*y*(1-y)}function m(y){return(1-y)*(1-y)}var S=c*d(t)+a*f(t)+s*m(t),_=u*d(t)+o*f(t)+n*m(t);return{x:S,y:_}}static getPointOnEllipticalArc(t,s,n,a,o,c){var u=Math.cos(c),d=Math.sin(c),f={x:n*Math.cos(o),y:a*Math.sin(o)};return{x:t+(f.x*u-f.y*d),y:s+(f.x*d+f.y*u)}}static parsePathData(t){if(!t)return[];var s=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];s=s.replace(new RegExp(" ","g"),",");for(var a=0;a<n.length;a++)s=s.replace(new RegExp(n[a],"g"),"|"+n[a]);var o=s.split("|"),c=[],u=[],d=0,f=0,m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,S;for(a=1;a<o.length;a++){var _=o[a],y=_.charAt(0);for(_=_.slice(1),u.length=0;S=m.exec(_);)u.push(S[0]);for(var b=[],x=0,E=u.length;x<E;x++){if(u[x]==="00"){b.push(0,0);continue}var I=parseFloat(u[x]);isNaN(I)?b.push(0):b.push(I)}for(;b.length>0&&!isNaN(b[0]);){var R="",p=[],w=d,A=f,C,B,F,rt,tt,st,wt,dt,Tt,Lt;switch(y){case"l":d+=b.shift(),f+=b.shift(),R="L",p.push(d,f);break;case"L":d=b.shift(),f=b.shift(),p.push(d,f);break;case"m":var Qt=b.shift(),ct=b.shift();if(d+=Qt,f+=ct,R="M",c.length>2&&c[c.length-1].command==="z"){for(var Dt=c.length-2;Dt>=0;Dt--)if(c[Dt].command==="M"){d=c[Dt].points[0]+Qt,f=c[Dt].points[1]+ct;break}}p.push(d,f),y="l";break;case"M":d=b.shift(),f=b.shift(),R="M",p.push(d,f),y="L";break;case"h":d+=b.shift(),R="L",p.push(d,f);break;case"H":d=b.shift(),R="L",p.push(d,f);break;case"v":f+=b.shift(),R="L",p.push(d,f);break;case"V":f=b.shift(),R="L",p.push(d,f);break;case"C":p.push(b.shift(),b.shift(),b.shift(),b.shift()),d=b.shift(),f=b.shift(),p.push(d,f);break;case"c":p.push(d+b.shift(),f+b.shift(),d+b.shift(),f+b.shift()),d+=b.shift(),f+=b.shift(),R="C",p.push(d,f);break;case"S":B=d,F=f,C=c[c.length-1],C.command==="C"&&(B=d+(d-C.points[2]),F=f+(f-C.points[3])),p.push(B,F,b.shift(),b.shift()),d=b.shift(),f=b.shift(),R="C",p.push(d,f);break;case"s":B=d,F=f,C=c[c.length-1],C.command==="C"&&(B=d+(d-C.points[2]),F=f+(f-C.points[3])),p.push(B,F,d+b.shift(),f+b.shift()),d+=b.shift(),f+=b.shift(),R="C",p.push(d,f);break;case"Q":p.push(b.shift(),b.shift()),d=b.shift(),f=b.shift(),p.push(d,f);break;case"q":p.push(d+b.shift(),f+b.shift()),d+=b.shift(),f+=b.shift(),R="Q",p.push(d,f);break;case"T":B=d,F=f,C=c[c.length-1],C.command==="Q"&&(B=d+(d-C.points[0]),F=f+(f-C.points[1])),d=b.shift(),f=b.shift(),R="Q",p.push(B,F,d,f);break;case"t":B=d,F=f,C=c[c.length-1],C.command==="Q"&&(B=d+(d-C.points[0]),F=f+(f-C.points[1])),d+=b.shift(),f+=b.shift(),R="Q",p.push(B,F,d,f);break;case"A":rt=b.shift(),tt=b.shift(),st=b.shift(),wt=b.shift(),dt=b.shift(),Tt=d,Lt=f,d=b.shift(),f=b.shift(),R="A",p=this.convertEndpointToCenterParameterization(Tt,Lt,d,f,wt,dt,rt,tt,st);break;case"a":rt=b.shift(),tt=b.shift(),st=b.shift(),wt=b.shift(),dt=b.shift(),Tt=d,Lt=f,d+=b.shift(),f+=b.shift(),R="A",p=this.convertEndpointToCenterParameterization(Tt,Lt,d,f,wt,dt,rt,tt,st);break}c.push({command:R||y,points:p,start:{x:w,y:A},pathLength:this.calcLength(w,A,R||y,p)})}(y==="z"||y==="Z")&&c.push({command:"z",points:[],start:void 0,pathLength:0})}return c}static calcLength(t,s,n,a){var o,c,u,d,f=gr;switch(n){case"L":return f.getLineLength(t,s,a[0],a[1]);case"C":return(0,Da.getCubicArcLength)([t,a[0],a[2],a[4]],[s,a[1],a[3],a[5]],1);case"Q":return(0,Da.getQuadraticArcLength)([t,a[0],a[2]],[s,a[1],a[3]],1);case"A":o=0;var m=a[4],S=a[5],_=a[4]+S,y=Math.PI/180;if(Math.abs(m-_)<y&&(y=Math.abs(m-_)),c=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],m,0),S<0)for(d=m-y;d>_;d-=y)u=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],d,0),o+=f.getLineLength(c.x,c.y,u.x,u.y),c=u;else for(d=m+y;d<_;d+=y)u=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],d,0),o+=f.getLineLength(c.x,c.y,u.x,u.y),c=u;return u=f.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],_,0),o+=f.getLineLength(c.x,c.y,u.x,u.y),o}return 0}static convertEndpointToCenterParameterization(t,s,n,a,o,c,u,d,f){var m=f*(Math.PI/180),S=Math.cos(m)*(t-n)/2+Math.sin(m)*(s-a)/2,_=-1*Math.sin(m)*(t-n)/2+Math.cos(m)*(s-a)/2,y=S*S/(u*u)+_*_/(d*d);y>1&&(u*=Math.sqrt(y),d*=Math.sqrt(y));var b=Math.sqrt((u*u*(d*d)-u*u*(_*_)-d*d*(S*S))/(u*u*(_*_)+d*d*(S*S)));o===c&&(b*=-1),isNaN(b)&&(b=0);var x=b*u*_/d,E=b*-d*S/u,I=(t+n)/2+Math.cos(m)*x-Math.sin(m)*E,R=(s+a)/2+Math.sin(m)*x+Math.cos(m)*E,p=function(tt){return Math.sqrt(tt[0]*tt[0]+tt[1]*tt[1])},w=function(tt,st){return(tt[0]*st[0]+tt[1]*st[1])/(p(tt)*p(st))},A=function(tt,st){return(tt[0]*st[1]<tt[1]*st[0]?-1:1)*Math.acos(w(tt,st))},C=A([1,0],[(S-x)/u,(_-E)/d]),B=[(S-x)/u,(_-E)/d],F=[(-1*S-x)/u,(-1*_-E)/d],rt=A(B,F);return w(B,F)<=-1&&(rt=Math.PI),w(B,F)>=1&&(rt=0),c===0&&rt>0&&(rt=rt-2*Math.PI),c===1&&rt<0&&(rt=rt+2*Math.PI),[I,R,u,d,C,rt,m,c]}}La.Path=gr,gr.prototype.className="Path",gr.prototype._attrsAffectingSize=["data"],(0,eb._registerNode)(gr),Jy.Factory.addGetterSetter(gr,"data"),Object.defineProperty(El,"__esModule",{value:!0}),El.Arrow=void 0;const kl=ai,ib=_o,Ig=De,rb=si,Lg=La;class ta extends ib.Line{_sceneFunc(t){super._sceneFunc(t);var s=Math.PI*2,n=this.points(),a=n,o=this.tension()!==0&&n.length>4;o&&(a=this.getTensionPoints());var c=this.pointerLength(),u=n.length,d,f;if(o){const _=[a[a.length-4],a[a.length-3],a[a.length-2],a[a.length-1],n[u-2],n[u-1]],y=Lg.Path.calcLength(a[a.length-4],a[a.length-3],"C",_),b=Lg.Path.getPointOnQuadraticBezier(Math.min(1,1-c/y),_[0],_[1],_[2],_[3],_[4],_[5]);d=n[u-2]-b.x,f=n[u-1]-b.y}else d=n[u-2]-n[u-4],f=n[u-1]-n[u-3];var m=(Math.atan2(f,d)+s)%s,S=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[u-2],n[u-1]),t.rotate(m),t.moveTo(0,0),t.lineTo(-c,S/2),t.lineTo(-c,-S/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),o?(d=(a[0]+a[2])/2-n[0],f=(a[1]+a[3])/2-n[1]):(d=n[2]-n[0],f=n[3]-n[1]),t.rotate((Math.atan2(-f,-d)+s)%s),t.moveTo(0,0),t.lineTo(-c,S/2),t.lineTo(-c,-S/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var s=this.dashEnabled();s&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),s&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),s=this.pointerWidth()/2;return{x:t.x-s,y:t.y-s,width:t.width+s*2,height:t.height+s*2}}}El.Arrow=ta,ta.prototype.className="Arrow",(0,rb._registerNode)(ta),kl.Factory.addGetterSetter(ta,"pointerLength",10,(0,Ig.getNumberValidator)()),kl.Factory.addGetterSetter(ta,"pointerWidth",10,(0,Ig.getNumberValidator)()),kl.Factory.addGetterSetter(ta,"pointerAtBeginning",!1),kl.Factory.addGetterSetter(ta,"pointerAtEnding",!0);var Tl={};Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.Circle=void 0;const nb=ai,sb=fr,ab=De,ob=si;class Na extends sb.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}Tl.Circle=Na,Na.prototype._centroid=!0,Na.prototype.className="Circle",Na.prototype._attrsAffectingSize=["radius"],(0,ob._registerNode)(Na),nb.Factory.addGetterSetter(Na,"radius",0,(0,ab.getNumberValidator)());var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.Ellipse=void 0;const $c=ai,lb=fr,Dg=De,hb=si;class Ms extends lb.Shape{_sceneFunc(t){var s=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),s!==n&&t.scale(1,n/s),t.arc(0,0,s,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Pl.Ellipse=Ms,Ms.prototype.className="Ellipse",Ms.prototype._centroid=!0,Ms.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,hb._registerNode)(Ms),$c.Factory.addComponentsGetterSetter(Ms,"radius",["x","y"]),$c.Factory.addGetterSetter(Ms,"radiusX",0,(0,Dg.getNumberValidator)()),$c.Factory.addGetterSetter(Ms,"radiusY",0,(0,Dg.getNumberValidator)());var Ml={};Object.defineProperty(Ml,"__esModule",{value:!0}),Ml.Image=void 0;const Kc=qi,ea=ai,cb=fr,db=si,xo=De;let En=class extends cb.Shape{constructor(r){super(r),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const r=this.image();r&&r.complete||r&&r.readyState===4||r&&r.addEventListener&&r.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(r){const t=this.getWidth(),s=this.getHeight(),n=this.cornerRadius(),a=this.attrs.image;let o;if(a){const c=this.attrs.cropWidth,u=this.attrs.cropHeight;c&&u?o=[a,this.cropX(),this.cropY(),c,u,0,0,t,s]:o=[a,0,0,t,s]}(this.hasFill()||this.hasStroke()||n)&&(r.beginPath(),n?Kc.Util.drawRoundedRectPath(r,t,s,n):r.rect(0,0,t,s),r.closePath(),r.fillStrokeShape(this)),a&&(n&&r.clip(),r.drawImage.apply(r,o))}_hitFunc(r){var t=this.width(),s=this.height(),n=this.cornerRadius();r.beginPath(),n?Kc.Util.drawRoundedRectPath(r,t,s,n):r.rect(0,0,t,s),r.closePath(),r.fillStrokeShape(this)}getWidth(){var r,t;return(r=this.attrs.width)!==null&&r!==void 0?r:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var r,t;return(r=this.attrs.height)!==null&&r!==void 0?r:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(r,t,s=null){var n=Kc.Util.createImageElement();n.onload=function(){var a=new En({image:n});t(a)},n.onerror=s,n.crossOrigin="Anonymous",n.src=r}};Ml.Image=En,En.prototype.className="Image",(0,db._registerNode)(En),ea.Factory.addGetterSetter(En,"cornerRadius",0,(0,xo.getNumberOrArrayOfNumbersValidator)(4)),ea.Factory.addGetterSetter(En,"image"),ea.Factory.addComponentsGetterSetter(En,"crop",["x","y","width","height"]),ea.Factory.addGetterSetter(En,"cropX",0,(0,xo.getNumberValidator)()),ea.Factory.addGetterSetter(En,"cropY",0,(0,xo.getNumberValidator)()),ea.Factory.addGetterSetter(En,"cropWidth",0,(0,xo.getNumberValidator)()),ea.Factory.addGetterSetter(En,"cropHeight",0,(0,xo.getNumberValidator)());var Oa={};Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.Tag=Oa.Label=void 0;const Rl=ai,ub=fr,fb=Fa,Xc=De,Ng=si;var Og=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],gb="Change.konva",pb="none",Yc="up",qc="right",Qc="down",Zc="left",mb=Og.length;class Jc extends fb.Group{constructor(t){super(t),this.on("add.konva",function(s){this._addListeners(s.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var s=this,n,a=function(){s._sync()};for(n=0;n<mb;n++)t.on(Og[n]+gb,a)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t=this.getText(),s=this.getTag(),n,a,o,c,u,d,f;if(t&&s){switch(n=t.width(),a=t.height(),o=s.pointerDirection(),c=s.pointerWidth(),f=s.pointerHeight(),u=0,d=0,o){case Yc:u=n/2,d=-1*f;break;case qc:u=n+c,d=a/2;break;case Qc:u=n/2,d=a+f;break;case Zc:u=-1*c,d=a/2;break}s.setAttrs({x:-1*u,y:-1*d,width:n,height:a}),t.setAttrs({x:-1*u,y:-1*d})}}}Oa.Label=Jc,Jc.prototype.className="Label",(0,Ng._registerNode)(Jc);class ia extends ub.Shape{_sceneFunc(t){var s=this.width(),n=this.height(),a=this.pointerDirection(),o=this.pointerWidth(),c=this.pointerHeight(),u=this.cornerRadius();let d=0,f=0,m=0,S=0;typeof u=="number"?d=f=m=S=Math.min(u,s/2,n/2):(d=Math.min(u[0]||0,s/2,n/2),f=Math.min(u[1]||0,s/2,n/2),S=Math.min(u[2]||0,s/2,n/2),m=Math.min(u[3]||0,s/2,n/2)),t.beginPath(),t.moveTo(d,0),a===Yc&&(t.lineTo((s-o)/2,0),t.lineTo(s/2,-1*c),t.lineTo((s+o)/2,0)),t.lineTo(s-f,0),t.arc(s-f,f,f,Math.PI*3/2,0,!1),a===qc&&(t.lineTo(s,(n-c)/2),t.lineTo(s+o,n/2),t.lineTo(s,(n+c)/2)),t.lineTo(s,n-S),t.arc(s-S,n-S,S,0,Math.PI/2,!1),a===Qc&&(t.lineTo((s+o)/2,n),t.lineTo(s/2,n+c),t.lineTo((s-o)/2,n)),t.lineTo(m,n),t.arc(m,n-m,m,Math.PI/2,Math.PI,!1),a===Zc&&(t.lineTo(0,(n+c)/2),t.lineTo(-1*o,n/2),t.lineTo(0,(n-c)/2)),t.lineTo(0,d),t.arc(d,d,d,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,s=0,n=this.pointerWidth(),a=this.pointerHeight(),o=this.pointerDirection(),c=this.width(),u=this.height();return o===Yc?(s-=a,u+=a):o===Qc?u+=a:o===Zc?(t-=n*1.5,c+=n):o===qc&&(c+=n*1.5),{x:t,y:s,width:c,height:u}}}Oa.Tag=ia,ia.prototype.className="Tag",(0,Ng._registerNode)(ia),Rl.Factory.addGetterSetter(ia,"pointerDirection",pb),Rl.Factory.addGetterSetter(ia,"pointerWidth",0,(0,Xc.getNumberValidator)()),Rl.Factory.addGetterSetter(ia,"pointerHeight",0,(0,Xc.getNumberValidator)()),Rl.Factory.addGetterSetter(ia,"cornerRadius",0,(0,Xc.getNumberOrArrayOfNumbersValidator)(4));var wo={};Object.defineProperty(wo,"__esModule",{value:!0}),wo.Rect=void 0;const vb=ai,yb=fr,bb=si,_b=qi,xb=De;class Fl extends yb.Shape{_sceneFunc(t){var s=this.cornerRadius(),n=this.width(),a=this.height();t.beginPath(),s?_b.Util.drawRoundedRectPath(t,n,a,s):t.rect(0,0,n,a),t.closePath(),t.fillStrokeShape(this)}}wo.Rect=Fl,Fl.prototype.className="Rect",(0,bb._registerNode)(Fl),vb.Factory.addGetterSetter(Fl,"cornerRadius",0,(0,xb.getNumberOrArrayOfNumbersValidator)(4));var Il={};Object.defineProperty(Il,"__esModule",{value:!0}),Il.RegularPolygon=void 0;const zg=ai,wb=fr,Hg=De,Ab=si;class ra extends wb.Shape{_sceneFunc(t){const s=this._getPoints();t.beginPath(),t.moveTo(s[0].x,s[0].y);for(var n=1;n<s.length;n++)t.lineTo(s[n].x,s[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,s=this.attrs.radius||0,n=[];for(var a=0;a<t;a++)n.push({x:s*Math.sin(a*2*Math.PI/t),y:-1*s*Math.cos(a*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();var s=t[0].x,n=t[0].y,a=t[0].x,o=t[0].y;return t.forEach(c=>{s=Math.min(s,c.x),n=Math.max(n,c.x),a=Math.min(a,c.y),o=Math.max(o,c.y)}),{x:s,y:a,width:n-s,height:o-a}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Il.RegularPolygon=ra,ra.prototype.className="RegularPolygon",ra.prototype._centroid=!0,ra.prototype._attrsAffectingSize=["radius"],(0,Ab._registerNode)(ra),zg.Factory.addGetterSetter(ra,"radius",0,(0,Hg.getNumberValidator)()),zg.Factory.addGetterSetter(ra,"sides",0,(0,Hg.getNumberValidator)());var Ll={};Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.Ring=void 0;const Bg=ai,Sb=fr,Ug=De,Eb=si;var Gg=Math.PI*2;class na extends Sb.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Gg,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Gg,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Ll.Ring=na,na.prototype.className="Ring",na.prototype._centroid=!0,na.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,Eb._registerNode)(na),Bg.Factory.addGetterSetter(na,"innerRadius",0,(0,Ug.getNumberValidator)()),Bg.Factory.addGetterSetter(na,"outerRadius",0,(0,Ug.getNumberValidator)());var Dl={};Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.Sprite=void 0;const sa=ai,Cb=fr,kb=Ia,jg=De,Tb=si;class jn extends Cb.Shape{constructor(t){super(t),this._updated=!0,this.anim=new kb.Animation(()=>{var s=this._updated;return this._updated=!1,s}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){!this.anim.isRunning()||(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){var s=this.animation(),n=this.frameIndex(),a=n*4,o=this.animations()[s],c=this.frameOffsets(),u=o[a+0],d=o[a+1],f=o[a+2],m=o[a+3],S=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,f,m),t.closePath(),t.fillStrokeShape(this)),S)if(c){var _=c[s],y=n*2;t.drawImage(S,u,d,f,m,_[y+0],_[y+1],f,m)}else t.drawImage(S,u,d,f,m,0,0,f,m)}_hitFunc(t){var s=this.animation(),n=this.frameIndex(),a=n*4,o=this.animations()[s],c=this.frameOffsets(),u=o[a+2],d=o[a+3];if(t.beginPath(),c){var f=c[s],m=n*2;t.rect(f[m+0],f[m+1],u,d)}else t.rect(0,0,u,d);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),s=this.animation(),n=this.animations(),a=n[s],o=a.length/4;t<o-1?this.frameIndex(t+1):this.frameIndex(0)}}Dl.Sprite=jn,jn.prototype.className="Sprite",(0,Tb._registerNode)(jn),sa.Factory.addGetterSetter(jn,"animation"),sa.Factory.addGetterSetter(jn,"animations"),sa.Factory.addGetterSetter(jn,"frameOffsets"),sa.Factory.addGetterSetter(jn,"image"),sa.Factory.addGetterSetter(jn,"frameIndex",0,(0,jg.getNumberValidator)()),sa.Factory.addGetterSetter(jn,"frameRate",17,(0,jg.getNumberValidator)()),sa.Factory.backCompat(jn,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Nl={};Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.Star=void 0;const td=ai,Pb=fr,ed=De,Mb=si;class Rs extends Pb.Shape{_sceneFunc(t){var s=this.innerRadius(),n=this.outerRadius(),a=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(var o=1;o<a*2;o++){var c=o%2===0?n:s,u=c*Math.sin(o*Math.PI/a),d=-1*c*Math.cos(o*Math.PI/a);t.lineTo(u,d)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Nl.Star=Rs,Rs.prototype.className="Star",Rs.prototype._centroid=!0,Rs.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,Mb._registerNode)(Rs),td.Factory.addGetterSetter(Rs,"numPoints",5,(0,ed.getNumberValidator)()),td.Factory.addGetterSetter(Rs,"innerRadius",0,(0,ed.getNumberValidator)()),td.Factory.addGetterSetter(Rs,"outerRadius",0,(0,ed.getNumberValidator)());var aa={};Object.defineProperty(aa,"__esModule",{value:!0}),aa.Text=aa.stringToArray=void 0;const id=qi,Lr=ai,Rb=fr,Fs=De,Fb=si;function Vg(r){return Array.from(r)}aa.stringToArray=Vg;var za="auto",Ib="center",Wg="inherit",Ao="justify",Lb="Change.konva",Db="2d",$g="-",Kg="left",Nb="text",Ob="Text",zb="top",Hb="bottom",Xg="middle",Yg="normal",Bb="px ",Ol=" ",Ub="right",qg="rtl",Gb="word",jb="char",Qg="none",rd="\u2026",Zg=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Vb=Zg.length;function Wb(r){return r.split(",").map(t=>{t=t.trim();const s=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return s&&!n&&(t=`"${t}"`),t}).join(", ")}var nd;function sd(){return nd||(nd=id.Util.createCanvasElement().getContext(Db),nd)}function $b(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Kb(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Xb(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}class Ji extends Rb.Shape{constructor(t){super(Xb(t)),this._partialTextX=0,this._partialTextY=0;for(var s=0;s<Vb;s++)this.on(Zg[s]+Lb,this._setTextData);this._setTextData()}_sceneFunc(t){var s=this.textArr,n=s.length;if(this.text()){var a=this.padding(),o=this.fontSize(),c=this.lineHeight()*o,u=this.verticalAlign(),d=this.direction(),f=0,m=this.align(),S=this.getWidth(),_=this.letterSpacing(),y=this.fill(),b=this.textDecoration(),x=b.indexOf("underline")!==-1,E=b.indexOf("line-through")!==-1,I;d=d===Wg?t.direction:d;var R=0,R=c/2,p=0,w=0;for(d===qg&&t.setAttr("direction",d),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",Xg),t.setAttr("textAlign",Kg),u===Xg?f=(this.getHeight()-n*c-a*2)/2:u===Hb&&(f=this.getHeight()-n*c-a*2),t.translate(a,f+a),I=0;I<n;I++){var p=0,w=0,A=s[I],C=A.text,B=A.width,F=A.lastInParagraph,rt,tt,st;if(t.save(),m===Ub?p+=S-B-a*2:m===Ib&&(p+=(S-B-a*2)/2),x){t.save(),t.beginPath(),t.moveTo(p,R+w+Math.round(o/2)),rt=C.split(" ").length-1,tt=rt===0,st=m===Ao&&!F?S-a*2:B,t.lineTo(p+Math.round(st),R+w+Math.round(o/2)),t.lineWidth=o/15;const ct=this._getLinearGradient();t.strokeStyle=ct||y,t.stroke(),t.restore()}if(E){t.save(),t.beginPath(),t.moveTo(p,R+w),rt=C.split(" ").length-1,tt=rt===0,st=m===Ao&&F&&!tt?S-a*2:B,t.lineTo(p+Math.round(st),R+w),t.lineWidth=o/15;const ct=this._getLinearGradient();t.strokeStyle=ct||y,t.stroke(),t.restore()}if(d!==qg&&(_!==0||m===Ao)){rt=C.split(" ").length-1;for(var wt=Vg(C),dt=0;dt<wt.length;dt++){var Tt=wt[dt];Tt===" "&&!F&&m===Ao&&(p+=(S-a*2-B)/rt),this._partialTextX=p,this._partialTextY=R+w,this._partialText=Tt,t.fillStrokeShape(this),p+=this.measureSize(Tt).width+_}}else _!==0&&t.setAttr("letterSpacing",`${_}px`),this._partialTextX=p,this._partialTextY=R+w,this._partialText=C,t.fillStrokeShape(this);t.restore(),n>1&&(R+=c)}}}_hitFunc(t){var s=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,s,n),t.closePath(),t.fillStrokeShape(this)}setText(t){var s=id.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(Nb,s),this}getWidth(){var t=this.attrs.width===za||this.attrs.width===void 0;return t?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var t=this.attrs.height===za||this.attrs.height===void 0;return t?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return id.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var s=sd(),n=this.fontSize(),a;return s.save(),s.font=this._getContextFont(),a=s.measureText(t),s.restore(),{width:a.width,height:n}}_getContextFont(){return this.fontStyle()+Ol+this.fontVariant()+Ol+(this.fontSize()+Bb)+Wb(this.fontFamily())}_addTextLine(t){this.align()===Ao&&(t=t.trim());var s=this._getTextWidth(t);return this.textArr.push({text:t,width:s,lastInParagraph:!1})}_getTextWidth(t){var s=this.letterSpacing(),n=t.length;return sd().measureText(t).width+(n?s*(n-1):0)}_setTextData(){var t=this.text().split(`
`),s=+this.fontSize(),n=0,a=this.lineHeight()*s,o=this.attrs.width,c=this.attrs.height,u=o!==za&&o!==void 0,d=c!==za&&c!==void 0,f=this.padding(),m=o-f*2,S=c-f*2,_=0,y=this.wrap(),b=y!==Qg,x=y!==jb&&b,E=this.ellipsis();this.textArr=[],sd().font=this._getContextFont();for(var I=E?this._getTextWidth(rd):0,R=0,p=t.length;R<p;++R){var w=t[R],A=this._getTextWidth(w);if(u&&A>m)for(;w.length>0;){for(var C=0,B=w.length,F="",rt=0;C<B;){var tt=C+B>>>1,st=w.slice(0,tt+1),wt=this._getTextWidth(st)+I;wt<=m?(C=tt+1,F=st,rt=wt):B=tt}if(F){if(x){var dt,Tt=w[F.length],Lt=Tt===Ol||Tt===$g;Lt&&rt<=m?dt=F.length:dt=Math.max(F.lastIndexOf(Ol),F.lastIndexOf($g))+1,dt>0&&(C=dt,F=F.slice(0,C),rt=this._getTextWidth(F))}F=F.trimRight(),this._addTextLine(F),n=Math.max(n,rt),_+=a;var Qt=this._shouldHandleEllipsis(_);if(Qt){this._tryToAddEllipsisToLastLine();break}if(w=w.slice(C),w=w.trimLeft(),w.length>0&&(A=this._getTextWidth(w),A<=m)){this._addTextLine(w),_+=a,n=Math.max(n,A);break}}else break}else this._addTextLine(w),_+=a,n=Math.max(n,A),this._shouldHandleEllipsis(_)&&R<p-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),d&&_+a>S)break}this.textHeight=s,this.textWidth=n}_shouldHandleEllipsis(t){var s=+this.fontSize(),n=this.lineHeight()*s,a=this.attrs.height,o=a!==za&&a!==void 0,c=this.padding(),u=a-c*2,d=this.wrap(),f=d!==Qg;return!f||o&&t+n>u}_tryToAddEllipsisToLastLine(){var t=this.attrs.width,s=t!==za&&t!==void 0,n=this.padding(),a=t-n*2,o=this.ellipsis(),c=this.textArr[this.textArr.length-1];if(!(!c||!o)){if(s){var u=this._getTextWidth(c.text+rd)<a;u||(c.text=c.text.slice(0,c.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+rd)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,s=this.hasShadow();return t&&s?!0:super._useBufferCanvas()}}aa.Text=Ji,Ji.prototype._fillFunc=$b,Ji.prototype._strokeFunc=Kb,Ji.prototype.className=Ob,Ji.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,Fb._registerNode)(Ji),Lr.Factory.overWriteSetter(Ji,"width",(0,Fs.getNumberOrAutoValidator)()),Lr.Factory.overWriteSetter(Ji,"height",(0,Fs.getNumberOrAutoValidator)()),Lr.Factory.addGetterSetter(Ji,"direction",Wg),Lr.Factory.addGetterSetter(Ji,"fontFamily","Arial"),Lr.Factory.addGetterSetter(Ji,"fontSize",12,(0,Fs.getNumberValidator)()),Lr.Factory.addGetterSetter(Ji,"fontStyle",Yg),Lr.Factory.addGetterSetter(Ji,"fontVariant",Yg),Lr.Factory.addGetterSetter(Ji,"padding",0,(0,Fs.getNumberValidator)()),Lr.Factory.addGetterSetter(Ji,"align",Kg),Lr.Factory.addGetterSetter(Ji,"verticalAlign",zb),Lr.Factory.addGetterSetter(Ji,"lineHeight",1,(0,Fs.getNumberValidator)()),Lr.Factory.addGetterSetter(Ji,"wrap",Gb),Lr.Factory.addGetterSetter(Ji,"ellipsis",!1,(0,Fs.getBooleanValidator)()),Lr.Factory.addGetterSetter(Ji,"letterSpacing",0,(0,Fs.getNumberValidator)()),Lr.Factory.addGetterSetter(Ji,"text","",(0,Fs.getStringValidator)()),Lr.Factory.addGetterSetter(Ji,"textDecoration","");var zl={};Object.defineProperty(zl,"__esModule",{value:!0}),zl.TextPath=void 0;const ad=qi,Cn=ai,Yb=fr,So=La,od=aa,Jg=De,qb=si;var Qb="",tp="normal";function ep(r){r.fillText(this.partialText,0,0)}function ip(r){r.strokeText(this.partialText,0,0)}class pr extends Yb.Shape{constructor(t){super(t),this.dummyCanvas=ad.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return So.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const s=this.pathLength;return t-1>s?null:So.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=So.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var s=this.textDecoration(),n=this.fill(),a=this.fontSize(),o=this.glyphInfo;s==="underline"&&t.beginPath();for(var c=0;c<o.length;c++){t.save();var u=o[c].p0;t.translate(u.x,u.y),t.rotate(o[c].rotation),this.partialText=o[c].text,t.fillStrokeShape(this),s==="underline"&&(c===0&&t.moveTo(0,a/2+1),t.lineTo(a,a/2+1)),t.restore()}s==="underline"&&(t.strokeStyle=n,t.lineWidth=a/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var s=this.glyphInfo;if(s.length>=1){var n=s[0].p0;t.moveTo(n.x,n.y)}for(var a=0;a<s.length;a++){var o=s[a].p1;t.lineTo(o.x,o.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return ad.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return od.Text.prototype.setText.call(this,t)}_getContextFont(){return od.Text.prototype._getContextFont.call(this)}_getTextSize(t){var s=this.dummyCanvas,n=s.getContext("2d");n.save(),n.font=this._getContextFont();var a=n.measureText(t);return n.restore(),{width:a.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:s}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=s,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),a=this.align(),o=this.kerningFunc(),c=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let u=0;a==="center"&&(u=Math.max(0,this.pathLength/2-c/2)),a==="right"&&(u=Math.max(0,this.pathLength-c));const d=(0,od.stringToArray)(this.text());let f=u;for(var m=0;m<d.length;m++){const S=this._getPointAtLength(f);if(!S)return;let _=this._getTextSize(d[m]).width+n;if(d[m]===" "&&a==="justify"){const R=this.text().split(" ").length-1;_+=(this.pathLength-c)/R}const y=this._getPointAtLength(f+_);if(!y)return;const b=So.Path.getLineLength(S.x,S.y,y.x,y.y);let x=0;if(o)try{x=o(d[m-1],d[m])*this.fontSize()}catch{x=0}S.x+=x,y.x+=x,this.textWidth+=x;const E=So.Path.getPointOnLine(x+b/2,S.x,S.y,y.x,y.y),I=Math.atan2(y.y-S.y,y.x-S.x);this.glyphInfo.push({transposeX:E.x,transposeY:E.y,text:d[m],rotation:I,p0:S,p1:y}),f+=_}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach(function(m){t.push(m.p0.x),t.push(m.p0.y),t.push(m.p1.x),t.push(m.p1.y)});for(var s=t[0]||0,n=t[0]||0,a=t[1]||0,o=t[1]||0,c,u,d=0;d<t.length/2;d++)c=t[d*2],u=t[d*2+1],s=Math.min(s,c),n=Math.max(n,c),a=Math.min(a,u),o=Math.max(o,u);var f=this.fontSize();return{x:s-f/2,y:a-f/2,width:n-s+f,height:o-a+f}}destroy(){return ad.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}zl.TextPath=pr,pr.prototype._fillFunc=ep,pr.prototype._strokeFunc=ip,pr.prototype._fillFuncHit=ep,pr.prototype._strokeFuncHit=ip,pr.prototype.className="TextPath",pr.prototype._attrsAffectingSize=["text","fontSize","data"],(0,qb._registerNode)(pr),Cn.Factory.addGetterSetter(pr,"data"),Cn.Factory.addGetterSetter(pr,"fontFamily","Arial"),Cn.Factory.addGetterSetter(pr,"fontSize",12,(0,Jg.getNumberValidator)()),Cn.Factory.addGetterSetter(pr,"fontStyle",tp),Cn.Factory.addGetterSetter(pr,"align","left"),Cn.Factory.addGetterSetter(pr,"letterSpacing",0,(0,Jg.getNumberValidator)()),Cn.Factory.addGetterSetter(pr,"textBaseline","middle"),Cn.Factory.addGetterSetter(pr,"fontVariant",tp),Cn.Factory.addGetterSetter(pr,"text",Qb),Cn.Factory.addGetterSetter(pr,"textDecoration",null),Cn.Factory.addGetterSetter(pr,"kerningFunc",null);var Hl={};Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.Transformer=void 0;const Ri=qi,Si=ai,rp=Vi,Zb=fr,Jb=wo,np=Fa,kn=si,Is=De,t2=si;var sp="tr-konva",e2=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${sp}`).join(" "),ap="nodesRect",i2=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],r2={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const n2="ontouchstart"in kn.Konva._global;function s2(r,t,s){if(r==="rotater")return s;t+=Ri.Util.degToRad(r2[r]||0);var n=(Ri.Util.radToDeg(t)%360+360)%360;return Ri.Util._inRange(n,315+22.5,360)||Ri.Util._inRange(n,0,22.5)?"ns-resize":Ri.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Ri.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Ri.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Ri.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Ri.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Ri.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Ri.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Ri.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var Bl=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],op=1e8;function a2(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function lp(r,t,s){const n=s.x+(r.x-s.x)*Math.cos(t)-(r.y-s.y)*Math.sin(t),a=s.y+(r.x-s.x)*Math.sin(t)+(r.y-s.y)*Math.cos(t);return{...r,rotation:r.rotation+t,x:n,y:a}}function o2(r,t){const s=a2(r);return lp(r,t,s)}function l2(r,t,s){let n=t;for(let a=0;a<r.length;a++){const o=kn.Konva.getAngle(r[a]),c=Math.abs(o-t)%(Math.PI*2);Math.min(c,Math.PI*2-c)<s&&(n=o)}return n}let ld=0;class yi extends np.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(e2,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return Ri.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return sp+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const s=t.filter(a=>a.isAncestorOf(this)?(Ri.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=t=s,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(a=>{const o=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},c=a._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");a.on(c,o),a.on(i2.map(u=>u+`.${this._getEventNamespace()}`).join(" "),o),a.on(`absoluteTransformChange.${this._getEventNamespace()}`,o),this._proxyDrag(a)}),this._resetTransformCache();var n=!!this.findOne(".top-left");return n&&this.update(),this}_proxyDrag(t){let s;t.on(`dragstart.${this._getEventNamespace()}`,n=>{s=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!s)return;const a=t.getAbsolutePosition(),o=a.x-s.x,c=a.y-s.y;this.nodes().forEach(u=>{if(u===t||u.isDragging())return;const d=u.getAbsolutePosition();u.setAbsolutePosition({x:d.x+o,y:d.y+c}),u.startDrag(n)}),s=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(ap),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(ap,this.__getNodeRect)}__getNodeShape(t,s=this.rotation(),n){var a=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=t.getAbsoluteScale(n),c=t.getAbsolutePosition(n),u=a.x*o.x-t.offsetX()*o.x,d=a.y*o.y-t.offsetY()*o.y;const f=(kn.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),m={x:c.x+u*Math.cos(f)+d*Math.sin(-f),y:c.y+d*Math.cos(f)+u*Math.sin(f),width:a.width*o.x,height:a.height*o.y,rotation:f};return lp(m,-kn.Konva.getAngle(s),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-op,y:-op,width:0,height:0,rotation:0};const s=[];this.nodes().map(f=>{const m=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var S=[{x:m.x,y:m.y},{x:m.x+m.width,y:m.y},{x:m.x+m.width,y:m.y+m.height},{x:m.x,y:m.y+m.height}],_=f.getAbsoluteTransform();S.forEach(function(y){var b=_.point(y);s.push(b)})});const n=new Ri.Transform;n.rotate(-kn.Konva.getAngle(this.rotation()));var a=1/0,o=1/0,c=-1/0,u=-1/0;s.forEach(function(f){var m=n.point(f);a===void 0&&(a=c=m.x,o=u=m.y),a=Math.min(a,m.x),o=Math.min(o,m.y),c=Math.max(c,m.x),u=Math.max(u,m.y)}),n.invert();const d=n.point({x:a,y:o});return{x:d.x,y:d.y,width:c-a,height:u-o,rotation:kn.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Bl.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){var s=new Jb.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:n2?10:"auto"}),n=this;s.on("mousedown touchstart",function(a){n._handleMouseDown(a)}),s.on("dragstart",a=>{s.stopDrag(),a.cancelBubble=!0}),s.on("dragend",a=>{a.cancelBubble=!0}),s.on("mouseenter",()=>{var a=kn.Konva.getAngle(this.rotation()),o=this.rotateAnchorCursor(),c=s2(t,a,o);s.getStage().content&&(s.getStage().content.style.cursor=c),this._cursorChange=!0}),s.on("mouseout",()=>{s.getStage().content&&(s.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(s)}_createBack(){var t=new Zb.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(s,n){var a=n.getParent(),o=a.padding();s.beginPath(),s.rect(-o,-o,n.width()+o*2,n.height()+o*2),s.moveTo(n.width()/2,-o),a.rotateEnabled()&&a.rotateLineVisible()&&s.lineTo(n.width()/2,-a.rotateAnchorOffset()*Ri.Util._sign(n.height())-o),s.fillStrokeShape(n)},hitFunc:(s,n)=>{if(this.shouldOverdrawWholeArea()){var a=this.padding();s.beginPath(),s.rect(-a,-a,n.width()+a*2,n.height()+a*2),s.fillStrokeShape(n)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",s=>{s.cancelBubble=!0}),t.on("dragmove",s=>{s.cancelBubble=!0}),t.on("dragend",s=>{s.cancelBubble=!0}),this.on("dragmove",s=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var s=this._getNodeRect(),n=s.width,a=s.height,o=Math.sqrt(Math.pow(n,2)+Math.pow(a,2));this.sin=Math.abs(a/o),this.cos=Math.abs(n/o),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var c=t.target.getAbsolutePosition(),u=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-c.x,y:u.y-c.y},ld++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(d=>{d._fire("transformstart",{evt:t.evt,target:d})})}_handleMouseMove(t){var s,n,a,o=this.findOne("."+this._movingAnchorName),c=o.getStage();c.setPointersPositions(t);const u=c.getPointerPosition();let d={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y};const f=o.getAbsolutePosition();this.anchorDragBoundFunc()&&(d=this.anchorDragBoundFunc()(f,d,t)),o.setAbsolutePosition(d);const m=o.getAbsolutePosition();if(!(f.x===m.x&&f.y===m.y)){if(this._movingAnchorName==="rotater"){var S=this._getNodeRect();s=o.x()-S.width/2,n=-o.y()+S.height/2;let dt=Math.atan2(-n,s)+Math.PI/2;S.height<0&&(dt-=Math.PI);var _=kn.Konva.getAngle(this.rotation());const Tt=_+dt,Lt=kn.Konva.getAngle(this.rotationSnapTolerance()),Qt=l2(this.rotationSnaps(),Tt,Lt)-S.rotation,ct=o2(S,Qt);this._fitNodesInto(ct,t);return}var y=this.shiftBehavior(),b;y==="inverted"?b=this.keepRatio()&&!t.shiftKey:y==="none"?b=this.keepRatio():b=this.keepRatio()||t.shiftKey;var p=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(b){var x=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};a=Math.sqrt(Math.pow(x.x-o.x(),2)+Math.pow(x.y-o.y(),2));var E=this.findOne(".top-left").x()>x.x?-1:1,I=this.findOne(".top-left").y()>x.y?-1:1;s=a*this.cos*E,n=a*this.sin*I,this.findOne(".top-left").x(x.x-s),this.findOne(".top-left").y(x.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(b){var x=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};a=Math.sqrt(Math.pow(o.x()-x.x,2)+Math.pow(x.y-o.y(),2));var E=this.findOne(".top-right").x()<x.x?-1:1,I=this.findOne(".top-right").y()>x.y?-1:1;s=a*this.cos*E,n=a*this.sin*I,this.findOne(".top-right").x(x.x+s),this.findOne(".top-right").y(x.y-n)}var R=o.position();this.findOne(".top-left").y(R.y),this.findOne(".bottom-right").x(R.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(b){var x=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};a=Math.sqrt(Math.pow(x.x-o.x(),2)+Math.pow(o.y()-x.y,2));var E=x.x<o.x()?-1:1,I=o.y()<x.y?-1:1;s=a*this.cos*E,n=a*this.sin*I,o.x(x.x-s),o.y(x.y+n)}R=o.position(),this.findOne(".top-left").x(R.x),this.findOne(".bottom-right").y(R.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(b){var x=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};a=Math.sqrt(Math.pow(o.x()-x.x,2)+Math.pow(o.y()-x.y,2));var E=this.findOne(".bottom-right").x()<x.x?-1:1,I=this.findOne(".bottom-right").y()<x.y?-1:1;s=a*this.cos*E,n=a*this.sin*I,this.findOne(".bottom-right").x(x.x+s),this.findOne(".bottom-right").y(x.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var p=this.centeredScaling()||t.altKey;if(p){var w=this.findOne(".top-left"),A=this.findOne(".bottom-right"),C=w.x(),B=w.y(),F=this.getWidth()-A.x(),rt=this.getHeight()-A.y();A.move({x:-C,y:-B}),w.move({x:F,y:rt})}var tt=this.findOne(".top-left").getAbsolutePosition();s=tt.x,n=tt.y;var st=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),wt=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:s,y:n,width:st,height:wt,rotation:kn.Konva.getAngle(this.rotation())},t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var s;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var n=this.getNode();ld--,this._fire("transformend",{evt:t,target:n}),(s=this.getLayer())===null||s===void 0||s.batchDraw(),n&&this._nodes.forEach(a=>{var o;a._fire("transformend",{evt:t,target:a}),(o=a.getLayer())===null||o===void 0||o.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,s){var n=this._getNodeRect();const a=1;if(Ri.Util._inRange(t.width,-this.padding()*2-a,a)){this.update();return}if(Ri.Util._inRange(t.height,-this.padding()*2-a,a)){this.update();return}var o=new Ri.Transform;if(o.rotate(kn.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const _=o.point({x:-this.padding()*2,y:0});t.x+=_.x,t.y+=_.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const _=o.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const _=o.point({x:0,y:-this.padding()*2});t.x+=_.x,t.y+=_.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const _=o.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const _=this.boundBoxFunc()(n,t);_?t=_:Ri.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,u=new Ri.Transform;u.translate(n.x,n.y),u.rotate(n.rotation),u.scale(n.width/c,n.height/c);const d=new Ri.Transform,f=t.width/c,m=t.height/c;this.flipEnabled()===!1?(d.translate(t.x,t.y),d.rotate(t.rotation),d.translate(t.width<0?t.width:0,t.height<0?t.height:0),d.scale(Math.abs(f),Math.abs(m))):(d.translate(t.x,t.y),d.rotate(t.rotation),d.scale(f,m));const S=d.multiply(u.invert());this._nodes.forEach(_=>{var y;const b=_.getParent().getAbsoluteTransform(),x=_.getTransform().copy();x.translate(_.offsetX(),_.offsetY());const E=new Ri.Transform;E.multiply(b.copy().invert()).multiply(S).multiply(b).multiply(x);const I=E.decompose();_.setAttrs(I),(y=_.getLayer())===null||y===void 0||y.batchDraw()}),this.rotation(Ri.Util._getRotation(t.rotation)),this._nodes.forEach(_=>{this._fire("transform",{evt:s,target:_}),_._fire("transform",{evt:s,target:_})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,s){this.findOne(t).setAttrs(s)}update(){var t,s=this._getNodeRect();this.rotation(Ri.Util._getRotation(s.rotation));var n=s.width,a=s.height,o=this.enabledAnchors(),c=this.resizeEnabled(),u=this.padding(),d=this.anchorSize();const f=this.find("._anchor");f.forEach(S=>{S.setAttrs({width:d,height:d,offsetX:d/2,offsetY:d/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:d/2+u,offsetY:d/2+u,visible:c&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:d/2+u,visible:c&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:d/2-u,offsetY:d/2+u,visible:c&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:a/2,offsetX:d/2+u,visible:c&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:a/2,offsetX:d/2-u,visible:c&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:a,offsetX:d/2+u,offsetY:d/2-u,visible:c&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:a,offsetY:d/2-u,visible:c&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:a,offsetX:d/2-u,offsetY:d/2-u,visible:c&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Ri.Util._sign(a)-u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:a,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const m=this.anchorStyleFunc();m&&f.forEach(S=>{m(S)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),np.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return rp.Node.prototype.toObject.call(this)}clone(t){var s=rp.Node.prototype.clone.call(this,t);return s}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Hl.Transformer=yi,yi.isTransforming=()=>ld>0;function h2(r){return r instanceof Array||Ri.Util.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(t){Bl.indexOf(t)===-1&&Ri.Util.warn("Unknown anchor name: "+t+". Available names are: "+Bl.join(", "))}),r||[]}yi.prototype.className="Transformer",(0,t2._registerNode)(yi),Si.Factory.addGetterSetter(yi,"enabledAnchors",Bl,h2),Si.Factory.addGetterSetter(yi,"flipEnabled",!0,(0,Is.getBooleanValidator)()),Si.Factory.addGetterSetter(yi,"resizeEnabled",!0),Si.Factory.addGetterSetter(yi,"anchorSize",10,(0,Is.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"rotateEnabled",!0),Si.Factory.addGetterSetter(yi,"rotateLineVisible",!0),Si.Factory.addGetterSetter(yi,"rotationSnaps",[]),Si.Factory.addGetterSetter(yi,"rotateAnchorOffset",50,(0,Is.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"rotateAnchorCursor","crosshair"),Si.Factory.addGetterSetter(yi,"rotationSnapTolerance",5,(0,Is.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"borderEnabled",!0),Si.Factory.addGetterSetter(yi,"anchorStroke","rgb(0, 161, 255)"),Si.Factory.addGetterSetter(yi,"anchorStrokeWidth",1,(0,Is.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"anchorFill","white"),Si.Factory.addGetterSetter(yi,"anchorCornerRadius",0,(0,Is.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"borderStroke","rgb(0, 161, 255)"),Si.Factory.addGetterSetter(yi,"borderStrokeWidth",1,(0,Is.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"borderDash"),Si.Factory.addGetterSetter(yi,"keepRatio",!0),Si.Factory.addGetterSetter(yi,"shiftBehavior","default"),Si.Factory.addGetterSetter(yi,"centeredScaling",!1),Si.Factory.addGetterSetter(yi,"ignoreStroke",!1),Si.Factory.addGetterSetter(yi,"padding",0,(0,Is.getNumberValidator)()),Si.Factory.addGetterSetter(yi,"node"),Si.Factory.addGetterSetter(yi,"nodes"),Si.Factory.addGetterSetter(yi,"boundBoxFunc"),Si.Factory.addGetterSetter(yi,"anchorDragBoundFunc"),Si.Factory.addGetterSetter(yi,"anchorStyleFunc"),Si.Factory.addGetterSetter(yi,"shouldOverdrawWholeArea",!1),Si.Factory.addGetterSetter(yi,"useSingleNodeRotation",!0),Si.Factory.backCompat(yi,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Ul={};Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.Wedge=void 0;const Gl=ai,c2=fr,d2=si,hp=De,u2=si;class hs extends c2.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,d2.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Ul.Wedge=hs,hs.prototype.className="Wedge",hs.prototype._centroid=!0,hs.prototype._attrsAffectingSize=["radius"],(0,u2._registerNode)(hs),Gl.Factory.addGetterSetter(hs,"radius",0,(0,hp.getNumberValidator)()),Gl.Factory.addGetterSetter(hs,"angle",0,(0,hp.getNumberValidator)()),Gl.Factory.addGetterSetter(hs,"clockwise",!1),Gl.Factory.backCompat(hs,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var jl={};Object.defineProperty(jl,"__esModule",{value:!0}),jl.Blur=void 0;const cp=ai,f2=Vi,g2=De;function dp(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var p2=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],m2=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function v2(r,t){var s=r.data,n=r.width,a=r.height,o,c,u,d,f,m,S,_,y,b,x,E,I,R,p,w,A,C,B,F,rt,tt,st,wt,dt=t+t+1,Tt=n-1,Lt=a-1,Qt=t+1,ct=Qt*(Qt+1)/2,Dt=new dp,ee=null,zt=Dt,Jt=null,oe=null,pe=p2[t],Ae=m2[t];for(u=1;u<dt;u++)zt=zt.next=new dp,u===Qt&&(ee=zt);for(zt.next=Dt,S=m=0,c=0;c<a;c++){for(w=A=C=B=_=y=b=x=0,E=Qt*(F=s[m]),I=Qt*(rt=s[m+1]),R=Qt*(tt=s[m+2]),p=Qt*(st=s[m+3]),_+=ct*F,y+=ct*rt,b+=ct*tt,x+=ct*st,zt=Dt,u=0;u<Qt;u++)zt.r=F,zt.g=rt,zt.b=tt,zt.a=st,zt=zt.next;for(u=1;u<Qt;u++)d=m+((Tt<u?Tt:u)<<2),_+=(zt.r=F=s[d])*(wt=Qt-u),y+=(zt.g=rt=s[d+1])*wt,b+=(zt.b=tt=s[d+2])*wt,x+=(zt.a=st=s[d+3])*wt,w+=F,A+=rt,C+=tt,B+=st,zt=zt.next;for(Jt=Dt,oe=ee,o=0;o<n;o++)s[m+3]=st=x*pe>>Ae,st!==0?(st=255/st,s[m]=(_*pe>>Ae)*st,s[m+1]=(y*pe>>Ae)*st,s[m+2]=(b*pe>>Ae)*st):s[m]=s[m+1]=s[m+2]=0,_-=E,y-=I,b-=R,x-=p,E-=Jt.r,I-=Jt.g,R-=Jt.b,p-=Jt.a,d=S+((d=o+t+1)<Tt?d:Tt)<<2,w+=Jt.r=s[d],A+=Jt.g=s[d+1],C+=Jt.b=s[d+2],B+=Jt.a=s[d+3],_+=w,y+=A,b+=C,x+=B,Jt=Jt.next,E+=F=oe.r,I+=rt=oe.g,R+=tt=oe.b,p+=st=oe.a,w-=F,A-=rt,C-=tt,B-=st,oe=oe.next,m+=4;S+=n}for(o=0;o<n;o++){for(A=C=B=w=y=b=x=_=0,m=o<<2,E=Qt*(F=s[m]),I=Qt*(rt=s[m+1]),R=Qt*(tt=s[m+2]),p=Qt*(st=s[m+3]),_+=ct*F,y+=ct*rt,b+=ct*tt,x+=ct*st,zt=Dt,u=0;u<Qt;u++)zt.r=F,zt.g=rt,zt.b=tt,zt.a=st,zt=zt.next;for(f=n,u=1;u<=t;u++)m=f+o<<2,_+=(zt.r=F=s[m])*(wt=Qt-u),y+=(zt.g=rt=s[m+1])*wt,b+=(zt.b=tt=s[m+2])*wt,x+=(zt.a=st=s[m+3])*wt,w+=F,A+=rt,C+=tt,B+=st,zt=zt.next,u<Lt&&(f+=n);for(m=o,Jt=Dt,oe=ee,c=0;c<a;c++)d=m<<2,s[d+3]=st=x*pe>>Ae,st>0?(st=255/st,s[d]=(_*pe>>Ae)*st,s[d+1]=(y*pe>>Ae)*st,s[d+2]=(b*pe>>Ae)*st):s[d]=s[d+1]=s[d+2]=0,_-=E,y-=I,b-=R,x-=p,E-=Jt.r,I-=Jt.g,R-=Jt.b,p-=Jt.a,d=o+((d=c+Qt)<Lt?d:Lt)*n<<2,_+=w+=Jt.r=s[d],y+=A+=Jt.g=s[d+1],b+=C+=Jt.b=s[d+2],x+=B+=Jt.a=s[d+3],Jt=Jt.next,E+=F=oe.r,I+=rt=oe.g,R+=tt=oe.b,p+=st=oe.a,w-=F,A-=rt,C-=tt,B-=st,oe=oe.next,m+=n}}const y2=function(r){var t=Math.round(this.blurRadius());t>0&&v2(r,t)};jl.Blur=y2,cp.Factory.addGetterSetter(f2.Node,"blurRadius",0,(0,g2.getNumberValidator)(),cp.Factory.afterSetFilter);var Vl={};Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.Brighten=void 0;const up=ai,b2=Vi,_2=De,x2=function(r){var t=this.brightness()*255,s=r.data,n=s.length,a;for(a=0;a<n;a+=4)s[a]+=t,s[a+1]+=t,s[a+2]+=t};Vl.Brighten=x2,up.Factory.addGetterSetter(b2.Node,"brightness",0,(0,_2.getNumberValidator)(),up.Factory.afterSetFilter);var Wl={};Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.Contrast=void 0;const fp=ai,w2=Vi,A2=De,S2=function(r){var t=Math.pow((this.contrast()+100)/100,2),s=r.data,n=s.length,a=150,o=150,c=150,u;for(u=0;u<n;u+=4)a=s[u],o=s[u+1],c=s[u+2],a/=255,a-=.5,a*=t,a+=.5,a*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,c/=255,c-=.5,c*=t,c+=.5,c*=255,a=a<0?0:a>255?255:a,o=o<0?0:o>255?255:o,c=c<0?0:c>255?255:c,s[u]=a,s[u+1]=o,s[u+2]=c};Wl.Contrast=S2,fp.Factory.addGetterSetter(w2.Node,"contrast",0,(0,A2.getNumberValidator)(),fp.Factory.afterSetFilter);var $l={};Object.defineProperty($l,"__esModule",{value:!0}),$l.Emboss=void 0;const Ls=ai,Kl=Vi,E2=qi,gp=De,C2=function(r){var t=this.embossStrength()*10,s=this.embossWhiteLevel()*255,n=this.embossDirection(),a=this.embossBlend(),o=0,c=0,u=r.data,d=r.width,f=r.height,m=d*4,S=f;switch(n){case"top-left":o=-1,c=-1;break;case"top":o=-1,c=0;break;case"top-right":o=-1,c=1;break;case"right":o=0,c=1;break;case"bottom-right":o=1,c=1;break;case"bottom":o=1,c=0;break;case"bottom-left":o=1,c=-1;break;case"left":o=0,c=-1;break;default:E2.Util.error("Unknown emboss direction: "+n)}do{var _=(S-1)*m,y=o;S+y<1&&(y=0),S+y>f&&(y=0);var b=(S-1+y)*d*4,x=d;do{var E=_+(x-1)*4,I=c;x+I<1&&(I=0),x+I>d&&(I=0);var R=b+(x-1+I)*4,p=u[E]-u[R],w=u[E+1]-u[R+1],A=u[E+2]-u[R+2],C=p,B=C>0?C:-C,F=w>0?w:-w,rt=A>0?A:-A;if(F>B&&(C=w),rt>B&&(C=A),C*=t,a){var tt=u[E]+C,st=u[E+1]+C,wt=u[E+2]+C;u[E]=tt>255?255:tt<0?0:tt,u[E+1]=st>255?255:st<0?0:st,u[E+2]=wt>255?255:wt<0?0:wt}else{var dt=s-C;dt<0?dt=0:dt>255&&(dt=255),u[E]=u[E+1]=u[E+2]=dt}}while(--x)}while(--S)};$l.Emboss=C2,Ls.Factory.addGetterSetter(Kl.Node,"embossStrength",.5,(0,gp.getNumberValidator)(),Ls.Factory.afterSetFilter),Ls.Factory.addGetterSetter(Kl.Node,"embossWhiteLevel",.5,(0,gp.getNumberValidator)(),Ls.Factory.afterSetFilter),Ls.Factory.addGetterSetter(Kl.Node,"embossDirection","top-left",null,Ls.Factory.afterSetFilter),Ls.Factory.addGetterSetter(Kl.Node,"embossBlend",!1,null,Ls.Factory.afterSetFilter);var Xl={};Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.Enhance=void 0;const pp=ai,k2=Vi,T2=De;function hd(r,t,s,n,a){var o=s-t,c=a-n,u;return o===0?n+c/2:c===0?n:(u=(r-t)/o,u=c*u+n,u)}const P2=function(r){var t=r.data,s=t.length,n=t[0],a=n,o,c=t[1],u=c,d,f=t[2],m=f,S,_,y=this.enhance();if(y!==0){for(_=0;_<s;_+=4)o=t[_+0],o<n?n=o:o>a&&(a=o),d=t[_+1],d<c?c=d:d>u&&(u=d),S=t[_+2],S<f?f=S:S>m&&(m=S);a===n&&(a=255,n=0),u===c&&(u=255,c=0),m===f&&(m=255,f=0);var b,x,E,I,R,p,w,A,C;for(y>0?(x=a+y*(255-a),E=n-y*(n-0),R=u+y*(255-u),p=c-y*(c-0),A=m+y*(255-m),C=f-y*(f-0)):(b=(a+n)*.5,x=a+y*(a-b),E=n+y*(n-b),I=(u+c)*.5,R=u+y*(u-I),p=c+y*(c-I),w=(m+f)*.5,A=m+y*(m-w),C=f+y*(f-w)),_=0;_<s;_+=4)t[_+0]=hd(t[_+0],n,a,E,x),t[_+1]=hd(t[_+1],c,u,p,R),t[_+2]=hd(t[_+2],f,m,C,A)}};Xl.Enhance=P2,pp.Factory.addGetterSetter(k2.Node,"enhance",0,(0,T2.getNumberValidator)(),pp.Factory.afterSetFilter);var Yl={};Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.Grayscale=void 0;const M2=function(r){var t=r.data,s=t.length,n,a;for(n=0;n<s;n+=4)a=.34*t[n]+.5*t[n+1]+.16*t[n+2],t[n]=a,t[n+1]=a,t[n+2]=a};Yl.Grayscale=M2;var ql={};Object.defineProperty(ql,"__esModule",{value:!0}),ql.HSL=void 0;const Ha=ai,cd=Vi,dd=De;Ha.Factory.addGetterSetter(cd.Node,"hue",0,(0,dd.getNumberValidator)(),Ha.Factory.afterSetFilter),Ha.Factory.addGetterSetter(cd.Node,"saturation",0,(0,dd.getNumberValidator)(),Ha.Factory.afterSetFilter),Ha.Factory.addGetterSetter(cd.Node,"luminance",0,(0,dd.getNumberValidator)(),Ha.Factory.afterSetFilter);const R2=function(r){var t=r.data,s=t.length,n=1,a=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,c=this.luminance()*127,u,d=n*a*Math.cos(o*Math.PI/180),f=n*a*Math.sin(o*Math.PI/180),m=.299*n+.701*d+.167*f,S=.587*n-.587*d+.33*f,_=.114*n-.114*d-.497*f,y=.299*n-.299*d-.328*f,b=.587*n+.413*d+.035*f,x=.114*n-.114*d+.293*f,E=.299*n-.3*d+1.25*f,I=.587*n-.586*d-1.05*f,R=.114*n+.886*d-.2*f,p,w,A,C;for(u=0;u<s;u+=4)p=t[u+0],w=t[u+1],A=t[u+2],C=t[u+3],t[u+0]=m*p+S*w+_*A+c,t[u+1]=y*p+b*w+x*A+c,t[u+2]=E*p+I*w+R*A+c,t[u+3]=C};ql.HSL=R2;var Ql={};Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.HSV=void 0;const Ba=ai,ud=Vi,fd=De,F2=function(r){var t=r.data,s=t.length,n=Math.pow(2,this.value()),a=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,c,u=n*a*Math.cos(o*Math.PI/180),d=n*a*Math.sin(o*Math.PI/180),f=.299*n+.701*u+.167*d,m=.587*n-.587*u+.33*d,S=.114*n-.114*u-.497*d,_=.299*n-.299*u-.328*d,y=.587*n+.413*u+.035*d,b=.114*n-.114*u+.293*d,x=.299*n-.3*u+1.25*d,E=.587*n-.586*u-1.05*d,I=.114*n+.886*u-.2*d,R,p,w,A;for(c=0;c<s;c+=4)R=t[c+0],p=t[c+1],w=t[c+2],A=t[c+3],t[c+0]=f*R+m*p+S*w,t[c+1]=_*R+y*p+b*w,t[c+2]=x*R+E*p+I*w,t[c+3]=A};Ql.HSV=F2,Ba.Factory.addGetterSetter(ud.Node,"hue",0,(0,fd.getNumberValidator)(),Ba.Factory.afterSetFilter),Ba.Factory.addGetterSetter(ud.Node,"saturation",0,(0,fd.getNumberValidator)(),Ba.Factory.afterSetFilter),Ba.Factory.addGetterSetter(ud.Node,"value",0,(0,fd.getNumberValidator)(),Ba.Factory.afterSetFilter);var Zl={};Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.Invert=void 0;const I2=function(r){var t=r.data,s=t.length,n;for(n=0;n<s;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};Zl.Invert=I2;var Jl={};Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.Kaleidoscope=void 0;const th=ai,mp=Vi,vp=qi,yp=De;var L2=function(r,t,s){var n=r.data,a=t.data,o=r.width,c=r.height,u=s.polarCenterX||o/2,d=s.polarCenterY||c/2,f,m,S,_=0,y=0,b=0,x=0,E,I=Math.sqrt(u*u+d*d);m=o-u,S=c-d,E=Math.sqrt(m*m+S*S),I=E>I?E:I;var R=c,p=o,w,A,C=360/p*Math.PI/180,B,F;for(A=0;A<p;A+=1)for(B=Math.sin(A*C),F=Math.cos(A*C),w=0;w<R;w+=1)m=Math.floor(u+I*w/R*F),S=Math.floor(d+I*w/R*B),f=(S*o+m)*4,_=n[f+0],y=n[f+1],b=n[f+2],x=n[f+3],f=(A+w*o)*4,a[f+0]=_,a[f+1]=y,a[f+2]=b,a[f+3]=x},D2=function(r,t,s){var n=r.data,a=t.data,o=r.width,c=r.height,u=s.polarCenterX||o/2,d=s.polarCenterY||c/2,f,m,S,_,y,b=0,x=0,E=0,I=0,R,p=Math.sqrt(u*u+d*d);m=o-u,S=c-d,R=Math.sqrt(m*m+S*S),p=R>p?R:p;var w=c,A=o,C,B,F=s.polarRotation||0,rt,tt;for(m=0;m<o;m+=1)for(S=0;S<c;S+=1)_=m-u,y=S-d,C=Math.sqrt(_*_+y*y)*w/p,B=(Math.atan2(y,_)*180/Math.PI+360+F)%360,B=B*A/360,rt=Math.floor(B),tt=Math.floor(C),f=(tt*o+rt)*4,b=n[f+0],x=n[f+1],E=n[f+2],I=n[f+3],f=(S*o+m)*4,a[f+0]=b,a[f+1]=x,a[f+2]=E,a[f+3]=I};const N2=function(r){var t=r.width,s=r.height,n,a,o,c,u,d,f,m,S,_,y=Math.round(this.kaleidoscopePower()),b=Math.round(this.kaleidoscopeAngle()),x=Math.floor(t*(b%360)/360);if(!(y<1)){var E=vp.Util.createCanvasElement();E.width=t,E.height=s;var I=E.getContext("2d").getImageData(0,0,t,s);vp.Util.releaseCanvas(E),L2(r,I,{polarCenterX:t/2,polarCenterY:s/2});for(var R=t/Math.pow(2,y);R<=8;)R=R*2,y-=1;R=Math.ceil(R);var p=R,w=0,A=p,C=1;for(x+R>t&&(w=p,A=0,C=-1),a=0;a<s;a+=1)for(n=w;n!==A;n+=C)o=Math.round(n+x)%t,S=(t*a+o)*4,u=I.data[S+0],d=I.data[S+1],f=I.data[S+2],m=I.data[S+3],_=(t*a+n)*4,I.data[_+0]=u,I.data[_+1]=d,I.data[_+2]=f,I.data[_+3]=m;for(a=0;a<s;a+=1)for(p=Math.floor(R),c=0;c<y;c+=1){for(n=0;n<p+1;n+=1)S=(t*a+n)*4,u=I.data[S+0],d=I.data[S+1],f=I.data[S+2],m=I.data[S+3],_=(t*a+p*2-n-1)*4,I.data[_+0]=u,I.data[_+1]=d,I.data[_+2]=f,I.data[_+3]=m;p*=2}D2(I,r,{polarRotation:0})}};Jl.Kaleidoscope=N2,th.Factory.addGetterSetter(mp.Node,"kaleidoscopePower",2,(0,yp.getNumberValidator)(),th.Factory.afterSetFilter),th.Factory.addGetterSetter(mp.Node,"kaleidoscopeAngle",0,(0,yp.getNumberValidator)(),th.Factory.afterSetFilter);var eh={};Object.defineProperty(eh,"__esModule",{value:!0}),eh.Mask=void 0;const bp=ai,O2=Vi,z2=De;function ih(r,t,s){var n=(s*r.width+t)*4,a=[];return a.push(r.data[n++],r.data[n++],r.data[n++],r.data[n++]),a}function Eo(r,t){return Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2)+Math.pow(r[2]-t[2],2))}function H2(r){for(var t=[0,0,0],s=0;s<r.length;s++)t[0]+=r[s][0],t[1]+=r[s][1],t[2]+=r[s][2];return t[0]/=r.length,t[1]/=r.length,t[2]/=r.length,t}function B2(r,t){var s=ih(r,0,0),n=ih(r,r.width-1,0),a=ih(r,0,r.height-1),o=ih(r,r.width-1,r.height-1),c=t||10;if(Eo(s,n)<c&&Eo(n,o)<c&&Eo(o,a)<c&&Eo(a,s)<c){for(var u=H2([n,s,o,a]),d=[],f=0;f<r.width*r.height;f++){var m=Eo(u,[r.data[f*4],r.data[f*4+1],r.data[f*4+2]]);d[f]=m<c?0:255}return d}}function U2(r,t){for(var s=0;s<r.width*r.height;s++)r.data[4*s+3]=t[s]}function G2(r,t,s){for(var n=[1,1,1,1,0,1,1,1,1],a=Math.round(Math.sqrt(n.length)),o=Math.floor(a/2),c=[],u=0;u<s;u++)for(var d=0;d<t;d++){for(var f=u*t+d,m=0,S=0;S<a;S++)for(var _=0;_<a;_++){var y=u+S-o,b=d+_-o;if(y>=0&&y<s&&b>=0&&b<t){var x=y*t+b,E=n[S*a+_];m+=r[x]*E}}c[f]=m===255*8?255:0}return c}function j2(r,t,s){for(var n=[1,1,1,1,1,1,1,1,1],a=Math.round(Math.sqrt(n.length)),o=Math.floor(a/2),c=[],u=0;u<s;u++)for(var d=0;d<t;d++){for(var f=u*t+d,m=0,S=0;S<a;S++)for(var _=0;_<a;_++){var y=u+S-o,b=d+_-o;if(y>=0&&y<s&&b>=0&&b<t){var x=y*t+b,E=n[S*a+_];m+=r[x]*E}}c[f]=m>=255*4?255:0}return c}function V2(r,t,s){for(var n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],a=Math.round(Math.sqrt(n.length)),o=Math.floor(a/2),c=[],u=0;u<s;u++)for(var d=0;d<t;d++){for(var f=u*t+d,m=0,S=0;S<a;S++)for(var _=0;_<a;_++){var y=u+S-o,b=d+_-o;if(y>=0&&y<s&&b>=0&&b<t){var x=y*t+b,E=n[S*a+_];m+=r[x]*E}}c[f]=m}return c}const W2=function(r){var t=this.threshold(),s=B2(r,t);return s&&(s=G2(s,r.width,r.height),s=j2(s,r.width,r.height),s=V2(s,r.width,r.height),U2(r,s)),r};eh.Mask=W2,bp.Factory.addGetterSetter(O2.Node,"threshold",0,(0,z2.getNumberValidator)(),bp.Factory.afterSetFilter);var rh={};Object.defineProperty(rh,"__esModule",{value:!0}),rh.Noise=void 0;const _p=ai,$2=Vi,K2=De,X2=function(r){var t=this.noise()*255,s=r.data,n=s.length,a=t/2,o;for(o=0;o<n;o+=4)s[o+0]+=a-2*a*Math.random(),s[o+1]+=a-2*a*Math.random(),s[o+2]+=a-2*a*Math.random()};rh.Noise=X2,_p.Factory.addGetterSetter($2.Node,"noise",.2,(0,K2.getNumberValidator)(),_p.Factory.afterSetFilter);var nh={};Object.defineProperty(nh,"__esModule",{value:!0}),nh.Pixelate=void 0;const xp=ai,Y2=qi,q2=Vi,Q2=De,Z2=function(r){var t=Math.ceil(this.pixelSize()),s=r.width,n=r.height,a,o,c,u,d,f,m,S=Math.ceil(s/t),_=Math.ceil(n/t),y,b,x,E,I,R,p,w=r.data;if(t<=0){Y2.Util.error("pixelSize value can not be <= 0");return}for(I=0;I<S;I+=1)for(R=0;R<_;R+=1){for(u=0,d=0,f=0,m=0,y=I*t,b=y+t,x=R*t,E=x+t,p=0,a=y;a<b;a+=1)if(!(a>=s))for(o=x;o<E;o+=1)o>=n||(c=(s*o+a)*4,u+=w[c+0],d+=w[c+1],f+=w[c+2],m+=w[c+3],p+=1);for(u=u/p,d=d/p,f=f/p,m=m/p,a=y;a<b;a+=1)if(!(a>=s))for(o=x;o<E;o+=1)o>=n||(c=(s*o+a)*4,w[c+0]=u,w[c+1]=d,w[c+2]=f,w[c+3]=m)}};nh.Pixelate=Z2,xp.Factory.addGetterSetter(q2.Node,"pixelSize",8,(0,Q2.getNumberValidator)(),xp.Factory.afterSetFilter);var sh={};Object.defineProperty(sh,"__esModule",{value:!0}),sh.Posterize=void 0;const wp=ai,J2=Vi,t_=De,e_=function(r){var t=Math.round(this.levels()*254)+1,s=r.data,n=s.length,a=255/t,o;for(o=0;o<n;o+=1)s[o]=Math.floor(s[o]/a)*a};sh.Posterize=e_,wp.Factory.addGetterSetter(J2.Node,"levels",.5,(0,t_.getNumberValidator)(),wp.Factory.afterSetFilter);var ah={};Object.defineProperty(ah,"__esModule",{value:!0}),ah.RGB=void 0;const oh=ai,gd=Vi,i_=De,r_=function(r){var t=r.data,s=t.length,n=this.red(),a=this.green(),o=this.blue(),c,u;for(c=0;c<s;c+=4)u=(.34*t[c]+.5*t[c+1]+.16*t[c+2])/255,t[c]=u*n,t[c+1]=u*a,t[c+2]=u*o,t[c+3]=t[c+3]};ah.RGB=r_,oh.Factory.addGetterSetter(gd.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),oh.Factory.addGetterSetter(gd.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),oh.Factory.addGetterSetter(gd.Node,"blue",0,i_.RGBComponent,oh.Factory.afterSetFilter);var lh={};Object.defineProperty(lh,"__esModule",{value:!0}),lh.RGBA=void 0;const Co=ai,hh=Vi,n_=De,s_=function(r){var t=r.data,s=t.length,n=this.red(),a=this.green(),o=this.blue(),c=this.alpha(),u,d;for(u=0;u<s;u+=4)d=1-c,t[u]=n*c+t[u]*d,t[u+1]=a*c+t[u+1]*d,t[u+2]=o*c+t[u+2]*d};lh.RGBA=s_,Co.Factory.addGetterSetter(hh.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),Co.Factory.addGetterSetter(hh.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),Co.Factory.addGetterSetter(hh.Node,"blue",0,n_.RGBComponent,Co.Factory.afterSetFilter),Co.Factory.addGetterSetter(hh.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});var ch={};Object.defineProperty(ch,"__esModule",{value:!0}),ch.Sepia=void 0;const a_=function(r){var t=r.data,s=t.length,n,a,o,c;for(n=0;n<s;n+=4)a=t[n+0],o=t[n+1],c=t[n+2],t[n+0]=Math.min(255,a*.393+o*.769+c*.189),t[n+1]=Math.min(255,a*.349+o*.686+c*.168),t[n+2]=Math.min(255,a*.272+o*.534+c*.131)};ch.Sepia=a_;var dh={};Object.defineProperty(dh,"__esModule",{value:!0}),dh.Solarize=void 0;const o_=function(r){var t=r.data,s=r.width,n=r.height,a=s*4,o=n;do{var c=(o-1)*a,u=s;do{var d=c+(u-1)*4,f=t[d],m=t[d+1],S=t[d+2];f>127&&(f=255-f),m>127&&(m=255-m),S>127&&(S=255-S),t[d]=f,t[d+1]=m,t[d+2]=S}while(--u)}while(--o)};dh.Solarize=o_;var uh={};Object.defineProperty(uh,"__esModule",{value:!0}),uh.Threshold=void 0;const Ap=ai,l_=Vi,h_=De,c_=function(r){var t=this.threshold()*255,s=r.data,n=s.length,a;for(a=0;a<n;a+=1)s[a]=s[a]<t?0:255};uh.Threshold=c_,Ap.Factory.addGetterSetter(l_.Node,"threshold",.5,(0,h_.getNumberValidator)(),Ap.Factory.afterSetFilter),Object.defineProperty(cl,"__esModule",{value:!0}),cl.Konva=void 0;const Sp=dl,d_=wl,u_=El,f_=Tl,g_=Pl,p_=Ml,Ep=Oa,m_=_o,v_=La,y_=wo,b_=Il,__=Ll,x_=Dl,w_=Nl,A_=aa,S_=zl,E_=Hl,C_=Ul,k_=jl,T_=Vl,P_=Wl,M_=$l,R_=Xl,F_=Yl,I_=ql,L_=Ql,D_=Zl,N_=Jl,O_=eh,z_=rh,H_=nh,B_=sh,U_=ah,G_=lh,j_=ch,V_=dh,W_=uh;cl.Konva=Sp.Konva.Util._assign(Sp.Konva,{Arc:d_.Arc,Arrow:u_.Arrow,Circle:f_.Circle,Ellipse:g_.Ellipse,Image:p_.Image,Label:Ep.Label,Tag:Ep.Tag,Line:m_.Line,Path:v_.Path,Rect:y_.Rect,RegularPolygon:b_.RegularPolygon,Ring:__.Ring,Sprite:x_.Sprite,Star:w_.Star,Text:A_.Text,TextPath:S_.TextPath,Transformer:E_.Transformer,Wedge:C_.Wedge,Filters:{Blur:k_.Blur,Brighten:T_.Brighten,Contrast:P_.Contrast,Emboss:M_.Emboss,Enhance:R_.Enhance,Grayscale:F_.Grayscale,HSL:I_.HSL,HSV:L_.HSV,Invert:D_.Invert,Kaleidoscope:N_.Kaleidoscope,Mask:O_.Mask,Noise:z_.Noise,Pixelate:H_.Pixelate,Posterize:B_.Posterize,RGB:U_.RGB,RGBA:G_.RGBA,Sepia:j_.Sepia,Solarize:V_.Solarize,Threshold:W_.Threshold}}),Object.defineProperty(cg.exports,"__esModule",{value:!0});const $_=cl;cg.exports=$_.Konva;var pd={exports:{}};(function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var s=dl;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return s.Konva}});const n=dl;r.exports=n.Konva})(pd,pd.exports);const ko=f0(pd.exports);var Cp={exports:{}},K_=function(r){var t={},s=Fr.exports,n=$h.exports,a=Object.assign;function o(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,h=1;h<arguments.length;h++)i+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),d=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),y=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),w=Symbol.iterator;function A(e){return e===null||typeof e!="object"?null:(e=w&&e[w]||e["@@iterator"],typeof e=="function"?e:null)}function C(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case f:return"Fragment";case d:return"Portal";case S:return"Profiler";case m:return"StrictMode";case x:return"Suspense";case E:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case y:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case b:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case I:return i=e.displayName||null,i!==null?i:C(e.type)||"Memo";case R:i=e._payload,e=e._init;try{return C(e(i))}catch{}}return null}function B(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return C(i);case 8:return i===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function F(e){var i=e,h=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(h=i.return),e=i.return;while(e)}return i.tag===3?h:null}function rt(e){if(F(e)!==e)throw Error(o(188))}function tt(e){var i=e.alternate;if(!i){if(i=F(e),i===null)throw Error(o(188));return i!==e?null:e}for(var h=e,g=i;;){var v=h.return;if(v===null)break;var P=v.alternate;if(P===null){if(g=v.return,g!==null){h=g;continue}break}if(v.child===P.child){for(P=v.child;P;){if(P===h)return rt(v),e;if(P===g)return rt(v),i;P=P.sibling}throw Error(o(188))}if(h.return!==g.return)h=v,g=P;else{for(var it=!1,Ct=v.child;Ct;){if(Ct===h){it=!0,h=v,g=P;break}if(Ct===g){it=!0,g=v,h=P;break}Ct=Ct.sibling}if(!it){for(Ct=P.child;Ct;){if(Ct===h){it=!0,h=P,g=v;break}if(Ct===g){it=!0,g=P,h=v;break}Ct=Ct.sibling}if(!it)throw Error(o(189))}}if(h.alternate!==g)throw Error(o(190))}if(h.tag!==3)throw Error(o(188));return h.stateNode.current===h?e:i}function st(e){return e=tt(e),e!==null?wt(e):null}function wt(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=wt(e);if(i!==null)return i;e=e.sibling}return null}function dt(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){if(e.tag!==4){var i=dt(e);if(i!==null)return i}e=e.sibling}return null}var Tt=Array.isArray,Lt=r.getPublicInstance,Qt=r.getRootHostContext,ct=r.getChildHostContext,Dt=r.prepareForCommit,ee=r.resetAfterCommit,zt=r.createInstance,Jt=r.appendInitialChild,oe=r.finalizeInitialChildren,pe=r.prepareUpdate,Ae=r.shouldSetTextContent,Ve=r.createTextInstance,Gt=r.scheduleTimeout,lt=r.cancelTimeout,Ft=r.noTimeout,Wt=r.isPrimaryRenderer,ve=r.supportsMutation,ie=r.supportsPersistence,xe=r.supportsHydration,_e=r.getInstanceFromNode,ut=r.preparePortalMount,T=r.getCurrentEventPriority,M=r.detachDeletedInstance,D=r.supportsMicrotasks,H=r.scheduleMicrotask,L=r.supportsTestSelectors,V=r.findFiberRoot,j=r.getBoundingRect,G=r.getTextContent,W=r.isHiddenSubtree,U=r.matchAccessibilityRole,O=r.setFocusIfFocusable,z=r.setupIntersectionObserver,et=r.appendChild,nt=r.appendChildToContainer,pt=r.commitTextUpdate,yt=r.commitMount,Nt=r.commitUpdate,Ht=r.insertBefore,Pt=r.insertInContainerBefore,Bt=r.removeChild,Z=r.removeChildFromContainer,at=r.resetTextContent,_t=r.hideInstance,vt=r.hideTextInstance,jt=r.unhideInstance,bt=r.unhideTextInstance,q=r.clearContainer,ot=r.cloneInstance,ft=r.createContainerChildSet,Et=r.appendChildToContainerChildSet,Kt=r.finalizeContainerChildren,te=r.replaceContainerChildren,me=r.cloneHiddenInstance,Pe=r.cloneHiddenTextInstance,Ti=r.canHydrateInstance,je=r.canHydrateTextInstance,hi=r.canHydrateSuspenseInstance,ze=r.isSuspenseInstancePending,vi=r.isSuspenseInstanceFallback,oi=r.getSuspenseInstanceFallbackErrorDetails,tr=r.registerSuspenseInstanceRetry,bi=r.getNextHydratableSibling,Me=r.getFirstHydratableChild,Q=r.getFirstHydratableChildWithinContainer,K=r.getFirstHydratableChildWithinSuspenseInstance,ht=r.hydrateInstance,xt=r.hydrateTextInstance,St=r.hydrateSuspenseInstance,It=r.getNextHydratableInstanceAfterSuspenseInstance,Ot=r.commitHydratedContainer,ye=r.commitHydratedSuspenseInstance,le=r.clearSuspenseBoundary,$t=r.clearSuspenseBoundaryFromContainer,ne=r.shouldDeleteUnhydratedTailInstances,ue=r.didNotMatchHydratedContainerTextInstance,he=r.didNotMatchHydratedTextInstance,Le;function we(e){if(Le===void 0)try{throw Error()}catch(h){var i=h.stack.trim().match(/\n( *(at )?)/);Le=i&&i[1]||""}return`
`+Le+e}var He=!1;function Ue(e,i){if(!e||He)return"";He=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(ge){var g=ge}Reflect.construct(e,[],i)}else{try{i.call()}catch(ge){g=ge}e.call(i.prototype)}else{try{throw Error()}catch(ge){g=ge}e()}}catch(ge){if(ge&&g&&typeof ge.stack=="string"){for(var v=ge.stack.split(`
`),P=g.stack.split(`
`),it=v.length-1,Ct=P.length-1;1<=it&&0<=Ct&&v[it]!==P[Ct];)Ct--;for(;1<=it&&0<=Ct;it--,Ct--)if(v[it]!==P[Ct]){if(it!==1||Ct!==1)do if(it--,Ct--,0>Ct||v[it]!==P[Ct]){var Vt=`
`+v[it].replace(" at new "," at ");return e.displayName&&Vt.includes("<anonymous>")&&(Vt=Vt.replace("<anonymous>",e.displayName)),Vt}while(1<=it&&0<=Ct);break}}}finally{He=!1,Error.prepareStackTrace=h}return(e=e?e.displayName||e.name:"")?we(e):""}var Oi=Object.prototype.hasOwnProperty,ei=[],or=-1;function zi(e){return{current:e}}function qe(e){0>or||(e.current=ei[or],ei[or]=null,or--)}function $(e,i){or++,ei[or]=e.current,e.current=i}var At={},Zt=zi(At),ae=zi(!1),de=At;function Ce(e,i){var h=e.type.contextTypes;if(!h)return At;var g=e.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===i)return g.__reactInternalMemoizedMaskedChildContext;var v={},P;for(P in h)v[P]=i[P];return g&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=v),v}function Se(e){return e=e.childContextTypes,e!=null}function ri(){qe(ae),qe(Zt)}function ci(e,i,h){if(Zt.current!==At)throw Error(o(168));$(Zt,i),$(ae,h)}function mr(e,i,h){var g=e.stateNode;if(i=i.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var v in g)if(!(v in i))throw Error(o(108,B(e)||"Unknown",v));return a({},h,g)}function Hi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||At,de=Zt.current,$(Zt,e),$(ae,ae.current),!0}function qr(e,i,h){var g=e.stateNode;if(!g)throw Error(o(169));h?(e=mr(e,i,de),g.__reactInternalMemoizedMergedChildContext=e,qe(ae),qe(Zt),$(Zt,e)):qe(ae),$(ae,h)}var wr=Math.clz32?Math.clz32:$x,gh=Math.log,cs=Math.LN2;function $x(e){return e>>>=0,e===0?32:31-(gh(e)/cs|0)|0}var ds=64,ph=4194304;function jr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mh(e,i){var h=e.pendingLanes;if(h===0)return 0;var g=0,v=e.suspendedLanes,P=e.pingedLanes,it=h&268435455;if(it!==0){var Ct=it&~v;Ct!==0?g=jr(Ct):(P&=it,P!==0&&(g=jr(P)))}else it=h&~v,it!==0?g=jr(it):P!==0&&(g=jr(P));if(g===0)return 0;if(i!==0&&i!==g&&!(i&v)&&(v=g&-g,P=i&-i,v>=P||v===16&&(P&4194240)!==0))return i;if(g&4&&(g|=h&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=g;0<i;)h=31-wr(i),v=1<<h,g|=e[h],i&=~v;return g}function la(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kx(e,i){for(var h=e.suspendedLanes,g=e.pingedLanes,v=e.expirationTimes,P=e.pendingLanes;0<P;){var it=31-wr(P),Ct=1<<it,Vt=v[it];Vt===-1?(!(Ct&h)||Ct&g)&&(v[it]=la(Ct,i)):Vt<=i&&(e.expiredLanes|=Ct),P&=~Ct}}function Vn(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Wp(){var e=ds;return ds<<=1,!(ds&4194240)&&(ds=64),e}function Wn(e){for(var i=[],h=0;31>h;h++)i.push(e);return i}function To(e,i,h){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-wr(i),e[i]=h}function $n(e,i){var h=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var g=e.eventTimes;for(e=e.expirationTimes;0<h;){var v=31-wr(h),P=1<<v;i[v]=0,g[v]=-1,e[v]=-1,h&=~P}}function Ad(e,i){var h=e.entangledLanes|=i;for(e=e.entanglements;h;){var g=31-wr(h),v=1<<g;v&i|e[g]&i&&(e[g]|=i),h&=~v}}var di=0;function $p(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Kn=n.unstable_scheduleCallback,Kp=n.unstable_cancelCallback,Ga=n.unstable_shouldYield,Xx=n.unstable_requestPaint,Wi=n.unstable_now,Sd=n.unstable_ImmediatePriority,ja=n.unstable_UserBlockingPriority,Ed=n.unstable_NormalPriority,Va=n.unstable_IdlePriority,vh=null,Dr=null;function Yx(e){if(Dr&&typeof Dr.onCommitFiberRoot=="function")try{Dr.onCommitFiberRoot(vh,e,void 0,(e.current.flags&128)===128)}catch{}}function Ns(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var Tn=typeof Object.is=="function"?Object.is:Ns,kr=null,yh=!1,sr=!1;function lr(e){kr===null?kr=[e]:kr.push(e)}function vr(e){yh=!0,lr(e)}function yr(){if(!sr&&kr!==null){sr=!0;var e=0,i=di;try{var h=kr;for(di=1;e<h.length;e++){var g=h[e];do g=g(!0);while(g!==null)}kr=null,yh=!1}catch(v){throw kr!==null&&(kr=kr.slice(e+1)),Kn(Sd,yr),v}finally{di=i,sr=!1}}return null}var Nr=[],Vr=0,Pn=null,Wr=0,hr=[],Qi=0,br=null,$r=1,Tr="";function ha(e,i){Nr[Vr++]=Wr,Nr[Vr++]=Pn,Pn=e,Wr=i}function Xn(e,i,h){hr[Qi++]=$r,hr[Qi++]=Tr,hr[Qi++]=br,br=e;var g=$r;e=Tr;var v=32-wr(g)-1;g&=~(1<<v),h+=1;var P=32-wr(i)+v;if(30<P){var it=v-v%5;P=(g&(1<<it)-1).toString(32),g>>=it,v-=it,$r=1<<32-wr(i)+v|h<<v|g,Tr=P+e}else $r=1<<P|h<<v|g,Tr=e}function Cd(e){e.return!==null&&(ha(e,1),Xn(e,1,0))}function Yn(e){for(;e===Pn;)Pn=Nr[--Vr],Nr[Vr]=null,Wr=Nr[--Vr],Nr[Vr]=null;for(;e===br;)br=hr[--Qi],hr[Qi]=null,Tr=hr[--Qi],hr[Qi]=null,$r=hr[--Qi],hr[Qi]=null}var ln=null,Ar=null,$i=!1,qn=!1,Mn=null;function ca(e,i){var h=xn(5,null,null,0);h.elementType="DELETED",h.stateNode=i,h.return=e,i=e.deletions,i===null?(e.deletions=[h],e.flags|=16):i.push(h)}function Xp(e,i){switch(e.tag){case 5:return i=Ti(i,e.type,e.pendingProps),i!==null?(e.stateNode=i,ln=e,Ar=Me(i),!0):!1;case 6:return i=je(i,e.pendingProps),i!==null?(e.stateNode=i,ln=e,Ar=null,!0):!1;case 13:if(i=hi(i),i!==null){var h=br!==null?{id:$r,overflow:Tr}:null;return e.memoizedState={dehydrated:i,treeContext:h,retryLane:1073741824},h=xn(18,null,null,0),h.stateNode=i,h.return=e,e.child=h,ln=e,Ar=null,!0}return!1;default:return!1}}function us(e){return(e.mode&1)!==0&&(e.flags&128)===0}function kd(e){if($i){var i=Ar;if(i){var h=i;if(!Xp(e,i)){if(us(e))throw Error(o(418));i=bi(h);var g=ln;i&&Xp(e,i)?ca(g,h):(e.flags=e.flags&-4097|2,$i=!1,ln=e)}}else{if(us(e))throw Error(o(418));e.flags=e.flags&-4097|2,$i=!1,ln=e}}}function fs(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ln=e}function bh(e){if(!xe||e!==ln)return!1;if(!$i)return fs(e),$i=!0,!1;if(e.tag!==3&&(e.tag!==5||ne(e.type)&&!Ae(e.type,e.memoizedProps))){var i=Ar;if(i){if(us(e))throw da(),Error(o(418));for(;i;)ca(e,i),i=bi(i)}}if(fs(e),e.tag===13){if(!xe)throw Error(o(316));if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Ar=It(e)}else Ar=ln?bi(e.stateNode):null;return!0}function da(){for(var e=Ar;e;)e=bi(e)}function Wa(){xe&&(Ar=ln=null,qn=$i=!1)}function ua(e){Mn===null?Mn=[e]:Mn.push(e)}var gs=c.ReactCurrentBatchConfig;function Rn(e,i){if(Tn(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var h=Object.keys(e),g=Object.keys(i);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var v=h[g];if(!Oi.call(i,v)||!Tn(e[v],i[v]))return!1}return!0}function pn(e){switch(e.tag){case 5:return we(e.type);case 16:return we("Lazy");case 13:return we("Suspense");case 19:return we("SuspenseList");case 0:case 2:case 15:return e=Ue(e.type,!1),e;case 11:return e=Ue(e.type.render,!1),e;case 1:return e=Ue(e.type,!0),e;default:return""}}function hn(e,i,h){if(e=h.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(o(309));var g=h.stateNode}if(!g)throw Error(o(147,e));var v=g,P=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===P?i.ref:(i=function(it){var Ct=v.refs;it===null?delete Ct[P]:Ct[P]=it},i._stringRef=P,i)}if(typeof e!="string")throw Error(o(284));if(!h._owner)throw Error(o(290,e))}return e}function Qr(e,i){throw e=Object.prototype.toString.call(i),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function mn(e){var i=e._init;return i(e._payload)}function vn(e){function i(Ut,Mt){if(e){var Yt=Ut.deletions;Yt===null?(Ut.deletions=[Mt],Ut.flags|=16):Yt.push(Mt)}}function h(Ut,Mt){if(!e)return null;for(;Mt!==null;)i(Ut,Mt),Mt=Mt.sibling;return null}function g(Ut,Mt){for(Ut=new Map;Mt!==null;)Mt.key!==null?Ut.set(Mt.key,Mt):Ut.set(Mt.index,Mt),Mt=Mt.sibling;return Ut}function v(Ut,Mt){return Ut=js(Ut,Mt),Ut.index=0,Ut.sibling=null,Ut}function P(Ut,Mt,Yt){return Ut.index=Yt,e?(Yt=Ut.alternate,Yt!==null?(Yt=Yt.index,Yt<Mt?(Ut.flags|=2,Mt):Yt):(Ut.flags|=2,Mt)):(Ut.flags|=1048576,Mt)}function it(Ut){return e&&Ut.alternate===null&&(Ut.flags|=2),Ut}function Ct(Ut,Mt,Yt,Te){return Mt===null||Mt.tag!==6?(Mt=cu(Yt,Ut.mode,Te),Mt.return=Ut,Mt):(Mt=v(Mt,Yt),Mt.return=Ut,Mt)}function Vt(Ut,Mt,Yt,Te){var Ge=Yt.type;return Ge===f?Ie(Ut,Mt,Yt.props.children,Te,Yt.key):Mt!==null&&(Mt.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===R&&mn(Ge)===Mt.type)?(Te=v(Mt,Yt.props),Te.ref=hn(Ut,Mt,Yt),Te.return=Ut,Te):(Te=jh(Yt.type,Yt.key,Yt.props,null,Ut.mode,Te),Te.ref=hn(Ut,Mt,Yt),Te.return=Ut,Te)}function ge(Ut,Mt,Yt,Te){return Mt===null||Mt.tag!==4||Mt.stateNode.containerInfo!==Yt.containerInfo||Mt.stateNode.implementation!==Yt.implementation?(Mt=du(Yt,Ut.mode,Te),Mt.return=Ut,Mt):(Mt=v(Mt,Yt.children||[]),Mt.return=Ut,Mt)}function Ie(Ut,Mt,Yt,Te,Ge){return Mt===null||Mt.tag!==7?(Mt=ba(Yt,Ut.mode,Te,Ge),Mt.return=Ut,Mt):(Mt=v(Mt,Yt),Mt.return=Ut,Mt)}function Ze(Ut,Mt,Yt){if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number")return Mt=cu(""+Mt,Ut.mode,Yt),Mt.return=Ut,Mt;if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case u:return Yt=jh(Mt.type,Mt.key,Mt.props,null,Ut.mode,Yt),Yt.ref=hn(Ut,null,Mt),Yt.return=Ut,Yt;case d:return Mt=du(Mt,Ut.mode,Yt),Mt.return=Ut,Mt;case R:var Te=Mt._init;return Ze(Ut,Te(Mt._payload),Yt)}if(Tt(Mt)||A(Mt))return Mt=ba(Mt,Ut.mode,Yt,null),Mt.return=Ut,Mt;Qr(Ut,Mt)}return null}function ke(Ut,Mt,Yt,Te){var Ge=Mt!==null?Mt.key:null;if(typeof Yt=="string"&&Yt!==""||typeof Yt=="number")return Ge!==null?null:Ct(Ut,Mt,""+Yt,Te);if(typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case u:return Yt.key===Ge?Vt(Ut,Mt,Yt,Te):null;case d:return Yt.key===Ge?ge(Ut,Mt,Yt,Te):null;case R:return Ge=Yt._init,ke(Ut,Mt,Ge(Yt._payload),Te)}if(Tt(Yt)||A(Yt))return Ge!==null?null:Ie(Ut,Mt,Yt,Te,null);Qr(Ut,Yt)}return null}function Ui(Ut,Mt,Yt,Te,Ge){if(typeof Te=="string"&&Te!==""||typeof Te=="number")return Ut=Ut.get(Yt)||null,Ct(Mt,Ut,""+Te,Ge);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case u:return Ut=Ut.get(Te.key===null?Yt:Te.key)||null,Vt(Mt,Ut,Te,Ge);case d:return Ut=Ut.get(Te.key===null?Yt:Te.key)||null,ge(Mt,Ut,Te,Ge);case R:var ni=Te._init;return Ui(Ut,Mt,Yt,ni(Te._payload),Ge)}if(Tt(Te)||A(Te))return Ut=Ut.get(Yt)||null,Ie(Mt,Ut,Te,Ge,null);Qr(Mt,Te)}return null}function Di(Ut,Mt,Yt,Te){for(var Ge=null,ni=null,Je=Mt,wi=Mt=0,Cr=null;Je!==null&&wi<Yt.length;wi++){Je.index>wi?(Cr=Je,Je=null):Cr=Je.sibling;var Ai=ke(Ut,Je,Yt[wi],Te);if(Ai===null){Je===null&&(Je=Cr);break}e&&Je&&Ai.alternate===null&&i(Ut,Je),Mt=P(Ai,Mt,wi),ni===null?Ge=Ai:ni.sibling=Ai,ni=Ai,Je=Cr}if(wi===Yt.length)return h(Ut,Je),$i&&ha(Ut,wi),Ge;if(Je===null){for(;wi<Yt.length;wi++)Je=Ze(Ut,Yt[wi],Te),Je!==null&&(Mt=P(Je,Mt,wi),ni===null?Ge=Je:ni.sibling=Je,ni=Je);return $i&&ha(Ut,wi),Ge}for(Je=g(Ut,Je);wi<Yt.length;wi++)Cr=Ui(Je,Ut,wi,Yt[wi],Te),Cr!==null&&(e&&Cr.alternate!==null&&Je.delete(Cr.key===null?wi:Cr.key),Mt=P(Cr,Mt,wi),ni===null?Ge=Cr:ni.sibling=Cr,ni=Cr);return e&&Je.forEach(function(Vs){return i(Ut,Vs)}),$i&&ha(Ut,wi),Ge}function en(Ut,Mt,Yt,Te){var Ge=A(Yt);if(typeof Ge!="function")throw Error(o(150));if(Yt=Ge.call(Yt),Yt==null)throw Error(o(151));for(var ni=Ge=null,Je=Mt,wi=Mt=0,Cr=null,Ai=Yt.next();Je!==null&&!Ai.done;wi++,Ai=Yt.next()){Je.index>wi?(Cr=Je,Je=null):Cr=Je.sibling;var Vs=ke(Ut,Je,Ai.value,Te);if(Vs===null){Je===null&&(Je=Cr);break}e&&Je&&Vs.alternate===null&&i(Ut,Je),Mt=P(Vs,Mt,wi),ni===null?Ge=Vs:ni.sibling=Vs,ni=Vs,Je=Cr}if(Ai.done)return h(Ut,Je),$i&&ha(Ut,wi),Ge;if(Je===null){for(;!Ai.done;wi++,Ai=Yt.next())Ai=Ze(Ut,Ai.value,Te),Ai!==null&&(Mt=P(Ai,Mt,wi),ni===null?Ge=Ai:ni.sibling=Ai,ni=Ai);return $i&&ha(Ut,wi),Ge}for(Je=g(Ut,Je);!Ai.done;wi++,Ai=Yt.next())Ai=Ui(Je,Ut,wi,Ai.value,Te),Ai!==null&&(e&&Ai.alternate!==null&&Je.delete(Ai.key===null?wi:Ai.key),Mt=P(Ai,Mt,wi),ni===null?Ge=Ai:ni.sibling=Ai,ni=Ai);return e&&Je.forEach(function(Sw){return i(Ut,Sw)}),$i&&ha(Ut,wi),Ge}function _s(Ut,Mt,Yt,Te){if(typeof Yt=="object"&&Yt!==null&&Yt.type===f&&Yt.key===null&&(Yt=Yt.props.children),typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case u:t:{for(var Ge=Yt.key,ni=Mt;ni!==null;){if(ni.key===Ge){if(Ge=Yt.type,Ge===f){if(ni.tag===7){h(Ut,ni.sibling),Mt=v(ni,Yt.props.children),Mt.return=Ut,Ut=Mt;break t}}else if(ni.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===R&&mn(Ge)===ni.type){h(Ut,ni.sibling),Mt=v(ni,Yt.props),Mt.ref=hn(Ut,ni,Yt),Mt.return=Ut,Ut=Mt;break t}h(Ut,ni);break}else i(Ut,ni);ni=ni.sibling}Yt.type===f?(Mt=ba(Yt.props.children,Ut.mode,Te,Yt.key),Mt.return=Ut,Ut=Mt):(Te=jh(Yt.type,Yt.key,Yt.props,null,Ut.mode,Te),Te.ref=hn(Ut,Mt,Yt),Te.return=Ut,Ut=Te)}return it(Ut);case d:t:{for(ni=Yt.key;Mt!==null;){if(Mt.key===ni)if(Mt.tag===4&&Mt.stateNode.containerInfo===Yt.containerInfo&&Mt.stateNode.implementation===Yt.implementation){h(Ut,Mt.sibling),Mt=v(Mt,Yt.children||[]),Mt.return=Ut,Ut=Mt;break t}else{h(Ut,Mt);break}else i(Ut,Mt);Mt=Mt.sibling}Mt=du(Yt,Ut.mode,Te),Mt.return=Ut,Ut=Mt}return it(Ut);case R:return ni=Yt._init,_s(Ut,Mt,ni(Yt._payload),Te)}if(Tt(Yt))return Di(Ut,Mt,Yt,Te);if(A(Yt))return en(Ut,Mt,Yt,Te);Qr(Ut,Yt)}return typeof Yt=="string"&&Yt!==""||typeof Yt=="number"?(Yt=""+Yt,Mt!==null&&Mt.tag===6?(h(Ut,Mt.sibling),Mt=v(Mt,Yt),Mt.return=Ut,Ut=Mt):(h(Ut,Mt),Mt=cu(Yt,Ut.mode,Te),Mt.return=Ut,Ut=Mt),it(Ut)):h(Ut,Mt)}return _s}var cr=vn(!0),Fn=vn(!1),In=zi(null),Ln=null,er=null,Oe=null;function yn(){Oe=er=Ln=null}function fa(e,i,h){Wt?($(In,i._currentValue),i._currentValue=h):($(In,i._currentValue2),i._currentValue2=h)}function Td(e){var i=In.current;qe(In),Wt?e._currentValue=i:e._currentValue2=i}function ps(e,i,h){for(;e!==null;){var g=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,g!==null&&(g.childLanes|=i)):g!==null&&(g.childLanes&i)!==i&&(g.childLanes|=i),e===h)break;e=e.return}}function $a(e,i){Ln=e,Oe=er=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(Zr=!0),e.firstContext=null)}function Sr(e){var i=Wt?e._currentValue:e._currentValue2;if(Oe!==e)if(e={context:e,memoizedValue:i,next:null},er===null){if(Ln===null)throw Error(o(308));er=e,Ln.dependencies={lanes:0,firstContext:e}}else er=er.next=e;return i}var ga=null;function ms(e){ga===null?ga=[e]:ga.push(e)}function Yp(e,i,h,g){var v=i.interleaved;return v===null?(h.next=h,ms(i)):(h.next=v.next,v.next=h),i.interleaved=h,Pr(e,g)}function Pr(e,i){e.lanes|=i;var h=e.alternate;for(h!==null&&(h.lanes|=i),h=e,e=e.return;e!==null;)e.childLanes|=i,h=e.alternate,h!==null&&(h.childLanes|=i),h=e,e=e.return;return h.tag===3?h.stateNode:null}var Os=!1;function cn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qp(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kt(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function k(e,i,h){var g=e.updateQueue;if(g===null)return null;if(g=g.shared,fi&2){var v=g.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),g.pending=i,Pr(e,h)}return v=g.interleaved,v===null?(i.next=i,ms(g)):(i.next=v.next,v.next=i),g.interleaved=i,Pr(e,h)}function X(e,i,h){if(i=i.updateQueue,i!==null&&(i=i.shared,(h&4194240)!==0)){var g=i.lanes;g&=e.pendingLanes,h|=g,i.lanes=h,Ad(e,h)}}function gt(e,i){var h=e.updateQueue,g=e.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var v=null,P=null;if(h=h.firstBaseUpdate,h!==null){do{var it={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};P===null?v=P=it:P=P.next=it,h=h.next}while(h!==null);P===null?v=P=i:P=P.next=i}else v=P=i;h={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:P,shared:g.shared,effects:g.effects},e.updateQueue=h;return}e=h.lastBaseUpdate,e===null?h.firstBaseUpdate=i:e.next=i,h.lastBaseUpdate=i}function mt(e,i,h,g){var v=e.updateQueue;Os=!1;var P=v.firstBaseUpdate,it=v.lastBaseUpdate,Ct=v.shared.pending;if(Ct!==null){v.shared.pending=null;var Vt=Ct,ge=Vt.next;Vt.next=null,it===null?P=ge:it.next=ge,it=Vt;var Ie=e.alternate;Ie!==null&&(Ie=Ie.updateQueue,Ct=Ie.lastBaseUpdate,Ct!==it&&(Ct===null?Ie.firstBaseUpdate=ge:Ct.next=ge,Ie.lastBaseUpdate=Vt))}if(P!==null){var Ze=v.baseState;it=0,Ie=ge=Vt=null,Ct=P;do{var ke=Ct.lane,Ui=Ct.eventTime;if((g&ke)===ke){Ie!==null&&(Ie=Ie.next={eventTime:Ui,lane:0,tag:Ct.tag,payload:Ct.payload,callback:Ct.callback,next:null});t:{var Di=e,en=Ct;switch(ke=i,Ui=h,en.tag){case 1:if(Di=en.payload,typeof Di=="function"){Ze=Di.call(Ui,Ze,ke);break t}Ze=Di;break t;case 3:Di.flags=Di.flags&-65537|128;case 0:if(Di=en.payload,ke=typeof Di=="function"?Di.call(Ui,Ze,ke):Di,ke==null)break t;Ze=a({},Ze,ke);break t;case 2:Os=!0}}Ct.callback!==null&&Ct.lane!==0&&(e.flags|=64,ke=v.effects,ke===null?v.effects=[Ct]:ke.push(Ct))}else Ui={eventTime:Ui,lane:ke,tag:Ct.tag,payload:Ct.payload,callback:Ct.callback,next:null},Ie===null?(ge=Ie=Ui,Vt=Ze):Ie=Ie.next=Ui,it|=ke;if(Ct=Ct.next,Ct===null){if(Ct=v.shared.pending,Ct===null)break;ke=Ct,Ct=ke.next,ke.next=null,v.lastBaseUpdate=ke,v.shared.pending=null}}while(1);if(Ie===null&&(Vt=Ze),v.baseState=Vt,v.firstBaseUpdate=ge,v.lastBaseUpdate=Ie,i=v.shared.interleaved,i!==null){v=i;do it|=v.lane,v=v.next;while(v!==i)}else P===null&&(v.shared.lanes=0);pa|=it,e.lanes=it,e.memoizedState=Ze}}function Rt(e,i,h){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var g=e[i],v=g.callback;if(v!==null){if(g.callback=null,g=h,typeof v!="function")throw Error(o(191,v));v.call(g)}}}var qt={},re=zi(qt),Xt=zi(qt),be=zi(qt);function fe(e){if(e===qt)throw Error(o(174));return e}function Ye(e,i){$(be,i),$(Xt,e),$(re,qt),e=Qt(i),qe(re),$(re,e)}function We(){qe(re),qe(Xt),qe(be)}function ui(e){var i=fe(be.current),h=fe(re.current);i=ct(h,e.type,i),h!==i&&($(Xt,e),$(re,i))}function pi(e){Xt.current===e&&(qe(re),qe(Xt))}var Qe=zi(0);function xi(e){for(var i=e;i!==null;){if(i.tag===13){var h=i.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||ze(h)||vi(h)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ki=[];function Bi(){for(var e=0;e<Ki.length;e++){var i=Ki[e];Wt?i._workInProgressVersionPrimary=null:i._workInProgressVersionSecondary=null}Ki.length=0}var Kr=c.ReactCurrentDispatcher,vs=c.ReactCurrentBatchConfig,dn=0,Fi=null,Ei=null,ir=null,zs=!1,Qn=!1,Zn=0,Ka=0;function rr(){throw Error(o(321))}function Xa(e,i){if(i===null)return!1;for(var h=0;h<i.length&&h<e.length;h++)if(!Tn(e[h],i[h]))return!1;return!0}function Pd(e,i,h,g,v,P){if(dn=P,Fi=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Kr.current=e===null||e.memoizedState===null?Jx:tw,e=h(g,v),Qn){P=0;do{if(Qn=!1,Zn=0,25<=P)throw Error(o(301));P+=1,ir=Ei=null,i.updateQueue=null,Kr.current=ew,e=h(g,v)}while(Qn)}if(Kr.current=wh,i=Ei!==null&&Ei.next!==null,dn=0,ir=Ei=Fi=null,zs=!1,i)throw Error(o(300));return e}function Md(){var e=Zn!==0;return Zn=0,e}function Jn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ir===null?Fi.memoizedState=ir=e:ir=ir.next=e,ir}function bn(){if(Ei===null){var e=Fi.alternate;e=e!==null?e.memoizedState:null}else e=Ei.next;var i=ir===null?Fi.memoizedState:ir.next;if(i!==null)ir=i,Ei=e;else{if(e===null)throw Error(o(310));Ei=e,e={memoizedState:Ei.memoizedState,baseState:Ei.baseState,baseQueue:Ei.baseQueue,queue:Ei.queue,next:null},ir===null?Fi.memoizedState=ir=e:ir=ir.next=e}return ir}function Po(e,i){return typeof i=="function"?i(e):i}function Rd(e){var i=bn(),h=i.queue;if(h===null)throw Error(o(311));h.lastRenderedReducer=e;var g=Ei,v=g.baseQueue,P=h.pending;if(P!==null){if(v!==null){var it=v.next;v.next=P.next,P.next=it}g.baseQueue=v=P,h.pending=null}if(v!==null){P=v.next,g=g.baseState;var Ct=it=null,Vt=null,ge=P;do{var Ie=ge.lane;if((dn&Ie)===Ie)Vt!==null&&(Vt=Vt.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),g=ge.hasEagerState?ge.eagerState:e(g,ge.action);else{var Ze={lane:Ie,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};Vt===null?(Ct=Vt=Ze,it=g):Vt=Vt.next=Ze,Fi.lanes|=Ie,pa|=Ie}ge=ge.next}while(ge!==null&&ge!==P);Vt===null?it=g:Vt.next=Ct,Tn(g,i.memoizedState)||(Zr=!0),i.memoizedState=g,i.baseState=it,i.baseQueue=Vt,h.lastRenderedState=g}if(e=h.interleaved,e!==null){v=e;do P=v.lane,Fi.lanes|=P,pa|=P,v=v.next;while(v!==e)}else v===null&&(h.lanes=0);return[i.memoizedState,h.dispatch]}function Fd(e){var i=bn(),h=i.queue;if(h===null)throw Error(o(311));h.lastRenderedReducer=e;var g=h.dispatch,v=h.pending,P=i.memoizedState;if(v!==null){h.pending=null;var it=v=v.next;do P=e(P,it.action),it=it.next;while(it!==v);Tn(P,i.memoizedState)||(Zr=!0),i.memoizedState=P,i.baseQueue===null&&(i.baseState=P),h.lastRenderedState=P}return[P,g]}function Qp(){}function Zp(e,i){var h=Fi,g=bn(),v=i(),P=!Tn(g.memoizedState,v);if(P&&(g.memoizedState=v,Zr=!0),g=g.queue,Id(em.bind(null,h,g,e),[e]),g.getSnapshot!==i||P||ir!==null&&ir.memoizedState.tag&1){if(h.flags|=2048,Mo(9,tm.bind(null,h,g,v,i),void 0,null),Er===null)throw Error(o(349));dn&30||Jp(h,i,v)}return v}function Jp(e,i,h){e.flags|=16384,e={getSnapshot:i,value:h},i=Fi.updateQueue,i===null?(i={lastEffect:null,stores:null},Fi.updateQueue=i,i.stores=[e]):(h=i.stores,h===null?i.stores=[e]:h.push(e))}function tm(e,i,h,g){i.value=h,i.getSnapshot=g,im(i)&&rm(e)}function em(e,i,h){return h(function(){im(i)&&rm(e)})}function im(e){var i=e.getSnapshot;e=e.value;try{var h=i();return!Tn(e,h)}catch{return!0}}function rm(e){var i=Pr(e,1);i!==null&&_n(i,e,1,-1)}function nm(e){var i=Jn();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:e},i.queue=e,e=e.dispatch=Zx.bind(null,Fi,e),[i.memoizedState,e]}function Mo(e,i,h,g){return e={tag:e,create:i,destroy:h,deps:g,next:null},i=Fi.updateQueue,i===null?(i={lastEffect:null,stores:null},Fi.updateQueue=i,i.lastEffect=e.next=e):(h=i.lastEffect,h===null?i.lastEffect=e.next=e:(g=h.next,h.next=e,e.next=g,i.lastEffect=e)),e}function sm(){return bn().memoizedState}function _h(e,i,h,g){var v=Jn();Fi.flags|=e,v.memoizedState=Mo(1|i,h,void 0,g===void 0?null:g)}function xh(e,i,h,g){var v=bn();g=g===void 0?null:g;var P=void 0;if(Ei!==null){var it=Ei.memoizedState;if(P=it.destroy,g!==null&&Xa(g,it.deps)){v.memoizedState=Mo(i,h,P,g);return}}Fi.flags|=e,v.memoizedState=Mo(1|i,h,P,g)}function am(e,i){return _h(8390656,8,e,i)}function Id(e,i){return xh(2048,8,e,i)}function om(e,i){return xh(4,2,e,i)}function lm(e,i){return xh(4,4,e,i)}function hm(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function cm(e,i,h){return h=h!=null?h.concat([e]):null,xh(4,4,hm.bind(null,i,e),h)}function Ld(){}function dm(e,i){var h=bn();i=i===void 0?null:i;var g=h.memoizedState;return g!==null&&i!==null&&Xa(i,g[1])?g[0]:(h.memoizedState=[e,i],e)}function um(e,i){var h=bn();i=i===void 0?null:i;var g=h.memoizedState;return g!==null&&i!==null&&Xa(i,g[1])?g[0]:(e=e(),h.memoizedState=[e,i],e)}function fm(e,i,h){return dn&21?(Tn(h,i)||(h=Wp(),Fi.lanes|=h,pa|=h,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,Zr=!0),e.memoizedState=h)}function qx(e,i){var h=di;di=h!==0&&4>h?h:4,e(!0);var g=vs.transition;vs.transition={};try{e(!1),i()}finally{di=h,vs.transition=g}}function gm(){return bn().memoizedState}function Qx(e,i,h){var g=Us(e);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},pm(e))mm(i,h);else if(h=Yp(e,i,h,g),h!==null){var v=Hr();_n(h,e,g,v),vm(h,i,g)}}function Zx(e,i,h){var g=Us(e),v={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(pm(e))mm(i,v);else{var P=e.alternate;if(e.lanes===0&&(P===null||P.lanes===0)&&(P=i.lastRenderedReducer,P!==null))try{var it=i.lastRenderedState,Ct=P(it,h);if(v.hasEagerState=!0,v.eagerState=Ct,Tn(Ct,it)){var Vt=i.interleaved;Vt===null?(v.next=v,ms(i)):(v.next=Vt.next,Vt.next=v),i.interleaved=v;return}}catch{}finally{}h=Yp(e,i,v,g),h!==null&&(v=Hr(),_n(h,e,g,v),vm(h,i,g))}}function pm(e){var i=e.alternate;return e===Fi||i!==null&&i===Fi}function mm(e,i){Qn=zs=!0;var h=e.pending;h===null?i.next=i:(i.next=h.next,h.next=i),e.pending=i}function vm(e,i,h){if(h&4194240){var g=i.lanes;g&=e.pendingLanes,h|=g,i.lanes=h,Ad(e,h)}}var wh={readContext:Sr,useCallback:rr,useContext:rr,useEffect:rr,useImperativeHandle:rr,useInsertionEffect:rr,useLayoutEffect:rr,useMemo:rr,useReducer:rr,useRef:rr,useState:rr,useDebugValue:rr,useDeferredValue:rr,useTransition:rr,useMutableSource:rr,useSyncExternalStore:rr,useId:rr,unstable_isNewReconciler:!1},Jx={readContext:Sr,useCallback:function(e,i){return Jn().memoizedState=[e,i===void 0?null:i],e},useContext:Sr,useEffect:am,useImperativeHandle:function(e,i,h){return h=h!=null?h.concat([e]):null,_h(4194308,4,hm.bind(null,i,e),h)},useLayoutEffect:function(e,i){return _h(4194308,4,e,i)},useInsertionEffect:function(e,i){return _h(4,2,e,i)},useMemo:function(e,i){var h=Jn();return i=i===void 0?null:i,e=e(),h.memoizedState=[e,i],e},useReducer:function(e,i,h){var g=Jn();return i=h!==void 0?h(i):i,g.memoizedState=g.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},g.queue=e,e=e.dispatch=Qx.bind(null,Fi,e),[g.memoizedState,e]},useRef:function(e){var i=Jn();return e={current:e},i.memoizedState=e},useState:nm,useDebugValue:Ld,useDeferredValue:function(e){return Jn().memoizedState=e},useTransition:function(){var e=nm(!1),i=e[0];return e=qx.bind(null,e[1]),Jn().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,h){var g=Fi,v=Jn();if($i){if(h===void 0)throw Error(o(407));h=h()}else{if(h=i(),Er===null)throw Error(o(349));dn&30||Jp(g,i,h)}v.memoizedState=h;var P={value:h,getSnapshot:i};return v.queue=P,am(em.bind(null,g,P,e),[e]),g.flags|=2048,Mo(9,tm.bind(null,g,P,h,i),void 0,null),h},useId:function(){var e=Jn(),i=Er.identifierPrefix;if($i){var h=Tr,g=$r;h=(g&~(1<<32-wr(g)-1)).toString(32)+h,i=":"+i+"R"+h,h=Zn++,0<h&&(i+="H"+h.toString(32)),i+=":"}else h=Ka++,i=":"+i+"r"+h.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},tw={readContext:Sr,useCallback:dm,useContext:Sr,useEffect:Id,useImperativeHandle:cm,useInsertionEffect:om,useLayoutEffect:lm,useMemo:um,useReducer:Rd,useRef:sm,useState:function(){return Rd(Po)},useDebugValue:Ld,useDeferredValue:function(e){var i=bn();return fm(i,Ei.memoizedState,e)},useTransition:function(){var e=Rd(Po)[0],i=bn().memoizedState;return[e,i]},useMutableSource:Qp,useSyncExternalStore:Zp,useId:gm,unstable_isNewReconciler:!1},ew={readContext:Sr,useCallback:dm,useContext:Sr,useEffect:Id,useImperativeHandle:cm,useInsertionEffect:om,useLayoutEffect:lm,useMemo:um,useReducer:Fd,useRef:sm,useState:function(){return Fd(Po)},useDebugValue:Ld,useDeferredValue:function(e){var i=bn();return Ei===null?i.memoizedState=e:fm(i,Ei.memoizedState,e)},useTransition:function(){var e=Fd(Po)[0],i=bn().memoizedState;return[e,i]},useMutableSource:Qp,useSyncExternalStore:Zp,useId:gm,unstable_isNewReconciler:!1};function Dn(e,i){if(e&&e.defaultProps){i=a({},i),e=e.defaultProps;for(var h in e)i[h]===void 0&&(i[h]=e[h]);return i}return i}function Dd(e,i,h,g){i=e.memoizedState,h=h(g,i),h=h==null?i:a({},i,h),e.memoizedState=h,e.lanes===0&&(e.updateQueue.baseState=h)}var Ah={isMounted:function(e){return(e=e._reactInternals)?F(e)===e:!1},enqueueSetState:function(e,i,h){e=e._reactInternals;var g=Hr(),v=Us(e),P=kt(g,v);P.payload=i,h!=null&&(P.callback=h),i=k(e,P,v),i!==null&&(_n(i,e,v,g),X(i,e,v))},enqueueReplaceState:function(e,i,h){e=e._reactInternals;var g=Hr(),v=Us(e),P=kt(g,v);P.tag=1,P.payload=i,h!=null&&(P.callback=h),i=k(e,P,v),i!==null&&(_n(i,e,v,g),X(i,e,v))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var h=Hr(),g=Us(e),v=kt(h,g);v.tag=2,i!=null&&(v.callback=i),i=k(e,v,g),i!==null&&(_n(i,e,g,h),X(i,e,g))}};function ym(e,i,h,g,v,P,it){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(g,P,it):i.prototype&&i.prototype.isPureReactComponent?!Rn(h,g)||!Rn(v,P):!0}function bm(e,i,h){var g=!1,v=At,P=i.contextType;return typeof P=="object"&&P!==null?P=Sr(P):(v=Se(i)?de:Zt.current,g=i.contextTypes,P=(g=g!=null)?Ce(e,v):At),i=new i(h,P),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ah,e.stateNode=i,i._reactInternals=e,g&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=v,e.__reactInternalMemoizedMaskedChildContext=P),i}function _m(e,i,h,g){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(h,g),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(h,g),i.state!==e&&Ah.enqueueReplaceState(i,i.state,null)}function Nd(e,i,h,g){var v=e.stateNode;v.props=h,v.state=e.memoizedState,v.refs={},cn(e);var P=i.contextType;typeof P=="object"&&P!==null?v.context=Sr(P):(P=Se(i)?de:Zt.current,v.context=Ce(e,P)),v.state=e.memoizedState,P=i.getDerivedStateFromProps,typeof P=="function"&&(Dd(e,i,P,h),v.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(i=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),i!==v.state&&Ah.enqueueReplaceState(v,v.state,null),mt(e,h,v,g),v.state=e.memoizedState),typeof v.componentDidMount=="function"&&(e.flags|=4194308)}function Ya(e,i){try{var h="",g=i;do h+=pn(g),g=g.return;while(g);var v=h}catch(P){v=`
Error generating stack: `+P.message+`
`+P.stack}return{value:e,source:i,stack:v,digest:null}}function Od(e,i,h){return{value:e,source:null,stack:h??null,digest:i??null}}function zd(e,i){try{console.error(i.value)}catch(h){setTimeout(function(){throw h})}}var iw=typeof WeakMap=="function"?WeakMap:Map;function xm(e,i,h){h=kt(-1,h),h.tag=3,h.payload={element:null};var g=i.value;return h.callback=function(){Oh||(Oh=!0,ru=g),zd(e,i)},h}function wm(e,i,h){h=kt(-1,h),h.tag=3;var g=e.type.getDerivedStateFromError;if(typeof g=="function"){var v=i.value;h.payload=function(){return g(v)},h.callback=function(){zd(e,i)}}var P=e.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(h.callback=function(){zd(e,i),typeof g!="function"&&(Hs===null?Hs=new Set([this]):Hs.add(this));var it=i.stack;this.componentDidCatch(i.value,{componentStack:it!==null?it:""})}),h}function Am(e,i,h){var g=e.pingCache;if(g===null){g=e.pingCache=new iw;var v=new Set;g.set(i,v)}else v=g.get(i),v===void 0&&(v=new Set,g.set(i,v));v.has(h)||(v.add(h),e=mw.bind(null,e,i,h),i.then(e,e))}function Sm(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Em(e,i,h,g,v){return e.mode&1?(e.flags|=65536,e.lanes=v,e):(e===i?e.flags|=65536:(e.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(i=kt(-1,1),i.tag=2,k(h,i,1))),h.lanes|=1),e)}var rw=c.ReactCurrentOwner,Zr=!1;function Xr(e,i,h,g){i.child=e===null?Fn(i,null,h,g):cr(i,e.child,h,g)}function Cm(e,i,h,g,v){h=h.render;var P=i.ref;return $a(i,v),g=Pd(e,i,h,g,P,v),h=Md(),e!==null&&!Zr?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~v,ys(e,i,v)):($i&&h&&Cd(i),i.flags|=1,Xr(e,i,g,v),i.child)}function km(e,i,h,g,v){if(e===null){var P=h.type;return typeof P=="function"&&!hu(P)&&P.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(i.tag=15,i.type=P,Tm(e,i,P,g,v)):(e=jh(h.type,null,g,i,i.mode,v),e.ref=i.ref,e.return=i,i.child=e)}if(P=e.child,!(e.lanes&v)){var it=P.memoizedProps;if(h=h.compare,h=h!==null?h:Rn,h(it,g)&&e.ref===i.ref)return ys(e,i,v)}return i.flags|=1,e=js(P,g),e.ref=i.ref,e.return=i,i.child=e}function Tm(e,i,h,g,v){if(e!==null){var P=e.memoizedProps;if(Rn(P,g)&&e.ref===i.ref)if(Zr=!1,i.pendingProps=g=P,(e.lanes&v)!==0)e.flags&131072&&(Zr=!0);else return i.lanes=e.lanes,ys(e,i,v)}return Hd(e,i,h,g,v)}function Pm(e,i,h){var g=i.pendingProps,v=g.children,P=e!==null?e.memoizedState:null;if(g.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},$(Qa,un),un|=h;else{if(!(h&1073741824))return e=P!==null?P.baseLanes|h:h,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,$(Qa,un),un|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=P!==null?P.baseLanes:h,$(Qa,un),un|=g}else P!==null?(g=P.baseLanes|h,i.memoizedState=null):g=h,$(Qa,un),un|=g;return Xr(e,i,v,h),i.child}function Mm(e,i){var h=i.ref;(e===null&&h!==null||e!==null&&e.ref!==h)&&(i.flags|=512,i.flags|=2097152)}function Hd(e,i,h,g,v){var P=Se(h)?de:Zt.current;return P=Ce(i,P),$a(i,v),h=Pd(e,i,h,g,P,v),g=Md(),e!==null&&!Zr?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~v,ys(e,i,v)):($i&&g&&Cd(i),i.flags|=1,Xr(e,i,h,v),i.child)}function Rm(e,i,h,g,v){if(Se(h)){var P=!0;Hi(i)}else P=!1;if($a(i,v),i.stateNode===null)Eh(e,i),bm(i,h,g),Nd(i,h,g,v),g=!0;else if(e===null){var it=i.stateNode,Ct=i.memoizedProps;it.props=Ct;var Vt=it.context,ge=h.contextType;typeof ge=="object"&&ge!==null?ge=Sr(ge):(ge=Se(h)?de:Zt.current,ge=Ce(i,ge));var Ie=h.getDerivedStateFromProps,Ze=typeof Ie=="function"||typeof it.getSnapshotBeforeUpdate=="function";Ze||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(Ct!==g||Vt!==ge)&&_m(i,it,g,ge),Os=!1;var ke=i.memoizedState;it.state=ke,mt(i,g,it,v),Vt=i.memoizedState,Ct!==g||ke!==Vt||ae.current||Os?(typeof Ie=="function"&&(Dd(i,h,Ie,g),Vt=i.memoizedState),(Ct=Os||ym(i,h,Ct,g,ke,Vt,ge))?(Ze||typeof it.UNSAFE_componentWillMount!="function"&&typeof it.componentWillMount!="function"||(typeof it.componentWillMount=="function"&&it.componentWillMount(),typeof it.UNSAFE_componentWillMount=="function"&&it.UNSAFE_componentWillMount()),typeof it.componentDidMount=="function"&&(i.flags|=4194308)):(typeof it.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=g,i.memoizedState=Vt),it.props=g,it.state=Vt,it.context=ge,g=Ct):(typeof it.componentDidMount=="function"&&(i.flags|=4194308),g=!1)}else{it=i.stateNode,qp(e,i),Ct=i.memoizedProps,ge=i.type===i.elementType?Ct:Dn(i.type,Ct),it.props=ge,Ze=i.pendingProps,ke=it.context,Vt=h.contextType,typeof Vt=="object"&&Vt!==null?Vt=Sr(Vt):(Vt=Se(h)?de:Zt.current,Vt=Ce(i,Vt));var Ui=h.getDerivedStateFromProps;(Ie=typeof Ui=="function"||typeof it.getSnapshotBeforeUpdate=="function")||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(Ct!==Ze||ke!==Vt)&&_m(i,it,g,Vt),Os=!1,ke=i.memoizedState,it.state=ke,mt(i,g,it,v);var Di=i.memoizedState;Ct!==Ze||ke!==Di||ae.current||Os?(typeof Ui=="function"&&(Dd(i,h,Ui,g),Di=i.memoizedState),(ge=Os||ym(i,h,ge,g,ke,Di,Vt)||!1)?(Ie||typeof it.UNSAFE_componentWillUpdate!="function"&&typeof it.componentWillUpdate!="function"||(typeof it.componentWillUpdate=="function"&&it.componentWillUpdate(g,Di,Vt),typeof it.UNSAFE_componentWillUpdate=="function"&&it.UNSAFE_componentWillUpdate(g,Di,Vt)),typeof it.componentDidUpdate=="function"&&(i.flags|=4),typeof it.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof it.componentDidUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=1024),i.memoizedProps=g,i.memoizedState=Di),it.props=g,it.state=Di,it.context=Vt,g=ge):(typeof it.componentDidUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||Ct===e.memoizedProps&&ke===e.memoizedState||(i.flags|=1024),g=!1)}return Bd(e,i,h,g,P,v)}function Bd(e,i,h,g,v,P){Mm(e,i);var it=(i.flags&128)!==0;if(!g&&!it)return v&&qr(i,h,!1),ys(e,i,P);g=i.stateNode,rw.current=i;var Ct=it&&typeof h.getDerivedStateFromError!="function"?null:g.render();return i.flags|=1,e!==null&&it?(i.child=cr(i,e.child,null,P),i.child=cr(i,null,Ct,P)):Xr(e,i,Ct,P),i.memoizedState=g.state,v&&qr(i,h,!0),i.child}function Fm(e){var i=e.stateNode;i.pendingContext?ci(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ci(e,i.context,!1),Ye(e,i.containerInfo)}function Im(e,i,h,g,v){return Wa(),ua(v),i.flags|=256,Xr(e,i,h,g),i.child}var Ud={dehydrated:null,treeContext:null,retryLane:0};function Gd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lm(e,i,h){var g=i.pendingProps,v=Qe.current,P=!1,it=(i.flags&128)!==0,Ct;if((Ct=it)||(Ct=e!==null&&e.memoizedState===null?!1:(v&2)!==0),Ct?(P=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(v|=1),$(Qe,v&1),e===null)return kd(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?vi(e)?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(it=g.children,e=g.fallback,P?(g=i.mode,P=i.child,it={mode:"hidden",children:it},!(g&1)&&P!==null?(P.childLanes=0,P.pendingProps=it):P=Vh(it,g,0,null),e=ba(e,g,h,null),P.return=i,e.return=i,P.sibling=e,i.child=P,i.child.memoizedState=Gd(h),i.memoizedState=Ud,e):jd(i,it));if(v=e.memoizedState,v!==null&&(Ct=v.dehydrated,Ct!==null))return nw(e,i,it,g,Ct,v,h);if(P){P=g.fallback,it=i.mode,v=e.child,Ct=v.sibling;var Vt={mode:"hidden",children:g.children};return!(it&1)&&i.child!==v?(g=i.child,g.childLanes=0,g.pendingProps=Vt,i.deletions=null):(g=js(v,Vt),g.subtreeFlags=v.subtreeFlags&14680064),Ct!==null?P=js(Ct,P):(P=ba(P,it,h,null),P.flags|=2),P.return=i,g.return=i,g.sibling=P,i.child=g,g=P,P=i.child,it=e.child.memoizedState,it=it===null?Gd(h):{baseLanes:it.baseLanes|h,cachePool:null,transitions:it.transitions},P.memoizedState=it,P.childLanes=e.childLanes&~h,i.memoizedState=Ud,g}return P=e.child,e=P.sibling,g=js(P,{mode:"visible",children:g.children}),!(i.mode&1)&&(g.lanes=h),g.return=i,g.sibling=null,e!==null&&(h=i.deletions,h===null?(i.deletions=[e],i.flags|=16):h.push(e)),i.child=g,i.memoizedState=null,g}function jd(e,i){return i=Vh({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function Sh(e,i,h,g){return g!==null&&ua(g),cr(i,e.child,null,h),e=jd(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function nw(e,i,h,g,v,P,it){if(h)return i.flags&256?(i.flags&=-257,g=Od(Error(o(422))),Sh(e,i,it,g)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(P=g.fallback,v=i.mode,g=Vh({mode:"visible",children:g.children},v,0,null),P=ba(P,v,it,null),P.flags|=2,g.return=i,P.return=i,g.sibling=P,i.child=g,i.mode&1&&cr(i,e.child,null,it),i.child.memoizedState=Gd(it),i.memoizedState=Ud,P);if(!(i.mode&1))return Sh(e,i,it,null);if(vi(v))return g=oi(v).digest,P=Error(o(419)),g=Od(P,g,void 0),Sh(e,i,it,g);if(h=(it&e.childLanes)!==0,Zr||h){if(g=Er,g!==null){switch(it&-it){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=v&(g.suspendedLanes|it)?0:v,v!==0&&v!==P.retryLane&&(P.retryLane=v,Pr(e,v),_n(g,e,v,-1))}return lu(),g=Od(Error(o(421))),Sh(e,i,it,g)}return ze(v)?(i.flags|=128,i.child=e.child,i=vw.bind(null,e),tr(v,i),null):(e=P.treeContext,xe&&(Ar=K(v),ln=i,$i=!0,Mn=null,qn=!1,e!==null&&(hr[Qi++]=$r,hr[Qi++]=Tr,hr[Qi++]=br,$r=e.id,Tr=e.overflow,br=i)),i=jd(i,g.children),i.flags|=4096,i)}function Dm(e,i,h){e.lanes|=i;var g=e.alternate;g!==null&&(g.lanes|=i),ps(e.return,i,h)}function Vd(e,i,h,g,v){var P=e.memoizedState;P===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:v}:(P.isBackwards=i,P.rendering=null,P.renderingStartTime=0,P.last=g,P.tail=h,P.tailMode=v)}function Nm(e,i,h){var g=i.pendingProps,v=g.revealOrder,P=g.tail;if(Xr(e,i,g.children,h),g=Qe.current,g&2)g=g&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dm(e,h,i);else if(e.tag===19)Dm(e,h,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}g&=1}if($(Qe,g),!(i.mode&1))i.memoizedState=null;else switch(v){case"forwards":for(h=i.child,v=null;h!==null;)e=h.alternate,e!==null&&xi(e)===null&&(v=h),h=h.sibling;h=v,h===null?(v=i.child,i.child=null):(v=h.sibling,h.sibling=null),Vd(i,!1,v,h,P);break;case"backwards":for(h=null,v=i.child,i.child=null;v!==null;){if(e=v.alternate,e!==null&&xi(e)===null){i.child=v;break}e=v.sibling,v.sibling=h,h=v,v=e}Vd(i,!0,h,null,P);break;case"together":Vd(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Eh(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function ys(e,i,h){if(e!==null&&(i.dependencies=e.dependencies),pa|=i.lanes,!(h&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(o(153));if(i.child!==null){for(e=i.child,h=js(e,e.pendingProps),i.child=h,h.return=i;e.sibling!==null;)e=e.sibling,h=h.sibling=js(e,e.pendingProps),h.return=i;h.sibling=null}return i.child}function sw(e,i,h){switch(i.tag){case 3:Fm(i),Wa();break;case 5:ui(i);break;case 1:Se(i.type)&&Hi(i);break;case 4:Ye(i,i.stateNode.containerInfo);break;case 10:fa(i,i.type._context,i.memoizedProps.value);break;case 13:var g=i.memoizedState;if(g!==null)return g.dehydrated!==null?($(Qe,Qe.current&1),i.flags|=128,null):h&i.child.childLanes?Lm(e,i,h):($(Qe,Qe.current&1),e=ys(e,i,h),e!==null?e.sibling:null);$(Qe,Qe.current&1);break;case 19:if(g=(h&i.childLanes)!==0,e.flags&128){if(g)return Nm(e,i,h);i.flags|=128}var v=i.memoizedState;if(v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),$(Qe,Qe.current),g)break;return null;case 22:case 23:return i.lanes=0,Pm(e,i,h)}return ys(e,i,h)}function ts(e){e.flags|=4}function Om(e,i){if(e!==null&&e.child===i.child)return!0;if(i.flags&16)return!1;for(e=i.child;e!==null;){if(e.flags&12854||e.subtreeFlags&12854)return!1;e=e.sibling}return!0}var Ro,Fo,Ch,kh;if(ve)Ro=function(e,i){for(var h=i.child;h!==null;){if(h.tag===5||h.tag===6)Jt(e,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===i)break;for(;h.sibling===null;){if(h.return===null||h.return===i)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Fo=function(){},Ch=function(e,i,h,g,v){if(e=e.memoizedProps,e!==g){var P=i.stateNode,it=fe(re.current);h=pe(P,h,e,g,v,it),(i.updateQueue=h)&&ts(i)}},kh=function(e,i,h,g){h!==g&&ts(i)};else if(ie){Ro=function(e,i,h,g){for(var v=i.child;v!==null;){if(v.tag===5){var P=v.stateNode;h&&g&&(P=me(P,v.type,v.memoizedProps,v)),Jt(e,P)}else if(v.tag===6)P=v.stateNode,h&&g&&(P=Pe(P,v.memoizedProps,v)),Jt(e,P);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)P=v.child,P!==null&&(P.return=v),Ro(e,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===i)break;for(;v.sibling===null;){if(v.return===null||v.return===i)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};var zm=function(e,i,h,g){for(var v=i.child;v!==null;){if(v.tag===5){var P=v.stateNode;h&&g&&(P=me(P,v.type,v.memoizedProps,v)),Et(e,P)}else if(v.tag===6)P=v.stateNode,h&&g&&(P=Pe(P,v.memoizedProps,v)),Et(e,P);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)P=v.child,P!==null&&(P.return=v),zm(e,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===i)break;for(;v.sibling===null;){if(v.return===null||v.return===i)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};Fo=function(e,i){var h=i.stateNode;if(!Om(e,i)){e=h.containerInfo;var g=ft(e);zm(g,i,!1,!1),h.pendingChildren=g,ts(i),Kt(e,g)}},Ch=function(e,i,h,g,v){var P=e.stateNode,it=e.memoizedProps;if((e=Om(e,i))&&it===g)i.stateNode=P;else{var Ct=i.stateNode,Vt=fe(re.current),ge=null;it!==g&&(ge=pe(Ct,h,it,g,v,Vt)),e&&ge===null?i.stateNode=P:(P=ot(P,ge,h,it,g,i,e,Ct),oe(P,h,g,v,Vt)&&ts(i),i.stateNode=P,e?ts(i):Ro(P,i,!1,!1))}},kh=function(e,i,h,g){h!==g?(e=fe(be.current),h=fe(re.current),i.stateNode=Ve(g,e,h,i),ts(i)):i.stateNode=e.stateNode}}else Fo=function(){},Ch=function(){},kh=function(){};function Io(e,i){if(!$i)switch(e.tailMode){case"hidden":i=e.tail;for(var h=null;i!==null;)i.alternate!==null&&(h=i),i=i.sibling;h===null?e.tail=null:h.sibling=null;break;case"collapsed":h=e.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:g.sibling=null}}function Or(e){var i=e.alternate!==null&&e.alternate.child===e.child,h=0,g=0;if(i)for(var v=e.child;v!==null;)h|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=e,v=v.sibling;else for(v=e.child;v!==null;)h|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=e,v=v.sibling;return e.subtreeFlags|=g,e.childLanes=h,i}function aw(e,i,h){var g=i.pendingProps;switch(Yn(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(i),null;case 1:return Se(i.type)&&ri(),Or(i),null;case 3:return h=i.stateNode,We(),qe(ae),qe(Zt),Bi(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(e===null||e.child===null)&&(bh(i)?ts(i):e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,Mn!==null&&(au(Mn),Mn=null))),Fo(e,i),Or(i),null;case 5:pi(i),h=fe(be.current);var v=i.type;if(e!==null&&i.stateNode!=null)Ch(e,i,v,g,h),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!g){if(i.stateNode===null)throw Error(o(166));return Or(i),null}if(e=fe(re.current),bh(i)){if(!xe)throw Error(o(175));e=ht(i.stateNode,i.type,i.memoizedProps,h,e,i,!qn),i.updateQueue=e,e!==null&&ts(i)}else{var P=zt(v,g,h,e,i);Ro(P,i,!1,!1),i.stateNode=P,oe(P,v,g,h,e)&&ts(i)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Or(i),null;case 6:if(e&&i.stateNode!=null)kh(e,i,e.memoizedProps,g);else{if(typeof g!="string"&&i.stateNode===null)throw Error(o(166));if(e=fe(be.current),h=fe(re.current),bh(i)){if(!xe)throw Error(o(176));if(e=i.stateNode,h=i.memoizedProps,(g=xt(e,h,i,!qn))&&(v=ln,v!==null))switch(v.tag){case 3:ue(v.stateNode.containerInfo,e,h,(v.mode&1)!==0);break;case 5:he(v.type,v.memoizedProps,v.stateNode,e,h,(v.mode&1)!==0)}g&&ts(i)}else i.stateNode=Ve(g,e,h,i)}return Or(i),null;case 13:if(qe(Qe),g=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($i&&Ar!==null&&i.mode&1&&!(i.flags&128))da(),Wa(),i.flags|=98560,v=!1;else if(v=bh(i),g!==null&&g.dehydrated!==null){if(e===null){if(!v)throw Error(o(318));if(!xe)throw Error(o(344));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(o(317));St(v,i)}else Wa(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;Or(i),v=!1}else Mn!==null&&(au(Mn),Mn=null),v=!0;if(!v)return i.flags&65536?i:null}return i.flags&128?(i.lanes=h,i):(h=g!==null,h!==(e!==null&&e.memoizedState!==null)&&h&&(i.child.flags|=8192,i.mode&1&&(e===null||Qe.current&1?_r===0&&(_r=3):lu())),i.updateQueue!==null&&(i.flags|=4),Or(i),null);case 4:return We(),Fo(e,i),e===null&&ut(i.stateNode.containerInfo),Or(i),null;case 10:return Td(i.type._context),Or(i),null;case 17:return Se(i.type)&&ri(),Or(i),null;case 19:if(qe(Qe),v=i.memoizedState,v===null)return Or(i),null;if(g=(i.flags&128)!==0,P=v.rendering,P===null)if(g)Io(v,!1);else{if(_r!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(P=xi(e),P!==null){for(i.flags|=128,Io(v,!1),e=P.updateQueue,e!==null&&(i.updateQueue=e,i.flags|=4),i.subtreeFlags=0,e=h,h=i.child;h!==null;)g=h,v=e,g.flags&=14680066,P=g.alternate,P===null?(g.childLanes=0,g.lanes=v,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=P.childLanes,g.lanes=P.lanes,g.child=P.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=P.memoizedProps,g.memoizedState=P.memoizedState,g.updateQueue=P.updateQueue,g.type=P.type,v=P.dependencies,g.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),h=h.sibling;return $(Qe,Qe.current&1|2),i.child}e=e.sibling}v.tail!==null&&Wi()>iu&&(i.flags|=128,g=!0,Io(v,!1),i.lanes=4194304)}else{if(!g)if(e=xi(P),e!==null){if(i.flags|=128,g=!0,e=e.updateQueue,e!==null&&(i.updateQueue=e,i.flags|=4),Io(v,!0),v.tail===null&&v.tailMode==="hidden"&&!P.alternate&&!$i)return Or(i),null}else 2*Wi()-v.renderingStartTime>iu&&h!==1073741824&&(i.flags|=128,g=!0,Io(v,!1),i.lanes=4194304);v.isBackwards?(P.sibling=i.child,i.child=P):(e=v.last,e!==null?e.sibling=P:i.child=P,v.last=P)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=Wi(),i.sibling=null,e=Qe.current,$(Qe,g?e&1|2:e&1),i):(Or(i),null);case 22:case 23:return ou(),h=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==h&&(i.flags|=8192),h&&i.mode&1?un&1073741824&&(Or(i),ve&&i.subtreeFlags&6&&(i.flags|=8192)):Or(i),null;case 24:return null;case 25:return null}throw Error(o(156,i.tag))}function ow(e,i){switch(Yn(i),i.tag){case 1:return Se(i.type)&&ri(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return We(),qe(ae),qe(Zt),Bi(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return pi(i),null;case 13:if(qe(Qe),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(o(340));Wa()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return qe(Qe),null;case 4:return We(),null;case 10:return Td(i.type._context),null;case 22:case 23:return ou(),null;case 24:return null;default:return null}}var Th=!1,zr=!1,lw=typeof WeakSet=="function"?WeakSet:Set,Re=null;function qa(e,i){var h=e.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){Xi(e,i,g)}else h.current=null}function Hm(e,i,h){try{h()}catch(g){Xi(e,i,g)}}var Bm=!1;function hw(e,i){for(Dt(e.containerInfo),Re=i;Re!==null;)if(e=Re,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,Re=i;else for(;Re!==null;){e=Re;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var g=h.memoizedProps,v=h.memoizedState,P=e.stateNode,it=P.getSnapshotBeforeUpdate(e.elementType===e.type?g:Dn(e.type,g),v);P.__reactInternalSnapshotBeforeUpdate=it}break;case 3:ve&&q(e.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Ct){Xi(e,e.return,Ct)}if(i=e.sibling,i!==null){i.return=e.return,Re=i;break}Re=e.return}return h=Bm,Bm=!1,h}function Lo(e,i,h){var g=i.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&e)===e){var P=v.destroy;v.destroy=void 0,P!==void 0&&Hm(i,h,P)}v=v.next}while(v!==g)}}function Ph(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var h=i=i.next;do{if((h.tag&e)===e){var g=h.create;h.destroy=g()}h=h.next}while(h!==i)}}function Wd(e){var i=e.ref;if(i!==null){var h=e.stateNode;switch(e.tag){case 5:e=Lt(h);break;default:e=h}typeof i=="function"?i(e):i.current=e}}function Um(e){var i=e.alternate;i!==null&&(e.alternate=null,Um(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&M(i)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Gm(e){return e.tag===5||e.tag===3||e.tag===4}function jm(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Gm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $d(e,i,h){var g=e.tag;if(g===5||g===6)e=e.stateNode,i?Pt(h,e,i):nt(h,e);else if(g!==4&&(e=e.child,e!==null))for($d(e,i,h),e=e.sibling;e!==null;)$d(e,i,h),e=e.sibling}function Kd(e,i,h){var g=e.tag;if(g===5||g===6)e=e.stateNode,i?Ht(h,e,i):et(h,e);else if(g!==4&&(e=e.child,e!==null))for(Kd(e,i,h),e=e.sibling;e!==null;)Kd(e,i,h),e=e.sibling}var Mr=null,Nn=!1;function es(e,i,h){for(h=h.child;h!==null;)Xd(e,i,h),h=h.sibling}function Xd(e,i,h){if(Dr&&typeof Dr.onCommitFiberUnmount=="function")try{Dr.onCommitFiberUnmount(vh,h)}catch{}switch(h.tag){case 5:zr||qa(h,i);case 6:if(ve){var g=Mr,v=Nn;Mr=null,es(e,i,h),Mr=g,Nn=v,Mr!==null&&(Nn?Z(Mr,h.stateNode):Bt(Mr,h.stateNode))}else es(e,i,h);break;case 18:ve&&Mr!==null&&(Nn?$t(Mr,h.stateNode):le(Mr,h.stateNode));break;case 4:ve?(g=Mr,v=Nn,Mr=h.stateNode.containerInfo,Nn=!0,es(e,i,h),Mr=g,Nn=v):(ie&&(g=h.stateNode.containerInfo,v=ft(g),te(g,v)),es(e,i,h));break;case 0:case 11:case 14:case 15:if(!zr&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var P=v,it=P.destroy;P=P.tag,it!==void 0&&(P&2||P&4)&&Hm(h,i,it),v=v.next}while(v!==g)}es(e,i,h);break;case 1:if(!zr&&(qa(h,i),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(Ct){Xi(h,i,Ct)}es(e,i,h);break;case 21:es(e,i,h);break;case 22:h.mode&1?(zr=(g=zr)||h.memoizedState!==null,es(e,i,h),zr=g):es(e,i,h);break;default:es(e,i,h)}}function Vm(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var h=e.stateNode;h===null&&(h=e.stateNode=new lw),i.forEach(function(g){var v=yw.bind(null,e,g);h.has(g)||(h.add(g),g.then(v,v))})}}function On(e,i){var h=i.deletions;if(h!==null)for(var g=0;g<h.length;g++){var v=h[g];try{var P=e,it=i;if(ve){var Ct=it;t:for(;Ct!==null;){switch(Ct.tag){case 5:Mr=Ct.stateNode,Nn=!1;break t;case 3:Mr=Ct.stateNode.containerInfo,Nn=!0;break t;case 4:Mr=Ct.stateNode.containerInfo,Nn=!0;break t}Ct=Ct.return}if(Mr===null)throw Error(o(160));Xd(P,it,v),Mr=null,Nn=!1}else Xd(P,it,v);var Vt=v.alternate;Vt!==null&&(Vt.return=null),v.return=null}catch(ge){Xi(v,i,ge)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Wm(i,e),i=i.sibling}function Wm(e,i){var h=e.alternate,g=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(On(i,e),is(e),g&4){try{Lo(3,e,e.return),Ph(3,e)}catch(ke){Xi(e,e.return,ke)}try{Lo(5,e,e.return)}catch(ke){Xi(e,e.return,ke)}}break;case 1:On(i,e),is(e),g&512&&h!==null&&qa(h,h.return);break;case 5:if(On(i,e),is(e),g&512&&h!==null&&qa(h,h.return),ve){if(e.flags&32){var v=e.stateNode;try{at(v)}catch(ke){Xi(e,e.return,ke)}}if(g&4&&(v=e.stateNode,v!=null)){var P=e.memoizedProps;if(h=h!==null?h.memoizedProps:P,g=e.type,i=e.updateQueue,e.updateQueue=null,i!==null)try{Nt(v,i,g,h,P,e)}catch(ke){Xi(e,e.return,ke)}}}break;case 6:if(On(i,e),is(e),g&4&&ve){if(e.stateNode===null)throw Error(o(162));v=e.stateNode,P=e.memoizedProps,h=h!==null?h.memoizedProps:P;try{pt(v,h,P)}catch(ke){Xi(e,e.return,ke)}}break;case 3:if(On(i,e),is(e),g&4){if(ve&&xe&&h!==null&&h.memoizedState.isDehydrated)try{Ot(i.containerInfo)}catch(ke){Xi(e,e.return,ke)}if(ie){v=i.containerInfo,P=i.pendingChildren;try{te(v,P)}catch(ke){Xi(e,e.return,ke)}}}break;case 4:if(On(i,e),is(e),g&4&&ie){P=e.stateNode,v=P.containerInfo,P=P.pendingChildren;try{te(v,P)}catch(ke){Xi(e,e.return,ke)}}break;case 13:On(i,e),is(e),v=e.child,v.flags&8192&&(P=v.memoizedState!==null,v.stateNode.isHidden=P,!P||v.alternate!==null&&v.alternate.memoizedState!==null||(eu=Wi())),g&4&&Vm(e);break;case 22:var it=h!==null&&h.memoizedState!==null;if(e.mode&1?(zr=(h=zr)||it,On(i,e),zr=h):On(i,e),is(e),g&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!it&&e.mode&1)for(Re=e,g=e.child;g!==null;){for(i=Re=g;Re!==null;){it=Re;var Ct=it.child;switch(it.tag){case 0:case 11:case 14:case 15:Lo(4,it,it.return);break;case 1:qa(it,it.return);var Vt=it.stateNode;if(typeof Vt.componentWillUnmount=="function"){var ge=it,Ie=it.return;try{var Ze=ge;Vt.props=Ze.memoizedProps,Vt.state=Ze.memoizedState,Vt.componentWillUnmount()}catch(ke){Xi(ge,Ie,ke)}}break;case 5:qa(it,it.return);break;case 22:if(it.memoizedState!==null){Xm(i);continue}}Ct!==null?(Ct.return=it,Re=Ct):Xm(i)}g=g.sibling}if(ve){t:if(g=null,ve)for(i=e;;){if(i.tag===5){if(g===null){g=i;try{v=i.stateNode,h?_t(v):jt(i.stateNode,i.memoizedProps)}catch(ke){Xi(e,e.return,ke)}}}else if(i.tag===6){if(g===null)try{P=i.stateNode,h?vt(P):bt(P,i.memoizedProps)}catch(ke){Xi(e,e.return,ke)}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;g===i&&(g=null),i=i.return}g===i&&(g=null),i.sibling.return=i.return,i=i.sibling}}}break;case 19:On(i,e),is(e),g&4&&Vm(e);break;case 21:break;default:On(i,e),is(e)}}function is(e){var i=e.flags;if(i&2){try{if(ve){t:{for(var h=e.return;h!==null;){if(Gm(h)){var g=h;break t}h=h.return}throw Error(o(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&(at(v),g.flags&=-33);var P=jm(e);Kd(e,P,v);break;case 3:case 4:var it=g.stateNode.containerInfo,Ct=jm(e);$d(e,Ct,it);break;default:throw Error(o(161))}}}catch(Vt){Xi(e,e.return,Vt)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function cw(e,i,h){Re=e,$m(e)}function $m(e,i,h){for(var g=(e.mode&1)!==0;Re!==null;){var v=Re,P=v.child;if(v.tag===22&&g){var it=v.memoizedState!==null||Th;if(!it){var Ct=v.alternate,Vt=Ct!==null&&Ct.memoizedState!==null||zr;Ct=Th;var ge=zr;if(Th=it,(zr=Vt)&&!ge)for(Re=v;Re!==null;)it=Re,Vt=it.child,it.tag===22&&it.memoizedState!==null?Ym(v):Vt!==null?(Vt.return=it,Re=Vt):Ym(v);for(;P!==null;)Re=P,$m(P),P=P.sibling;Re=v,Th=Ct,zr=ge}Km(e)}else v.subtreeFlags&8772&&P!==null?(P.return=v,Re=P):Km(e)}}function Km(e){for(;Re!==null;){var i=Re;if(i.flags&8772){var h=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:zr||Ph(5,i);break;case 1:var g=i.stateNode;if(i.flags&4&&!zr)if(h===null)g.componentDidMount();else{var v=i.elementType===i.type?h.memoizedProps:Dn(i.type,h.memoizedProps);g.componentDidUpdate(v,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var P=i.updateQueue;P!==null&&Rt(i,P,g);break;case 3:var it=i.updateQueue;if(it!==null){if(h=null,i.child!==null)switch(i.child.tag){case 5:h=Lt(i.child.stateNode);break;case 1:h=i.child.stateNode}Rt(i,it,h)}break;case 5:var Ct=i.stateNode;h===null&&i.flags&4&&yt(Ct,i.type,i.memoizedProps,i);break;case 6:break;case 4:break;case 12:break;case 13:if(xe&&i.memoizedState===null){var Vt=i.alternate;if(Vt!==null){var ge=Vt.memoizedState;if(ge!==null){var Ie=ge.dehydrated;Ie!==null&&ye(Ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}zr||i.flags&512&&Wd(i)}catch(Ze){Xi(i,i.return,Ze)}}if(i===e){Re=null;break}if(h=i.sibling,h!==null){h.return=i.return,Re=h;break}Re=i.return}}function Xm(e){for(;Re!==null;){var i=Re;if(i===e){Re=null;break}var h=i.sibling;if(h!==null){h.return=i.return,Re=h;break}Re=i.return}}function Ym(e){for(;Re!==null;){var i=Re;try{switch(i.tag){case 0:case 11:case 15:var h=i.return;try{Ph(4,i)}catch(Vt){Xi(i,h,Vt)}break;case 1:var g=i.stateNode;if(typeof g.componentDidMount=="function"){var v=i.return;try{g.componentDidMount()}catch(Vt){Xi(i,v,Vt)}}var P=i.return;try{Wd(i)}catch(Vt){Xi(i,P,Vt)}break;case 5:var it=i.return;try{Wd(i)}catch(Vt){Xi(i,it,Vt)}}}catch(Vt){Xi(i,i.return,Vt)}if(i===e){Re=null;break}var Ct=i.sibling;if(Ct!==null){Ct.return=i.return,Re=Ct;break}Re=i.return}}var Mh=0,Rh=1,Fh=2,Ih=3,Lh=4;if(typeof Symbol=="function"&&Symbol.for){var Do=Symbol.for;Mh=Do("selector.component"),Rh=Do("selector.has_pseudo_class"),Fh=Do("selector.role"),Ih=Do("selector.test_id"),Lh=Do("selector.text")}function Yd(e){var i=_e(e);if(i!=null){if(typeof i.memoizedProps["data-testname"]!="string")throw Error(o(364));return i}if(e=V(e),e===null)throw Error(o(362));return e.stateNode.current}function qd(e,i){switch(i.$$typeof){case Mh:if(e.type===i.value)return!0;break;case Rh:t:{i=i.value,e=[e,0];for(var h=0;h<e.length;){var g=e[h++],v=e[h++],P=i[v];if(g.tag!==5||!W(g)){for(;P!=null&&qd(g,P);)v++,P=i[v];if(v===i.length){i=!0;break t}else for(g=g.child;g!==null;)e.push(g,v),g=g.sibling}}i=!1}return i;case Fh:if(e.tag===5&&U(e.stateNode,i.value))return!0;break;case Lh:if((e.tag===5||e.tag===6)&&(e=G(e),e!==null&&0<=e.indexOf(i.value)))return!0;break;case Ih:if(e.tag===5&&(e=e.memoizedProps["data-testname"],typeof e=="string"&&e.toLowerCase()===i.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Qd(e){switch(e.$$typeof){case Mh:return"<"+(C(e.value)||"Unknown")+">";case Rh:return":has("+(Qd(e)||"")+")";case Fh:return'[role="'+e.value+'"]';case Lh:return'"'+e.value+'"';case Ih:return'[data-testname="'+e.value+'"]';default:throw Error(o(365))}}function qm(e,i){var h=[];e=[e,0];for(var g=0;g<e.length;){var v=e[g++],P=e[g++],it=i[P];if(v.tag!==5||!W(v)){for(;it!=null&&qd(v,it);)P++,it=i[P];if(P===i.length)h.push(v);else for(v=v.child;v!==null;)e.push(v,P),v=v.sibling}}return h}function Zd(e,i){if(!L)throw Error(o(363));e=Yd(e),e=qm(e,i),i=[],e=Array.from(e);for(var h=0;h<e.length;){var g=e[h++];if(g.tag===5)W(g)||i.push(g.stateNode);else for(g=g.child;g!==null;)e.push(g),g=g.sibling}return i}var dw=Math.ceil,Dh=c.ReactCurrentDispatcher,Jd=c.ReactCurrentOwner,ar=c.ReactCurrentBatchConfig,fi=0,Er=null,dr=null,Rr=0,un=0,Qa=zi(0),_r=0,No=null,pa=0,Nh=0,tu=0,Oo=null,Jr=null,eu=0,iu=1/0,bs=null;function Za(){iu=Wi()+500}var Oh=!1,ru=null,Hs=null,zh=!1,Bs=null,Hh=0,zo=0,nu=null,Bh=-1,Uh=0;function Hr(){return fi&6?Wi():Bh!==-1?Bh:Bh=Wi()}function Us(e){return e.mode&1?fi&2&&Rr!==0?Rr&-Rr:gs.transition!==null?(Uh===0&&(Uh=Wp()),Uh):(e=di,e!==0?e:T()):1}function _n(e,i,h,g){if(50<zo)throw zo=0,nu=null,Error(o(185));To(e,h,g),(!(fi&2)||e!==Er)&&(e===Er&&(!(fi&2)&&(Nh|=h),_r===4&&Gs(e,Rr)),tn(e,g),h===1&&fi===0&&!(i.mode&1)&&(Za(),yh&&yr()))}function tn(e,i){var h=e.callbackNode;Kx(e,i);var g=mh(e,e===Er?Rr:0);if(g===0)h!==null&&Kp(h),e.callbackNode=null,e.callbackPriority=0;else if(i=g&-g,e.callbackPriority!==i){if(h!=null&&Kp(h),i===1)e.tag===0?vr(Zm.bind(null,e)):lr(Zm.bind(null,e)),D?H(function(){!(fi&6)&&yr()}):Kn(Sd,yr),h=null;else{switch($p(g)){case 1:h=Sd;break;case 4:h=ja;break;case 16:h=Ed;break;case 536870912:h=Va;break;default:h=Ed}h=o0(h,Qm.bind(null,e))}e.callbackPriority=i,e.callbackNode=h}}function Qm(e,i){if(Bh=-1,Uh=0,fi&6)throw Error(o(327));var h=e.callbackNode;if(ya()&&e.callbackNode!==h)return null;var g=mh(e,e===Er?Rr:0);if(g===0)return null;if(g&30||g&e.expiredLanes||i)i=Gh(e,g);else{i=g;var v=fi;fi|=2;var P=e0();(Er!==e||Rr!==i)&&(bs=null,Za(),ma(e,i));do try{gw();break}catch(Ct){t0(e,Ct)}while(1);yn(),Dh.current=P,fi=v,dr!==null?i=0:(Er=null,Rr=0,i=_r)}if(i!==0){if(i===2&&(v=Vn(e),v!==0&&(g=v,i=su(e,v))),i===1)throw h=No,ma(e,0),Gs(e,g),tn(e,Wi()),h;if(i===6)Gs(e,g);else{if(v=e.current.alternate,!(g&30)&&!uw(v)&&(i=Gh(e,g),i===2&&(P=Vn(e),P!==0&&(g=P,i=su(e,P))),i===1))throw h=No,ma(e,0),Gs(e,g),tn(e,Wi()),h;switch(e.finishedWork=v,e.finishedLanes=g,i){case 0:case 1:throw Error(o(345));case 2:va(e,Jr,bs);break;case 3:if(Gs(e,g),(g&130023424)===g&&(i=eu+500-Wi(),10<i)){if(mh(e,0)!==0)break;if(v=e.suspendedLanes,(v&g)!==g){Hr(),e.pingedLanes|=e.suspendedLanes&v;break}e.timeoutHandle=Gt(va.bind(null,e,Jr,bs),i);break}va(e,Jr,bs);break;case 4:if(Gs(e,g),(g&4194240)===g)break;for(i=e.eventTimes,v=-1;0<g;){var it=31-wr(g);P=1<<it,it=i[it],it>v&&(v=it),g&=~P}if(g=v,g=Wi()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*dw(g/1960))-g,10<g){e.timeoutHandle=Gt(va.bind(null,e,Jr,bs),g);break}va(e,Jr,bs);break;case 5:va(e,Jr,bs);break;default:throw Error(o(329))}}}return tn(e,Wi()),e.callbackNode===h?Qm.bind(null,e):null}function su(e,i){var h=Oo;return e.current.memoizedState.isDehydrated&&(ma(e,i).flags|=256),e=Gh(e,i),e!==2&&(i=Jr,Jr=h,i!==null&&au(i)),e}function au(e){Jr===null?Jr=e:Jr.push.apply(Jr,e)}function uw(e){for(var i=e;;){if(i.flags&16384){var h=i.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var v=h[g],P=v.getSnapshot;v=v.value;try{if(!Tn(P(),v))return!1}catch{return!1}}}if(h=i.child,i.subtreeFlags&16384&&h!==null)h.return=i,i=h;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Gs(e,i){for(i&=~tu,i&=~Nh,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var h=31-wr(i),g=1<<h;e[h]=-1,i&=~g}}function Zm(e){if(fi&6)throw Error(o(327));ya();var i=mh(e,0);if(!(i&1))return tn(e,Wi()),null;var h=Gh(e,i);if(e.tag!==0&&h===2){var g=Vn(e);g!==0&&(i=g,h=su(e,g))}if(h===1)throw h=No,ma(e,0),Gs(e,i),tn(e,Wi()),h;if(h===6)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,va(e,Jr,bs),tn(e,Wi()),null}function Jm(e){Bs!==null&&Bs.tag===0&&!(fi&6)&&ya();var i=fi;fi|=1;var h=ar.transition,g=di;try{if(ar.transition=null,di=1,e)return e()}finally{di=g,ar.transition=h,fi=i,!(fi&6)&&yr()}}function ou(){un=Qa.current,qe(Qa)}function ma(e,i){e.finishedWork=null,e.finishedLanes=0;var h=e.timeoutHandle;if(h!==Ft&&(e.timeoutHandle=Ft,lt(h)),dr!==null)for(h=dr.return;h!==null;){var g=h;switch(Yn(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&ri();break;case 3:We(),qe(ae),qe(Zt),Bi();break;case 5:pi(g);break;case 4:We();break;case 13:qe(Qe);break;case 19:qe(Qe);break;case 10:Td(g.type._context);break;case 22:case 23:ou()}h=h.return}if(Er=e,dr=e=js(e.current,null),Rr=un=i,_r=0,No=null,tu=Nh=pa=0,Jr=Oo=null,ga!==null){for(i=0;i<ga.length;i++)if(h=ga[i],g=h.interleaved,g!==null){h.interleaved=null;var v=g.next,P=h.pending;if(P!==null){var it=P.next;P.next=v,g.next=it}h.pending=g}ga=null}return e}function t0(e,i){do{var h=dr;try{if(yn(),Kr.current=wh,zs){for(var g=Fi.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}zs=!1}if(dn=0,ir=Ei=Fi=null,Qn=!1,Zn=0,Jd.current=null,h===null||h.return===null){_r=1,No=i,dr=null;break}t:{var P=e,it=h.return,Ct=h,Vt=i;if(i=Rr,Ct.flags|=32768,Vt!==null&&typeof Vt=="object"&&typeof Vt.then=="function"){var ge=Vt,Ie=Ct,Ze=Ie.tag;if(!(Ie.mode&1)&&(Ze===0||Ze===11||Ze===15)){var ke=Ie.alternate;ke?(Ie.updateQueue=ke.updateQueue,Ie.memoizedState=ke.memoizedState,Ie.lanes=ke.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var Ui=Sm(it);if(Ui!==null){Ui.flags&=-257,Em(Ui,it,Ct,P,i),Ui.mode&1&&Am(P,ge,i),i=Ui,Vt=ge;var Di=i.updateQueue;if(Di===null){var en=new Set;en.add(Vt),i.updateQueue=en}else Di.add(Vt);break t}else{if(!(i&1)){Am(P,ge,i),lu();break t}Vt=Error(o(426))}}else if($i&&Ct.mode&1){var _s=Sm(it);if(_s!==null){!(_s.flags&65536)&&(_s.flags|=256),Em(_s,it,Ct,P,i),ua(Ya(Vt,Ct));break t}}P=Vt=Ya(Vt,Ct),_r!==4&&(_r=2),Oo===null?Oo=[P]:Oo.push(P),P=it;do{switch(P.tag){case 3:P.flags|=65536,i&=-i,P.lanes|=i;var Ut=xm(P,Vt,i);gt(P,Ut);break t;case 1:Ct=Vt;var Mt=P.type,Yt=P.stateNode;if(!(P.flags&128)&&(typeof Mt.getDerivedStateFromError=="function"||Yt!==null&&typeof Yt.componentDidCatch=="function"&&(Hs===null||!Hs.has(Yt)))){P.flags|=65536,i&=-i,P.lanes|=i;var Te=wm(P,Ct,i);gt(P,Te);break t}}P=P.return}while(P!==null)}r0(h)}catch(Ge){i=Ge,dr===h&&h!==null&&(dr=h=h.return);continue}break}while(1)}function e0(){var e=Dh.current;return Dh.current=wh,e===null?wh:e}function lu(){(_r===0||_r===3||_r===2)&&(_r=4),Er===null||!(pa&268435455)&&!(Nh&268435455)||Gs(Er,Rr)}function Gh(e,i){var h=fi;fi|=2;var g=e0();(Er!==e||Rr!==i)&&(bs=null,ma(e,i));do try{fw();break}catch(v){t0(e,v)}while(1);if(yn(),fi=h,Dh.current=g,dr!==null)throw Error(o(261));return Er=null,Rr=0,_r}function fw(){for(;dr!==null;)i0(dr)}function gw(){for(;dr!==null&&!Ga();)i0(dr)}function i0(e){var i=a0(e.alternate,e,un);e.memoizedProps=e.pendingProps,i===null?r0(e):dr=i,Jd.current=null}function r0(e){var i=e;do{var h=i.alternate;if(e=i.return,i.flags&32768){if(h=ow(h,i),h!==null){h.flags&=32767,dr=h;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_r=6,dr=null;return}}else if(h=aw(h,i,un),h!==null){dr=h;return}if(i=i.sibling,i!==null){dr=i;return}dr=i=e}while(i!==null);_r===0&&(_r=5)}function va(e,i,h){var g=di,v=ar.transition;try{ar.transition=null,di=1,pw(e,i,h,g)}finally{ar.transition=v,di=g}return null}function pw(e,i,h,g){do ya();while(Bs!==null);if(fi&6)throw Error(o(327));h=e.finishedWork;var v=e.finishedLanes;if(h===null)return null;if(e.finishedWork=null,e.finishedLanes=0,h===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var P=h.lanes|h.childLanes;if($n(e,P),e===Er&&(dr=Er=null,Rr=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||zh||(zh=!0,o0(Ed,function(){return ya(),null})),P=(h.flags&15990)!==0,h.subtreeFlags&15990||P){P=ar.transition,ar.transition=null;var it=di;di=1;var Ct=fi;fi|=4,Jd.current=null,hw(e,h),Wm(h,e),ee(e.containerInfo),e.current=h,cw(h),Xx(),fi=Ct,di=it,ar.transition=P}else e.current=h;if(zh&&(zh=!1,Bs=e,Hh=v),P=e.pendingLanes,P===0&&(Hs=null),Yx(h.stateNode),tn(e,Wi()),i!==null)for(g=e.onRecoverableError,h=0;h<i.length;h++)v=i[h],g(v.value,{componentStack:v.stack,digest:v.digest});if(Oh)throw Oh=!1,e=ru,ru=null,e;return Hh&1&&e.tag!==0&&ya(),P=e.pendingLanes,P&1?e===nu?zo++:(zo=0,nu=e):zo=0,yr(),null}function ya(){if(Bs!==null){var e=$p(Hh),i=ar.transition,h=di;try{if(ar.transition=null,di=16>e?16:e,Bs===null)var g=!1;else{if(e=Bs,Bs=null,Hh=0,fi&6)throw Error(o(331));var v=fi;for(fi|=4,Re=e.current;Re!==null;){var P=Re,it=P.child;if(Re.flags&16){var Ct=P.deletions;if(Ct!==null){for(var Vt=0;Vt<Ct.length;Vt++){var ge=Ct[Vt];for(Re=ge;Re!==null;){var Ie=Re;switch(Ie.tag){case 0:case 11:case 15:Lo(8,Ie,P)}var Ze=Ie.child;if(Ze!==null)Ze.return=Ie,Re=Ze;else for(;Re!==null;){Ie=Re;var ke=Ie.sibling,Ui=Ie.return;if(Um(Ie),Ie===ge){Re=null;break}if(ke!==null){ke.return=Ui,Re=ke;break}Re=Ui}}}var Di=P.alternate;if(Di!==null){var en=Di.child;if(en!==null){Di.child=null;do{var _s=en.sibling;en.sibling=null,en=_s}while(en!==null)}}Re=P}}if(P.subtreeFlags&2064&&it!==null)it.return=P,Re=it;else t:for(;Re!==null;){if(P=Re,P.flags&2048)switch(P.tag){case 0:case 11:case 15:Lo(9,P,P.return)}var Ut=P.sibling;if(Ut!==null){Ut.return=P.return,Re=Ut;break t}Re=P.return}}var Mt=e.current;for(Re=Mt;Re!==null;){it=Re;var Yt=it.child;if(it.subtreeFlags&2064&&Yt!==null)Yt.return=it,Re=Yt;else t:for(it=Mt;Re!==null;){if(Ct=Re,Ct.flags&2048)try{switch(Ct.tag){case 0:case 11:case 15:Ph(9,Ct)}}catch(Ge){Xi(Ct,Ct.return,Ge)}if(Ct===it){Re=null;break t}var Te=Ct.sibling;if(Te!==null){Te.return=Ct.return,Re=Te;break t}Re=Ct.return}}if(fi=v,yr(),Dr&&typeof Dr.onPostCommitFiberRoot=="function")try{Dr.onPostCommitFiberRoot(vh,e)}catch{}g=!0}return g}finally{di=h,ar.transition=i}}return!1}function n0(e,i,h){i=Ya(h,i),i=xm(e,i,1),e=k(e,i,1),i=Hr(),e!==null&&(To(e,1,i),tn(e,i))}function Xi(e,i,h){if(e.tag===3)n0(e,e,h);else for(;i!==null;){if(i.tag===3){n0(i,e,h);break}else if(i.tag===1){var g=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Hs===null||!Hs.has(g))){e=Ya(h,e),e=wm(i,e,1),i=k(i,e,1),e=Hr(),i!==null&&(To(i,1,e),tn(i,e));break}}i=i.return}}function mw(e,i,h){var g=e.pingCache;g!==null&&g.delete(i),i=Hr(),e.pingedLanes|=e.suspendedLanes&h,Er===e&&(Rr&h)===h&&(_r===4||_r===3&&(Rr&130023424)===Rr&&500>Wi()-eu?ma(e,0):tu|=h),tn(e,i)}function s0(e,i){i===0&&(e.mode&1?(i=ph,ph<<=1,!(ph&130023424)&&(ph=4194304)):i=1);var h=Hr();e=Pr(e,i),e!==null&&(To(e,i,h),tn(e,h))}function vw(e){var i=e.memoizedState,h=0;i!==null&&(h=i.retryLane),s0(e,h)}function yw(e,i){var h=0;switch(e.tag){case 13:var g=e.stateNode,v=e.memoizedState;v!==null&&(h=v.retryLane);break;case 19:g=e.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(i),s0(e,h)}var a0;a0=function(e,i,h){if(e!==null)if(e.memoizedProps!==i.pendingProps||ae.current)Zr=!0;else{if(!(e.lanes&h)&&!(i.flags&128))return Zr=!1,sw(e,i,h);Zr=!!(e.flags&131072)}else Zr=!1,$i&&i.flags&1048576&&Xn(i,Wr,i.index);switch(i.lanes=0,i.tag){case 2:var g=i.type;Eh(e,i),e=i.pendingProps;var v=Ce(i,Zt.current);$a(i,h),v=Pd(null,i,g,e,v,h);var P=Md();return i.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Se(g)?(P=!0,Hi(i)):P=!1,i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,cn(i),v.updater=Ah,i.stateNode=v,v._reactInternals=i,Nd(i,g,e,h),i=Bd(null,i,g,!0,P,h)):(i.tag=0,$i&&P&&Cd(i),Xr(null,i,v,h),i=i.child),i;case 16:g=i.elementType;t:{switch(Eh(e,i),e=i.pendingProps,v=g._init,g=v(g._payload),i.type=g,v=i.tag=_w(g),e=Dn(g,e),v){case 0:i=Hd(null,i,g,e,h);break t;case 1:i=Rm(null,i,g,e,h);break t;case 11:i=Cm(null,i,g,e,h);break t;case 14:i=km(null,i,g,Dn(g.type,e),h);break t}throw Error(o(306,g,""))}return i;case 0:return g=i.type,v=i.pendingProps,v=i.elementType===g?v:Dn(g,v),Hd(e,i,g,v,h);case 1:return g=i.type,v=i.pendingProps,v=i.elementType===g?v:Dn(g,v),Rm(e,i,g,v,h);case 3:t:{if(Fm(i),e===null)throw Error(o(387));g=i.pendingProps,P=i.memoizedState,v=P.element,qp(e,i),mt(i,g,null,h);var it=i.memoizedState;if(g=it.element,xe&&P.isDehydrated)if(P={element:g,isDehydrated:!1,cache:it.cache,pendingSuspenseBoundaries:it.pendingSuspenseBoundaries,transitions:it.transitions},i.updateQueue.baseState=P,i.memoizedState=P,i.flags&256){v=Ya(Error(o(423)),i),i=Im(e,i,g,h,v);break t}else if(g!==v){v=Ya(Error(o(424)),i),i=Im(e,i,g,h,v);break t}else for(xe&&(Ar=Q(i.stateNode.containerInfo),ln=i,$i=!0,Mn=null,qn=!1),h=Fn(i,null,g,h),i.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Wa(),g===v){i=ys(e,i,h);break t}Xr(e,i,g,h)}i=i.child}return i;case 5:return ui(i),e===null&&kd(i),g=i.type,v=i.pendingProps,P=e!==null?e.memoizedProps:null,it=v.children,Ae(g,v)?it=null:P!==null&&Ae(g,P)&&(i.flags|=32),Mm(e,i),Xr(e,i,it,h),i.child;case 6:return e===null&&kd(i),null;case 13:return Lm(e,i,h);case 4:return Ye(i,i.stateNode.containerInfo),g=i.pendingProps,e===null?i.child=cr(i,null,g,h):Xr(e,i,g,h),i.child;case 11:return g=i.type,v=i.pendingProps,v=i.elementType===g?v:Dn(g,v),Cm(e,i,g,v,h);case 7:return Xr(e,i,i.pendingProps,h),i.child;case 8:return Xr(e,i,i.pendingProps.children,h),i.child;case 12:return Xr(e,i,i.pendingProps.children,h),i.child;case 10:t:{if(g=i.type._context,v=i.pendingProps,P=i.memoizedProps,it=v.value,fa(i,g,it),P!==null)if(Tn(P.value,it)){if(P.children===v.children&&!ae.current){i=ys(e,i,h);break t}}else for(P=i.child,P!==null&&(P.return=i);P!==null;){var Ct=P.dependencies;if(Ct!==null){it=P.child;for(var Vt=Ct.firstContext;Vt!==null;){if(Vt.context===g){if(P.tag===1){Vt=kt(-1,h&-h),Vt.tag=2;var ge=P.updateQueue;if(ge!==null){ge=ge.shared;var Ie=ge.pending;Ie===null?Vt.next=Vt:(Vt.next=Ie.next,Ie.next=Vt),ge.pending=Vt}}P.lanes|=h,Vt=P.alternate,Vt!==null&&(Vt.lanes|=h),ps(P.return,h,i),Ct.lanes|=h;break}Vt=Vt.next}}else if(P.tag===10)it=P.type===i.type?null:P.child;else if(P.tag===18){if(it=P.return,it===null)throw Error(o(341));it.lanes|=h,Ct=it.alternate,Ct!==null&&(Ct.lanes|=h),ps(it,h,i),it=P.sibling}else it=P.child;if(it!==null)it.return=P;else for(it=P;it!==null;){if(it===i){it=null;break}if(P=it.sibling,P!==null){P.return=it.return,it=P;break}it=it.return}P=it}Xr(e,i,v.children,h),i=i.child}return i;case 9:return v=i.type,g=i.pendingProps.children,$a(i,h),v=Sr(v),g=g(v),i.flags|=1,Xr(e,i,g,h),i.child;case 14:return g=i.type,v=Dn(g,i.pendingProps),v=Dn(g.type,v),km(e,i,g,v,h);case 15:return Tm(e,i,i.type,i.pendingProps,h);case 17:return g=i.type,v=i.pendingProps,v=i.elementType===g?v:Dn(g,v),Eh(e,i),i.tag=1,Se(g)?(e=!0,Hi(i)):e=!1,$a(i,h),bm(i,g,v),Nd(i,g,v,h),Bd(null,i,g,!0,e,h);case 19:return Nm(e,i,h);case 22:return Pm(e,i,h)}throw Error(o(156,i.tag))};function o0(e,i){return Kn(e,i)}function bw(e,i,h,g){this.tag=e,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(e,i,h,g){return new bw(e,i,h,g)}function hu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _w(e){if(typeof e=="function")return hu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===b)return 11;if(e===I)return 14}return 2}function js(e,i){var h=e.alternate;return h===null?(h=xn(e.tag,i,e.key,e.mode),h.elementType=e.elementType,h.type=e.type,h.stateNode=e.stateNode,h.alternate=e,e.alternate=h):(h.pendingProps=i,h.type=e.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=e.flags&14680064,h.childLanes=e.childLanes,h.lanes=e.lanes,h.child=e.child,h.memoizedProps=e.memoizedProps,h.memoizedState=e.memoizedState,h.updateQueue=e.updateQueue,i=e.dependencies,h.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},h.sibling=e.sibling,h.index=e.index,h.ref=e.ref,h}function jh(e,i,h,g,v,P){var it=2;if(g=e,typeof e=="function")hu(e)&&(it=1);else if(typeof e=="string")it=5;else t:switch(e){case f:return ba(h.children,v,P,i);case m:it=8,v|=8;break;case S:return e=xn(12,h,i,v|2),e.elementType=S,e.lanes=P,e;case x:return e=xn(13,h,i,v),e.elementType=x,e.lanes=P,e;case E:return e=xn(19,h,i,v),e.elementType=E,e.lanes=P,e;case p:return Vh(h,v,P,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _:it=10;break t;case y:it=9;break t;case b:it=11;break t;case I:it=14;break t;case R:it=16,g=null;break t}throw Error(o(130,e==null?e:typeof e,""))}return i=xn(it,h,i,v),i.elementType=e,i.type=g,i.lanes=P,i}function ba(e,i,h,g){return e=xn(7,e,g,i),e.lanes=h,e}function Vh(e,i,h,g){return e=xn(22,e,g,i),e.elementType=p,e.lanes=h,e.stateNode={isHidden:!1},e}function cu(e,i,h){return e=xn(6,e,null,i),e.lanes=h,e}function du(e,i,h){return i=xn(4,e.children!==null?e.children:[],e.key,i),i.lanes=h,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function xw(e,i,h,g,v){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ft,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wn(0),this.expirationTimes=Wn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wn(0),this.identifierPrefix=g,this.onRecoverableError=v,xe&&(this.mutableSourceEagerHydrationData=null)}function l0(e,i,h,g,v,P,it,Ct,Vt){return e=new xw(e,i,h,Ct,Vt),i===1?(i=1,P===!0&&(i|=8)):i=0,P=xn(3,null,null,i),e.current=P,P.stateNode=e,P.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},cn(P),e}function h0(e){if(!e)return At;e=e._reactInternals;t:{if(F(e)!==e||e.tag!==1)throw Error(o(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(Se(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(i!==null);throw Error(o(171))}if(e.tag===1){var h=e.type;if(Se(h))return mr(e,h,i)}return i}function c0(e){var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=st(i),e===null?null:e.stateNode}function d0(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var h=e.retryLane;e.retryLane=h!==0&&h<i?h:i}}function Wh(e,i){d0(e,i),(e=e.alternate)&&d0(e,i)}function ww(e){return e=st(e),e===null?null:e.stateNode}function Aw(){return null}return t.attemptContinuousHydration=function(e){if(e.tag===13){var i=Pr(e,134217728);if(i!==null){var h=Hr();_n(i,e,134217728,h)}Wh(e,134217728)}},t.attemptDiscreteHydration=function(e){if(e.tag===13){var i=Pr(e,1);if(i!==null){var h=Hr();_n(i,e,1,h)}Wh(e,1)}},t.attemptHydrationAtCurrentPriority=function(e){if(e.tag===13){var i=Us(e),h=Pr(e,i);if(h!==null){var g=Hr();_n(h,e,i,g)}Wh(e,i)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var h=jr(i.pendingLanes);h!==0&&(Ad(i,h|1),tn(i,Wi()),!(fi&6)&&(Za(),yr()))}break;case 13:Jm(function(){var g=Pr(e,1);if(g!==null){var v=Hr();_n(g,e,1,v)}}),Wh(e,1)}},t.batchedUpdates=function(e,i){var h=fi;fi|=1;try{return e(i)}finally{fi=h,fi===0&&(Za(),yh&&yr())}},t.createComponentSelector=function(e){return{$$typeof:Mh,value:e}},t.createContainer=function(e,i,h,g,v,P,it){return l0(e,i,!1,null,h,g,v,P,it)},t.createHasPseudoClassSelector=function(e){return{$$typeof:Rh,value:e}},t.createHydrationContainer=function(e,i,h,g,v,P,it,Ct,Vt){return e=l0(h,g,!0,e,v,P,it,Ct,Vt),e.context=h0(null),h=e.current,g=Hr(),v=Us(h),P=kt(g,v),P.callback=i??null,k(h,P,v),e.current.lanes=v,To(e,v,g),tn(e,g),e},t.createPortal=function(e,i,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:g==null?null:""+g,children:e,containerInfo:i,implementation:h}},t.createRoleSelector=function(e){return{$$typeof:Fh,value:e}},t.createTestNameSelector=function(e){return{$$typeof:Ih,value:e}},t.createTextSelector=function(e){return{$$typeof:Lh,value:e}},t.deferredUpdates=function(e){var i=di,h=ar.transition;try{return ar.transition=null,di=16,e()}finally{di=i,ar.transition=h}},t.discreteUpdates=function(e,i,h,g,v){var P=di,it=ar.transition;try{return ar.transition=null,di=1,e(i,h,g,v)}finally{di=P,ar.transition=it,fi===0&&Za()}},t.findAllNodes=Zd,t.findBoundingRects=function(e,i){if(!L)throw Error(o(363));i=Zd(e,i),e=[];for(var h=0;h<i.length;h++)e.push(j(i[h]));for(i=e.length-1;0<i;i--){h=e[i];for(var g=h.x,v=g+h.width,P=h.y,it=P+h.height,Ct=i-1;0<=Ct;Ct--)if(i!==Ct){var Vt=e[Ct],ge=Vt.x,Ie=ge+Vt.width,Ze=Vt.y,ke=Ze+Vt.height;if(g>=ge&&P>=Ze&&v<=Ie&&it<=ke){e.splice(i,1);break}else if(g!==ge||h.width!==Vt.width||ke<P||Ze>it){if(!(P!==Ze||h.height!==Vt.height||Ie<g||ge>v)){ge>g&&(Vt.width+=ge-g,Vt.x=g),Ie<v&&(Vt.width=v-ge),e.splice(i,1);break}}else{Ze>P&&(Vt.height+=Ze-P,Vt.y=P),ke<it&&(Vt.height=it-Ze),e.splice(i,1);break}}}return e},t.findHostInstance=c0,t.findHostInstanceWithNoPortals=function(e){return e=tt(e),e=e!==null?dt(e):null,e===null?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return c0(e)},t.flushControlled=function(e){var i=fi;fi|=1;var h=ar.transition,g=di;try{ar.transition=null,di=1,e()}finally{di=g,ar.transition=h,fi=i,fi===0&&(Za(),yr())}},t.flushPassiveEffects=ya,t.flushSync=Jm,t.focusWithin=function(e,i){if(!L)throw Error(o(363));for(e=Yd(e),i=qm(e,i),i=Array.from(i),e=0;e<i.length;){var h=i[e++];if(!W(h)){if(h.tag===5&&O(h.stateNode))return!0;for(h=h.child;h!==null;)i.push(h),h=h.sibling}}return!1},t.getCurrentUpdatePriority=function(){return di},t.getFindAllNodesFailureDescription=function(e,i){if(!L)throw Error(o(363));var h=0,g=[];e=[Yd(e),0];for(var v=0;v<e.length;){var P=e[v++],it=e[v++],Ct=i[it];if((P.tag!==5||!W(P))&&(qd(P,Ct)&&(g.push(Qd(Ct)),it++,it>h&&(h=it)),it<i.length))for(P=P.child;P!==null;)e.push(P,it),P=P.sibling}if(h<i.length){for(e=[];h<i.length;h++)e.push(Qd(i[h]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+e.join(" > ")}return null},t.getPublicRootInstance=function(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return Lt(e.child.stateNode);default:return e.child.stateNode}},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:ww,findFiberByHostInstance:e.findFiberByHostInstance||Aw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")e=!1;else{var i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(i.isDisabled||!i.supportsFiber)e=!0;else{try{vh=i.inject(e),Dr=i}catch{}e=!!i.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,i,h,g){if(!L)throw Error(o(363));e=Zd(e,i);var v=z(e,h,g).disconnect;return{disconnect:function(){v()}}},t.registerMutableSourceForHydration=function(e,i){var h=i._getVersion;h=h(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,h]:e.mutableSourceEagerHydrationData.push(i,h)},t.runWithPriority=function(e,i){var h=di;try{return di=e,i()}finally{di=h}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,i,h,g){var v=i.current,P=Hr(),it=Us(v);return h=h0(h),i.context===null?i.context=h:i.pendingContext=h,i=kt(P,it),i.payload={element:e},g=g===void 0?null:g,g!==null&&(i.callback=g),e=k(v,i,it),e!==null&&(_n(e,v,it,P),X(e,v,it)),it},t};(function(r){r.exports=K_})(Cp);const X_=f0(Cp.exports);var md={exports:{}},oa={};oa.ConcurrentRoot=1,oa.ContinuousEventPriority=4,oa.DefaultEventPriority=16,oa.DiscreteEventPriority=1,oa.IdleEventPriority=536870912,oa.LegacyRoot=0,function(r){r.exports=oa}(md);const kp={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let Tp=!1,Pp=!1;const vd=".react-konva-event",Y_=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,q_=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,Q_={};function fh(r,t,s=Q_){if(!Tp&&"zIndex"in t&&(console.warn(q_),Tp=!0),!Pp&&t.draggable){var n=t.x!==void 0||t.y!==void 0,a=t.onDragEnd||t.onDragMove;n&&!a&&(console.warn(Y_),Pp=!0)}for(var o in s)if(!kp[o]){var c=o.slice(0,2)==="on",u=s[o]!==t[o];if(c&&u){var d=o.substr(2).toLowerCase();d.substr(0,7)==="content"&&(d="content"+d.substr(7,1).toUpperCase()+d.substr(8)),r.off(d,s[o])}var f=!t.hasOwnProperty(o);f&&r.setAttr(o,void 0)}var m=t._useStrictMode,S={},_=!1;const y={};for(var o in t)if(!kp[o]){var c=o.slice(0,2)==="on",b=s[o]!==t[o];if(c&&b){var d=o.substr(2).toLowerCase();d.substr(0,7)==="content"&&(d="content"+d.substr(7,1).toUpperCase()+d.substr(8)),t[o]&&(y[d]=t[o])}!c&&(t[o]!==s[o]||m&&t[o]!==r.getAttr(o))&&(_=!0,S[o]=t[o])}_&&(r.setAttrs(S),Ds(r));for(var d in y)r.on(d+vd,y[d])}function Ds(r){if(!si.Konva.autoDrawEnabled){var t=r.getLayer()||r.getStage();t&&t.batchDraw()}}const Mp={},Z_={};ko.Node.prototype._applyProps=fh;function J_(r,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}r.add(t),Ds(r)}function tx(r,t,s){let n=ko[r];n||(console.error(`Konva has no node with the type ${r}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${r}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=ko.Group);const a={},o={};for(var c in t){var u=c.slice(0,2)==="on";u?o[c]=t[c]:a[c]=t[c]}const d=new n(a);return fh(d,o),d}function ex(r,t,s){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${r}"`)}function ix(r,t,s){return!1}function rx(r){return r}function nx(){return null}function sx(){return null}function ax(r,t,s,n){return Z_}function ox(){}function lx(r){}function hx(r,t){return!1}function cx(){return Mp}function dx(){return Mp}const ux=setTimeout,fx=clearTimeout,gx=-1;function px(r,t){return!1}const mx=!1,vx=!0,yx=!0;function bx(r,t){t.parent===r?t.moveToTop():r.add(t),Ds(r)}function _x(r,t){t.parent===r?t.moveToTop():r.add(t),Ds(r)}function Rp(r,t,s){t._remove(),r.add(t),t.setZIndex(s.getZIndex()),Ds(r)}function xx(r,t,s){Rp(r,t,s)}function wx(r,t){t.destroy(),t.off(vd),Ds(r)}function Ax(r,t){t.destroy(),t.off(vd),Ds(r)}function Sx(r,t,s){console.error(`Text components are not yet supported in ReactKonva. You text is: "${s}"`)}function Ex(r,t,s){}function Cx(r,t,s,n,a){fh(r,a,n)}function kx(r){r.hide(),Ds(r)}function Tx(r){}function Px(r,t){(t.visible==null||t.visible)&&r.show()}function Mx(r,t){}function Rx(r){}function Fx(){}const Ix=()=>md.exports.DefaultEventPriority,Lx=Object.freeze(Object.defineProperty({__proto__:null,appendInitialChild:J_,createInstance:tx,createTextInstance:ex,finalizeInitialChildren:ix,getPublicInstance:rx,prepareForCommit:nx,preparePortalMount:sx,prepareUpdate:ax,resetAfterCommit:ox,resetTextContent:lx,shouldDeprioritizeSubtree:hx,getRootHostContext:cx,getChildHostContext:dx,scheduleTimeout:ux,cancelTimeout:fx,noTimeout:gx,shouldSetTextContent:px,isPrimaryRenderer:mx,warnsIfNotActing:vx,supportsMutation:yx,appendChild:bx,appendChildToContainer:_x,insertBefore:Rp,insertInContainerBefore:xx,removeChild:wx,removeChildFromContainer:Ax,commitTextUpdate:Sx,commitMount:Ex,commitUpdate:Cx,hideInstance:kx,hideTextInstance:Tx,unhideInstance:Px,unhideTextInstance:Mx,clearContainer:Rx,detachDeletedInstance:Fx,getCurrentEventPriority:Ix,now:$h.exports.unstable_now,idlePriority:$h.exports.unstable_IdlePriority,run:$h.exports.unstable_runWithPriority},Symbol.toStringTag,{value:"Module"}));var Dx=Object.defineProperty,Nx=Object.defineProperties,Ox=Object.getOwnPropertyDescriptors,Fp=Object.getOwnPropertySymbols,zx=Object.prototype.hasOwnProperty,Hx=Object.prototype.propertyIsEnumerable,Ip=(r,t,s)=>t in r?Dx(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Lp=(r,t)=>{for(var s in t||(t={}))zx.call(t,s)&&Ip(r,s,t[s]);if(Fp)for(var s of Fp(t))Hx.call(t,s)&&Ip(r,s,t[s]);return r},Bx=(r,t)=>Nx(r,Ox(t)),Dp,Np;typeof window<"u"&&((Dp=window.document)!=null&&Dp.createElement||((Np=window.navigator)==null?void 0:Np.product)==="ReactNative")?Fr.exports.useLayoutEffect:Fr.exports.useEffect;function Op(r,t,s){if(!r)return;if(s(r)===!0)return r;let n=t?r.return:r.child;for(;n;){const a=Op(n,t,s);if(a)return a;n=t?null:n.sibling}}function zp(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const Hp=console.error;console.error=function(){const r=[...arguments].join("");if(r!=null&&r.startsWith("Warning:")&&r.includes("useContext")){console.error=Hp;return}return Hp.apply(this,arguments)};const yd=zp(Fr.exports.createContext(null));class Bp extends Fr.exports.Component{render(){return Fr.exports.createElement(yd.Provider,{value:this._reactInternals},this.props.children)}}function Ux(){const r=Fr.exports.useContext(yd);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=Fr.exports.useId();return Fr.exports.useMemo(()=>{for(const s of[r,r==null?void 0:r.alternate]){if(!s)continue;const n=Op(s,!1,a=>{let o=a.memoizedState;for(;o;){if(o.memoizedState===t)return!0;o=o.next}});if(n)return n}},[r,t])}function Gx(){const r=Ux(),[t]=Fr.exports.useState(()=>new Map);t.clear();let s=r;for(;s;){if(s.type&&typeof s.type=="object"){const n=s.type._context===void 0&&s.type.Provider===s.type?s.type:s.type._context;n&&n!==yd&&!t.has(n)&&t.set(n,Fr.exports.useContext(zp(n)))}s=s.return}return t}function jx(){const r=Gx();return Fr.exports.useMemo(()=>Array.from(r.keys()).reduce((t,s)=>n=>Fr.exports.createElement(t,null,Fr.exports.createElement(s.Provider,Bx(Lp({},n),{value:r.get(s)}))),t=>Fr.exports.createElement(Bp,Lp({},t))),[r])}function Vx(r){const t=se.useRef({});return se.useLayoutEffect(()=>{t.current=r}),se.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}let Up,Ua;Up=r=>{const t=se.useRef(),s=se.useRef(),n=se.useRef(),a=Vx(r),o=jx(),c=u=>{const{forwardedRef:d}=r;!d||(typeof d=="function"?d(u):d.current=u)};return se.useLayoutEffect(()=>(s.current=new ko.Stage({width:r.width,height:r.height,container:t.current}),c(s.current),n.current=Ua.createContainer(s.current,md.exports.LegacyRoot,!1,null),Ua.updateContainer(se.createElement(o,{},r.children),n.current),()=>{!ko.isBrowser||(c(null),Ua.updateContainer(null,n.current,null),s.current.destroy())}),[]),se.useLayoutEffect(()=>{c(s.current),fh(s.current,r,a),Ua.updateContainer(se.createElement(o,{},r.children),n.current,null)}),se.createElement("div",{ref:t,id:r.id,accessKey:r.accessKey,className:r.className,role:r.role,style:r.style,tabIndex:r.tabIndex,title:r.title})},v0="Layer",p0="Group",m0="Image",Ua=X_(Lx),Ua.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:se.version,rendererPackageName:"react-konva"}),y0=se.forwardRef((r,t)=>se.createElement(Bp,{},se.createElement(Up,{...r,forwardedRef:t})));let gn;typeof window<"u"?gn=window:typeof self<"u"?gn=self:gn=global;let bd=null,_d=null;const Gp=20,xd=gn.clearTimeout,jp=gn.setTimeout,wd=gn.cancelAnimationFrame||gn.mozCancelAnimationFrame||gn.webkitCancelAnimationFrame,Vp=gn.requestAnimationFrame||gn.mozRequestAnimationFrame||gn.webkitRequestAnimationFrame;wd==null||Vp==null?(bd=xd,_d=function(r){return jp(r,Gp)}):(bd=function([r,t]){wd(r),xd(t)},_d=function(r){const t=Vp(function(){xd(s),r()}),s=jp(function(){wd(t),r()},Gp);return[t,s]});function Wx(r){let t,s,n,a,o,c,u;const d=typeof document<"u"&&document.attachEvent;if(!d){c=function(x){const E=x.__resizeTriggers__,I=E.firstElementChild,R=E.lastElementChild,p=I.firstElementChild;R.scrollLeft=R.scrollWidth,R.scrollTop=R.scrollHeight,p.style.width=I.offsetWidth+1+"px",p.style.height=I.offsetHeight+1+"px",I.scrollLeft=I.scrollWidth,I.scrollTop=I.scrollHeight},o=function(x){return x.offsetWidth!==x.__resizeLast__.width||x.offsetHeight!==x.__resizeLast__.height},u=function(x){if(x.target.className&&typeof x.target.className.indexOf=="function"&&x.target.className.indexOf("contract-trigger")<0&&x.target.className.indexOf("expand-trigger")<0)return;const E=this;c(this),this.__resizeRAF__&&bd(this.__resizeRAF__),this.__resizeRAF__=_d(function(){o(E)&&(E.__resizeLast__.width=E.offsetWidth,E.__resizeLast__.height=E.offsetHeight,E.__resizeListeners__.forEach(function(I){I.call(E,x)}))})};let m=!1,S="";n="animationstart";const _="Webkit Moz O ms".split(" ");let y="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),b="";{const x=document.createElement("fakeelement");if(x.style.animationName!==void 0&&(m=!0),m===!1){for(let E=0;E<_.length;E++)if(x.style[_[E]+"AnimationName"]!==void 0){b=_[E],S="-"+b.toLowerCase()+"-",n=y[E],m=!0;break}}}s="resizeanim",t="@"+S+"keyframes "+s+" { from { opacity: 0; } to { opacity: 0; } } ",a=S+"animation: 1ms "+s+"; "}const f=function(m){if(!m.getElementById("detectElementResize")){const S=(t||"")+".resize-triggers { "+(a||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',_=m.head||m.getElementsByTagName("head")[0],y=m.createElement("style");y.id="detectElementResize",y.type="text/css",r!=null&&y.setAttribute("nonce",r),y.styleSheet?y.styleSheet.cssText=S:y.appendChild(m.createTextNode(S)),_.appendChild(y)}};return{addResizeListener:function(m,S){if(d)m.attachEvent("onresize",S);else{if(!m.__resizeTriggers__){const _=m.ownerDocument,y=gn.getComputedStyle(m);y&&y.position==="static"&&(m.style.position="relative"),f(_),m.__resizeLast__={},m.__resizeListeners__=[],(m.__resizeTriggers__=_.createElement("div")).className="resize-triggers";const b=_.createElement("div");b.className="expand-trigger",b.appendChild(_.createElement("div"));const x=_.createElement("div");x.className="contract-trigger",m.__resizeTriggers__.appendChild(b),m.__resizeTriggers__.appendChild(x),m.appendChild(m.__resizeTriggers__),c(m),m.addEventListener("scroll",u,!0),n&&(m.__resizeTriggers__.__animationListener__=function(E){E.animationName===s&&c(m)},m.__resizeTriggers__.addEventListener(n,m.__resizeTriggers__.__animationListener__))}m.__resizeListeners__.push(S)}},removeResizeListener:function(m,S){if(d)m.detachEvent("onresize",S);else if(m.__resizeListeners__.splice(m.__resizeListeners__.indexOf(S),1),!m.__resizeListeners__.length){m.removeEventListener("scroll",u,!0),m.__resizeTriggers__.__animationListener__&&(m.__resizeTriggers__.removeEventListener(n,m.__resizeTriggers__.__animationListener__),m.__resizeTriggers__.__animationListener__=null);try{m.__resizeTriggers__=!m.removeChild(m.__resizeTriggers__)}catch{}}}}}g0=class extends Fr.exports.Component{constructor(...r){super(...r),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:t,disableWidth:s,onResize:n}=this.props;if(this._parentNode){const a=window.getComputedStyle(this._parentNode)||{},o=parseFloat(a.paddingLeft||"0"),c=parseFloat(a.paddingRight||"0"),u=parseFloat(a.paddingTop||"0"),d=parseFloat(a.paddingBottom||"0"),f=this._parentNode.getBoundingClientRect(),m=f.height-u-d,S=f.width-o-c,_=this._parentNode.offsetHeight-u-d,y=this._parentNode.offsetWidth-o-c;(!t&&(this.state.height!==_||this.state.scaledHeight!==m)||!s&&(this.state.width!==y||this.state.scaledWidth!==S))&&(this.setState({height:_,width:y,scaledHeight:m,scaledWidth:S}),typeof n=="function"&&n({height:_,scaledHeight:m,scaledWidth:S,width:y}))}},this._setRef=t=>{this._autoSizer=t}}componentDidMount(){const{nonce:r}=this.props,t=this._autoSizer?this._autoSizer.parentNode:null;if(t!=null&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){this._parentNode=t;const s=t.ownerDocument.defaultView.ResizeObserver;s!=null?(this._resizeObserver=new s(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(t)):(this._detectElementResize=Wx(r),this._detectElementResize.addResizeListener(t,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:r,defaultHeight:t,defaultWidth:s,disableHeight:n=!1,disableWidth:a=!1,doNotBailOutOnEmptyChildren:o=!1,nonce:c,onResize:u,style:d={},tagName:f="div",...m}=this.props,{height:S,scaledHeight:_,scaledWidth:y,width:b}=this.state,x={overflow:"visible"},E={};let I=!1;return n||(S===0&&(I=!0),x.height=0,E.height=S,E.scaledHeight=_),a||(b===0&&(I=!0),x.width=0,E.width=b,E.scaledWidth=y),o&&(I=!1),Fr.exports.createElement(f,{ref:this._setRef,style:{...x,...d},...m},!I&&r(E))}}});export{g0 as A,p0 as G,m0 as I,v0 as L,y0 as S,b0 as V,_0 as _,Pw as __tla,x0 as a};
