import{r as l,R as S,j as R,a as s,__tla as b}from"./index-f72dbdd0.js";import{_ as P,A as C,V as U,S as D,L as H,I as $,a as L,__tla as T}from"./react-virtualized-auto-sizer.esm-5698c0dc.js";let I,V=Promise.all([(()=>{try{return b}catch{}})(),(()=>{try{return T}catch{}})()]).then(async()=>{const k=(o,{scale:d=1}={},{refreshDeps:u}={refreshDeps:[]})=>{const[_,v]=l.exports.useState([]);return l.exports.useEffect(()=>{console.log("pdf\u5F00\u59CB"),console.time("pdf\u52A0\u8F7D\u65F6\u95F4"),(async()=>{const a=[],w=await P({url:o,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.2.67/cmaps/",cMapPacked:!0}).promise;for(let x=0;x<w.numPages;x++){const h=await w.getPage(x+1),t=h.getViewport({scale:d}),p=document.createElement("canvas"),f=p.getContext("2d");p.width=t.width,p.height=t.height,console.time("page.render"),f!=null&&await h.render({canvasContext:f,viewport:t}).promise,console.timeEnd("page.render"),h.cleanup(),a.push({width:t.width,height:t.height,pdfImgDataUrl:p.toDataURL()})}return a})().then(a=>{v(a),console.timeEnd("pdf\u52A0\u8F7D\u65F6\u95F4")})},u),_};L.workerSrc="pdf.worker.js",I=function(){const o=l.exports.useRef(null),d=l.exports.useRef(null),[u,_]=l.exports.useState({x:0,y:0}),[v,a]=S.useState(0),[w,x]=S.useState(0),h=l.exports.useRef(null),t=k("./demo.pdf",{scale:1.5},{refreshDeps:[]}),{contentHeight:p,contentWidth:f}=l.exports.useMemo(()=>({contentHeight:t.reduce((r,n)=>r+n.height,0),contentWidth:Math.max(...t.map(r=>r.width))}),[t]),E=l.exports.useCallback(()=>{if(d.current==null||o.current==null)return;const{scrollLeft:r,scrollTop:n,clientHeight:e}=d.current,i=r,g=n,c=f-i,m=e;o.current.container().style.transform=`translate(${i}px, ${g}px)`,o.current.container().style.width=`${c}px`,o.current.container().style.height=`${m}px`,o.current.position({x:-i,y:-g}),o.current.setSize({width:c,height:m}),_({x:i,y:g})},[f]);return l.exports.useEffect(()=>{var e;const r=u.y,n=t.reduce((i,g,c,m)=>{const y=m.slice(0,c+1).reduce((M,j)=>M+j.height,0);return r<=y?i:i+1},0);h.current!=null&&((e=h.current)==null||e.scrollToIndex({index:n}),a(n))},[u,t]),l.exports.useEffect(()=>{var n;let r=0;for(let e=0;e<t.length;e++){const i=t[e];if(e===w){(n=d.current)==null||n.scrollTo({top:r+10});break}else r=r+i.height}},[w,t]),R("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",position:"relative",overflow:"hidden"},children:[s("div",{style:{flexBasis:200,flexShrink:0,height:"100%",overflow:"auto"},children:s(C,{children:({width:r,height:n})=>s(U,{ref:h,style:{height:n,width:r},totalCount:t.length,overscan:{main:n,reverse:n},itemContent:e=>s("div",{style:v===e?{border:"1px solid #000"}:{},children:s("img",{width:"100%",src:t[e].pdfImgDataUrl,onClick:()=>{a(e),x(e)}})})})})}),s("div",{style:{flexGrow:1,height:"100%",overflow:"hidden"},children:s(C,{children:({width:r,height:n})=>s("div",{ref:d,style:{width:r,height:n,overflow:"auto"},onScroll:E,children:s("div",{style:{margin:"0 auto",width:Math.max(...t.map(e=>e.width)),height:p},children:s(D,{width:r,height:n,ref:o,x:-u.x,y:-u.y,children:s(H,{children:t.map((e,i,g)=>{if(!(Math.abs(i-v)<=2))return null;const c=new window.Image;return c.src=e.pdfImgDataUrl,s($,{y:g.slice(0,i).reduce((m,y)=>m+((y==null?void 0:y.height)??0),0),x:(f-e.width)/2,image:c},i)})})})})})})})]})}});export{V as __tla,I as default};
