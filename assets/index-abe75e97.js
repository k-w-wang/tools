import{r as i,a,R as b,j as S,b1 as E}from"./index-5e1236b8.js";import{d as L}from"./debounce-4e606a1d.js";function y({content:d,onSplitChange:x}){const e=i.exports.useRef(null),s=i.exports.useRef([]).current,[u,o]=i.exports.useState(null),[c,f]=i.exports.useState({x:0,y:0}),[p,v]=i.exports.useState({x:0,y:0});return i.exports.useEffect(()=>{var r;if(e.current==null)return;const t=document.createTextNode(d);(r=e.current)==null||r.appendChild(t);const g=L(()=>{var C;const n=(C=e.current)==null?void 0:C.getBoundingClientRect();s.length=0;for(let h=1;h<t.length;h++){const m=document.createRange();m.setStart(t,h),m.setEnd(t,h+1),s.push({left:m.getBoundingClientRect().left-((n==null?void 0:n.left)??0),right:m.getBoundingClientRect().right-((n==null?void 0:n.left)??0),top:m.getBoundingClientRect().top-((n==null?void 0:n.top)??0),bottom:m.getBoundingClientRect().bottom-((n==null?void 0:n.top)??0)})}},1e3,!0),l=new ResizeObserver(()=>{g()});return l.observe(e.current),()=>{l.disconnect()}},[d]),i.exports.useEffect(()=>{var t,g;return(t=e.current)==null||t.addEventListener("mousemove",l=>{var n;const r=(n=e.current)==null?void 0:n.getBoundingClientRect();v({x:l.clientX-((r==null?void 0:r.left)??0),y:l.clientY-((r==null?void 0:r.top)??0)})}),(g=e.current)==null||g.addEventListener("mouseleave",l=>{v({x:0,y:0})}),()=>{var l,r;(l=e.current)==null||l.removeEventListener("mousemove",()=>{console.log("remove mousemove")}),(r=e.current)==null||r.removeEventListener("mouseleave",()=>{console.log("remove mousemove")})}},[]),i.exports.useEffect(()=>{if(p.x===0||p.y===0){o(null),f({x:0,y:0});return}s.forEach((t,g)=>{t.left<=p.x&&t.right>=p.x&&t.top<=p.y&&t.bottom>=p.y&&(f({x:t.left-2,y:t.top}),o(g+1))})},[p]),a("div",{ref:e,title:"点击任意位置拆分",className:"content",style:{border:"1px dashed #3c85f0",padding:4},onClick:()=>{if(u==null)return;const t=[d.substring(0,u),d.substring(u)];x(t)},children:c.x!==0&&c.y!==0&&a("span",{className:"content-before",style:{left:c.x,top:c.y}})})}function B({content:d,className:x}){const[e,s]=i.exports.useState([d]),u=(o,c)=>{s(()=>(e.splice(c,1,...o),[...e]))};return a("div",{className:x,style:{display:"flex",flexDirection:"column",gap:"4px"},children:e.map((o,c)=>a(y,{content:o,onSplitChange:f=>u(f,c)},o+c.toString()))})}const j=()=>{const[d,x]=b.useState(["这是一段测试文字！"]),e=(s,u)=>{x(o=>(o.splice(u,1,...s),[...o]))};return S(E,{children:[a("h1",{children:"V1版本"}),a(B,{content:"这是一段测试文字！"},"v1"),a("h1",{children:"V2版本"}),a("div",{style:{display:"flex",flexDirection:"column",gap:4},children:d.map((s,u)=>a(y,{content:s,onSplitChange:o=>e(o,u)},s+u.toString()))},"v2")]})};export{j as default};
